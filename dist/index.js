"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var Wg=require("p-retry"),Ug=require("emittery"),b=require("lodash"),A=require("white-web-sdk"),Hg=require("uuid"),Zg=require("@juggle/resize-observer"),Qg=require("video.js"),$u=require("value-enhancer");function dl(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}function Gg(t){if(t&&t.__esModule)return t;var e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});return t&&Object.keys(t).forEach(function(i){if(i!=="default"){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}}),e.default=t,Object.freeze(e)}var Hd=dl(Wg),Ai=dl(Ug),Fu=dl(Qg),re=(t=>(t.AppMove="AppMove",t.AppFocus="AppFocus",t.AppResize="AppResize",t.AppBoxStateChange="AppBoxStateChange",t.GetAttributes="GetAttributes",t.UpdateWindowManagerWrapper="UpdateWindowManagerWrapper",t.InitReplay="InitReplay",t.WindowCreated="WindowCreated",t.SetMainViewScenePath="SetMainViewScenePath",t.SetMainViewSceneIndex="SetMainViewSceneIndex",t.SetAppFocusIndex="SetAppFocusIndex",t.SwitchViewsToFreedom="SwitchViewsToFreedom",t.MoveCamera="MoveCamera",t.MoveCameraToContain="MoveCameraToContain",t.CursorMove="CursorMove",t.RootDirRemoved="RootDirRemoved",t.Refresh="Refresh",t.InitMainViewCamera="InitMainViewCamera",t))(re||{});const qo="__WindowManger",So="__WindowMangerEnsureReconnected__";var De=(t=>(t.Size="size",t.Position="position",t.SceneIndex="SceneIndex",t.ZIndex="zIndex",t))(De||{}),Zd=(t=>(t.setBoxSize="setBoxSize",t.setBoxMinSize="setBoxMinSize",t.destroy="destroy",t))(Zd||{}),ea=(t=>(t.StartCreate="StartCreate",t))(ea||{}),ta=(t=>(t.Leave="leave",t.Normal="normal",t))(ta||{});const Wu="2.16.1",Yg=340/720,Xg=340/720,Jg=9/16,We="/",Qd="/init",Gd=200,J=new Ai.default;class Kg{constructor(){this.list=[],this.isEmit=!1,this.invoked=()=>{this.currentInvoker=void 0,this.list.length===0&&(this.clear(),this.emitReady())},this.clear=()=>{clearInterval(this.timer),this.timer=void 0}}initInterval(){return setInterval(()=>{this.invoke()},50)}push(e){this.list.push(e),this.invoke(),this.timer===void 0&&this.list.length>0&&(this.timer=this.initInterval())}invoke(){if(this.list.length===0||this.currentInvoker!==void 0)return;const e=this.list.shift();e&&(this.currentInvoker=e,e().then(()=>{this.invoked()}).catch(i=>{console.error(`[WindowManager]: create app error: ${i.message}`),this.invoked()}))}emitReady(){this.isEmit||setTimeout(()=>{J.emit("ready")},Gd),this.isEmit=!0}empty(){this.list=[],this.clear()}destroy(){this.timer&&this.clear()}}const R=new Ai.default,qg="__WindowManagerAppCache";let Kn,Uu;const em=async()=>{Kn=await nm()},tm=(t,e)=>{if(!!Kn)return sm(Kn,{kind:t,sourceCode:e})},im=async t=>Kn?await rm(Kn,t):null;function nm(){return new Promise((t,e)=>{const i=indexedDB.open(qg,2);i.onerror=n=>{e(n)},i.onupgradeneeded=n=>{const r=n.target.result;r.objectStoreNames.contains("apps")||(Uu=r.createObjectStore("apps",{keyPath:"kind"}),Uu.createIndex("kind","kind",{unique:!0}))},i.onsuccess=()=>{const n=i.result;t(n)}})}function rm(t,e){return new Promise((i,n)=>{const s=t.transaction(["apps"]).objectStore("apps").index("kind").get(e);s.onerror=o=>n(o),s.onsuccess=()=>{s.result?i(s.result):i(null)}})}function sm(t,e){return new Promise((i,n)=>{const r=t.transaction(["apps"],"readwrite").objectStore("apps").add(e);r.onsuccess=()=>i(),r.onerror=()=>n()})}const om="NetlessApp",am=1e4,lm=async t=>{const e=await im(t);if(e)return e.sourceCode;{const n=await(await dm(t,{timeout:am})).text();return await tm(t,n),n}},Hu=(t,e)=>{let i=Function(t+`
;return ${e}`)();return typeof i=="undefined"&&(i=window[e]),i},um=async(t,e,i)=>{const n=i||om+e;J.emit("loadApp",{kind:e,status:"start"});let r;try{if(r=await lm(t),!r||r.length===0)throw J.emit("loadApp",{kind:e,status:"failed",reason:"script is empty."}),new Error("[WindowManager]: script is empty.")}catch(s){throw J.emit("loadApp",{kind:e,status:"failed",reason:s.message}),s}return cm(r,n,e)},cm=(t,e,i)=>{try{const n=Hu(t,e);return J.emit("loadApp",{kind:i,status:"success"}),n}catch(n){if(n.message.includes("Can only have one anonymous define call per script file")){const r=window.define;typeof r=="function"&&r.amd&&delete r.amd;const s=Hu(t,e);return J.emit("loadApp",{kind:i,status:"success"}),s}throw J.emit("loadApp",{kind:i,status:"failed",reason:n.message}),n}};async function dm(t,e){const{timeout:i=1e4}=e,n=new AbortController,r=setTimeout(()=>n.abort(),i),s=await fetch(t,{...e,signal:n.signal,headers:{"content-type":"text/plain"}});return clearTimeout(r),s}class hm{constructor(){this.kindEmitters=new Map,this.registered=new Map,this.appClassesCache=new Map,this.appClasses=new Map,this.syncRegisterApp=null,this.onSyncRegisterAppChange=e=>{this.register({kind:e.kind,src:e.src})}}setSyncRegisterApp(e){this.syncRegisterApp=e}async register(e){this.appClassesCache.delete(e.kind),this.registered.set(e.kind,e);const i=e.src;let n;if(typeof i=="string"&&(n=async()=>{const r=await um(i,e.kind,e.name);return r.__esModule?r.default:r},this.syncRegisterApp&&this.syncRegisterApp({kind:e.kind,src:i,name:e.name})),typeof i=="function"&&(n=async()=>{let r=await i();if(r)return(r.__esModule||r.default)&&(r=r.default),r;throw new Error(`[WindowManager]: load remote script failed, ${i}`)}),typeof i=="object"&&(n=async()=>i),this.appClasses.set(e.kind,async()=>{let r=this.appClassesCache.get(e.kind);return r||(r=n(),this.appClassesCache.set(e.kind,r)),r}),e.addHooks){const r=this.createKindEmitter(e.kind);r&&e.addHooks(r)}}unregister(e){this.appClasses.delete(e),this.appClassesCache.delete(e),this.registered.delete(e);const i=this.kindEmitters.get(e);i&&(i.clearListeners(),this.kindEmitters.delete(e))}async notifyApp(e,i,n){const r=this.kindEmitters.get(e);await(r==null?void 0:r.emit(i,n))}createKindEmitter(e){if(!this.kindEmitters.has(e)){const i=new Ai.default;this.kindEmitters.set(e,i)}return this.kindEmitters.get(e)}}const Ne=new hm,pm=async t=>{var i,n;const e=await((i=Ne.appClasses.get(t))==null?void 0:i());return e&&((n=e.config)==null?void 0:n.singleton)?t:`${t}-${Hg.v4().replace("-","").slice(0,8)}`},xi=(t,e)=>{if(t.focusScenePath!==e)return t.focusScenePath=e,t},ia=(t,e)=>{if(t&&t.isWritable&&t.state.sceneState.scenePath!==e){const i=e==="/"?"":e;t.setScenePath(i)}},fm=(t,e,i)=>{var n;if(t&&e){const s=(n=rn(t)[e])==null?void 0:n[i];if(s)return`${e}/${s.name}`}},na=(t,e,i)=>{t&&t.scenePathType(e)!==A.ScenePathType.None&&t.removeScenes(e,i)},gm=(t,e)=>{R.once(t).then(e)};b.debounce((t,e)=>{t.emit("mainViewModeChange",e)},200);const mm=(t,e,i=0)=>{const n=rn(t)[e];if(!n)return;const r=n[i];if(!r)return;const s=r.name;return e===We?`/${s}`:`${e}/${s}`},rn=t=>t.entireScenes(),Ln=(t,e,i,n)=>{var r;for(let s=0;s<i.length;++s)if((r=i[s].name)!=null&&r.includes("/"))throw new Error("scenes name can not have '/'");return t==null?void 0:t.putScenes(e,i,n)},vm=t=>t.startsWith("/"),Io=t=>{const e=t.split("/");e.pop();let i=e.join("/");return i===""&&(i="/"),i},wm=t=>t.endsWith("/")?t.slice(0,-1):t,Zu=t=>{const e=t.split(".").map(i=>i.padStart(2,"0")).join("");return parseInt(e)},Yd=t=>new Promise(e=>setTimeout(e,t)),ym=t=>t.split("").reduce((i,n)=>(n===We&&(i+=1),i),0)===1;class xm{constructor(e){this.manager=e,this.displayer=this.manager.displayer,this.mainMagixEventListener=i=>{if(i.authorId!==this.displayer.observerId){const n=i.payload;switch(n.eventName){case re.AppMove:{this.appMoveHandler(n.payload);break}case re.AppResize:{this.appResizeHandler(n.payload);break}case re.AppBoxStateChange:{this.boxStateChangeHandler(n.payload);break}case re.SetMainViewScenePath:{this.setMainViewScenePathHandler(n.payload);break}case re.MoveCamera:{this.moveCameraHandler(n.payload);break}case re.MoveCameraToContain:{this.moveCameraToContainHandler(n.payload);break}case re.CursorMove:{this.cursorMoveHandler(n.payload);break}case re.RootDirRemoved:{this.rootDirRemovedHandler();break}case re.Refresh:{this.refreshHandler();break}case re.InitMainViewCamera:{this.initMainViewCameraHandler();break}case re.SetAppFocusIndex:{this.setAppFocusViewIndexHandler(n.payload);break}}}},this.appMoveHandler=i=>{var n;(n=this.boxManager)==null||n.moveBox(i)},this.appResizeHandler=i=>{var n,r;(n=this.boxManager)==null||n.resizeBox(Object.assign(i,{skipUpdate:!0})),(r=this.manager.room)==null||r.refreshViewSize()},this.boxStateChangeHandler=i=>{J.emit("boxStateChange",i)},this.setMainViewScenePathHandler=({nextScenePath:i})=>{xi(this.manager.mainView,i),J.emit("mainViewScenePathChange",i)},this.moveCameraHandler=i=>{b.isEqual(b.omit(i,["animationMode"]),{...this.manager.mainView.camera})||this.manager.mainView.moveCamera(i)},this.moveCameraToContainHandler=i=>{this.manager.mainView.moveCameraToContain(i)},this.cursorMoveHandler=i=>{R.emit("cursorMove",i)},this.rootDirRemovedHandler=()=>{this.manager.createRootDirScenesCallback(),this.manager.mainViewProxy.rebind(),R.emit("rootDirRemoved")},this.refreshHandler=()=>{this.manager.windowManger._refresh()},this.initMainViewCameraHandler=()=>{this.manager.mainViewProxy.addCameraReaction()},this.setAppFocusViewIndexHandler=i=>{if(i.type==="main")this.manager.setSceneIndexWithoutSync(i.index);else if(i.type==="app"&&i.appID){const n=this.manager.appProxies.get(i.appID);n&&n.setSceneIndexWithoutSync(i.index)}}}get boxManager(){return this.manager.boxManager}addListeners(){this.displayer.addMagixEventListener(qo,this.mainMagixEventListener)}removeListeners(){this.displayer.removeMagixEventListener(qo,this.mainMagixEventListener)}}class Xd extends Error{constructor(){super(...arguments),this.message="[WindowManager]: app duplicate exists and cannot be created again"}}class Mm extends Error{constructor(e){super(`[WindowManager]: app ${e} need register or provide src`)}}class tt extends Error{constructor(){super(...arguments),this.message="[WindowManager]: AppManager must be initialized"}}class Jd extends Error{constructor(e){super(`[WindowManager]: white-web-sdk version must large than ${e}`)}}class Kd extends Error{constructor(){super(...arguments),this.message="[WindowManager]: kind must be a valid string"}}class qd extends Error{constructor(){super(...arguments),this.message="[WindowManager]: box need created"}}class eh extends Error{constructor(){super(...arguments),this.message='[WindowManager]: ScenePath should start with "/"'}}class th extends Error{constructor(){super(...arguments),this.message="[WindowManager]: boxManager not found"}}class ih extends Error{constructor(){super(...arguments),this.message="[WindowManager]: room phase only Connected can be bindContainer"}}const nh="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Sm=nh.length,Qu=Array(20),Li=()=>{for(let t=0;t<20;t++)Qu[t]=nh.charAt(Math.random()*Sm);return Qu.join("")};class pn{constructor(){this.disposers=new Map}add(e,i=Li()){return this.flush(i),this.disposers.set(i,e()),i}addDisposer(e,i=Li()){return this.flush(i),this.disposers.set(i,e),i}addEventListener(e,i,n,r,s=Li()){return this.add(()=>(e.addEventListener(i,n,r),()=>e.removeEventListener(i,n,r)),s),s}setTimeout(e,i,n=Li()){return this.add(()=>{const r=window.setTimeout(()=>{this.remove(n),e()},i);return()=>window.clearTimeout(r)},n)}setInterval(e,i,n=Li()){return this.add(()=>{const r=window.setInterval(e,i);return()=>window.clearInterval(r)},n)}remove(e){const i=this.disposers.get(e);return this.disposers.delete(e),i}flush(e){const i=this.remove(e);if(i)try{i()}catch(n){console.error(n)}}flushAll(){this.disposers.forEach(e=>{try{e()}catch(i){console.error(i)}}),this.disposers.clear()}}const rh=t=>(e,i)=>{if(e!==void 0)if(A.listenUpdated){const n=r=>{r.map(o=>o.kind).includes(t)&&i()};return A.listenUpdated(e,n),i(),()=>A.unlistenUpdated(e,n)}else return A.reaction(()=>e,()=>{i()},{fireImmediately:!0})},ra=(t,e,i)=>{let n=null;const r=A.reaction(t,()=>{n&&(n(),n=null);const s=t();b.isObject(s)?(n=()=>A.unlistenUpdated(s,e),A.listenUpdated(s,e)):i==null||i(s)},{fireImmediately:!0});return()=>{n==null||n(),r()}};rh(A.UpdateEventKind.Removed);rh(A.UpdateEventKind.Inserted);class Im{constructor(){this.listeners=new Set}get length(){return this.listeners.size}dispatch(e){this.listeners.forEach(i=>i(e))}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}}const Co=Object.keys;function Gu(t){return Boolean(b.has(t,"__isRef"))}function Cm(t){return{k:Li(),v:t,__isRef:!0}}const et="_WM-STORAGE_";class Yu{constructor(e,i,n){if(this.maxIllusionQueueSize=500,this._sideEffect=new pn,this._destroyed=!1,this._refMap=new WeakMap,this._lastValue=new Map,this.onStateChanged=new Im,n&&!b.isObject(n))throw new Error(`Default state for Storage ${i} is not an object.`);this._context=e,this.id=i||null,this._state={};const r=this._getRawState(this._state);this._context.getIsWritable()&&(this.id===null?e.isAddApp&&n&&this.setState(n):(r===this._state||!b.isObject(r))&&(b.get(this._context.getAttributes(),[et])||this._context.updateAttributes([et],{}),this._context.updateAttributes([et,this.id],this._state),n&&this.setState(n))),Co(r).forEach(s=>{if(!(this.id===null&&s===et))try{const o=b.isObject(r[s])?JSON.parse(JSON.stringify(r[s])):r[s];Gu(o)?(this._state[s]=o.v,b.isObject(o.v)&&this._refMap.set(o.v,o)):this._state[s]=o}catch(o){console.error(o)}}),this._sideEffect.addDisposer(ra(()=>this.id===null?e.getAttributes():b.get(e.getAttributes(),[et,this.id]),this._updateProperties.bind(this),this.destroy.bind(this)))}get state(){return this._destroyed&&console.warn(`Accessing state on destroyed Storage "${this.id}"`),this._state}addStateChangedListener(e){return this.onStateChanged.addListener(e),()=>this.onStateChanged.removeListener(e)}ensureState(e){return this.setState(Co(e).reduce((i,n)=>(b.has(this._state,n)||(i[n]=e[n]),i),{}))}setState(e){if(this._destroyed){console.error(new Error(`Cannot call setState on destroyed Storage "${this.id}".`));return}if(!this._context.getIsWritable()){console.error(new Error(`Cannot setState on Storage "${this.id}" without writable access`),e);return}const i=Co(e);i.length>0&&i.forEach(n=>{const r=e[n];if(r!==this._state[n])if(r===void 0)this._lastValue.set(n,this._state[n]),delete this._state[n],this._setRawState(n,r);else{this._lastValue.set(n,this._state[n]),this._state[n]=r;let s=r;if(b.isObject(r)){let o=this._refMap.get(r);o||(o=Cm(r),this._refMap.set(r,o)),s=o}this._setRawState(n,s)}})}emptyStorage(){if(!(b.size(this._state)<=0)){if(this._destroyed){console.error(new Error(`Cannot empty destroyed Storage "${this.id}".`));return}if(!this._context.getIsWritable()){console.error(new Error(`Cannot empty Storage "${this.id}" without writable access.`));return}this.setState(b.mapValues(this._state,b.noop))}}deleteStorage(){if(this.id===null)throw new Error("Cannot delete main Storage");if(!this._context.getIsWritable()){console.error(new Error(`Cannot delete Storage "${this.id}" without writable access.`));return}this.destroy(),this._context.updateAttributes([et,this.id],void 0)}get destroyed(){return this._destroyed}destroy(){this._destroyed=!0,this._sideEffect.flushAll()}_getRawState(e){var i;return this.id===null?(i=this._context.getAttributes())!=null?i:e:b.get(this._context.getAttributes(),[et,this.id],e)}_setRawState(e,i){if(this.id===null){if(e===et)throw new Error(`Cannot set attribute internal filed "${et}"`);return this._context.updateAttributes([e],i)}else return this._context.updateAttributes([et,this.id,e],i)}_updateProperties(e){var i;if(this._destroyed){console.error(new Error(`Cannot call _updateProperties on destroyed Storage "${this.id}".`));return}if(e.length>0){const n={};for(let r=0;r<e.length;r++)try{const s=e[r],o=s.key;if(this.id===null&&o===et)continue;const a=b.isObject(s.value)?JSON.parse(JSON.stringify(s.value)):s.value;let l;switch(this._lastValue.has(o)&&(l=this._lastValue.get(o),this._lastValue.delete(o)),s.kind){case 2:{b.has(this._state,o)&&(l=this._state[o],delete this._state[o]),n[o]={oldValue:l};break}default:{let u=a;if(Gu(a)){const{k:c,v:d}=a,f=this._state[o];b.isObject(f)&&((i=this._refMap.get(f))==null?void 0:i.k)===c?u=f:(u=d,b.isObject(d)&&this._refMap.set(d,a))}u!==this._state[o]&&(l=this._state[o],this._state[o]=u),n[o]={newValue:u,oldValue:l};break}}}catch(s){console.error(s)}this.onStateChanged.dispatch(n)}}}class bm{constructor(e,i,n,r,s){this.manager=e,this.boxManager=i,this.appId=n,this.appProxy=r,this.appOptions=s,this.mobxUtils={autorun:A.autorun,reaction:A.reaction,toJS:A.toJS},this.objectUtils={listenUpdated:A.listenUpdated,unlistenUpdated:A.unlistenUpdated,listenDisposed:A.listenDisposed,unlistenDisposed:A.unlistenDisposed},this.store=this.manager.store,this.isReplay=this.manager.isReplay,this.getDisplayer=()=>this.manager.displayer,this.getAttributes=()=>this.appProxy.attributes,this.getScenes=()=>{const o=this.store.getAppAttributes(this.appId);return o!=null&&o.isDynamicPPT?this.appProxy.scenes:o==null?void 0:o.options.scenes},this.getView=()=>this.appProxy.view,this.mountView=o=>{const a=this.getView();a&&(a.divElement=o,setTimeout(()=>{var l;(l=this.getRoom())==null||l.refreshViewSize(),J.emit("onAppViewMounted",{appId:this.appId,view:a})},1e3))},this.getInitScenePath=()=>this.manager.getAppInitPath(this.appId),this.getIsWritable=()=>this.manager.canOperate,this.getBox=()=>{const o=this.boxManager.getBox(this.appId);if(o)return o;throw new qd},this.getRoom=()=>this.manager.room,this.setAttributes=o=>{this.manager.safeSetAttributes({[this.appId]:o})},this.updateAttributes=(o,a)=>{this.manager.attributes[this.appId]&&this.manager.safeUpdateAttributes([this.appId,...o],a)},this.setScenePath=async o=>{var a;!this.appProxy.box||(this.appProxy.setFullPath(o),(a=this.getRoom())==null||a.setScenePath(o))},this.getAppOptions=()=>typeof this.appOptions=="function"?this.appOptions():this.appOptions,this.createStorage=(o,a)=>{const l=new Yu(this,o,a);return this.emitter.on("destroy",()=>{l.destroy()}),l},this.dispatchMagixEvent=(...o)=>{var l;const a=`${this.appId}:${o[0]}`;return(l=this.manager.room)==null?void 0:l.dispatchMagixEvent(a,o[1])},this.addMagixEventListener=(o,a,l)=>{const u=`${this.appId}:${o}`;return this.manager.displayer.addMagixEventListener(u,a,l),()=>this.manager.displayer.removeMagixEventListener(u,a)},this.removeMagixEventListener=this.manager.displayer.removeMagixEventListener.bind(this.manager.displayer),this.nextPage=async()=>{const o=this.pageState.index+1;return o>this.pageState.length-1?(console.warn("[WindowManager] nextPage: index out of range"),!1):(this.appProxy.setSceneIndex(o),!0)},this.jumpPage=async o=>0<=o&&o<this.pageState.length?(this.appProxy.setSceneIndex(o),!0):(console.warn("[WindowManager] nextPage: index out of range"),!1),this.prevPage=async()=>{const o=this.pageState.index-1;return o<0?(console.warn("[WindowManager] prevPage: index out of range"),!1):(this.appProxy.setSceneIndex(o),!0)},this.addPage=async o=>{const a=o==null?void 0:o.after,l=o==null?void 0:o.scene,u=this.appProxy.scenePath;if(!!u)if(a){const c=this.pageState.index+1;Ln(this.manager.room,u,[l||{}],c)}else Ln(this.manager.room,u,[l||{}])},this.removePage=async o=>{const a=o===void 0?this.pageState.index:o;return this.pageState.length===1?(console.warn("[WindowManager]: can not remove the last page"),!1):a<0||a>=this.pageState.length?(console.warn(`[WindowManager]: page index ${o} out of range`),!1):this.appProxy.removeSceneByIndex(a)},this.emitter=r.appEmitter,this.isAddApp=r.isAddApp}get storage(){return this._storage||(this._storage=new Yu(this)),this._storage}get pageState(){return this.appProxy.pageState}get kind(){return this.appProxy.kind}dispatchAppEvent(e,i){R.emit(`custom-${this.kind}`,{kind:this.kind,appId:this.appId,type:e,value:i})}get extendWrapper(){return this.manager.extendWrapper}}class Am{constructor(e){this.params=e,this.sceneNode=null,this.onSceneChange=r=>{this.sceneNode=r,this.params.notifyPageStateChange()};const{displayer:i,scenePath:n}=this.params;n&&(this.sceneNode=i.createScenesCallback(n,{onAddScene:this.onSceneChange,onRemoveScene:this.onSceneChange}))}getFullPath(e){var n;const i=(n=this.sceneNode)==null?void 0:n.scenes;if(this.params.scenePath&&i){const r=i[e];if(r)return`${this.params.scenePath}/${r}`}}toObject(){var e,i;return{index:((e=this.params.view)==null?void 0:e.focusSceneIndex)||0,length:((i=this.sceneNode)==null?void 0:i.scenes.length)||0}}destroy(){var e;(e=this.sceneNode)==null||e.dispose()}}var sh={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,i="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(i=!1));function r(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,d,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var v=new r(c,d||l,f),w=i?i+u:u;return l._events[w]?l._events[w].fn?l._events[w]=[l._events[w],v]:l._events[w].push(v):(l._events[w]=v,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],c,d;if(this._eventsCount===0)return u;for(d in c=this._events)e.call(c,d)&&u.push(i?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},a.prototype.listeners=function(u){var c=i?i+u:u,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,v=d.length,w=new Array(v);f<v;f++)w[f]=d[f].fn;return w},a.prototype.listenerCount=function(u){var c=i?i+u:u,d=this._events[c];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,c,d,f,v,w){var y=i?i+u:u;if(!this._events[y])return!1;var h=this._events[y],p=arguments.length,g,m;if(h.fn){switch(h.once&&this.removeListener(u,h.fn,void 0,!0),p){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,c),!0;case 3:return h.fn.call(h.context,c,d),!0;case 4:return h.fn.call(h.context,c,d,f),!0;case 5:return h.fn.call(h.context,c,d,f,v),!0;case 6:return h.fn.call(h.context,c,d,f,v,w),!0}for(m=1,g=new Array(p-1);m<p;m++)g[m-1]=arguments[m];h.fn.apply(h.context,g)}else{var x=h.length,M;for(m=0;m<x;m++)switch(h[m].once&&this.removeListener(u,h[m].fn,void 0,!0),p){case 1:h[m].fn.call(h[m].context);break;case 2:h[m].fn.call(h[m].context,c);break;case 3:h[m].fn.call(h[m].context,c,d);break;case 4:h[m].fn.call(h[m].context,c,d,f);break;default:if(!g)for(M=1,g=new Array(p-1);M<p;M++)g[M-1]=arguments[M];h[m].fn.apply(h[m].context,g)}}return!0},a.prototype.on=function(u,c,d){return s(this,u,c,d,!1)},a.prototype.once=function(u,c,d){return s(this,u,c,d,!0)},a.prototype.removeListener=function(u,c,d,f){var v=i?i+u:u;if(!this._events[v])return this;if(!c)return o(this,v),this;var w=this._events[v];if(w.fn)w.fn===c&&(!f||w.once)&&(!d||w.context===d)&&o(this,v);else{for(var y=0,h=[],p=w.length;y<p;y++)(w[y].fn!==c||f&&!w[y].once||d&&w[y].context!==d)&&h.push(w[y]);h.length?this._events[v]=h.length===1?h[0]:h:o(this,v)}return this},a.prototype.removeAllListeners=function(u){var c;return u?(c=i?i+u:u,this._events[c]&&o(this,c)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=i,a.EventEmitter=a,t.exports=a})(sh);var vs=sh.exports;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var qn=function(){return qn=Object.assign||function(e){for(var i,n=1,r=arguments.length;n<r;n++){i=arguments[n];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},qn.apply(this,arguments)};function hl(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i}var bo=0,oh=typeof window!="undefined"&&window.requestAnimationFrame!==void 0?function(t){return window.requestAnimationFrame(t)}:function(t){var e=Date.now(),i=Math.max(0,16.7-(e-bo));bo=e+i,setTimeout(function(){return t(bo)},i)},Em=function(t){var e=[],i=[],n=0,r=!1,s=0,o=new WeakSet,a=new WeakSet,l={cancel:function(u){var c=i.indexOf(u);o.add(u),c!==-1&&i.splice(c,1)},process:function(u){var c;if(r=!0,c=[i,e],e=c[0],i=c[1],i.length=0,n=e.length,n){var d;for(s=0;s<n;s++)d=e[s],d(u),a.has(d)===!0&&!o.has(d)&&(l.schedule(d),t(!0))}r=!1},schedule:function(u,c,d){c===void 0&&(c=!1),d===void 0&&(d=!1);var f=d&&r,v=f?e:i;o.delete(u),c&&a.add(u),v.indexOf(u)===-1&&(v.push(u),f&&(n=e.length))}};return l},Tm=40,Xu=1/60*1e3,qr=!0,er=!1,sa=!1,Bn={delta:0,timestamp:0},pl=["read","update","preRender","render","postRender"],Nm=function(t){return er=t},ah=pl.reduce(function(t,e){return t[e]=Em(Nm),t},{}),Pm=pl.reduce(function(t,e){var i=ah[e];return t[e]=function(n,r,s){return r===void 0&&(r=!1),s===void 0&&(s=!1),er||Bm(),i.schedule(n,r,s),n},t},{}),km=function(t){return ah[t].process(Bn)},lh=function(t){er=!1,Bn.delta=qr?Xu:Math.max(Math.min(t-Bn.timestamp,Tm),1),qr||(Xu=Bn.delta),Bn.timestamp=t,sa=!0,pl.forEach(km),sa=!1,er&&(qr=!1,oh(lh))},Bm=function(){er=!0,qr=!0,sa||oh(lh)};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Je=function(){return Je=Object.assign||function(e){for(var i,n=1,r=arguments.length;n<r;n++){i=arguments[n];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Je.apply(this,arguments)},uh=function(t,e){return function(i){return Math.max(Math.min(i,e),t)}},es=function(t){return t%1?Number(t.toFixed(5)):t},ch=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i,Ks={test:function(t){return typeof t=="number"},parse:parseFloat,transform:function(t){return t}},jn=Je(Je({},Ks),{transform:uh(0,1)}),Dr=Je(Je({},Ks),{default:1}),fl=function(t){return{test:function(e){return typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1},parse:parseFloat,transform:function(e){return""+e+t}}},ri=fl("deg"),Rn=fl("%"),Z=fl("px"),Ju=Je(Je({},Rn),{parse:function(t){return Rn.parse(t)/100},transform:function(t){return Rn.transform(t*100)}}),Dm=function(t){return t.substring(t.indexOf("(")+1,t.lastIndexOf(")"))},zm=uh(0,255),oa=function(t){return t.red!==void 0},aa=function(t){return t.hue!==void 0};function _m(t){return Dm(t).replace(/(,|\/)/g," ").split(/ \s*/)}var dh=function(t){return function(e){if(typeof e!="string")return e;for(var i={},n=_m(e),r=0;r<4;r++)i[t[r]]=n[r]!==void 0?parseFloat(n[r]):1;return i}},Lm=function(t){var e=t.red,i=t.green,n=t.blue,r=t.alpha,s=r===void 0?1:r;return"rgba("+e+", "+i+", "+n+", "+s+")"},jm=function(t){var e=t.hue,i=t.saturation,n=t.lightness,r=t.alpha,s=r===void 0?1:r;return"hsla("+e+", "+i+", "+n+", "+s+")"},Ao=Je(Je({},Ks),{transform:function(t){return Math.round(zm(t))}});function gl(t,e){return t.startsWith(e)&&ch.test(t)}var ts={test:function(t){return typeof t=="string"?gl(t,"rgb"):oa(t)},parse:dh(["red","green","blue","alpha"]),transform:function(t){var e=t.red,i=t.green,n=t.blue,r=t.alpha,s=r===void 0?1:r;return Lm({red:Ao.transform(e),green:Ao.transform(i),blue:Ao.transform(n),alpha:es(jn.transform(s))})}},Eo={test:function(t){return typeof t=="string"?gl(t,"hsl"):aa(t)},parse:dh(["hue","saturation","lightness","alpha"]),transform:function(t){var e=t.hue,i=t.saturation,n=t.lightness,r=t.alpha,s=r===void 0?1:r;return jm({hue:Math.round(e),saturation:Rn.transform(es(i)),lightness:Rn.transform(es(n)),alpha:es(jn.transform(s))})}},Ku=Je(Je({},ts),{test:function(t){return typeof t=="string"&&gl(t,"#")},parse:function(t){var e="",i="",n="";return t.length>4?(e=t.substr(1,2),i=t.substr(3,2),n=t.substr(5,2)):(e=t.substr(1,1),i=t.substr(2,1),n=t.substr(3,1),e+=e,i+=i,n+=n),{red:parseInt(e,16),green:parseInt(i,16),blue:parseInt(n,16),alpha:1}}}),ut={test:function(t){return typeof t=="string"&&ch.test(t)||oa(t)||aa(t)},parse:function(t){return ts.test(t)?ts.parse(t):Eo.test(t)?Eo.parse(t):Ku.test(t)?Ku.parse(t):t},transform:function(t){return oa(t)?ts.transform(t):aa(t)?Eo.transform(t):t}},ml=function(t){var e=t.onRead,i=t.onRender,n=t.uncachedValues,r=n===void 0?new Set:n,s=t.useCache,o=s===void 0?!0:s;return function(a){a===void 0&&(a={});var l=hl(a,[]),u={},c=[],d=!1;function f(w,y){w.startsWith("--")&&(l.hasCSSVariable=!0);var h=u[w];u[w]=y,u[w]!==h&&(c.indexOf(w)===-1&&c.push(w),d||(d=!0,Pm.render(v.render)))}var v={get:function(w,y){y===void 0&&(y=!1);var h=!y&&o&&!r.has(w)&&u[w]!==void 0;return h?u[w]:e(w,l)},set:function(w,y){if(typeof w=="string")f(w,y);else for(var h in w)f(h,w[h]);return this},render:function(w){return w===void 0&&(w=!1),(d||w===!0)&&(i(u,l,c),d=!1,c.length=0),this}};return v}},Rm=/([a-z])([A-Z])/g,Vm="$1-$2",qs=function(t){return t.replace(Rm,Vm).toLowerCase()},hh=new Map,vl=new Map,ph=["Webkit","Moz","O","ms",""],Om=ph.length,$m=typeof document!="undefined",To,fh=function(t,e){return vl.set(t,qs(e))},Fm=function(t){To=To||document.createElement("div");for(var e=0;e<Om;e++){var i=ph[e],n=i==="",r=n?t:i+t.charAt(0).toUpperCase()+t.slice(1);if(r in To.style||n){if(n&&t==="clipPath"&&vl.has(t))return;hh.set(t,r),fh(t,(n?"":"-")+qs(r))}}},Wm=function(t){return fh(t,t)},gh=function(t,e){e===void 0&&(e=!1);var i=e?vl:hh;return i.has(t)||($m?Fm(t):Wm(t)),i.get(t)||t},Um=["","X","Y","Z"],Hm=["translate","scale","rotate","skew","transformPerspective"],la=Hm.reduce(function(t,e){return Um.reduce(function(i,n){return i.push(e+n),i},t)},["x","y","z"]),Zm=la.reduce(function(t,e){return t[e]=!0,t},{});function wl(t){return Zm[t]===!0}function Qm(t,e){return la.indexOf(t)-la.indexOf(e)}var Gm=new Set(["originX","originY","originZ"]);function Ym(t){return Gm.has(t)}var qu=qn(qn({},Ks),{transform:Math.round}),Xm={color:ut,backgroundColor:ut,outlineColor:ut,fill:ut,stroke:ut,borderColor:ut,borderTopColor:ut,borderRightColor:ut,borderBottomColor:ut,borderLeftColor:ut,borderWidth:Z,borderTopWidth:Z,borderRightWidth:Z,borderBottomWidth:Z,borderLeftWidth:Z,borderRadius:Z,radius:Z,borderTopLeftRadius:Z,borderTopRightRadius:Z,borderBottomRightRadius:Z,borderBottomLeftRadius:Z,width:Z,maxWidth:Z,height:Z,maxHeight:Z,size:Z,top:Z,right:Z,bottom:Z,left:Z,padding:Z,paddingTop:Z,paddingRight:Z,paddingBottom:Z,paddingLeft:Z,margin:Z,marginTop:Z,marginRight:Z,marginBottom:Z,marginLeft:Z,rotate:ri,rotateX:ri,rotateY:ri,rotateZ:ri,scale:Dr,scaleX:Dr,scaleY:Dr,scaleZ:Dr,skew:ri,skewX:ri,skewY:ri,distance:Z,translateX:Z,translateY:Z,translateZ:Z,x:Z,y:Z,z:Z,perspective:Z,opacity:jn,originX:Ju,originY:Ju,originZ:Z,zIndex:qu,fillOpacity:jn,strokeOpacity:jn,numOctaves:qu},yl=function(t){return Xm[t]},Jm=function(t,e){return e&&typeof t=="number"?e.transform(t):t},Vn="scrollLeft",On="scrollTop",mh=new Set([Vn,On]),Km=new Set([Vn,On,"transform"]),qm={x:"translateX",y:"translateY",z:"translateZ"};function vh(t){return typeof t=="function"}function ev(t,e,i,n,r,s){s===void 0&&(s=!0);var o="",a=!1;i.sort(Qm);for(var l=i.length,u=0;u<l;u++){var c=i[u];o+=(qm[c]||c)+"("+e[c]+") ",a=c==="z"?!0:a}return!a&&r?o+="translateZ(0)":o=o.trim(),vh(t.transform)?o=t.transform(e,n?"":o):s&&n&&(o="none"),o}function tv(t,e,i,n,r,s,o,a){e===void 0&&(e=!0),i===void 0&&(i={}),n===void 0&&(n={}),r===void 0&&(r={}),s===void 0&&(s=[]),o===void 0&&(o=!1),a===void 0&&(a=!0);var l=!0,u=!1,c=!1;for(var d in t){var f=t[d],v=yl(d),w=Jm(f,v);wl(d)?(u=!0,n[d]=w,s.push(d),l&&(v.default&&f!==v.default||!v.default&&f!==0)&&(l=!1)):Ym(d)?(r[d]=w,c=!0):(!Km.has(d)||!vh(w))&&(i[gh(d,o)]=w)}return(u||typeof t.transform=="function")&&(i.transform=ev(t,n,s,l,e,a)),c&&(i.transformOrigin=(r.originX||"50%")+" "+(r.originY||"50%")+" "+(r.originZ||0)),i}function xl(t){var e=t===void 0?{}:t,i=e.enableHardwareAcceleration,n=i===void 0?!0:i,r=e.isDashCase,s=r===void 0?!0:r,o=e.allowTransformNone,a=o===void 0?!0:o,l={},u={},c={},d=[];return function(f){return d.length=0,tv(f,n,l,u,c,d,s,a),l}}function iv(t,e){var i=e.element,n=e.preparseOutput,r=yl(t);if(wl(t))return r&&r.default||0;if(mh.has(t))return i[t];var s=window.getComputedStyle(i,null).getPropertyValue(gh(t,!0))||0;return n&&r&&r.test(s)&&r.parse?r.parse(s):s}function nv(t,e,i){var n=e.element,r=e.buildStyles,s=e.hasCSSVariable;if(Object.assign(n.style,r(t)),s)for(var o=i.length,a=0;a<o;a++){var l=i[a];l.startsWith("--")&&n.style.setProperty(l,t[l])}i.indexOf(Vn)!==-1&&(n[Vn]=t[Vn]),i.indexOf(On)!==-1&&(n[On]=t[On])}var rv=ml({onRead:iv,onRender:nv,uncachedValues:mh});function sv(t,e){e===void 0&&(e={});var i=e.enableHardwareAcceleration,n=e.allowTransformNone,r=hl(e,["enableHardwareAcceleration","allowTransformNone"]);return rv(qn({element:t,buildStyles:xl({enableHardwareAcceleration:i,allowTransformNone:n}),preparseOutput:!0},r))}var wh=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues"]),ec=.5,yh=function(){return{style:{}}},No=function(t,e){return Z.transform(t*e)},ov={x:0,y:0,width:0,height:0};function tc(t,e,i){return typeof t=="string"?t:Z.transform(e+i*t)}function av(t,e,i){return tc(e,t.x,t.width)+" "+tc(i,t.y,t.height)}var xh={enableHardwareAcceleration:!1,isDashCase:!1};function lv(t,e,i,n,r,s){e===void 0&&(e=ov),n===void 0&&(n=xl(xh)),r===void 0&&(r=yh()),s===void 0&&(s=!0);var o=t.attrX,a=t.attrY,l=t.originX,u=t.originY,c=t.pathLength,d=t.pathSpacing,f=d===void 0?1:d,v=t.pathOffset,w=v===void 0?0:v,y=hl(t,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]),h=n(y);for(var p in h)if(p==="transform")r.style.transform=h[p];else{var g=s&&!wh.has(p)?qs(p):p;r[g]=h[p]}return(l!==void 0||u!==void 0||h.transform)&&(r.style.transformOrigin=av(e,l!==void 0?l:ec,u!==void 0?u:ec)),o!==void 0&&(r.x=o),a!==void 0&&(r.y=a),i!==void 0&&c!==void 0&&(r[s?"stroke-dashoffset":"strokeDashoffset"]=No(-w,i),r[s?"stroke-dasharray":"strokeDasharray"]=No(c,i)+" "+No(f,i)),r}function uv(t,e,i){i===void 0&&(i=!0);var n=yh(),r=xl(xh);return function(s){return lv(s,t,e,r,n,i)}}var cv=function(t){return typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()},dv=function(t){try{return cv(t)}catch{return{x:0,y:0,width:0,height:0}}},hv=function(t){return t.tagName==="path"},pv=ml({onRead:function(t,e){var i=e.element;if(t=wh.has(t)?t:qs(t),wl(t)){var n=yl(t);return n&&n.default||0}else return i.getAttribute(t)},onRender:function(t,e){var i=e.element,n=e.buildAttrs,r=n(t);for(var s in r)s==="style"?Object.assign(i.style,r.style):i.setAttribute(s,r[s])}}),fv=function(t){var e=dv(t),i=hv(t)&&t.getTotalLength?t.getTotalLength():void 0;return pv({element:t,buildAttrs:uv(e,i)})},gv=ml({useCache:!1,onRead:function(t){return t==="scrollTop"?window.pageYOffset:window.pageXOffset},onRender:function(t){var e=t.scrollTop,i=e===void 0?0:e,n=t.scrollLeft,r=n===void 0?0:n;return window.scrollTo(r,i)}}),ua=new WeakMap,mv=function(t){return t instanceof HTMLElement||typeof t.click=="function"},vv=function(t){return t instanceof SVGElement||"ownerSVGElement"in t},wv=function(t,e){var i;return t===window?i=gv(t):mv(t)?i=sv(t,e):vv(t)&&(i=fv(t)),ua.set(t,i),i},yv=function(t,e){return ua.has(t)?ua.get(t):wv(t,e)};function xv(t,e){var i=typeof t=="string"?document.querySelector(t):t;return yv(i,e)}var dt=function(e,i,n,r){var s=n?n.call(r,e,i):void 0;if(s!==void 0)return!!s;if(e===i)return!0;if(typeof e!="object"||!e||typeof i!="object"||!i)return!1;var o=Object.keys(e),a=Object.keys(i);if(o.length!==a.length)return!1;for(var l=Object.prototype.hasOwnProperty.bind(i),u=0;u<o.length;u++){var c=o[u];if(!l(c))return!1;var d=e[c],f=i[c];if(s=n?n.call(r,d,f,c):void 0,s===!1||s===void 0&&d!==f)return!1}return!0};const Mh="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Mv=Mh.length,ic=Array(20),ji=()=>{for(let t=0;t<20;t++)ic[t]=Mh.charAt(Math.random()*Mv);return ic.join("")};class tr{constructor(){this.disposers=new Map}add(e,i=ji()){return this.flush(i),this.disposers.set(i,e()),i}addDisposer(e,i=ji()){return this.flush(i),this.disposers.set(i,e),i}addEventListener(e,i,n,r,s=ji()){return this.add(()=>(e.addEventListener(i,n,r),()=>e.removeEventListener(i,n,r)),s),s}setTimeout(e,i,n=ji()){return this.add(()=>{const r=window.setTimeout(()=>{this.remove(n),e()},i);return()=>window.clearTimeout(r)},n)}setInterval(e,i,n=ji()){return this.add(()=>{const r=window.setInterval(e,i);return()=>window.clearInterval(r)},n)}remove(e){const i=this.disposers.get(e);return this.disposers.delete(e),i}flush(e){const i=this.remove(e);if(i)try{i()}catch(n){console.error(n)}}flushAll(){this.disposers.forEach(e=>{try{e()}catch(i){console.error(i)}}),this.disposers.clear()}}var Sv=Object.defineProperty,Po=(typeof require!="undefined"&&require,(t,e,i)=>(((n,r,s)=>{r in n?Sv(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s})(t,typeof e!="symbol"?e+"":e,i),i));class gr{constructor(e,i){Po(this,"_value"),Po(this,"_beforeDestroys"),Po(this,"_subscribers"),this._value=e,i&&(this.compare=i)}get value(){return this._value}setValue(e,i){if(!this.compare(e,this._value)){const n=this._value;this._value=e,this._subscribers&&this._subscribers.forEach(r=>r(e,n,i))}}reaction(e){return this._subscribers||(this._subscribers=new Set),this._subscribers.add(e),()=>{this._subscribers&&this._subscribers.delete(e)}}subscribe(e,i){const n=this.reaction(e);return e(this._value,void 0,i),n}derive(e,i,n){const r=new gr(e(this.value,void 0,n),i),s=this.reaction((o,a,l)=>{r.setValue(e(o,a,l))});return r.addBeforeDestroy(s),r}destroy(){this._beforeDestroys&&(this._beforeDestroys.forEach(e=>e()),this._beforeDestroys.clear()),this._subscribers&&this._subscribers.clear()}addBeforeDestroy(e){return this._beforeDestroys||(this._beforeDestroys=new Set),this._beforeDestroys.add(e),()=>{this._beforeDestroys&&this._beforeDestroys.delete(e)}}compare(e,i){return e===i}}function Iv(t,e,i,n){let r=t.map(o=>o.value);const s=new gr(e(r,void 0,n),i);return t.forEach((o,a)=>{const l=o.reaction((u,c,d)=>{const f=r.slice();f[a]=u;const v=r;r=f,s.setValue(e(f,v,d),d)});s.addBeforeDestroy(l)}),s}function Sh(t,e){Object.keys(e).forEach(i=>{Cv(t,i,e[i])})}function Cv(t,e,i){var n;return Object.defineProperties(t,{[e]:{get:()=>i.value},[`_${e}$`]:{value:i},[`set${n=e,n[0].toUpperCase()+n.slice(1)}`]:{value:(r,s)=>i.setValue(r,s)}}),t}function Ml(t){const e=i=>{const n=t.addDisposer(()=>{i.destroy()});return i.addBeforeDestroy(()=>{t.remove(n)}),i};return{bindSideEffect:e,combine:(i,n,r,s)=>e(Iv(i,n,r,s)),createVal:(i,n)=>e(new gr(i,n))}}var Sl=(t=>(t.Light="light",t.Dark="dark",t.Auto="auto",t))(Sl||{}),B=(t=>(t.Normal="normal",t.Minimized="minimized",t.Maximized="maximized",t))(B||{}),ve=(t=>(t.DarkMode="dark_mode",t.PrefersColorScheme="prefers_color_scheme",t.Close="close",t.Focus="focus",t.Blur="blur",t.Move="move",t.Resize="resize",t.IntrinsicMove="intrinsic_move",t.IntrinsicResize="intrinsic_resize",t.VisualResize="visual_resize",t.ZIndex="z_index",t.State="state",t.Minimized="minimized",t.Maximized="maximized",t.Readonly="readonly",t.Destroyed="destroyed",t))(ve||{}),ze=(t=>(t.Close="close",t.Maximize="maximize",t.Minimize="minimize",t))(ze||{}),ht=(t=>(t.North="n",t.South="s",t.West="w",t.East="e",t.NorthWest="nw",t.NorthEast="ne",t.SouthEast="se",t.SouthWest="sw",t))(ht||{});const ko="dh";function Be(t,e,i){return Math.min(Math.max(t,e),i)}function Gi(t){t.stopPropagation(),t.cancelable&&t.preventDefault()}let bv=1;function Av(){return`New Box ${bv++}`}function Ev(t){return Boolean(t)}function zr(t){return!t}function Tv(t,e,i){const n=new Set(e),r=new Set(i);return t.filter(s=>!n.has(s)&&!r.has(s))}const ws=()=>typeof navigator!="undefined"&&typeof window!="undefined"&&/iPad|iPhone|iPod/.test(window.navigator.userAgent),ys=()=>typeof navigator!="undefined"&&/Android/.test(window.navigator.userAgent);function nc(t){return t.touches?t.touches[0]:t}function Nv(){return Date.now().toString().slice(6)+Math.random().toString().slice(2,8)}class Ih{constructor({readonly:e=!1,title:i,buttons:n,onEvent:r,onDragStart:s,namespace:o="telebox",state:a=B.Normal,appReadonly:l=!1}={}){this.$btns=[],this.sideEffect=new tr,this.lastTitleBarClick={timestamp:0,clientX:-100,clientY:-100},this.handleTitleBarClick=u=>{var c;if(this.readonly||u.button!==0||(c=u.target.dataset)!=null&&c.teleTitleBarNoDblClick)return;Gi(u);const d=Date.now();d-this.lastTitleBarClick.timestamp<=500?Math.abs(u.clientX-this.lastTitleBarClick.clientX)<=5&&Math.abs(u.clientY-this.lastTitleBarClick.clientY)<=5&&this.onEvent&&this.onEvent({type:ze.Maximize}):this.onDragStart&&this.onDragStart(u),this.lastTitleBarClick.timestamp=d,this.lastTitleBarClick.clientX=u.clientX,this.lastTitleBarClick.clientY=u.clientY},this.lastTitleBarTouch={timestamp:0,clientX:-100,clientY:-100},this.handleTitleBarTouch=u=>{var c;if(this.readonly||(c=u.target.dataset)!=null&&c.teleTitleBarNoDblClick)return;Gi(u);const d=Date.now(),{clientX:f=this.lastTitleBarTouch.clientX+100,clientY:v=this.lastTitleBarTouch.clientY+100}=u.touches[0]||{};d-this.lastTitleBarTouch.timestamp<=500?Math.abs(f-this.lastTitleBarTouch.clientX)<=10&&Math.abs(v-this.lastTitleBarTouch.clientY)<=10&&this.onEvent&&this.onEvent({type:ze.Maximize}):this.onDragStart&&this.onDragStart(u),this.lastTitleBarTouch.timestamp=d,this.lastTitleBarTouch.clientX=f,this.lastTitleBarTouch.clientY=v},this.readonly=e,this.onEvent=r,this.onDragStart=s,this.namespace=o,this.title=i,this.state=a,this.appReadonly=l,this.buttons=n||[{type:ze.Minimize,iconClassName:this.wrapClassName("titlebar-icon-minimize")},{type:ze.Maximize,iconClassName:this.wrapClassName("titlebar-icon-maximize"),isActive:u=>u===B.Maximized},{type:ze.Close,iconClassName:this.wrapClassName("titlebar-icon-close")}],this.$dragArea=this.renderDragArea()}setTitle(e){this.title=e,this.$title&&(this.$title.textContent=e,this.$title.title=e)}setState(e){this.state!==e&&(this.state=e,this.buttons.forEach((i,n)=>{i.isActive&&this.$btns[n].classList.toggle("is-active",i.isActive(e))}))}setReadonly(e){var i;this.readonly!==e&&(this.readonly=e,(i=this.$buttonsContainer)==null||i.classList.toggle(this.wrapClassName("titlebar-btns-disable"),Boolean(ys()||ws()||this.readonly)))}render(){if(!this.$titleBar){this.$titleBar=document.createElement("div"),this.$titleBar.className=this.wrapClassName("titlebar");const e=document.createElement("div");e.className=this.wrapClassName("title-area"),e.dataset.teleBoxHandle=ko,this.$title=document.createElement("h1"),this.$title.className=this.wrapClassName("title"),this.$title.dataset.teleBoxHandle=ko,this.title&&(this.$title.textContent=this.title,this.$title.title=this.title),e.appendChild(this.$title),e.appendChild(this.$dragArea);const i=document.createElement("div");i.className=this.wrapClassName("titlebar-btns"),i.classList.toggle(this.wrapClassName("titlebar-btns-disable"),ys()||ws()||this.readonly),this.buttons.forEach(({iconClassName:n,isActive:r},s)=>{const o=String(s),a=document.createElement("button");a.className=`${this.wrapClassName("titlebar-btn")} ${n}`,a.dataset.teleTitleBarBtnIndex=o,a.dataset.teleTitleBarNoDblClick="true",r&&a.classList.toggle("is-active",r(this.state)),this.$btns.push(a),i.appendChild(a)}),this.sideEffect.addEventListener(i,"click",n=>{var r;if(this.readonly)return;const s=n.target,o=Number((r=s.dataset)==null?void 0:r.teleTitleBarBtnIndex);if(!Number.isNaN(o)&&o<this.buttons.length){Gi(n);const a=this.buttons[o];this.onEvent&&this.onEvent({type:a.type,value:a.value})}}),this.$buttonsContainer=i,this.$titleBar.appendChild(e),this.$titleBar.appendChild(i)}return this.$titleBar}renderDragArea(){const e=document.createElement("div");return e.className=this.wrapClassName("drag-area"),e.dataset.teleBoxHandle=ko,this.sideEffect.addEventListener(e,"mousedown",this.handleTitleBarClick),this.sideEffect.addEventListener(e,"touchstart",this.handleTitleBarTouch,{passive:!0}),e}dragHandle(){return this.$titleBar}wrapClassName(e){return`${this.namespace}-${e}`}destroy(){this.sideEffect.flushAll(),this.$titleBar&&(this.$titleBar=void 0,this.$title=void 0,this.$btns.length=0,this.onDragStart=void 0,this.onEvent=void 0)}}class Pv{constructor({id:e=Nv(),title:i=Av(),prefersColorScheme:n=Sl.Light,darkMode:r,visible:s=!0,width:o=.5,height:a=.5,minWidth:l=0,minHeight:u=0,x:c=.1,y:d=.1,minimized:f=!1,maximized:v=!1,readonly:w=!1,resizable:y=!0,draggable:h=!0,fence:p=!0,fixRatio:g=!1,focus:m=!1,zIndex:x=100,namespace:M="telebox",titleBar:T,content:z,footer:P,styles:D,containerRect:S={x:0,y:0,width:window.innerWidth,height:window.innerHeight},collectorRect:N,fixed:I=!1,addObserver:U,appReadonly:$,hasHeader:F=!0}={}){this.hasHeader=!0,this._renderSideEffect=new tr,this.handleTrackStart=L=>{var K;return(K=this._handleTrackStart)==null?void 0:K.call(this,L)},this.hasHeader=F,this._sideEffect=new tr,this._valSideEffectBinder=Ml(this._sideEffect);const{combine:pe,createVal:X}=this._valSideEffectBinder;this.addObserver=U||Bo,this.appReadonly=$,this.id=e,this.namespace=M,this.events=new vs,this._delegateEvents=new vs,this.scale=X(1),this.fixed=I;const Ae=X(n);Ae.reaction((L,K,H)=>{H||this.events.emit(ve.PrefersColorScheme,L)});const Ee=X(Boolean(r));r==null&&Ae.subscribe((L,K,H)=>{this._sideEffect.add(()=>{if(L==="auto"){const ge=window.matchMedia("(prefers-color-scheme: dark)");if(ge){Ee.setValue(ge.matches,H);const kr=Br=>{Ee.setValue(Br.matches,H)};return ge.addListener(kr),()=>ge.removeListener(kr)}else return Bo}else return Ee.setValue(L==="dark",H),Bo},"prefers-color-scheme")}),Ee.reaction((L,K,H)=>{H||this.events.emit(ve.DarkMode,L)});const Mt=X(S,dt),St=X(N,dt),ki=X(i);ki.reaction((L,K,H)=>{H||this.titleBar.setTitle(L)});const wn=X(s);wn.reaction((L,K,H)=>{!H&&!L&&this.events.emit(ve.Close)});const E=X(w);E.reaction((L,K,H)=>{H||this.events.emit(ve.Readonly,L)});const V=X(y),Y=X(h),ae=X(p),ce=X(g),at=X(x);at.reaction((L,K,H)=>{H||this.events.emit(ve.ZIndex,L)});const lt=X(m);lt.reaction((L,K,H)=>{H||this.events.emit(L?ve.Focus:ve.Blur)});const Ge=X(f);Ge.reaction((L,K,H)=>{H||this.events.emit(ve.Minimized,L)});const Oe=X(v);Oe.reaction((L,K,H)=>{H||this.events.emit(ve.Maximized,L)});const Vu=pe([Ge,Oe],([L,K])=>(console.log("state reaction",L,K),L?B.Minimized:K?B.Maximized:B.Normal));Vu.reaction((L,K,H)=>{H||this.events.emit(ve.State,L)});const Nr=X({width:Be(l,0,1),height:Be(u,0,1)},dt),yn=X({width:Be(o,Nr.value.width,1),height:Be(a,Nr.value.height,1)},dt);Nr.reaction((L,K,H)=>{yn.setValue({width:Be(o,L.width,1),height:Be(a,L.height,1)},H)}),yn.reaction((L,K,H)=>{H||this.events.emit(ve.IntrinsicResize,L)});const xn=pe([yn,Oe],([L,K])=>K?{width:1,height:1}:L,dt);xn.reaction((L,K,H)=>{H||this.events.emit(ve.Resize,L)});const Ou=pe([xn,Ge,Mt,St],([L,K,H,ge])=>K&&ge?{width:ge.width/L.width/H.width,height:ge.height/L.height/H.height}:L,dt);Ou.reaction((L,K,H)=>{H||this.events.emit(ve.VisualResize,L)});const Mo=X({x:Be(c,0,1),y:Be(d,0,1)},dt);Mo.reaction((L,K,H)=>{H||this.events.emit(ve.IntrinsicMove,L)});const Pr=pe([Mo,yn,Mt,St,Ge,Oe],([L,K,H,ge,kr,Br])=>kr&&ge?Br?{x:(ge.x+ge.width/2)/H.width-1/2,y:(ge.y+ge.height/2)/H.height-1/2}:{x:(ge.x+ge.width/2)/H.width-K.width/2,y:(ge.y+ge.height/2)/H.height-K.height/2}:Br?{x:0,y:0}:L,dt);Pr.reaction((L,K,H)=>{H||this.events.emit(ve.Move,L)}),this.titleBar=T||new Ih({readonly:E.value,appReadonly:this.appReadonly,title:ki.value,namespace:this.namespace,onDragStart:L=>{var K;return(K=this._handleTrackStart)==null?void 0:K.call(this,L)},onEvent:L=>{if(this._delegateEvents.listeners.length>0)this._delegateEvents.emit(L.type);else switch(L.type){case ze.Maximize:{console.log("[TeleBox] TeleBox TitleBar Maximize Event",{boxId:this.id,currentMaximized:Oe.value});break}case ze.Minimize:{console.log("[TeleBox] TeleBox TitleBar Minimize Event",{boxId:this.id,currentMinimized:Ge.value});break}case ze.Close:{console.log("[TeleBox] TeleBox TitleBar Close Event",{boxId:this.id,currentVisible:wn.value});break}default:{console.error("Unsupported titleBar event:",L);break}}}}),E.reaction(L=>{this.titleBar.setReadonly(L)});const Og=X(z),$g=X(P),Fg=X(D);Sh(this,{prefersColorScheme:Ae,darkMode:Ee,containerRect:Mt,collectorRect:St,title:ki,visible:wn,readonly:E,resizable:V,draggable:Y,fence:ae,fixRatio:ce,focus:lt,zIndex:at,minimized:Ge,maximized:Oe,$userContent:Og,$userFooter:$g,$userStyles:Fg}),this._state$=Vu,this._minSize$=Nr,this._size$=xn,this._intrinsicSize$=yn,this._visualSize$=Ou,this._coord$=Pr,this._intrinsicCoord$=Mo,this.fixRatio&&this.transform(Pr.value.x,Pr.value.y,xn.value.width,xn.value.height,!0),this.$box=this.render()}get darkMode(){return this._darkMode$.value}get state(){return this._state$.value}setState(e,i=!1){return console.log("setstate",e,i),this}get minWidth(){return this._minSize$.value.width}get minHeight(){return this._minSize$.value.height}setMinWidth(e,i=!1){return this._minSize$.setValue({width:e,height:this.minHeight},i),this}setMinHeight(e,i=!1){return this._minSize$.setValue({width:this.minWidth,height:e},i),this}get intrinsicWidth(){return this._intrinsicSize$.value.width}get intrinsicHeight(){return this._intrinsicSize$.value.height}resize(e,i,n=!1){return this._intrinsicSize$.setValue({width:e,height:i},n),this}get width(){return this._size$.value.width}get height(){return this._size$.value.height}get absoluteWidth(){return this.width*this.containerRect.width}get absoluteHeight(){return this.height*this.containerRect.height}get visualWidth(){return this._visualSize$.value.width}get visualHeight(){return this._visualSize$.value.height}get intrinsicX(){return this._intrinsicCoord$.value.x}get intrinsicY(){return this._intrinsicCoord$.value.y}move(e,i,n=!1){return this.fixed?this:(this._intrinsicCoord$.setValue({x:e,y:i},n),this)}get x(){return this._coord$.value.x}get y(){return this._coord$.value.y}transform(e,i,n,r,s=!1){if(this.fixRatio){const o=this.intrinsicHeight/this.intrinsicWidth*n;i!==this.intrinsicY&&(i-=o-r),r=o}return i<0&&(i=0,r>this.intrinsicHeight&&(r=this.intrinsicHeight)),this.fixed||this._intrinsicCoord$.setValue({x:n>=this.minWidth?e:this.intrinsicX,y:r>=this.minHeight?i:this.intrinsicY},s),this._intrinsicSize$.setValue({width:Be(n,this.minWidth,1),height:Be(r,this.minHeight,1)},s),this}mount(e){return e.appendChild(this.render()),this}unmount(){return this.$box&&this.$box.remove(),this}mountContent(e){return this.set$userContent(e),this}unmountContent(){return this.set$userContent(void 0),this}mountFooter(e){return this.set$userFooter(e),this}unmountFooter(){return this.set$userFooter(void 0),this}getUserStyles(){return this.$userStyles}mountStyles(e){let i;return typeof e=="string"?(i=document.createElement("style"),i.textContent=e):i=e,this.set$userStyles(i),this}unmountStyles(){return this.set$userStyles(void 0),this}setFixed(e){this.fixed=e}render(e){var i;if(e){if(e===this.$box)return this.$box;this.$box=e}else{if(this.$box)return this.$box;this.$box=document.createElement("div")}this._renderSideEffect.flushAll(),this.$box.classList.add(this.wrapClassName("box"));const n=(f,v,w,y=Ev)=>this._renderSideEffect.add(()=>{const h=this.wrapClassName(w);return v.subscribe(p=>{f.classList.toggle(h,y(p))})});n(this.$box,this._readonly$,"readonly"),n(this.$box,this._draggable$,"no-drag",zr),n(this.$box,this._resizable$,"no-resize",zr),n(this.$box,this._focus$,"blur",zr),n(this.$box,this._darkMode$,"color-scheme-dark"),n(this.$box,this._darkMode$,"color-scheme-light",zr),this._renderSideEffect.add(()=>{const f=this.wrapClassName("minimized"),v=this.wrapClassName("maximized"),w="box-maximized-timer";return this._state$.subscribe(y=>{console.log(y===B.Minimized,y),this.$box.classList.toggle(f,y===B.Minimized),y===B.Maximized?(this._renderSideEffect.flush(w),this.$box.classList.toggle(v,!0)):this.$box.classList.toggle(v,!1)})}),this._renderSideEffect.add(()=>this._visible$.subscribe(f=>{this.$box.style.display=f?"block":"none"})),this._renderSideEffect.add(()=>this._zIndex$.subscribe(f=>{this.$box.style.zIndex=String(f)}));const r=xv(this.$box);this.$box.dataset.teleBoxID=this.id,this.$box.style.width=this.absoluteWidth+"px",this.$box.style.height=this.absoluteHeight+"px";const s=this.x*this.containerRect.width+this.containerRect.x,o=this.y*this.containerRect.height+this.containerRect.y;this.$box.style.transform=`translate(${s-10}px,${o-10}px)`,this._valSideEffectBinder.combine([this._coord$,this._size$,this._minimized$,this._containerRect$,this._collectorRect$],([f,v,w,y,h])=>{const p=v.width*y.width,g=v.height*y.height;return{width:p+(w&&h?1:0),height:g+(w&&h?1:0),x:f.x*y.width,y:f.y*y.height,scaleX:1,scaleY:1}},dt).subscribe(f=>{r.set(f)}),r.set({x:s,y:o});const a=document.createElement("div");a.className=this.wrapClassName("box-main"),this.$box.appendChild(a);const l=document.createElement("div");l.className=this.wrapClassName("titlebar-wrap"),l.appendChild(this.titleBar.render()),this.$titleBar=l;const u=document.createElement("div");u.className=this.wrapClassName("content-wrap")+" tele-fancy-scrollbar",u.classList.toggle("hide-scroll",Boolean(ws()||ys()||this.appReadonly));const c=document.createElement("div");c.className=this.wrapClassName("content")+" tele-fancy-scrollbar",this.$content=c,(i=this.id)!=null&&i.includes("Plyr")&&(u.style.background="none",a.style.background="none",c.style.background="none"),this.hasHeader==!1&&(u.style.background="none",l.style.display="none",a.style.background="none",c.style.background="none"),this._renderSideEffect.add(()=>{let f;return this._$userStyles$.subscribe(v=>{f&&f.remove(),f=v,v&&u.appendChild(v)})}),this._renderSideEffect.add(()=>{let f;return this._$userContent$.subscribe(v=>{f&&f.remove(),f=v,v&&c.appendChild(v)})}),u.appendChild(c);const d=document.createElement("div");return d.className=this.wrapClassName("footer-wrap"),this.$footer=d,this._renderSideEffect.add(()=>{let f;return this._$userFooter$.subscribe(v=>{f&&f.remove(),f=v,v&&d.appendChild(v)})}),this._state$.reaction(f=>{d.classList.toggle(this.wrapClassName("footer-hide"),f==B.Maximized)}),a.appendChild(l),a.appendChild(u),a.appendChild(d),this.$contentWrap=u,this.addObserver(u,f=>{const v=f.find(w=>w.target==u);(v==null?void 0:v.target)==u&&(c.style.width=v.contentRect.width*this.scale.value+"px",c.style.height=v.contentRect.height*this.scale.value+"px")}),this.scale.reaction(f=>{c.style.width=u.getBoundingClientRect().width*f+"px",c.style.height=u.getBoundingClientRect().height*f+"px"}),this._renderResizeHandlers(),this.$box}_renderResizeHandlers(){const e=document.createElement("div");e.className=this.wrapClassName("resize-handles"),Object.values(ht).forEach(y=>{const h=document.createElement("div");h.className=this.wrapClassName(y)+" "+this.wrapClassName("resize-handle"),h.dataset.teleBoxHandle=y,e.appendChild(h)}),this.$box.appendChild(e);const i="handle-tracking-listener",n=this.wrapClassName("transforming");let r,s=0,o=0,a=0,l=0,u=0,c=0,d;const f=y=>{if(this.state!==B.Normal)return;Gi(y);let{pageX:h,pageY:p}=nc(y);p<0&&(p=0);const g=(h-u)/this.containerRect.width,m=(p-c)/this.containerRect.height;switch(d){case ht.North:{this.transform(this.x,o+m,this.width,l-m);break}case ht.South:{this.transform(this.x,this.y,this.width,l+m);break}case ht.West:{this.transform(s+g,this.y,a-g,this.height);break}case ht.East:{this.transform(this.x,this.y,a+g,this.height);break}case ht.NorthWest:{this.transform(s+g,o+m,a-g,l-m);break}case ht.NorthEast:{this.transform(this.x,o+m,a+g,l-m);break}case ht.SouthEast:{this.transform(this.x,this.y,a+g,l+m);break}case ht.SouthWest:{this.transform(s+g,this.y,a-g,l+m);break}default:{if(this.fence)this.move(Be(s+g,0,1-this.width),Be(o+m,0,1-this.height));else{const x=50/this.containerRect.width,M=40/this.containerRect.height;this.move(Be(s+g,x-this.width,1-x),Be(o+m,0,1-M))}break}}},v=y=>{d=void 0,r&&(Gi(y),this.$box.classList.toggle(n,!1),this._sideEffect.flush(i),r.remove())},w=y=>{var h;if(this.readonly||y.button!=null&&y.button!==0||!this.draggable||d||this.state!==B.Normal)return;const p=y.target;if((h=p.dataset)!=null&&h.teleBoxHandle){Gi(y),s=this.x,o=this.y,a=this.width,l=this.height,{pageX:u,pageY:c}=nc(y),d=p.dataset.teleBoxHandle,r||(r=document.createElement("div"));const g=d?this.wrapClassName(`cursor-${d}`):"";r.className=this.wrapClassName(`track-mask${g?` ${g}`:""}`),this.$box.appendChild(r),this.$box.classList.add(n),this._sideEffect.add(()=>(window.addEventListener("mousemove",f),window.addEventListener("touchmove",f,{passive:!1}),window.addEventListener("mouseup",v),window.addEventListener("touchend",v,{passive:!1}),window.addEventListener("touchcancel",v,{passive:!1}),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("touchmove",f),window.removeEventListener("mouseup",v),window.removeEventListener("touchend",v),window.removeEventListener("touchcancel",v)}),i)}};this._handleTrackStart=w,this._sideEffect.addEventListener(e,"mousedown",w,{},"box-resizeHandles-mousedown"),this._sideEffect.addEventListener(e,"touchstart",w,{passive:!1},"box-resizeHandles-touchstart")}setScaleContent(e){this.scale.setValue(e)}destroy(){this.$box.remove(),this.events.emit(ve.Destroyed),this._sideEffect.flushAll(),this._renderSideEffect.flushAll(),this.events.removeAllListeners(),this._delegateEvents.removeAllListeners()}wrapClassName(e){return`${this.namespace}-${e}`}}function Bo(){}var kv="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzFfNDQyNDQpIj4KPGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZF8xXzQ0MjQ0KSI+CjxwYXRoIGQ9Ik0xNC4wMDAyIDE2LjE5NTNDMTMuODI0NyAxNi4xOTUzIDEzLjY1MjIgMTYuMTQ5MSAxMy41MDAyIDE2LjA2MTVMNC41MDAxNyAxMC44NjQzQzQuMDIxNzggMTAuNTg3OSAzLjg1Nzk2IDkuOTc2MTIgNC4xMzQyOCA5LjQ5NzczQzQuMjIyMDQgOS4zNDU3OSA0LjM0ODIzIDkuMjE5NiA0LjUwMDE3IDkuMTMxODRMMTMuNTAwMiAzLjkzODQ4QzEzLjgwOTggMy43NjA3NCAxNC4xOTA1IDMuNzYwNzQgMTQuNTAwMiAzLjkzODQ4TDIzLjUwMDIgOS4xMzE4NEMyMy45Nzg2IDkuNDA4MTYgMjQuMTQyNCAxMC4wMiAyMy44NjYxIDEwLjQ5ODRDMjMuNzc4MyAxMC42NTAzIDIzLjY1MjEgMTAuNzc2NSAyMy41MDAyIDEwLjg2NDNMMTQuNTAwMiAxNi4wNjE1QzE0LjM0ODEgMTYuMTQ5MSAxNC4xNzU3IDE2LjE5NTMgMTQuMDAwMiAxNi4xOTUzWiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8ZyBmaWx0ZXI9InVybCgjZmlsdGVyMV9kXzFfNDQyNDQpIj4KPHBhdGggZD0iTTIzLjUwMDIgMTMuMTMxOUwyMS41MzYxIDExLjk5ODVMMTQuNTAwMiAxNi4wNjE2QzE0LjE5MDcgMTYuMjQgMTMuODA5NiAxNi4yNCAxMy41MDAyIDE2LjA2MTZMNi40NjQyOCAxMS45OTg1TDQuNTAwMTcgMTMuMTMxOUM0LjAyMTc4IDEzLjQwODIgMy44NTc5NiAxNC4wMiA0LjEzNDI4IDE0LjQ5ODRDNC4yMjIwNCAxNC42NTA0IDQuMzQ4MjMgMTQuNzc2NiA0LjUwMDE3IDE0Ljg2NDNMMTMuNTAwMiAyMC4wNjE2QzEzLjgwOTYgMjAuMjQgMTQuMTkwNyAyMC4yNCAxNC41MDAyIDIwLjA2MTZMMjMuNTAwMiAxNC44NjQzQzIzLjk3ODYgMTQuNTg4IDI0LjE0MjQgMTMuOTc2MiAyMy44NjYxIDEzLjQ5NzhDMjMuNzc4MyAxMy4zNDU5IDIzLjY1MjEgMTMuMjE5NyAyMy41MDAyIDEzLjEzMTlaIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjgiIHNoYXBlLXJlbmRlcmluZz0iY3Jpc3BFZGdlcyIvPgo8L2c+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIyX2RfMV80NDI0NCkiPgo8cGF0aCBkPSJNMjMuNTAwMiAxNy4xMzE5TDIxLjUzNjEgMTUuOTk4NUwxNC41MDAyIDIwLjA2MTZDMTQuMTkwNyAyMC4yNCAxMy44MDk2IDIwLjI0IDEzLjUwMDIgMjAuMDYxNkw2LjQ2NDI4IDE1Ljk5ODVMNC41MDAxNyAxNy4xMzE5QzQuMDIxNzggMTcuNDA4MiAzLjg1Nzk2IDE4LjAyIDQuMTM0MjggMTguNDk4NEM0LjIyMjA0IDE4LjY1MDQgNC4zNDgyMyAxOC43NzY2IDQuNTAwMTcgMTguODY0M0wxMy41MDAyIDI0LjA2MTZDMTMuODA5NiAyNC4yNCAxNC4xOTA3IDI0LjI0IDE0LjUwMDIgMjQuMDYxNkwyMy41MDAyIDE4Ljg2NDNDMjMuOTc4NiAxOC41ODggMjQuMTQyNCAxNy45NzYyIDIzLjg2NjEgMTcuNDk3OEMyMy43NzgzIDE3LjM0NTkgMjMuNjUyMSAxNy4yMTk3IDIzLjUwMDIgMTcuMTMxOVoiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuNiIgc2hhcGUtcmVuZGVyaW5nPSJjcmlzcEVkZ2VzIi8+CjwvZz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9kXzFfNDQyNDQiIHg9IjMiIHk9IjMuODA1MTgiIHdpZHRoPSIyMiIgaGVpZ2h0PSIxNC4zOTAxIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjEiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMC41Ii8+CjxmZUNvbXBvc2l0ZSBpbjI9ImhhcmRBbHBoYSIgb3BlcmF0b3I9Im91dCIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwLjU1Mjk0MSAwIDAgMCAwIDAuNTYwNzg0IDAgMCAwIDAgMC42NTA5OCAwIDAgMCAwLjE1IDAiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3dfMV80NDI0NCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd18xXzQ0MjQ0IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8ZmlsdGVyIGlkPSJmaWx0ZXIxX2RfMV80NDI0NCIgeD0iMyIgeT0iMTEuOTk4NSIgd2lkdGg9IjIyIiBoZWlnaHQ9IjEwLjE5NjgiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iaGFyZEFscGhhIi8+CjxmZU9mZnNldCBkeT0iMSIvPgo8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIwLjUiLz4KPGZlQ29tcG9zaXRlIGluMj0iaGFyZEFscGhhIiBvcGVyYXRvcj0ib3V0Ii8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAuNTUyOTQxIDAgMCAwIDAgMC41NjA3ODQgMCAwIDAgMCAwLjY1MDk4IDAgMCAwIDAuMTUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd18xXzQ0MjQ0Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93XzFfNDQyNDQiIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjxmaWx0ZXIgaWQ9ImZpbHRlcjJfZF8xXzQ0MjQ0IiB4PSIzIiB5PSIxNS45OTg1IiB3aWR0aD0iMjIiIGhlaWdodD0iMTAuMTk2OCIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJoYXJkQWxwaGEiLz4KPGZlT2Zmc2V0IGR5PSIxIi8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjAuNSIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJvdXQiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMC41NTI5NDEgMCAwIDAgMCAwLjU2MDc4NCAwIDAgMCAwIDAuNjUwOTggMCAwIDAgMC4xNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93XzFfNDQyNDQiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3dfMV80NDI0NCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xXzQ0MjQ0Ij4KPHJlY3Qgd2lkdGg9IjI4IiBoZWlnaHQ9IjI4IiBmaWxsPSJ3aGl0ZSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo=";let Mn,Sn;function Bv(t,e=!1){Mn?e?Sn==null||Sn.push(t):Mn.push(t):(Mn=e?[]:[t],Sn=e?[t]:[],Promise.resolve().then(()=>{const i=Mn,n=Sn;Mn=void 0,Sn=void 0,n==null||n.forEach(r=>r()),i==null||i.forEach(r=>r())}))}function Dv(t){const e=t.cloneNode(!0);e.style.position="absolute",e.style.top="-99999px",e.style.float="none",e.style.visibility="hidden",e.style.display="block",document.body.appendChild(e);const i=e.getBoundingClientRect();return document.body.removeChild(e),{height:i.height,width:i.width}}class Ch{constructor({visible:e=!0,readonly:i=!1,darkMode:n=!1,namespace:r="telebox",styles:s={},onClick:o,allBoxStatusInfo:a={},boxes:l=[],externalEvents:u,appReadonly:c}={}){this.allBoxStatusInfo={},this.handleCollectorClick=()=>{!this._readonly&&this.onClick&&this.popupVisible$.setValue(!this.popupVisible$.value)},this.externalEvents=u,this._sideEffect=new tr;const{createVal:d}=Ml(this._sideEffect);this._visible=e,this._readonly=i,this._darkMode=n,this.namespace=r,this.styles=s,this.allBoxStatusInfo={...a},this.boxes=l,this.onClick=o,this.appReadonly=c,this.popupVisible$=d(!1),this.popupVisible$.reaction(v=>{var w;(w=this.$titles)==null||w.classList.toggle(this.wrapClassName("collector-hide"),!v),requestAnimationFrame(()=>{requestAnimationFrame(()=>{var y;(y=this.$titles)==null||y.classList.toggle(this.wrapClassName("collector-titles-visible"),v)})})});const f=v=>{var w,y;!this.popupVisible$||(y=(w=v.target.className)==null?void 0:w.includes)!=null&&y.call(w,"collector")||this.popupVisible$.setValue(!1)};this._sideEffect.addEventListener(window,"pointerdown",f,!0)}get visible(){return this._visible}get readonly(){return this._readonly}get darkMode(){return this._darkMode}mount(e){return this.render(e),this.root=e,this}unmount(){return this.$collector&&this.$collector.remove(),this}setVisible(e){var i;return this._visible!==e&&(this._visible=e,this.$collector&&((i=this.wrp$)==null||i.classList.toggle(this.wrapClassName("collector-visible"),e),e?this.renderTitles():this.popupVisible$.setValue(!1))),this}setReadonly(e){return this._readonly!==e&&(this._readonly=e,this.$collector&&this.$collector.classList.toggle(this.wrapClassName("collector-readonly"),e)),this}setDarkMode(e){return this._darkMode!==e&&(this._darkMode=e,this.$collector&&(this.$collector.classList.toggle(this.wrapClassName("color-scheme-dark"),e),this.$collector.classList.toggle(this.wrapClassName("color-scheme-light"),!e))),this}setStyles(e){if(Object.assign(this.styles,e),this.wrp$){const i=this.wrp$;Object.keys(e).forEach(n=>{const r=e[n];r!=null&&(i.style[n]=r)})}return this}setAllBoxStatusInfo(e){console.log("[TeleBox] TeleBoxCollector - setAllBoxStatusInfo",e),this.allBoxStatusInfo={...e},this.updateMinimizedCount(),this.renderTitles()}updateMinimizedCount(){if(this.count$){const e=Object.values(this.allBoxStatusInfo).filter(i=>i===B.Minimized).length;this.count$.textContent=String(e)}}setBoxes(e){this.boxes=e,this.renderTitles()}render(e){if(ys()||ws()){const i=document.createElement("div");return i.className=this.wrapClassName("collector-hide"),i}return this.$collector||(this.$collector=document.createElement("button"),this.$collector.className=this.wrapClassName("collector"),this.$collector.style.backgroundImage=`url('${kv}')`,this.wrp$=document.createElement("div"),this.count$=document.createElement("div"),this.wrp$.className=this.wrapClassName("collector-wrp"),this.count$.className=this.wrapClassName("collector-count"),this.wrp$.appendChild(this.count$),this.wrp$.appendChild(this.$collector),this.wrp$.addEventListener("click",this.handleCollectorClick),this._visible&&(this.wrp$.classList.toggle(this.wrapClassName("collector-visible")),this.renderTitles()),this._readonly&&this.$collector.classList.add(this.wrapClassName("collector-readonly")),this.$collector.classList.add(this.wrapClassName(this._darkMode?"color-scheme-dark":"color-scheme-light")),this.setStyles(this.styles),e.appendChild(this.wrp$)),this.$collector}renderTitles(){var e,i,n,r;this.$titles||(this.$titles=document.createElement("div"),this.$titles.className=this.wrapClassName("collector-titles"),this.$titles.classList.toggle(this.wrapClassName("collector-hide"),!this.popupVisible$.value)),this._sideEffect.addEventListener(this.$titles,"wheel",u=>{u.deltaX||u.currentTarget.scrollBy({left:u.deltaY>0?250:-250,behavior:"smooth"})},{passive:!1},"min-popup-render-wheel-titles");const s=this.$titles.querySelector(`.${this.wrapClassName("collector-titles-content")}`),o=s!=null?s:document.createElement("div");o.className=this.wrapClassName("collector-titles-content"),s||(this.$titles.appendChild(o),this._sideEffect.addEventListener(o,"click",u=>{var c,d,f,v;const w=u.target;(d=(c=w.dataset)==null?void 0:c.teleBoxID)!=null&&d.length&&((v=this.onClick)==null||v.call(this,(f=w.dataset)==null?void 0:f.teleBoxID))},{},"telebox-collector-titles-content-click")),o.innerHTML="";const a=(e=this.boxes)==null?void 0:e.filter(u=>this.allBoxStatusInfo[u.id]===B.Minimized).map(u=>{const c=document.createElement("button");return c.className=this.wrapClassName("collector-titles-tab"),c.textContent=u.title,c.dataset.teleBoxID=u.id,c.dataset.teleTitleBarNoDblClick="true",o.appendChild(c),u._title$.reaction(d=>c.textContent=d)});this._sideEffect.addDisposer(()=>a==null?void 0:a.forEach(u=>u()),"min-popup-render-tab-titles");const l=(i=this.wrp$)==null?void 0:i.querySelector(`.${this.wrapClassName("collector-titles")}`);return l?(r=this.wrp$)==null||r.replaceChild(this.$titles,l):(n=this.wrp$)==null||n.appendChild(this.$titles),Bv(()=>{var u,c;if(!this.$titles||!this.wrp$||!this.root)return;const d=(u=this.wrp$)==null?void 0:u.getBoundingClientRect(),f=(c=this.root)==null?void 0:c.getBoundingClientRect(),v=Dv(this.$titles);d.top-f.top>v.height;const w=-v.height-10;this.$titles.style.top=`${w}px`,this.$titles.style.left="0px"}),this.$titles}destroy(){this.$collector&&(this.$collector.removeEventListener("click",this.handleCollectorClick),this.$collector.remove(),this.$collector=void 0),this.onClick=void 0}wrapClassName(e){return`${this.namespace}-${e}`}}var ee=(t=>(t.Focused="focused",t.Blurred="blurred",t.Created="created",t.Removed="removed",t.State="state",t.AllBoxStatusInfo="all_box_status_info",t.LastLastNotMinimizedBoxsStatus="last_last_not_minimized_boxs_status",t.Move="move",t.Resize="resize",t.IntrinsicMove="intrinsic_move",t.IntrinsicResize="intrinsic_resize",t.VisualResize="visual_resize",t.ZIndex="z_index",t.PrefersColorScheme="prefers_color_scheme",t.DarkMode="dark_mode",t.BoxToMinimized="boxToMinimized",t.BoxToMaximized="boxToMaximized",t.BoxToNormal="boxToNormal",t))(ee||{});class zv extends Ih{constructor(e){super(e),this.boxes=e.boxes,this.focusedBox=e.focusedBox,this.containerRect=e.containerRect,this.darkMode=e.darkMode,this.allBoxStatusInfo=e.allBoxStatusInfo}focusBox(e){var i,n;if(!(this.focusedBox&&this.focusedBox===e||!(e!=null&&e.hasHeader))){if(console.log("[TeleBox] TitleBar FocusBox Called",e==null?void 0:e.id,(i=this.focusedBox)==null?void 0:i.id,this.state),this.$titles&&(this.state===B.Maximized||this.hasMaximizedBox())){const{children:r}=this.$titles.firstElementChild;for(let s=r.length-1;s>=0;s-=1){const o=r[s],a=(n=o.dataset)==null?void 0:n.teleBoxID;a&&(e&&a===e.id?o.classList.toggle(this.wrapClassName("titles-tab-focus"),!0):this.focusedBox&&a===this.focusedBox.id&&o.classList.toggle(this.wrapClassName("titles-tab-focus"),!1))}}this.focusedBox=e}}hasMaximizedBox(){return Object.entries(this.allBoxStatusInfo||{}).some(([e,i])=>i===B.Maximized)}setContainerRect(e){if(this.containerRect=e,this.$titleBar){const{x:i,y:n,width:r}=e;this.$titleBar.style.transform=`translate(${i}px, ${n}px)`,this.$titleBar.style.width=r+"px"}}setBoxes(e){this.boxes=e,this.updateTitles()}setAllBoxStatusInfo(e){console.log("[TeleBox] MaxTitleBar - setAllBoxStatusInfo",e),this.allBoxStatusInfo=e,this.updateTitles()}setState(e){super.setState(e),this.$titleBar&&this.$titleBar.classList.toggle(this.wrapClassName("max-titlebar-maximized"),e===B.Maximized),this.updateTitles()}setReadonly(e){super.setReadonly(e),this.$titleBar&&this.$titleBar.classList.toggle(this.wrapClassName("readonly"),this.readonly)}setDarkMode(e){e!==this.darkMode&&(this.darkMode=e,this.$titleBar&&(this.$titleBar.classList.toggle(this.wrapClassName("color-scheme-dark"),e),this.$titleBar.classList.toggle(this.wrapClassName("color-scheme-light"),!e)))}setIndexZ(e){this.$titleBar&&(this.$titleBar.style.zIndex=String(e))}render(){const e=super.render(),{x:i,y:n,width:r}=this.containerRect;e.style.transform=`translate(${i}px, ${n}px)`,e.style.width=r+"px",e.classList.add(this.wrapClassName("max-titlebar")),e.classList.toggle(this.wrapClassName("max-titlebar-maximized"),this.state===B.Maximized),e.classList.toggle(this.wrapClassName("readonly"),this.readonly),e.classList.add(this.wrapClassName(this.darkMode?"color-scheme-dark":"color-scheme-light"));const s=document.createElement("div");return s.classList.add(this.wrapClassName("titles-area")),e.insertBefore(s,e.firstElementChild),this.updateTitles(),e}destroy(){super.destroy(),this.$titles=void 0,this.boxes.length=0,this.focusedBox=void 0}updateTitles(){var e;const i=Object.entries(this.allBoxStatusInfo).filter(([r,s])=>s===B.Maximized).map(([r,s])=>r),n=Object.entries(this.allBoxStatusInfo).filter(([r,s])=>s===B.Minimized).map(([r,s])=>r);(e=this.$titleBar)==null||e.classList.toggle(this.wrapClassName("max-titlebar-active"),i.length>0&&this.boxes.length>0&&i.filter(r=>!n.includes(r)).length>0),this.$titleBar&&i.length>0&&this.boxes.length>0&&i.filter(r=>!n.includes(r)).length>0&&(this.$titleBar.classList.toggle(this.wrapClassName("max-titlebar-single-title"),this.boxes.length===1),this.boxes.length===1?(this.setTitle(this.boxes[0].title),this.boxes[0].hasHeader===!1?this.$titleBar.style.display="none":this.$titleBar.style.display=""):this.$titleBar.replaceChild(this.renderTitles(),this.$titleBar.firstElementChild))}renderTitles(){this.$titles=document.createElement("div"),this.$titles.className=this.wrapClassName("titles"),this.$titles.addEventListener("wheel",o=>{o.currentTarget.scrollBy({left:o.deltaY>0?250:-250,behavior:"smooth"})},{passive:!1});const e=document.createElement("div");e.className=this.wrapClassName("titles-content"),this.$titles.appendChild(e);const i=Object.entries(this.allBoxStatusInfo).filter(([o,a])=>a===B.Maximized).map(([o,a])=>o),n=Object.entries(this.allBoxStatusInfo).filter(([o,a])=>a===B.Minimized).map(([o,a])=>o),r=this.boxes.filter(o=>i.includes(o.id)).filter(o=>!n.includes(o.id)).filter(o=>o.hasHeader),s=this.boxes.filter(o=>i.includes(o.id)).filter(o=>!n.includes(o.id)).filter(o=>!o.hasHeader);return this.$titleBar&&(r.length==0&&s.length>0?this.$titleBar.style.display="none":this.$titleBar.style.display=""),r.forEach(o=>{const a=document.createElement("button");a.className=this.wrapClassName("titles-tab"),a.textContent=o.title,a.dataset.teleBoxID=o.id,a.dataset.teleTitleBarNoDblClick="true",this.focusedBox&&o.id===this.focusedBox.id&&a.classList.add(this.wrapClassName("titles-tab-focus")),e.appendChild(a)}),this.$titles}}function _v(){let t=new Set;function e(o){return t.add(o),()=>{i(o)}}function i(o){t.delete(o)}function n(...o){t.forEach(a=>{a(...o)})}function r(){return Boolean(t.size)}function s(){t=new Set}return{runCallbacks:n,addCallback:e,removeCallback:i,hasCallbacks:r,removeAll:s}}class Lv{constructor({root:e=document.body,prefersColorScheme:i=Sl.Light,fence:n=!0,containerRect:r={x:0,y:0,width:window.innerWidth,height:window.innerHeight},collector:s,namespace:o="telebox",readonly:a=!1,allBoxStatusInfo:l={},lastLastNotMinimizedBoxsStatus:u={},appReadonly:c=!1}={}){this.externalEvents=new vs,this.events=new vs,this.appReadonly=!1,console.log("[TeleBox] Manager Constructor Start",{allBoxStatusInfo:l,readonly:a,appReadonly:c}),this._sideEffect=new tr;const{combine:d,createVal:f}=Ml(this._sideEffect);this.callbackManager=_v(),this.sizeObserver=new ResizeObserver(this.callbackManager.runCallbacks),this.elementObserverMap=new Map,this.root=e,this.namespace=o,this.appReadonly=c,this.boxes$=f([]),this.lastLastNotMinimizedBoxsStatus$=f(u),this.topBox$=this.boxes$.derive(S=>{if(S.length>0)return S.reduce((I,U)=>I.zIndex>U.zIndex?I:U)});const v=window.matchMedia("(prefers-color-scheme: dark)"),w=f(!1);v&&(w.setValue(v.matches),this._sideEffect.add(()=>{const S=N=>{w.setValue(N.matches)};return v.addListener(S),()=>v.removeListener(S)}));const y=f(i);y.reaction((S,N,I)=>{this.boxes$.value.forEach(U=>U.setPrefersColorScheme(S,I)),I||this.events.emit(ee.PrefersColorScheme,S)}),this._darkMode$=d([w,y],([S,N])=>N==="auto"?S:N==="dark"),this._darkMode$.reaction((S,N,I)=>{this.boxes$.value.forEach(U=>U.setDarkMode(S,I)),I||this.events.emit(ee.DarkMode,S)});const h=f(a);h.reaction((S,N,I)=>{this.boxes$.value.forEach(U=>U.setReadonly(S,I))}),Object.entries(l||{}).filter(([S,N])=>N===B.Minimized).map(([S,N])=>S),Object.entries(l||{}).filter(([S,N])=>N===B.Maximized).map(([S,N])=>S),this.allBoxStatusInfo$=f(l),console.log("[TeleBox] Manager Constructor AllBoxStatusInfo Created",{allBoxStatusInfo:l}),this.allBoxStatusInfo$.reaction((S,N,I)=>{var U,$,F;console.log("[TeleBox] AllBoxStatusInfo Reaction Triggered",{allBoxStatusInfo:S,skipUpdate:I});const pe=this.getMaximizedBoxes(S),X=this.getMinimizedBoxes(S);this.boxes$.value.forEach(Ee=>{const Mt=pe.includes(Ee.id),St=X.includes(Ee.id);Ee.setMaximized(Mt,!0),Ee.setMinimized(St,!0)}),this.maxTitleBar.setState(pe.length>0?B.Maximized:B.Normal),this.maxTitleBar.setAllBoxStatusInfo({...S||{}});const Ae=X.length>0;console.log("[TeleBox] Collector Visibility Update",{minimized:Ae,minimizedBoxes:X}),(U=x.value)==null||U.setVisible(Ae),($=this.collector)==null||$.setAllBoxStatusInfo({...S||{}}),Ae&&(F=x.value)!=null&&F.$collector&&T.setValue(M()),this.makeBoxTopFromNotMinimized(),I||this.events.emit(ee.AllBoxStatusInfo,S)}),this.lastLastNotMinimizedBoxsStatus$.reaction((S,N,I)=>{I||this.events.emit(ee.LastLastNotMinimizedBoxsStatus,S)});const p=d([this.allBoxStatusInfo$],([S])=>{const N=this.getMinimizedBoxes(S),I=this.getMaximizedBoxes(S);return N.length?B.Minimized:I.length?B.Maximized:B.Normal});p.reaction((S,N,I)=>{this.maxTitleBar.setState(S),I||this.events.emit(ee.State,S)});const g=f(n);g.subscribe((S,N,I)=>{this.boxes$.value.forEach(U=>U.setFence(S,I))});const m=f(r,dt);m.reaction((S,N,I)=>{this.boxes$.value.forEach(U=>U.setContainerRect(S,I)),this.maxTitleBar.setContainerRect(S)});const x=f(s===null?null:s||new Ch({visible:this.getMinimizedBoxes().length>0&&!this.readonly,readonly:h.value,namespace:o,allBoxStatusInfo:this.allBoxStatusInfo$.value,boxes:this.boxes$.value,externalEvents:this.externalEvents,appReadonly:this.appReadonly}).mount(e));x.subscribe(S=>{S&&(S.setVisible(this.getMinimizedBoxes().length>0&&!h.value),S.setReadonly(h.value),S.setDarkMode(this._darkMode$.value),this._sideEffect.add(()=>(S.onClick=N=>{if(console.log("[TeleBox] Collector Click Event",{boxId:N,readonly:h.value}),!h.value){const U=(this.lastLastNotMinimizedBoxsStatus$.value||{})[N],$={...this.allBoxStatusInfo$.value||{}};U&&($[N]=U,this.setAllBoxStatusInfo($,!1)),this.makeBoxTopFromNotMinimized(this.boxes.find(F=>F.id===N),!1),U===B.Minimized?this.events.emit(ee.BoxToMinimized,{boxId:N,allBoxStatusInfo:$}):U===B.Maximized?this.events.emit(ee.BoxToMaximized,{boxId:N,allBoxStatusInfo:$}):U===B.Normal&&this.events.emit(ee.BoxToNormal,{boxId:N,allBoxStatusInfo:$})}},()=>S.destroy()),"collect-onClick"))}),h.subscribe(S=>{var N,I;(N=x.value)==null||N.setReadonly(S),(I=x.value)==null||I.setVisible(this.getMinimizedBoxes().length>0&&!h.value)}),this._darkMode$.subscribe(S=>{var N;(N=x.value)==null||N.setDarkMode(S)});const M=()=>{var S;if((S=x.value)!=null&&S.$collector){const{x:N,y:I,width:U,height:$}=x.value.$collector.getBoundingClientRect(),F=this.root.getBoundingClientRect();return{x:N-F.x,y:I-F.y,width:U,height:$}}},T=f(this.getMinimizedBoxes().length>0?M():void 0);T.subscribe((S,N,I)=>{this.boxes$.value.forEach(U=>{U.setCollectorRect(S,I)})});const z=this.wrapClassName("titlebar-icon-close"),P=S=>{var N;if(h.value)return;const I=S.target;if(!!I.tagName)for(let U=I;U;U=U.parentElement){if(U.classList&&U.classList.contains(z))return;const $=(N=U.dataset)==null?void 0:N.teleBoxID;if($){const F=this.getBox($);if(F){this.focusBox(F),this.makeBoxTop(F);return}}}};this._sideEffect.addEventListener(window,"mousedown",P,!0),this._sideEffect.addEventListener(window,"touchstart",P,!0),this.maxTitleBar=new zv({darkMode:this.darkMode,readonly:h.value,namespace:this.namespace,state:p.value,boxes:this.boxes$.value,containerRect:m.value,allBoxStatusInfo:this.allBoxStatusInfo$.value,onEvent:S=>{var N,I,U;if(!((N=this.topBox)!=null&&N.id))return;const $={...S,boxId:((I=this.maxTitleBar.focusedBox)==null?void 0:I.id)||((U=this.topBox)==null?void 0:U.id),hasFocus:this.focusBox!==void 0&&this.focusBox!==null};switch(S.type){case ze.Maximize:{if(console.log("[TeleBox] TitleBar Options Click To Maximize",$),$.hasFocus){const F={...this.allBoxStatusInfo$.value||{}};F[$.boxId]=B.Maximized===F[$.boxId]?B.Normal:B.Maximized,this.setAllBoxStatusInfo(F,!1)}else{const F={...this.allBoxStatusInfo$.value||{}};Object.keys(F).forEach(pe=>{F[pe]===B.Maximized&&(F[pe]=B.Normal)}),this.setAllBoxStatusInfo(F,!1)}this.events.emit(ee.BoxToMaximized,{boxId:$.boxId,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}});break}case ze.Minimize:{if(console.log("[TeleBox] TitleBar Options Click To Minimize",$),$.hasFocus)this.changeBoxToMinimized($.boxId);else{const F={...this.allBoxStatusInfo$.value||{}};Object.keys(F).forEach(pe=>{F[pe]===B.Maximized&&(F[pe]=B.Normal)}),this.setAllBoxStatusInfo(F,!1)}this.events.emit(ee.BoxToMinimized,{boxId:$.boxId,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}});break}case ve.Close:{console.log("[TeleBox] TitleBar Options Click To Close",$),this.changeBoxToClose($.boxId),this.events.emit(ee.BoxToNormal,{boxId:$.boxId,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}});break}}},appReadonly:this.appReadonly}),h.subscribe(S=>this.maxTitleBar.setReadonly(S)),this._darkMode$.subscribe(S=>{this.maxTitleBar.setDarkMode(S)}),this.boxes$.reaction(S=>{var N;this.maxTitleBar.setBoxes(S),(N=this.collector)==null||N.setBoxes(S)});const D={prefersColorScheme:y,containerRect:m,collector:x,collectorRect:T,readonly:h,fence:g,allBoxStatusInfo:this.allBoxStatusInfo$,lastLastNotMinimizedBoxsStatus:this.lastLastNotMinimizedBoxsStatus$};Sh(this,D),this._state$=p,this.root.appendChild(this.maxTitleBar.render())}get boxes(){return this.boxes$.value}get topBox(){return this.topBox$.value}get darkMode(){return this._darkMode$.value}get state(){return this._state$.value}get minimizedCount(){return this.getMinimizedBoxes().length}get maximizedCount(){return this.getMaximizedBoxes().length}setMinimized(e,i=!1){console.log("[TeleBox] SetMinimized Called",{data:e,skipUpdate:i})}setMaximized(e,i=!1){console.log("[TeleBox] SetMaximized Called",{data:e,skipUpdate:i})}cleanAllBoxStatusInfo(e){if(!e||Object.keys(e).length===0)return{};const i=this.boxes$.value.map(r=>r.id),n={...e||{}};return Object.keys(n).forEach(r=>{i.includes(r)||delete n[r]}),n}setAllBoxStatusInfo(e,i=!1){e=e||{},console.log("[TeleBox] SetAllBoxStatusInfo",{oldAllBoxStatusInfo:this.allBoxStatusInfo$.value,newAllBoxStatusInfo:e,skipUpdate:i});const r={...this.cleanAllBoxStatusInfo(e||{})};this.allBoxStatusInfo$.setValue(r)}setLastLastNotMinimizedBoxsStatus(e,i=!1){e=e||{},console.log("[TeleBox] SetLastLastNotMinimizedBoxsStatus",{oldLastLastNotMinimizedBoxsStatus:this.lastLastNotMinimizedBoxsStatus$.value,newLastLastNotMinimizedBoxsStatus:e,skipUpdate:i});const r={...this.cleanAllBoxStatusInfo(e||{})};this.lastLastNotMinimizedBoxsStatus$.setValue(r,i)}getMaximizedBoxes(e=this.allBoxStatusInfo$.value){return e=e||{},!e||Object.keys(e).length===0?[]:Object.entries(e).filter(([i,n])=>n===B.Maximized).map(([i,n])=>i)}getMinimizedBoxes(e=this.allBoxStatusInfo$.value){return e=e||{},!e||Object.keys(e).length===0?[]:Object.entries(e).filter(([i,n])=>n===B.Minimized).map(([i,n])=>i)}setState(e,i=!1){switch(console.log(i),e){case B.Maximized:break;case B.Minimized:break}return this}create(e={},i=!0){const n=e.id||ji(),r=this.getMaximizedBoxes(),s=this.getMinimizedBoxes(),o=r.includes(n)||r.length>0&&e.maximized!==!1,a=s.includes(n)||e.minimized===!0,l=new Pv({zIndex:this.topBox?this.topBox.zIndex+1:100,...i?this.smartPosition(e):e,darkMode:this.darkMode,prefersColorScheme:this.prefersColorScheme,maximized:o,minimized:a,fence:this.fence,namespace:this.namespace,containerRect:this.containerRect,readonly:this.readonly,collectorRect:this.collectorRect,id:n,appReadonly:this.appReadonly,addObserver:(c,d)=>{const f=this.elementObserverMap.get(n);f?f.push({el:c,cb:d}):this.elementObserverMap.set(n,[{el:c,cb:d}]),this.callbackManager.addCallback(d),this.sizeObserver.observe(c)}});l.mount(this.root),l.focus&&(this.focusBox(l),i&&this.makeBoxTop(l)),this.boxes$.setValue([...this.boxes,l]);const u={...this.allBoxStatusInfo$.value||{}};return o?u[n]=B.Maximized:a?u[n]=B.Minimized:u[n]=B.Normal,console.log("[TeleBox] Create - Setting AllBoxStatusInfo for new box",{boxId:n,managerMaximized$:o,managerMinimized$:a,newState:u[n],allBoxStatusInfo:u}),this.setAllBoxStatusInfo(u),l._delegateEvents.on(ze.Maximize,()=>{console.log("[TeleBox] TitleBar Maximize From Box Event",{boxId:l.id});const c=this.cleanAllBoxStatusInfo(this.allBoxStatusInfo$.value);Object.entries(c).forEach(([d,f])=>{f!==B.Minimized&&(c[d]=B.Maximized)}),this.setAllBoxStatusInfo(c,!1),this.events.emit(ee.BoxToNormal,{boxId:l.id,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}})}),l._delegateEvents.on(ze.Minimize,()=>{console.log("[TeleBox] TitleBar Minimize From Box Event",{boxId:l.id}),this.changeBoxToMinimized(l.id),this.events.emit(ee.BoxToMinimized,{boxId:l.id,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}})}),l._delegateEvents.on(ze.Close,()=>{console.log("[TeleBox] TitleBar Close From Box Event",{boxId:l.id}),this.changeBoxToClose(l.id),this.events.emit(ee.Removed,[l]),this.events.emit(ee.BoxToNormal,{boxId:l.id,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}})}),l._coord$.reaction((c,d,f)=>{f||this.events.emit(ee.Move,l)}),l._size$.reaction((c,d,f)=>{f||this.events.emit(ee.Resize,l)}),l._intrinsicCoord$.reaction((c,d,f)=>{f||this.events.emit(ee.IntrinsicMove,l)}),l._intrinsicSize$.reaction((c,d,f)=>{f||this.events.emit(ee.IntrinsicResize,l)}),l._visualSize$.reaction((c,d,f)=>{f||this.events.emit(ee.VisualResize,l)}),l._zIndex$.reaction((c,d,f)=>{if(console.log("[TeleBox] Current Box ZIndex ",l.id,l.zIndex," Original ZIndex ",l.zIndex),this.boxes.length>0){const w=this.boxes.reduce((y,h)=>y.zIndex>h.zIndex?y:h);this.topBox$.setValue(w)}f||this.events.emit(ee.ZIndex,l);const v=this.boxes$.value.filter(w=>this.getMaximizedBoxes().includes(w.id)).sort((w,y)=>y.zIndex-w.zIndex);v&&v.length>0&&this.maxTitleBar.setIndexZ(v[0].zIndex+1)}),this.events.emit(ee.Created,l),l}changeBoxToMinimized(e){const i={...this.allBoxStatusInfo$.value||{}},n={...this.lastLastNotMinimizedBoxsStatus$.value};n[e]=i[e],i[e]=B.Minimized,this.setAllBoxStatusInfo(i,!1),this.lastLastNotMinimizedBoxsStatus$.setValue(n,!1)}changeBoxToClose(e){this.remove(e,!1);const i={...this.lastLastNotMinimizedBoxsStatus$.value};delete i[e],this.lastLastNotMinimizedBoxsStatus$.setValue(i,!1)}query(e){return e?this.boxes.filter(this.teleBoxMatcher(e)):[...this.boxes]}queryOne(e){return e?this.boxes.find(this.teleBoxMatcher(e)):this.boxes[0]}update(e,i,n=!1){const r=this.boxes.find(s=>s.id===e);if(r)return this.updateBox(r,i,n)}updateAll(e,i=!1){this.boxes$.value.forEach(n=>{this.updateBox(n,e,i)})}remove(e,i=!1){console.log("[TeleBox] Remove Method Called",{boxOrID:e,skipUpdate:i});const n=this.getBoxIndex(e);if(n>=0){const r=typeof e=="string"?e:e.id,s=this.boxes.slice(),o=s.splice(n,1);if(this.boxes$.setValue(s),o.forEach(a=>a.destroy()),r){const a={...this.allBoxStatusInfo$.value||{}};delete a[r],this.setAllBoxStatusInfo(a,i);const l=this.elementObserverMap.get(r);l&&l.forEach(({el:u,cb:c})=>{this.callbackManager.removeCallback(c),this.sizeObserver.unobserve(u),this.elementObserverMap.delete(r)})}return i||(this.boxes.length<=0&&this.setAllBoxStatusInfo({},i),this.events.emit(ee.Removed,o)),o[0]}}removeTopBox(){if(this.topBox)return this.remove(this.topBox)}removeAll(e=!1){console.log("[TeleBox] RemoveAll Method Called",{skipUpdate:e,boxCount:this.boxes$.value.length});const i=this.boxes$.value;return this.boxes$.setValue([]),i.forEach(n=>n.destroy()),this.sizeObserver.disconnect(),this.elementObserverMap=new Map,this.callbackManager.removeAll(),e||(this.boxes.length<=0&&(console.log("[TeleBox] RemoveAll - No Boxes Left, Clearing Arrays"),this.setAllBoxStatusInfo({})),console.log("[TeleBox] RemoveAll - Emitting Removed Event",i),this.events.emit(ee.Removed,i)),i}destroy(e=!1){this.events.removeAllListeners(),this._sideEffect.flushAll(),this.removeAll(e),this.sizeObserver.disconnect(),this.callbackManager.removeAll(),Object.keys(this).forEach(i=>{const n=this[i];n instanceof gr&&n.destroy()})}wrapClassName(e){return`${this.namespace}-${e}`}focusBox(e,i=!1){console.log("[TeleBox] FocusBox Called",{boxOrID:e,skipUpdate:i});const n=this.getBox(e);n&&(this.boxes$.value.forEach(r=>{if(n===r){let s=!1;n.focus||(s=!0,n.setFocus(!0,i)),s&&!i&&this.events.emit(ee.Focused,n)}else r.focus&&this.blurBox(r,i)}),this.getMaximizedBoxes().length>0?this.getMaximizedBoxes().includes(n.id)&&(console.log("[TeleBox] FocusBox - MaxTitleBar Focus (Maximized Box)",{targetBoxId:n.id}),this.maxTitleBar.focusBox(n)):(console.log("[TeleBox] FocusBox - MaxTitleBar Focus (No Maximized Boxes)",{targetBoxId:n.id}),this.maxTitleBar.focusBox(n)))}focusTopBox(){var e,i;if(console.log("[TeleBox] FocusTopBox Called",{topBox:(e=this.topBox)==null?void 0:e.id,topBoxFocus:(i=this.topBox)==null?void 0:i.focus}),this.topBox&&!this.topBox.focus)return console.log("[TeleBox] FocusTopBox - Focusing Top Box",{topBox:this.topBox.id}),this.focusBox(this.topBox)}blurBox(e,i=!1){const n=this.getBox(e);n&&n.focus&&(n.setFocus(!1,i),i||this.events.emit(ee.Blurred,n))}blurAll(e=!1){this.boxes$.value.forEach(i=>{i.focus&&(i.setFocus(!1,e),e||this.events.emit(ee.Blurred,i))}),this.maxTitleBar.focusedBox&&this.maxTitleBar.focusBox()}setScaleContent(e,i){const n=this.boxes.find(r=>r.id==e);n&&n.setScaleContent(i)}teleBoxMatcher(e){const i=Object.keys(e);return n=>i.every(r=>e[r]===n[r])}updateBox(e,i,n=!1){var r;console.log("[TeleBox] UpdateBox Method Called",{boxId:e.id,config:i,skipUpdate:n}),(i.x!=null||i.y!=null)&&e.move(i.x==null?e.intrinsicX:i.x,i.y==null?e.intrinsicY:i.y,n),(i.width!=null||i.height!=null)&&e.resize(i.width==null?e.intrinsicWidth:i.width,i.height==null?e.intrinsicHeight:i.height,n),i.title!=null&&(e.setTitle(i.title),this.maxTitleBar.updateTitles()),i.visible!=null&&e.setVisible(i.visible,n),i.minHeight!=null&&e.setMinHeight(i.minHeight,n),i.minWidth!=null&&e.setMinWidth(i.minWidth,n),i.resizable!=null&&e.setResizable(i.resizable,n),i.draggable!=null&&e.setDraggable(i.draggable,n),i.fixRatio!=null&&e.setFixRatio(i.fixRatio,n),i.zIndex!=null&&e.setZIndex(i.zIndex,n),i.content!=null&&e.mountContent(i.content),i.footer!=null&&e.mountFooter(i.footer),(r=e.id)!=null&&r.includes("audio")?(console.log("[TeleBox] UpdateBox - Audio Box Special Handling",{boxId:e.id}),e.setMaximized(!0,n),e.setMinimized(!1,n)):(console.log("[TeleBox] UpdateBox - Regular Box Config",i),i.maximized!=null&&(console.log("[TeleBox] UpdateBox - Setting Maximized",{boxId:e.id,maximized:i.maximized,skipUpdate:n}),e.setMaximized(i.maximized,n)),i.minimized!=null&&(console.log("[TeleBox] UpdateBox - Setting Minimized",{boxId:e.id,minimized:i.minimized,skipUpdate:n}),e.setMinimized(i.minimized,n)))}smartPosition(e={}){let{x:i,y:n}=e;const{width:r=.5,height:s=.5}=e;if(i==null){let o=20;this.topBox&&(o=this.topBox.intrinsicX*this.containerRect.width+20,o>this.containerRect.width-r*this.containerRect.width&&(o=20)),i=o/this.containerRect.width}if(n==null){let o=20;this.topBox&&(o=this.topBox.intrinsicY*this.containerRect.height+20,o>this.containerRect.height-s*this.containerRect.height&&(o=20)),n=o/this.containerRect.height}return{...e,x:i,y:n,width:r,height:s}}makeBoxTop(e,i=!1){var n,r;if(console.log("[TeleBox] TopBox Change To",e.id,e.zIndex," Original TopBox ",(n=this.topBox)==null?void 0:n.id,(r=this.topBox)==null?void 0:r.zIndex),this.topBox&&e!==this.topBox)if(this.getMaximizedBoxes().includes(e.id)){const s=this.topBox.zIndex+1,o=Tv(this.boxes$.value.map(l=>l.id),this.getMaximizedBoxes(),this.getMinimizedBoxes()),a=this.boxes$.value.filter(l=>o.includes(l.id));e._zIndex$.setValue(s,i),a.sort((l,u)=>l._zIndex$.value-u._zIndex$.value).forEach((l,u)=>{l._zIndex$.setValue(s+1+u,i)})}else e._zIndex$.setValue(this.topBox.zIndex+1,i)}makeBoxTopFromNotMinimized(e=void 0,i=!1){if(console.log("[TeleBox] MakeBoxTopFromNotMinimized Called",{topFocusBox:e==null?void 0:e.id,skipUpdate:i}),!e){const s=this.allBoxStatusInfo$.value||{},o=Object.entries(s).filter(([l,u])=>u!==B.Minimized).map(([l,u])=>l),a=this.boxes.filter(l=>o.includes(l.id));a.length>0&&(e=a.reduce((l,u)=>l.zIndex>u.zIndex?l:u))}if(!e){console.log("[TeleBox] No topFocusBox found, returning early");return}this.makeBoxTop(e,i);const n=this.allBoxStatusInfo$.value||{};if(n[e.id]===B.Maximized)this.maxTitleBar.focusBox(e);else{const s=this.boxes.filter(o=>n[o.id]===B.Maximized);if(s.length>0){const o=s.reduce((a,l)=>a.zIndex>l.zIndex?a:l);this.maxTitleBar.focusBox(o)}}i||this.events.emit(ee.ZIndex,e);const r=this.boxes$.value.filter(s=>this.getMaximizedBoxes().includes(s.id)).sort((s,o)=>o.zIndex-s.zIndex);r&&r.length>0&&this.maxTitleBar.setIndexZ(r[0].zIndex+1)}makeBoxTopFromMaximized(e){var i;console.log("[TeleBox] MakeBoxTopFromMaximized Called",{boxId:e,currentMaximized:this.getMaximizedBoxes(),currentMinimized:this.getMinimizedBoxes()});let n;if(e)this.getMaximizedBoxes().includes(e)&&!this.getMinimizedBoxes().includes(e)&&(n=this.boxes$.value.find(s=>s.id===e),console.log("[TeleBox] MakeBoxTopFromMaximized - Found Specific Box",{boxId:e,maxIndexBox:n==null?void 0:n.id}));else{const s=this.allBoxStatusInfo$.value||{},o=(i=this.boxes)==null?void 0:i.filter(a=>s[a.id]===B.Maximized);o&&o.length>0&&(n=o.reduce((a,l)=>a.zIndex>l.zIndex?a:l),n&&(console.log("[TeleBox] MakeBoxTopFromMaximized - Focusing Max Index Box",{maxIndexBox:n.id}),this.maxTitleBar.focusBox(n)))}const r=!!n;return console.log("[TeleBox] MakeBoxTopFromMaximized Result",{result:r,maxIndexBox:n==null?void 0:n.id}),r}getBoxIndex(e){return typeof e=="string"?this.boxes.findIndex(i=>i.id===e):this.boxes.findIndex(i=>i===e)}setMaxTitleFocus(e){this.getBox(e)&&this.maxTitleBar.focusBox(this.getBox(e))}getBox(e){return typeof e=="string"?this.boxes.find(i=>i.id===e):e}}var Ud;const $n=(Ud=window.navigator)==null?void 0:Ud.userAgent;$n==null||$n.match(/(Edge?)\/(\d+)/);const Il=()=>typeof navigator!="undefined"&&typeof window!="undefined"&&/iPad|iPhone|iPod/.test($n),Cl=()=>typeof navigator!="undefined"&&/Android/.test($n),jv=(t,e,i,n,r)=>new Rv({safeSetAttributes:s=>t.safeSetAttributes(s),getMainView:()=>t.mainView,updateAppState:(...s)=>{var o;return(o=t.appManager)==null?void 0:o.store.updateAppState(...s)},canOperate:()=>t.canOperate,notifyContainerRectUpdate:s=>{var o;return(o=t.appManager)==null?void 0:o.notifyContainerRectUpdate(s)},cleanFocus:()=>{var s;return(s=t.appManager)==null?void 0:s.store.cleanFocus()},setAppFocus:s=>{var o;return(o=t.appManager)==null?void 0:o.store.setAppFocus(s,!0)},callbacks:e,emitter:i,boxEmitter:n,manager:t},r);class Rv{constructor(e,i){this.context=e,this.createTeleBoxManagerConfig=i;const{emitter:n,callbacks:r,boxEmitter:s,manager:o}=e;this.manager=o,this.teleBoxManager=this.setupBoxManager(i),this.teleBoxManager._state$.reaction(a=>{r.emit("boxStateChange",a),n.emit("boxStateChange",a)}),this.teleBoxManager._darkMode$.reaction(a=>{r.emit("darkModeChange",a)}),this.teleBoxManager._prefersColorScheme$.reaction(a=>{r.emit("prefersColorSchemeChange",a)}),this.teleBoxManager.events.on("all_box_status_info",a=>{var c;console.log("[TeleBox] BoxManager - AllBoxStatusInfo Event Received",a);const l=a||{};(c=this.context.manager.appManager)==null||c.store.setAllBoxStatusInfo(l),Object.entries(l).filter(([d,f])=>f===B.Maximized).map(([d,f])=>d);const u=Object.entries(l).filter(([d,f])=>f===B.Minimized).map(([d,f])=>d);r.emit("onAllBoxStatusInfo",l),u.length>0&&setTimeout(()=>{const d=1e-4*(Math.random()>.5?1:-1);this.teleBoxManager.boxes.forEach(f=>{var v;(v=f.id)!=null&&v.toLocaleLowerCase().includes("slide")&&f.resize(f.intrinsicWidth+d,f.intrinsicHeight+d,!0)})},400)}),this.teleBoxManager.events.on("last_last_not_minimized_boxs_status",a=>{var u;console.log("[TeleBox] BoxManager - LastLastNotMinimizedBoxsStatus Event Received",a);const l=a||{};(u=this.context.manager.appManager)==null||u.store.setLastNotMinimizedBoxsStatus(l)}),this.teleBoxManager.events.on("removed",a=>{console.log("[TeleBox] BoxManager - Removed Event Received",a),a.forEach(l=>{s.emit("close",{appId:l.id})})}),this.teleBoxManager.events.on("intrinsic_move",b.debounce(a=>{s.emit("move",{appId:a.id,x:a.intrinsicX,y:a.intrinsicY})},50)),this.teleBoxManager.events.on("intrinsic_resize",b.debounce(a=>{s.emit("resize",{appId:a.id,width:a.intrinsicWidth,height:a.intrinsicHeight})},200)),this.teleBoxManager.events.on("focused",a=>{a&&(this.canOperate?s.emit("focus",{appId:a.id}):this.teleBoxManager.blurBox(a.id))}),this.teleBoxManager.events.on("z_index",a=>{this.context.updateAppState(a.id,De.ZIndex,a.zIndex),r.emit("appZIndexChange",{appId:a.id,box:a})}),n.on("playgroundSizeChange",()=>this.updateManagerRect()),n.on("updateManagerRect",()=>this.updateManagerRect()),n.on("onScaleChange",({appId:a,scale:l})=>{this.changeScale(a,l)})}get mainView(){return this.context.getMainView()}get canOperate(){return this.context.canOperate()}get boxState(){return this.teleBoxManager.state}get maximized(){var i;const e=(i=this.context.manager.appManager)==null?void 0:i.store.getAllBoxStatusInfo();return e?Object.entries(e).filter(([n,r])=>r===B.Maximized).map(([n,r])=>n):[]}get minimized(){var i;const e=(i=this.context.manager.appManager)==null?void 0:i.store.getAllBoxStatusInfo();return e?Object.entries(e).filter(([n,r])=>r===B.Minimized).map(([n,r])=>n):[]}get darkMode(){return this.teleBoxManager.darkMode}get prefersColorScheme(){return this.teleBoxManager.prefersColorScheme}get boxSize(){return this.teleBoxManager.boxes.length}changeScale(e,i){this.teleBoxManager.setScaleContent(e,i)}createBox(e){var c,d,f,v,w,y,h;if(!this.teleBoxManager)return;let{minwidth:i=Yg,minheight:n=Xg}=(c=e.app.config)!=null?c:{};const{width:r,height:s}=(d=e.app.config)!=null?d:{},o=((f=e.options)==null?void 0:f.title)||e.appId,a=this.teleBoxManager.containerRect;i>1&&(i=i/a.width),n>1&&(n=n/a.height);const l={title:o,minWidth:i,minHeight:n,width:r,height:s,id:e.appId,hasHeader:(v=e.appId)!=null&&v.includes("audio")?!1:(y=(w=e.options)==null?void 0:w.hasHeader)!=null?y:!0},u=this.teleBoxManager.create(l,e.smartPosition);this.context.emitter.emit(`${e.appId}${re.WindowCreated}`),(h=this.manager.scrollerManager)==null||h.add({appId:e.appId,manager:this.manager,scrollElement:u==null?void 0:u.$contentWrap})}setBoxInitState(e){const i=this.teleBoxManager.queryOne({id:e});i&&i.state===B.Maximized&&this.context.boxEmitter.emit("resize",{appId:e,x:i.x,y:i.y,width:i.intrinsicWidth,height:i.intrinsicHeight})}setupBoxManager(e){const i=q.wrapper?q.wrapper:document.body,n=i.getBoundingClientRect(),r={root:i,containerRect:{x:0,y:0,width:n.width,height:n.height},fence:!1,prefersColorScheme:e==null?void 0:e.prefersColorScheme},s=new Lv(r);this.teleBoxManager&&this.teleBoxManager.destroy(),this.teleBoxManager=s;const o=(e==null?void 0:e.collectorContainer)||q.wrapper;return o&&this.setCollectorContainer(o),s}setCollectorContainer(e){var n;const i=new Ch({styles:(n=this.createTeleBoxManagerConfig)==null?void 0:n.collectorStyles,readonly:this.teleBoxManager.readonly}).mount(e);this.teleBoxManager.setCollector(i)}getBox(e){return this.teleBoxManager.queryOne({id:e})}closeBox(e,i=!1){var n;return(n=this.manager.scrollerManager)==null||n.remove(e),this.teleBoxManager.remove(e,i)}boxIsFocus(e){const i=this.getBox(e);return i==null?void 0:i.focus}getFocusBox(){return this.teleBoxManager.query({focus:!0})[0]}getTopBox(){return this.teleBoxManager.topBox}updateBoxState(e){if(console.log(e),!e)return;const i=this.getBox(e.id);i&&(this.teleBoxManager.update(i.id,{x:e.x,y:e.y,width:e.width||.5,height:e.height||.5,zIndex:e.zIndex,maximized:e.maximized,minimized:e.minimized},!0),setTimeout(()=>{e.focus&&this.teleBoxManager.focusBox(i.id,!0),e.maximized!=null&&this.teleBoxManager.setMaximized(Boolean(e.maximized),!0),e.minimized!=null&&this.teleBoxManager.setMinimized(Boolean(e.minimized),!0)},50),this.context.callbacks.emit("boxStateChange",this.teleBoxManager.state))}updateManagerRect(){var i;const e=(i=q.wrapper)==null?void 0:i.getBoundingClientRect();if(e&&e.width>0&&e.height>0){const n={x:0,y:0,width:e.width,height:e.height};this.teleBoxManager.setContainerRect(n),this.context.notifyContainerRectUpdate(this.teleBoxManager.containerRect)}}moveBox({appId:e,x:i,y:n}){this.teleBoxManager.update(e,{x:i,y:n},!0)}focusBox({appId:e},i=!0){this.teleBoxManager.focusBox(e,i)}resizeBox({appId:e,width:i,height:n,skipUpdate:r}){this.teleBoxManager.update(e,{width:i,height:n},r)}setBoxMinSize(e){this.teleBoxManager.update(e.appId,{minWidth:e.minWidth,minHeight:e.minHeight},!0)}setBoxTitle(e){this.teleBoxManager.update(e.appId,{title:e.title},!0)}blurAllBox(){this.teleBoxManager.blurAll()}updateAll(e){this.teleBoxManager.updateAll(e)}setMaximized(e,i=!0){e!==this.maximized&&this.teleBoxManager.setMaximized(e,i)}setMinimized(e,i=!0){this.teleBoxManager.setMinimized(e,i)}focusTopBox(){if(this.teleBoxManager.query().length>=1){const i=this.getTopBox();i&&this.focusBox({appId:i.id},!1)}}updateBox(e,i,n=!0){this.teleBoxManager.update(e,i,n)}setReadonly(e){this.teleBoxManager.setReadonly(e||Il()||Cl())}setPrefersColorScheme(e){this.teleBoxManager.setPrefersColorScheme(e)}setZIndex(e,i,n=!0){this.teleBoxManager.update(e,{zIndex:i},n)}destroy(){this.teleBoxManager.destroy()}}var O=(t=>(t.Apps="apps",t.Focus="focus",t.State="state",t.BoxState="boxState",t.MainViewCamera="mainViewCamera",t.MainViewSize="mainViewSize",t.Broadcaster="broadcaster",t.Cursors="cursors",t.Position="position",t.CursorState="cursorState",t.FullPath="fullPath",t.Registered="registered",t.IframeBridge="iframeBridge",t.LaserPointerActive="laserPointerActive",t.AllBoxStatusInfo="allBoxStatusInfo",t.LastNotMinimizedBoxsStatus="lastNotMinimizedBoxsStatus",t.ViewScrollChange="viewScrollChange",t.MainViewBackgroundInfo="mainViewBackgroundInfo",t.Scale="Scale",t.TeacherInfo="teacher",t))(O||{});class Vv{constructor(e){this.context=e,this.setAppFocus=(i,n)=>{n?this.context.safeSetAttributes({focus:i}):this.context.safeSetAttributes({focus:void 0})}}setContext(e){this.context=e}get attributes(){return this.context.getAttributes()}apps(){return b.get(this.attributes,["apps"])}get focus(){return b.get(this.attributes,["focus"])}getAppAttributes(e){return b.get(this.apps(),[e])}getAppState(e){return b.get(this.apps(),[e,"state"])}getMaximized(){const e=this.getAllBoxStatusInfo();return e?Object.entries(e).filter(([i,n])=>n===B.Maximized).map(([i,n])=>i):[]}setTeacherInfo(e){this.context.safeSetAttributes({teacher:e})}getTeacherInfo(){return b.get(this.attributes,["teacher"])}getMinimized(){const e=this.getAllBoxStatusInfo();return e?Object.entries(e).filter(([i,n])=>n===B.Minimized).map(([i,n])=>i):[]}setAllBoxStatusInfo(e){console.log("[TeleBox] AttributesDelegate - setAllBoxStatusInfo",e),this.context.safeSetAttributes({allBoxStatusInfo:e})}getAllBoxStatusInfo(){return b.get(this.attributes,["allBoxStatusInfo"])}getLaserPointerActive(){return b.get(this.attributes,["laserPointerActive"])}setLaserPointerActive(e,i){this.context.safeSetAttributes({laserPointerActive:{active:e,uid:i}})}setBoxStatusInfo(e,i){this.context.safeUpdateAttributes(["allBoxStatusInfo",e],i)}getBoxStatusInfo(e){return b.get(this.attributes,["allBoxStatusInfo",e])}getLastNotMinimizedBoxsStatus(){return b.get(this.attributes,["lastNotMinimizedBoxsStatus"])}setLastNotMinimizedBoxsStatus(e){this.context.safeSetAttributes({lastNotMinimizedBoxsStatus:e})}setViewScrollChange(e){console.log(`${te} ViewScrollChange Set`,JSON.stringify(e)),this.context.safeSetAttributes({viewScrollChange:e})}getViewScrollChange(){return b.get(this.attributes,["viewScrollChange"])}getLastNotMinimizedBoxStatus(e){return b.get(this.attributes,["lastNotMinimizedBoxsStatus",e])}setLastNotMinimizedBoxStatus(e,i){this.context.safeUpdateAttributes(["lastNotMinimizedBoxsStatus",e],i)}setupAppAttributes(e,i,n){this.attributes.apps||this.context.safeSetAttributes({apps:{}});const s=["scenePath","title"];n||s.push("scenes");const o=b.pick(e.options,s),a={kind:e.kind,options:o,isDynamicPPT:n};typeof e.src=="string"&&(a.src=e.src),a.createdAt=Date.now(),this.context.safeUpdateAttributes(["apps",i],a),this.context.safeUpdateAttributes(["apps",i,"state"],{[De.Size]:{},[De.Position]:{},[De.SceneIndex]:0})}updateAppState(e,i,n){b.get(this.attributes,["apps",e,"state"])&&this.context.safeUpdateAttributes(["apps",e,"state",i],n)}cleanAppAttributes(e){this.context.safeUpdateAttributes(["apps",e],void 0),this.context.safeSetAttributes({[e]:void 0}),this.attributes.focus===e&&this.cleanFocus()}cleanFocus(){this.context.safeSetAttributes({focus:void 0})}getAppSceneIndex(e){var i;return(i=this.getAppState(e))==null?void 0:i[De.SceneIndex]}getAppScenePath(e){var i,n;return(n=(i=this.getAppAttributes(e))==null?void 0:i.options)==null?void 0:n.scenePath}getMainViewScenePath(){return this.attributes._mainScenePath}getMainViewSceneIndex(){return this.attributes._mainSceneIndex}getBoxState(){return this.attributes.boxState}setMainViewScenePath(e){this.context.safeSetAttributes({_mainScenePath:e})}setMainViewSceneIndex(e){this.context.safeSetAttributes({_mainSceneIndex:e})}getMainViewCamera(){return b.get(this.attributes,["mainViewCamera"])}getMainViewSize(){return b.get(this.attributes,["mainViewSize"])}setMainViewCamera(e){this.context.safeSetAttributes({mainViewCamera:{...e}})}setMainViewSize(e){e.width===0||e.height===0||this.context.safeSetAttributes({mainViewSize:{...e}})}setMainViewCameraAndSize(e,i){i.width===0||i.height===0||this.context.safeSetAttributes({mainViewCamera:{...e},mainViewSize:{...i}})}updateCursor(e,i){b.get(this.attributes,["cursors"])||this.context.safeUpdateAttributes(["cursors"],{}),b.get(this.attributes,["cursors",e])||this.context.safeUpdateAttributes(["cursors",e],{}),this.context.safeUpdateAttributes(["cursors",e,"position"],i)}updateCursorState(e,i){b.get(this.attributes,["cursors",e])||this.context.safeUpdateAttributes(["cursors",e],{}),this.context.safeUpdateAttributes(["cursors",e,"cursorState"],i)}getCursorState(e){return b.get(this.attributes,["cursors",e,"cursorState"])}cleanCursor(e){this.context.safeUpdateAttributes(["cursors",e],void 0)}setMainViewFocusPath(e){const i=this.getMainViewScenePath();i&&xi(e,i)}getIframeBridge(){return b.get(this.attributes,["iframeBridge"])}setIframeBridge(e){if(b.isObject(e)){const i=this.getIframeBridge();for(const n in e){const r=e[n];i[n]!==r&&this.context.safeUpdateAttributes(["iframeBridge",n],r)}}}}const Ov=new Vv({getAttributes:()=>{throw new Error("getAttributes not implemented")},safeSetAttributes:()=>{throw new Error("safeSetAttributes not implemented")},safeUpdateAttributes:()=>{throw new Error("safeUpdateAttributes not implemented")}}),nt=(...t)=>{q.debug&&console.log("[WindowManager]:",...t)},bl=(t,e)=>{let i=0;const n=e.length-1;return t===e.index?t===n?i=t-1:i=e.index+1:i=e.index,i},At=new Ai.default;class Al{constructor(e,i,n,r){var s;this.params=e,this.manager=i,this.boxManager=this.manager.boxManager,this.appProxies=this.manager.appProxies,this.viewManager=this.manager.viewManager,this.store=this.manager.store,this.status="normal",this.getAppInitState=o=>{var h,p;const a=this.store.getAppState(o);if(!a)return;const l=a==null?void 0:a[De.Position],u=this.store.focus,c=a==null?void 0:a[De.Size],d=a==null?void 0:a[De.SceneIndex],f=(h=this.store.getMaximized())==null?void 0:h.includes(o),v=(p=this.store.getMinimized())==null?void 0:p.includes(o),w=a==null?void 0:a.zIndex;let y={maximized:f,minimized:v,zIndex:w};return l&&(y={...y,id:o,x:l.x,y:l.y}),u===o&&(y={...y,focus:!0}),c&&(y={...y,width:c.width,height:c.height}),d&&(y={...y,sceneIndex:d}),y},this.appAttributesUpdateListener=o=>{this.manager.refresher.add(o,()=>A.autorun(()=>{const a=this.manager.attributes[o];a&&this.appEmitter.emit("attributesUpdate",a)})),this.manager.refresher.add(this.stateKey,()=>A.autorun(()=>{var l,u,c,d;const a=(l=this.appAttributes)==null?void 0:l.state;(a==null?void 0:a.zIndex)>0&&a.zIndex!==((u=this.box)==null?void 0:u.zIndex)&&((c=this.boxManager)==null||c.setZIndex(o,a.zIndex),(d=this.boxManager)==null||d.focusBox({appId:o}))})),this.manager.refresher.add(`${o}-fullPath`,()=>A.autorun(()=>{var l;const a=(l=this.appAttributes)==null?void 0:l.fullPath;this.setFocusScenePathHandler(a),this._prevFullPath!==a&&(this.notifyPageStateChange(),this._prevFullPath=a)}))},this.setFocusScenePathHandler=b.debounce(o=>{var a;this.view&&o&&o!==((a=this.view)==null?void 0:a.focusScenePath)&&(xi(this.view,o),J.emit("onAppScenePathChange",{appId:this.id,view:this.view}))},50),this.notifyPageStateChange=b.debounce(()=>{this.appEmitter.emit("pageStateChange",this.pageState)},50),this.kind=e.kind,this.id=n,this.stateKey=`${this.id}_state`,this.appProxies.set(this.id,this),this.appEmitter=new Ai.default,this.appListener=this.makeAppEventListener(this.id),this.isAddApp=r,this.initScenes(),(s=this.params.options)!=null&&s.scenePath&&this.createView(),this._pageState=new Am({displayer:this.manager.displayer,scenePath:this.scenePath,view:this.view,notifyPageStateChange:this.notifyPageStateChange})}initScenes(){var i;const e=this.params.options;e&&(this.scenePath=e.scenePath,((i=this.appAttributes)==null?void 0:i.isDynamicPPT)&&this.scenePath?this.scenes=rn(this.manager.displayer)[this.scenePath]:this.scenes=e.scenes)}get view(){return this.manager.viewManager.getView(this.id)}get viewIndex(){var e;return(e=this.view)==null?void 0:e.focusSceneIndex}get isWritable(){var e;return this.manager.canOperate&&!((e=this.box)!=null&&e.readonly)}get attributes(){return this.manager.attributes[this.id]}get appAttributes(){return this.store.getAppAttributes(this.id)}getFullScenePath(){if(this.scenePath)return b.get(this.appAttributes,[O.FullPath])||this.getFullScenePathFromScenes()}getFullScenePathFromScenes(){const e=b.get(this.appAttributes,["state","SceneIndex"],0),i=fm(this.manager.room,this.scenePath,e);return i&&this.setFullPath(i),i}setFullPath(e){this.manager.safeUpdateAttributes(["apps",this.id,O.FullPath],e)}async baseInsertApp(e=!1){var s;const i=this.params;if(!i.kind)throw new Error("[WindowManager]: kind require");const n=await((s=Ne.appClasses.get(i.kind))==null?void 0:s()),r=Ne.registered.get(i.kind);if(n)await this.setupApp(this.id,e,n,i.options,r==null?void 0:r.appOptions);else throw new Error(`[WindowManager]: app load failed ${i.kind} ${i.src}`);return R.emit("updateManagerRect"),{appId:this.id,app:n}}get box(){var e;return(e=this.boxManager)==null?void 0:e.getBox(this.id)}async setupApp(e,i,n,r,s){var a,l,u;if(nt("setupApp",e,n,r),!this.boxManager)throw new th;const o=new bm(this.manager,this.boxManager,e,this,s);this.appContext=o;try{R.once(`${e}${re.WindowCreated}`).then(async()=>{var w,y,h,p,g,m,x,M,T,z;let f;if(!i){f=this.getAppInitState(e);const P=(h=(y=(w=this.boxManager)==null?void 0:w.teleBoxManager)==null?void 0:y.getMaximizedBoxes())==null?void 0:h.includes(e),D=(m=(g=(p=this.boxManager)==null?void 0:p.teleBoxManager)==null?void 0:g.getMinimizedBoxes())==null?void 0:m.includes(e);Object.assign(f||{},{maximized:P,minimized:D}),(x=this.boxManager)==null||x.updateBoxState(f);const S=(M=this.boxManager)==null?void 0:M.teleBoxManager.getMaximizedBoxes().filter(N=>{var I;return!((I=this==null?void 0:this.boxManager)!=null&&I.teleBoxManager.getMinimizedBoxes().includes(N))});S!=null&&S.length&&((z=(T=this.boxManager)==null?void 0:T.teleBoxManager)==null||z.makeBoxTopFromMaximized())}this.appEmitter.onAny(this.appListener),this.appAttributesUpdateListener(e),this.setViewFocusScenePath();let v;this.manager.isReplay&&(v=this.manager.mainView.scenePath),setTimeout(async()=>{console.log("setup app",n);const P=await n.setup(o);this.appResult=P,Ne.notifyApp(this.kind,"created",{appId:e,result:P}),this.afterSetupApp(f),this.fixMobileSize(),v&&this.manager.mainViewProxy.setFocusScenePath(v),J.emit("onAppSetup",e)},Gd)});const c=(r==null?void 0:r.hasHeader)===!1||((a=this.appAttributes.options)==null?void 0:a.hasHeader)===!1?!1:((l=this.appAttributes.state)==null?void 0:l.hasHeader)!==!1;(u=this.boxManager)==null||u.createBox({appId:e,app:n,options:{...r,hasHeader:c},canOperate:this.manager.canOperate,smartPosition:this.isAddApp}),this.isAddApp&&this.box&&(this.store.updateAppState(e,De.ZIndex,this.box.zIndex),this.store.updateAppState(e,De.Size,{width:this.box.intrinsicWidth,height:this.box.intrinsicHeight}),this.boxManager.focusBox({appId:e},!1));const d=this.store.attributes[O.MainViewBackgroundInfo];d&&d.img.length>0&&R.emit("onBackgroundImgChange",d.img)}catch(c){throw console.error(c),new Error(`[WindowManager]: app setup error: ${c.message}`)}}fixMobileSize(){var i,n;const e=(i=this.boxManager)==null?void 0:i.getBox(this.id);e&&((n=this.boxManager)==null||n.resizeBox({appId:this.id,width:e.intrinsicWidth+.001,height:e.intrinsicHeight+.001,skipUpdate:!0}))}afterSetupApp(e){var i;e&&(!(e!=null&&e.x)||!e.y)&&((i=this.boxManager)==null||i.setBoxInitState(this.id))}async onSeek(e){var n;this.appEmitter.emit("seek",e).catch(r=>{console.log(`[WindowManager]: emit seek error: ${r.message}`)});const i=this.getAppInitState(this.id);(n=this.boxManager)==null||n.updateBoxState(i)}async onReconnected(){var s;if(!Boolean(this.manager.attributes.apps[this.id])){await this.destroy(!0,!1,!0);return}this.appEmitter.emit("reconnected",void 0);const i=this.getAppInitState(this.id);await this.destroy(!0,!1,!0);const n=this.params;await new Al(n,this.manager,this.id,this.isAddApp).baseInsertApp(!0),(s=this.boxManager)==null||s.updateBoxState(i)}async onRemoveScene(e){if(this.scenePath&&e.startsWith(this.scenePath+"/")){let i=this.pageState.index,n=this._pageState.getFullPath(i);n||(i=0,n=this._pageState.getFullPath(i)),n&&this.setFullPath(n),this.setViewFocusScenePath(),this.view&&(this.view.focusSceneIndex=i)}}emitAppSceneStateChange(e){this.appEmitter.emit("sceneStateChange",e)}emitAppIsWritableChange(){this.appEmitter.emit("writableChange",this.isWritable)}makeAppEventListener(e){return(i,n)=>{var r,s,o,a;if(!!this.manager.canOperate)switch(i){case"setBoxSize":{(r=this.boxManager)==null||r.resizeBox({appId:e,width:n.width,height:n.height,skipUpdate:!1});break}case"setBoxMinSize":{(s=this.boxManager)==null||s.setBoxMinSize({appId:e,minWidth:n.minwidth,minHeight:n.minheight});break}case"setBoxTitle":{(o=this.boxManager)==null||o.setBoxTitle({appId:e,title:n.title});break}case Zd.destroy:{if(this.status==="destroyed")return;this.destroy(!0,!1,!0,n==null?void 0:n.error),n!=null&&n.error&&console.error(n==null?void 0:n.error);break}case"focus":{(a=this.boxManager)==null||a.focusBox({appId:this.id}),At.emit("focus",{appId:this.id});break}}}}setScenePath(){if(!this.manager.canOperate)return;const e=this.getFullScenePath();this.manager.room&&e&&this.view&&ia(this.manager.room,e)}setViewFocusScenePath(){const e=this.getFullScenePath();return e&&this.view&&xi(this.view,e),e}async createView(){const e=await this.viewManager.createView(this.id);return this.setViewFocusScenePath(),e}get pageState(){return this._pageState.toObject()}async removeSceneByIndex(e){const i=this._pageState.getFullPath(e);if(i){const n=bl(e,this.pageState);return this.setSceneIndexWithoutSync(n),this.manager.dispatchInternalEvent(re.SetAppFocusIndex,{type:"app",appID:this.id,index:n}),setTimeout(()=>{na(this.manager.room,i,e)},100),!0}else return!1}setSceneIndexWithoutSync(e){this.view&&(this.view.focusSceneIndex=e)}setSceneIndex(e){if(this.view){this.view.focusSceneIndex=e;const i=this._pageState.getFullPath(e);i&&this.setFullPath(i)}}async destroy(e,i,n,r){var s;if(this.status!=="destroyed"){this.status="destroyed";try{await Ne.notifyApp(this.kind,"destroy",{appId:this.id}),await this.appEmitter.emit("destroy",{error:r})}catch(o){console.error("[WindowManager]: notifyApp error",o.message,o.stack)}this.appEmitter.clearListeners(),R.emit(`destroy-${this.id}`,{error:r}),e&&((s=this.boxManager)==null||s.closeBox(this.id,n)),i&&(this.store.cleanAppAttributes(this.id),this.scenePath&&na(this.manager.room,this.scenePath)),this.appProxies.delete(this.id),this._pageState.destroy(),this.viewManager.destroyView(this.id),this.manager.appStatus.delete(this.id),this.manager.refresher.remove(this.id),this.manager.refresher.remove(this.stateKey),this.manager.refresher.remove(`${this.id}-fullPath`),this._prevFullPath=void 0}}close(){return this.destroy(!0,!0,!1)}}class $v{constructor(e){this.displayer=e,this.views=new Map}createView(e){const i=bh(this.displayer);return this.views.set(e,i),i}getView(e){return this.views.get(e)}destroyView(e){const i=this.views.get(e);if(i){try{i.release()}catch{}this.views.delete(e)}}setViewScenePath(e,i){const n=this.views.get(e);n&&(n.focusScenePath=i)}destroy(){this.views.forEach(e=>{try{e.release()}catch{}}),this.views.clear()}}const bh=t=>{const e=t.views.createView();return Fv(e),e},Fv=t=>{t.setCameraBound({maxContentMode:()=>10,minContentMode:()=>.1})};class Wv{constructor(e){this.manager=e,this.polling=!1,this.started=!1,this.mainViewIsAddListener=!1,this.store=this.manager.store,this.viewMode=this.manager.windowManger.viewMode,this.sideEffectManager=new pn,this.syncCamera=()=>{if(!this.polling||this.viewMode!==A.ViewMode.Broadcaster)return;const{mainViewCamera:n}=this;n&&n.id!==this.manager.uid&&this.moveCameraSizeByAttributes()},this.startListenWritableChange=()=>{this.sideEffectManager.add(()=>R.on("writableChange",n=>{n&&this.ensureCameraAndSize(),this.manager.room&&this.syncMainView(this.manager.room)}))},this.addCameraReaction=()=>{this.manager.refresher.add(O.MainViewCamera,this.cameraReaction)},this.cameraReaction=()=>A.reaction(()=>this.mainViewCamera,n=>{n&&n.id!==this.manager.uid&&(this.moveCameraToContian(this.mainViewSize),this.moveCamera(n))},{fireImmediately:!0}),this.sizeChangeHandler=b.debounce(n=>{n&&(this.moveCameraToContian(n),this.moveCamera(this.mainViewCamera)),this.ensureMainViewSize()},30),this.onUpdateContainerSizeRatio=()=>{const n=this.store.getMainViewSize();this.sizeChangeHandler(n)},this.onCameraUpdatedByDevice=n=>{this.viewMode!==A.ViewMode.Follower&&(this.store.setMainViewCamera({...n,id:this.manager.uid}),b.isEqual(this.mainViewSize,{...this.mainView.size,id:this.manager.uid})||this.setMainViewSize(this.view.size))},this.mainViewClickListener=()=>{this.mainViewClickHandler()},this.setMainViewSize=b.debounce(n=>{this.store.setMainViewSize({...n,id:this.manager.uid})},50),this._syncMainViewTimer=0,this.onCameraOrSizeUpdated=()=>{J.emit("cameraStateChange",this.cameraState),this.manager.room&&this.manager.room.syncMainView&&(clearTimeout(this._syncMainViewTimer),this._syncMainViewTimer=setTimeout(this.syncMainView,100,this.manager.room)),this.ensureMainViewSize()},this.syncMainView=n=>{n.isWritable&&n.syncMainView(this.mainView)},this.setViewMode=n=>{this.viewMode=n},this.mainView=this.createMainView(),this.moveCameraSizeByAttributes(),R.once("mainViewMounted").then(()=>{this.addMainViewListener(),this.start(),this.ensureCameraAndSize(),this.startListenWritableChange()});const i=()=>{this.sizeChangeHandler(this.mainViewSize)};this.sideEffectManager.add(()=>R.on("playgroundSizeChange",i)),this.sideEffectManager.add(()=>R.on("containerSizeRatioUpdate",this.onUpdateContainerSizeRatio)),this.sideEffectManager.add(()=>R.on("startReconnect",()=>{this.didRelease||this.mainView.release()})),this.sideEffectManager.setInterval(this.syncCamera,1500)}ensureCameraAndSize(){this.viewMode===A.ViewMode.Broadcaster&&(!this.mainViewCamera||!this.mainViewSize)&&(this.manager.dispatchInternalEvent(re.InitMainViewCamera),this.setCameraAndSize())}get mainViewCamera(){return this.store.getMainViewCamera()}get mainViewSize(){return this.store.getMainViewSize()}get didRelease(){return b.get(this.view,["didRelease"])}moveCameraSizeByAttributes(){this.moveCameraToContian(this.mainViewSize),this.moveCamera(this.mainViewCamera)}start(){this.sizeChangeHandler(this.mainViewSize),!this.started&&(this.addCameraListener(),this.addCameraReaction(),this.manager.room&&this.syncMainView(this.manager.room),this.started=!0)}setCameraAndSize(){const e={...this.mainView.camera,id:this.manager.uid},i={...this.mainView.size,id:this.manager.uid};this.store.setMainViewCameraAndSize(e,i)}setMainViewCameraAndSize(e,i){this.store.setMainViewCameraAndSize(e,i)}get view(){return this.mainView}get cameraState(){return{...this.view.camera,...this.view.size}}createMainView(){const e=bh(this.manager.displayer),i=this.store.getMainViewScenePath();return i&&xi(e,i),e}onReconnect(){if(this.didRelease)this.rebind();else{const e=this.store.getMainViewScenePath();this.setFocusScenePath(e)}}setFocusScenePath(e){if(e)return xi(this.view,e)}rebind(){const e=this.mainView.divElement,i=this.mainView.disableCameraTransform;this.stop(),this.didRelease||this.mainView.release(),this.removeMainViewListener(),this.mainView=this.createMainView(),this.mainView.disableCameraTransform=i,this.mainView.divElement=e,this.addMainViewListener(),this.start(),J.emit("onMainViewRebind",this.mainView)}addMainViewListener(){this.mainViewIsAddListener||this.view.divElement&&(this.view.divElement.addEventListener("click",this.mainViewClickListener),this.view.divElement.addEventListener("touchend",this.mainViewClickListener),this.mainViewIsAddListener=!0)}removeMainViewListener(){this.view.divElement&&(this.view.divElement.removeEventListener("click",this.mainViewClickListener),this.view.divElement.removeEventListener("touchend",this.mainViewClickListener)),this.mainViewIsAddListener=!1}async mainViewClickHandler(){var e;!this.manager.canOperate||(this.store.cleanFocus(),(e=this.manager.boxManager)==null||e.blurAllBox())}addCameraListener(){this.view.callbacks.on("onCameraUpdatedByDevice",this.onCameraUpdatedByDevice),this.view.callbacks.on("onCameraUpdated",this.onCameraOrSizeUpdated),this.view.callbacks.on("onSizeUpdated",this.onCameraOrSizeUpdated)}removeCameraListener(){this.view.callbacks.off("onCameraUpdatedByDevice",this.onCameraUpdatedByDevice),this.view.callbacks.off("onCameraUpdated",this.onCameraOrSizeUpdated),this.view.callbacks.off("onSizeUpdated",this.onCameraOrSizeUpdated)}ensureMainViewSize(){(!this.mainViewSize||this.mainViewSize.width===0||this.mainViewSize.height===0)&&this.mainView.size.width>0&&this.mainView.size.height>0&&this.setMainViewSize(this.mainView.size)}moveCameraToContian(e){b.isEmpty(e)||(this.view.moveCameraToContain({width:e.width,height:e.height,originX:-e.width/2,originY:-e.height/2,animationMode:A.AnimationMode.Immediately}),this.scale=this.view.camera.scale)}moveCamera(e){if(!b.isEmpty(e)){if(b.isEqual(e,this.view.camera))return;const{centerX:i,centerY:n,scale:r}=e,s=r*(this.scale||1);this.view.moveCamera({centerX:i,centerY:n,scale:s,animationMode:A.AnimationMode.Immediately})}}stop(){this.removeCameraListener(),this.manager.refresher.remove(O.MainViewCamera),this.manager.refresher.remove(O.MainViewSize),this.started=!1}destroy(){this.removeMainViewListener(),this.stop(),this.sideEffectManager.flushAll()}}class Uv{constructor(e){this.context=e,this.addRedoUndoListeners=i=>{if(i===void 0)this.addViewCallbacks(this.context.mainView(),this.onCanRedoStepsUpdate,this.onCanUndoStepsUpdate);else{const n=this.context.getAppProxy(i);n&&n.view&&this.addViewCallbacks(n.view,this.onCanRedoStepsUpdate,this.onCanUndoStepsUpdate)}},this.addViewCallbacks=(i,n,r)=>{n(i.canRedoSteps),r(i.canUndoSteps),i.callbacks.on("onCanRedoStepsUpdate",n),i.callbacks.on("onCanUndoStepsUpdate",r)},this.disposeViewCallbacks=i=>{i.callbacks.off("onCanRedoStepsUpdate",this.onCanRedoStepsUpdate),i.callbacks.off("onCanUndoStepsUpdate",this.onCanUndoStepsUpdate)},this.onCanRedoStepsUpdate=i=>{J.emit("canRedoStepsChange",i)},this.onCanUndoStepsUpdate=i=>{J.emit("canUndoStepsChange",i)},this.disposePrevFocusViewRedoUndoListeners=i=>{let n;if(i===void 0)n=this.context.mainView();else{const r=this.context.getAppProxy(i);r&&r.view&&(n=r.view)}n&&this.disposeViewCallbacks(n)},R.on("focusedChange",i=>{this.disposePrevFocusViewRedoUndoListeners(i.prev),setTimeout(()=>{this.addRedoUndoListeners(i.focused)},0)}),R.on("rootDirRemoved",()=>{this.disposePrevFocusViewRedoUndoListeners(e.focus()),this.addRedoUndoListeners(e.focus())}),this.addRedoUndoListeners(e.focus())}destroy(){this.disposePrevFocusViewRedoUndoListeners(this.context.focus())}}class Hv{constructor(e){this.windowManger=e,this.appProxies=new Map,this.appStatus=new Map,this.store=Ov,this.isReplay=this.windowManger.isReplay,this.mainViewScenesLength=0,this.callbacksNode=null,this.appCreateQueue=new Kg,this.sideEffectManager=new pn,this.sceneState=null,this.rootDirRemoving=!1,this.onRemoveScenes=async i=>{var r,s;const{scenePath:n}=i;if(n===We){await this.onRootDirRemoved(),this.dispatchInternalEvent(re.RootDirRemoved);return}if(ym(n)){let o=this.mainView.focusSceneIndex||0,a=(r=this.callbacksNode)==null?void 0:r.scenes[o];a||(o=0,a=(s=this.callbacksNode)==null?void 0:s.scenes[o]),a&&this.setMainViewScenePath(`${We}${a}`),await this.setMainViewSceneIndex(o)}else this.appProxies.forEach(o=>{o.onRemoveScene(n)})},this.onReadonlyChanged=()=>{this.appProxies.forEach(i=>{i.emitAppIsWritableChange()})},this.onPlayerSeekStart=async()=>{await this.closeAll()},this.onPlayerSeekDone=async i=>{await this.attributesUpdateCallback(this.attributes.apps),this.appProxies.forEach(n=>{n.onSeek(i)})},this.createRootDirScenesCallback=()=>{let i=!1;this.callbacksNode&&(this.callbacksNode.dispose(),i=!0),this.callbacksNode=this.displayer.createScenesCallback(We,{onAddScene:this.onSceneChange,onRemoveScene:async(n,r)=>{await this.onSceneChange(n),R.emit("rootDirSceneRemoved",r)}}),this.callbacksNode&&(this.updateSceneState(this.callbacksNode),this.mainViewScenesLength=this.callbacksNode.scenes.length,i&&this.emitMainViewScenesChange(this.callbacksNode.scenes.length))},this.removeSceneByIndex=async i=>{var s;const n=bl(i,this.windowManger.pageState);this.setSceneIndexWithoutSync(n),this.dispatchInternalEvent(re.SetAppFocusIndex,{type:"main",index:n});const r=(s=this.callbacksNode)==null?void 0:s.scenes[i];return setTimeout(()=>{r&&na(this.room,`${We}${r}`,i)},100),new Promise((o,a)=>{R.once("rootDirSceneRemoved").then(l=>{l===r&&o(!0)}).catch(l=>{console.log(`[WindowManager]: removePage error: ${l}`),a(!1)})})},this.setSceneIndexWithoutSync=i=>{var r;const n=(r=this.callbacksNode)==null?void 0:r.scenes[i];n&&this.mainViewProxy.setFocusScenePath(`${We}${n}`)},this.onSceneChange=i=>(this.mainViewScenesLength=i.scenes.length,this.updateSceneState(i),this.emitMainViewScenesChange(this.mainViewScenesLength)),this.emitMainViewScenesChange=i=>Promise.all([J.emit("mainViewScenesLengthChange",i),R.emit("changePageState")]),this.updateSceneState=i=>{const n=this.store.getMainViewSceneIndex()||0;let r=i.scenes[n];r||(r=i.scenes[this.mainView.focusSceneIndex||0]),this.sceneState={scenePath:`${We}${r}`,contextPath:i.path,index:n,scenes:i.scenes.map(s=>({name:s})),sceneName:r},J.emit("sceneStateChange",this.sceneState)},this.onBoxMove=i=>{this.dispatchInternalEvent(re.AppMove,i),this.store.updateAppState(i.appId,De.Position,{x:i.x,y:i.y}),J.emit("onBoxMove",i)},this.onBoxResize=i=>{i.width&&i.height&&(this.dispatchInternalEvent(re.AppResize,i),this.store.updateAppState(i.appId,De.Size,{width:i.width,height:i.height}),J.emit("onBoxResize",i))},this.onBoxFocus=i=>{this.windowManger.safeSetAttributes({focus:i.appId}),J.emit("onBoxFocus",i)},this.onBoxClose=i=>{const n=this.appProxies.get(i.appId);n&&n.destroy(!1,!0,!0,i.error),J.emit("onBoxClose",i)},this.onBoxStateChange=i=>{this.dispatchInternalEvent(re.AppBoxStateChange,i),J.emit("onBoxStateChange",i)},this.addAppsChangeListener=()=>{this.refresher.add("apps",()=>ra(()=>this.attributes.apps,()=>{this.attributesUpdateCallback(this.attributes.apps)}))},this.addAppCloseListener=()=>{this.refresher.add("appsClose",()=>ra(()=>this.attributes.apps,i=>{i.some(n=>n.kind===A.UpdateEventKind.Removed)&&this.onAppDelete(this.attributes.apps)}))},this.onMainViewIndexChange=i=>{i!==void 0&&this._prevSceneIndex!==i&&(J.emit("mainViewSceneIndexChange",i),R.emit("changePageState"),this.callbacksNode&&this.updateSceneState(this.callbacksNode),this._prevSceneIndex=i)},this.onFocusChange=i=>{var n;this._prevFocused!==i&&(J.emit("focusedChange",i),R.emit("focusedChange",{focused:i,prev:this._prevFocused}),this._prevFocused=i,i!==void 0&&((n=this.boxManager)==null||n.focusBox({appId:i}),setTimeout(()=>{const r=this.appProxies.get(i);r&&Ne.notifyApp(r.kind,"focus",{appId:i})},0)))},this.attributesUpdateCallback=b.debounce(i=>this._attributesUpdateCallback(i),100),this._appIds=[],this.onRegisteredChange=i=>{!i||Object.entries(i).forEach(([n,r])=>{Ne.appClasses.has(n)||Ne.register({kind:n,src:r.src,name:r.name})})},this.onMinimized=i=>{var n,r;((n=this.boxManager)==null?void 0:n.minimized)!==i&&(i===!0&&((r=this.boxManager)==null||r.blurAllBox()),setTimeout(()=>{var s;(s=this.boxManager)==null||s.setMinimized(Boolean(i))},0))},this.onAppDelete=async i=>{const n=Object.keys(i);for(const[r,s]of this.appProxies.entries())n.includes(r)||await s.destroy(!0,!1,!0)},this.closeAll=async()=>{for(const[i,n]of this.appProxies.entries())await n.destroy(!0,!1,!0)},this.displayerStateListener=i=>{this.appProxies.forEach(n=>{n.appEmitter.emit("roomStateChange",i)}),R.emit("observerIdChange",this.displayer.observerId)},this.displayerWritableListener=i=>{var s,o;const n=!i,r=this.windowManger.readonly===void 0||this.windowManger.readonly===!1;this.windowManger.readonly===void 0?(s=this.boxManager)==null||s.setReadonly(i):(o=this.boxManager)==null||o.setReadonly(!(n&&r)),this.appProxies.forEach(a=>{a.emitAppIsWritableChange()}),R.emit("writableChange",n)},this.updateSceneIndex=()=>{const i=this.store.getMainViewScenePath(),n=Io(i),r=rn(this.displayer)[n];if(r.length){const s=i.replace(n,"").replace("/",""),o=r.findIndex(a=>a.name===s);b.isInteger(o)&&o>=0&&this.safeSetAttributes({_mainSceneIndex:o})}},this.updateRootDirRemoving=i=>{this.rootDirRemoving=i},this.displayer=e.displayer,this.store.setContext({getAttributes:()=>this.attributes,safeSetAttributes:i=>this.safeSetAttributes(i),safeUpdateAttributes:(i,n)=>this.safeUpdateAttributes(i,n)}),this.mainViewProxy=new Wv(this),this.viewManager=new $v(this.displayer),this.appListeners=new xm(this),this.displayer.callbacks.on(this.eventName,this.displayerStateListener),this.appListeners.addListeners(),this.refresher=Vg,this.refresher.setRoom(this.room),this.refresher.setContext({emitter:R}),this.sideEffectManager.addDisposer(()=>{var i,n;this.appCreateQueue.destroy(),this.mainViewProxy.destroy(),this.refresher.destroy(),this.viewManager.destroy(),(i=this.boxManager)==null||i.destroy(),(n=this.callbacksNode)==null||n.dispose()}),R.once("onCreated").then(()=>this.onCreated()),R.on("onReconnected",()=>this.onReconnected()),A.isPlayer(this.displayer)&&(R.on("seekStart",this.onPlayerSeekStart),R.on("seek",this.onPlayerSeekDone)),R.on("removeScenes",this.onRemoveScenes),R.on("setReadonly",this.onReadonlyChanged),this.createRootDirScenesCallback(),Ne.setSyncRegisterApp(i=>{this.safeUpdateAttributes([O.Registered,i.kind],i)})}getMemberState(){var e;return((e=this.room)==null?void 0:e.state.memberState)||{strokeColor:[0,0,0]}}async onRootDirRemoved(e=!0){this.setMainViewScenePath(Qd),this.createRootDirScenesCallback();for(const[i,n]of this.appProxies.entries())n.view&&await this.closeApp(i,e);this.mainViewProxy.rebind(),R.emit("rootDirRemoved"),this.updateRootDirRemoving(!1)}get eventName(){return A.isRoom(this.displayer)?"onRoomStateChanged":"onPlayerStateChanged"}get attributes(){return this.windowManger.attributes}get canOperate(){return this.windowManger.canOperate}get room(){return A.isRoom(this.displayer)?this.displayer:void 0}get isLaserPointerActive(){return this.windowManger.isLaserPointerActive}get mainView(){return this.mainViewProxy.view}get polling(){return this.mainViewProxy.polling}set polling(e){this.mainViewProxy.polling=e}get focusApp(){if(this.store.focus)return this.appProxies.get(this.store.focus)}get extendWrapper(){return this.windowManger.extendWrapper}get uid(){var e;return((e=this.room)==null?void 0:e.uid)||""}getMainViewSceneDir(){const e=this.store.getMainViewScenePath();if(e)return Io(e);throw new Error("[WindowManager]: mainViewSceneDir not found")}async onCreated(){var e;if(Object.keys(this.attributes.apps).length&&this.store.focus&&await new Promise(i=>{this._focusAppCreatedResolve=i}).then(()=>{this.focusByAttributes(this.attributes.apps)}),await this.attributesUpdateCallback(this.attributes.apps),this.focusByAttributes(this.attributes.apps),R.emit("updateManagerRect"),At.on("move",this.onBoxMove),At.on("resize",this.onBoxResize),At.on("focus",this.onBoxFocus),At.on("close",this.onBoxClose),At.on("boxStateChange",this.onBoxStateChange),this.addAppsChangeListener(),this.addAppCloseListener(),this.refresher.add("mainViewIndex",()=>A.autorun(()=>{const i=b.get(this.attributes,"_mainSceneIndex");this.onMainViewIndexChange(i)})),this.refresher.add("focusedChange",()=>A.autorun(()=>{const i=b.get(this.attributes,"focus");this.onFocusChange(i)})),this.refresher.add("registeredChange",()=>A.autorun(()=>{const i=b.get(this.attributes,O.Registered);this.onRegisteredChange(i)})),!this.attributes.apps||Object.keys(this.attributes.apps).length===0){const i=this.store.getMainViewScenePath();if(!i)return;this.resetScenePath(i)}this.displayerWritableListener(!((e=this.room)!=null&&e.isWritable)),this.displayer.callbacks.on("onEnableWriteNowChanged",this.displayerWritableListener),this._prevFocused=this.attributes.focus,this.sideEffectManager.add(()=>{const i=new Uv({mainView:()=>this.mainViewProxy.view,focus:()=>this.attributes.focus,getAppProxy:n=>this.appProxies.get(n)});return()=>i.destroy()})}notifyAppsChange(e){(this._appIds.length!==e.length||!this._appIds.every(i=>e.includes(i)))&&(this._appIds=e,J.emit("appsChange",e))}async _attributesUpdateCallback(e){if(e&&q.container){const i=Object.keys(e);i.length===0&&this.appCreateQueue.emitReady();const r=b.orderBy(i.map(s=>({id:s,createdAt:e[s].createdAt})),"createdAt","asc").map(({id:s})=>s);this.notifyAppsChange(r);for(const s of r)if(!this.appProxies.has(s)&&!this.appStatus.has(s)){const o=e[s];try{if(!this.attributes[s])throw new Error("appAttributes is undefined");this.appCreateQueue.push(()=>(this.appStatus.set(s,ea.StartCreate),this.baseInsertApp({kind:o.kind,options:o.options,isDynamicPPT:o.isDynamicPPT},s,!1))),this.focusByAttributes(e)}catch(a){console.warn("[WindowManager]: Insert App Error",a)}}}}refresh(){this.attributesUpdateCallback(this.attributes.apps)}setBoxManager(e){this.boxManager=e}resetMaximized(){var i,n;const e=this.store.getAllBoxStatusInfo();e&&((n=(i=this.boxManager)==null?void 0:i.teleBoxManager)==null||n.setAllBoxStatusInfo({...e}))}resetMinimized(){var i,n;const e=this.store.getAllBoxStatusInfo();e&&((n=(i=this.boxManager)==null?void 0:i.teleBoxManager)==null||n.setAllBoxStatusInfo({...e}))}bindMainView(e,i){const n=this.mainViewProxy.view;n.disableCameraTransform=i,n.divElement=e,n.focusScenePath||this.setMainViewFocusPath(),R.emit("mainViewMounted"),J.emit("onMainViewMounted",n)}setMainViewFocusPath(e){var n;const i=e||this.store.getMainViewScenePath();if(i)return xi(this.mainView,i),((n=this.mainView)==null?void 0:n.focusScenePath)===i}resetScenePath(e){this.displayer.state.sceneState.scenePath!==e&&ia(this.room,e)}async addApp(e,i){nt("addApp",e);const{appId:n,needFocus:r}=await this.beforeAddApp(e,i),s=await this.baseInsertApp(e,n,!0,r);return this.afterAddApp(s),s==null?void 0:s.id}async beforeAddApp(e,i){var o,a;const n=await pm(e.kind);this.appStatus.set(n,ea.StartCreate);const r=(o=e.attributes)!=null?o:{};this.safeUpdateAttributes([n],r),this.store.setupAppAttributes(e,n,i);const s=!((a=this.boxManager)!=null&&a.minimized);return s&&this.store.setAppFocus(n,!0),{appId:n,needFocus:s}}afterAddApp(e){var i,n;if(e&&e.box){const r=e.box;At.emit("move",{appId:e.id,x:r==null?void 0:r.intrinsicX,y:r==null?void 0:r.intrinsicY}),this.store.updateAppState(e.id,De.ZIndex,r.zIndex)}(i=this.boxManager)!=null&&i.minimized&&((n=this.boxManager)==null||n.setMinimized(!1,!1))}async closeApp(e,i=!0){const n=this.appProxies.get(e);n&&n.destroy(!0,i,!1)}async baseInsertApp(e,i,n,r){if(this.appProxies.has(i)){console.warn("[WindowManager]: app duplicate exists and cannot be created again");return}const s=new Al(e,this,i,n);if(s)return await s.baseInsertApp(r),this.appStatus.delete(i),s;throw this.appStatus.delete(i),new Error("[WindowManger]: initialize AppProxy failed")}safeSetAttributes(e){this.windowManger.safeSetAttributes(e)}safeUpdateAttributes(e,i){this.windowManger.safeUpdateAttributes(e,i)}async setMainViewScenePath(e){if(this.room){const i=this.displayer.scenePathType(e);if(Io(e)!==We)throw new Error('[WindowManager]: main view scenePath must in root dir "/"');if(i===A.ScenePathType.None)throw new Error(`[WindowManager]: ${e} not valid scene`);if(i===A.ScenePathType.Page)await this._setMainViewScenePath(e);else if(i===A.ScenePathType.Dir){const r=mm(this.displayer,e);r&&await this._setMainViewScenePath(r)}}}async _setMainViewScenePath(e){this.setMainViewFocusPath(e)&&(this.safeSetAttributes({_mainScenePath:e}),this.store.setMainViewFocusPath(this.mainView),this.updateSceneIndex(),this.dispatchSetMainViewScenePath(e))}async setMainViewSceneIndex(e){var i;if(this.room){if(this.store.getMainViewSceneIndex()===e)return;const n=(i=this.callbacksNode)==null?void 0:i.scenes[e],r=`${We}${n}`;if(n)this.setMainViewFocusPath(r)&&(this.store.setMainViewScenePath(r),this.store.setMainViewSceneIndex(e),this.dispatchSetMainViewScenePath(r));else throw new Error(`[WindowManager]: ${e} not valid index`)}}dispatchSetMainViewScenePath(e){this.dispatchInternalEvent(re.SetMainViewScenePath,{nextScenePath:e}),J.emit("mainViewScenePathChange",e),ia(this.room,e)}getAppInitPath(e){var n;const i=this.store.getAppAttributes(e);if(i)return(n=i==null?void 0:i.options)==null?void 0:n.scenePath}safeDispatchMagixEvent(e,i){this.canOperate&&this.displayer.dispatchMagixEvent(e,i)}focusByAttributes(e){var i;if(e&&Object.keys(e).length===((i=this.boxManager)==null?void 0:i.boxSize)){const n=this.store.focus;n&&this.boxManager.focusBox({appId:n})}}async onReconnected(){this.attributesUpdateCallback(this.attributes.apps);const i=Array.from(this.appProxies.values()).map(n=>n.onReconnected());this.mainViewProxy.onReconnect(),await Promise.all(i),this.callbacksNode&&this.onSceneChange(this.callbacksNode)}notifyContainerRectUpdate(e){this.appProxies.forEach(i=>{i.appEmitter.emit("containerRectUpdate",e)})}dispatchInternalEvent(e,i){this.safeDispatchMagixEvent(qo,{eventName:e,payload:i})}destroy(){this.displayer.callbacks.off(this.eventName,this.displayerStateListener),this.displayer.callbacks.off("onEnableWriteNowChanged",this.displayerWritableListener),this.appListeners.removeListeners(),At.clearListeners(),R.clearListeners(),this.appProxies.size&&this.appProxies.forEach(e=>{e.destroy(!0,!1,!0)}),J.clearListeners(),this.sideEffectManager.flushAll(),this._prevFocused=void 0,this._prevSceneIndex=void 0,this._focusAppCreatedResolve=void 0}}const Zv=t=>{const e=document.createElement("div");e.className="netless-window-manager-playground";const i=document.createElement("div");i.className="netless-window-manager-sizer";const n=document.createElement("div");n.className="netless-window-manager-wrapper";const r=document.createElement("div");r.className="netless-window-manager-wrapper netless-window-manager-fancy-scrollbar",r.classList.toggle("netless-window-manager-fancy-scrollbar-readonly",Boolean(Cl()||Il()));const s=document.createElement("div");s.className="netless-window-manager-main-view-wrapper netless-window-manager-main-view-wrp";const o=document.createElement("div");o.className="netless-window-manager-main-view";const a=document.createElement("div");return a.style.display="none",e.appendChild(i),e.appendChild(a),i.appendChild(n),s.appendChild(o),r.appendChild(s),n.appendChild(r),t.appendChild(e),q.wrapper=n,{playground:e,wrapper:n,sizer:i,mainViewElement:o,mainViewWrapper:s,extendWrapper:a,mainViewScrollWrapper:r}},Qv=()=>{if(Zu(A.WhiteVersion)<Zu(Wu))throw new Jd(Wu)},xs=(t,e)=>{var s;const i=(t==null?void 0:t.state.roomMembers)||[];let n=-1,r;for(const o of i)((s=o.payload)==null?void 0:s.uid)===e&&n<o.memberId&&(n=o.memberId,r=o);return r},Gv=async t=>{let e=t.getInvisiblePlugin(q.kind);if(e)return e;let i;const n=new Promise(u=>{q._resolve=i=u});let r=!1;const s=Yv(t);!t.isWritable&&s&&(r=!0,await Hd.default(async u=>{nt(`switching to writable (x${u})`),await t.setWritable(!0)},{retries:10,maxTimeout:5e3})),t.isWritable?(nt("creating InvisiblePlugin..."),t.createInvisiblePlugin(q,{}).catch(console.warn)):(s&&console.warn("[WindowManager]: failed to switch to writable"),console.warn("[WindowManager]: waiting for others to create the plugin..."));const o=setTimeout(()=>{console.warn("[WindowManager]: no one called createInvisiblePlugin() after 20 seconds")},2e4),a=setTimeout(()=>{throw new Error("[WindowManager]: no one called createInvisiblePlugin() after 60 seconds")},6e4),l=setInterval(()=>{e=t.getInvisiblePlugin(q.kind),e&&(clearTimeout(a),clearTimeout(o),clearInterval(l),i(e),r&&t.isWritable&&setTimeout(()=>t.setWritable(!1).catch(console.warn),500))},200);return n},Yv=t=>{try{const e=atob(t.roomToken.slice(12)),i=e.indexOf("&role=");return+e[i+6]<2}catch(e){return console.error(e),!1}},Xv=window.ResizeObserver||Zg.ResizeObserver;class El{constructor(e){this.emitter=e}static create(e,i,n,r){const s=new El(r);return s.observePlaygroundSize(e,i,n),s}observePlaygroundSize(e,i,n){this.updateSizer(e.getBoundingClientRect(),i,n),this.containerResizeObserver=new Xv(r=>{var o;const s=(o=r[0])==null?void 0:o.contentRect;s&&(this.updateSizer(s,i,n),this.emitter.emit("playgroundSizeChange",s))}),this.disposer=this.emitter.on("containerSizeRatioUpdate",()=>{const r=e.getBoundingClientRect();this.updateSizer(r,i,n),this.emitter.emit("playgroundSizeChange",r)}),this.containerResizeObserver.observe(e)}updateSizer({width:e,height:i},n,r){e&&i&&(i/e>q.containerSizeRatio?(i=e*q.containerSizeRatio,n.classList.toggle("netless-window-manager-sizer-horizontal",!0)):(e=i/q.containerSizeRatio,n.classList.toggle("netless-window-manager-sizer-horizontal",!1)),r.style.width=`${e}px`,r.style.height=`${i}px`)}disconnect(){var e;(e=this.containerResizeObserver)==null||e.disconnect(),b.isFunction(this.disposer)&&(this.disposer(),this.disposer=void 0)}}function ir(){}function Ah(t){return t()}function rc(){return Object.create(null)}function eo(t){t.forEach(Ah)}function Eh(t){return typeof t=="function"}function Jv(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let _r;function Ms(t,e){return _r||(_r=document.createElement("a")),_r.href=e,t===_r.href}function Kv(t){return Object.keys(t).length===0}function Nt(t,e){t.appendChild(e)}function to(t,e,i){t.insertBefore(e,i||null)}function mr(t){t.parentNode&&t.parentNode.removeChild(t)}function Wt(t){return document.createElement(t)}function Tl(t){return document.createTextNode(t)}function ca(){return Tl(" ")}function de(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function qv(t){return Array.from(t.childNodes)}function Th(t,e){e=""+e,t.data!==e&&(t.data=e)}function Se(t,e,i,n){i==null?t.style.removeProperty(e):t.style.setProperty(e,i,n?"important":"")}let Nl;function Fn(t){Nl=t}const Ri=[],sc=[];let Yi=[];const oc=[],ew=Promise.resolve();let da=!1;function tw(){da||(da=!0,ew.then(Nh))}function ha(t){Yi.push(t)}const Do=new Set;let Bi=0;function Nh(){if(Bi!==0)return;const t=Nl;do{try{for(;Bi<Ri.length;){const e=Ri[Bi];Bi++,Fn(e),iw(e.$$)}}catch(e){throw Ri.length=0,Bi=0,e}for(Fn(null),Ri.length=0,Bi=0;sc.length;)sc.pop()();for(let e=0;e<Yi.length;e+=1){const i=Yi[e];Do.has(i)||(Do.add(i),i())}Yi.length=0}while(Ri.length);for(;oc.length;)oc.pop()();da=!1,Do.clear(),Fn(t)}function iw(t){if(t.fragment!==null){t.update(),eo(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ha)}}function nw(t){const e=[],i=[];Yi.forEach(n=>t.indexOf(n)===-1?e.push(n):i.push(n)),i.forEach(n=>n()),Yi=e}const rw=new Set;function sw(t,e){t&&t.i&&(rw.delete(t),t.i(e))}function ow(t,e,i,n){const{fragment:r,after_update:s}=t.$$;r&&r.m(e,i),n||ha(()=>{const o=t.$$.on_mount.map(Ah).filter(Eh);t.$$.on_destroy?t.$$.on_destroy.push(...o):eo(o),t.$$.on_mount=[]}),s.forEach(ha)}function aw(t,e){const i=t.$$;i.fragment!==null&&(nw(i.after_update),eo(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function lw(t,e){t.$$.dirty[0]===-1&&(Ri.push(t),tw(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function uw(t,e,i,n,r,s,o,a=[-1]){const l=Nl;Fn(t);const u=t.$$={fragment:null,ctx:[],props:s,update:ir,not_equal:r,bound:rc(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:rc(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(u.root);let c=!1;if(u.ctx=i?i(t,e.props||{},(d,f,...v)=>{const w=v.length?v[0]:f;return u.ctx&&r(u.ctx[d],u.ctx[d]=w)&&(!u.skip_bound&&u.bound[d]&&u.bound[d](w),c&&lw(t,d)),f}):[],u.update(),c=!0,eo(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const d=qv(e.target);u.fragment&&u.fragment.l(d),d.forEach(mr)}else u.fragment&&u.fragment.c();e.intro&&sw(t.$$.fragment),ow(t,e.target,e.anchor,e.customElement),Nh()}Fn(l)}class cw{$destroy(){aw(this,1),this.$destroy=ir}$on(e,i){if(!Eh(i))return ir;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(i),()=>{const r=n.indexOf(i);r!==-1&&n.splice(r,1)}}$set(e){this.$$set&&!Kv(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ac(t){let e,i,n,r,s,o,a,l=t[18]&&lc(t),u=t[19]&&uc(t);return{c(){e=Wt("div"),i=Wt("div"),l&&l.c(),n=ca(),r=Wt("span"),s=Tl(t[1]),o=ca(),u&&u.c(),Se(r,"overflow","hidden"),Se(r,"white-space","nowrap"),Se(r,"text-overflow","ellipsis"),Se(r,"max-width","80px"),de(i,"class",t[9]),Se(i,"background-color",t[3]),Se(i,"color",t[10]),Se(i,"opacity",t[12]),de(e,"class",a="netless-window-manager-cursor-name "+t[16]+" "+t[15])},m(c,d){to(c,e,d),Nt(e,i),l&&l.m(i,null),Nt(i,n),Nt(i,r),Nt(r,s),Nt(i,o),u&&u.m(i,null)},p(c,d){c[18]?l?l.p(c,d):(l=lc(c),l.c(),l.m(i,n)):l&&(l.d(1),l=null),d&2&&Th(s,c[1]),c[19]?u?u.p(c,d):(u=uc(c),u.c(),u.m(i,null)):u&&(u.d(1),u=null),d&512&&de(i,"class",c[9]),d&8&&Se(i,"background-color",c[3]),d&1024&&Se(i,"color",c[10]),d&4096&&Se(i,"opacity",c[12]),d&98304&&a!==(a="netless-window-manager-cursor-name "+c[16]+" "+c[15])&&de(e,"class",a)},d(c){c&&mr(e),l&&l.d(),u&&u.d()}}}function lc(t){let e,i;return{c(){e=Wt("img"),de(e,"class","netless-window-manager-cursor-selector-avatar"),de(e,"style",t[20]()),Ms(e.src,i=t[8])||de(e,"src",i),de(e,"alt","avatar")},m(n,r){to(n,e,r)},p(n,r){r&256&&!Ms(e.src,i=n[8])&&de(e,"src",i)},d(n){n&&mr(e)}}}function uc(t){let e,i;return{c(){e=Wt("span"),i=Tl(t[2]),de(e,"class","netless-window-manager-cursor-tag-name"),Se(e,"background-color",t[11])},m(n,r){to(n,e,r),Nt(e,i)},p(n,r){r&4&&Th(i,n[2]),r&2048&&Se(e,"background-color",n[11])},d(n){n&&mr(e)}}}function dw(t){let e,i,n,r,s,o,a,l=!t[14]&&ac(t);return{c(){e=Wt("div"),l&&l.c(),i=ca(),n=Wt("div"),r=Wt("img"),de(r,"class",s="netless-window-manager-cursor-"+t[4]+"-image "+t[15]),Ms(r.src,o=t[7])||de(r,"src",o),de(r,"alt",t[4]),de(n,"class","cursor-image-wrapper"),de(e,"class",a="netless-window-manager-cursor-mid"+(t[13]?" netless-window-manager-cursor-custom":"")),Se(e,"transform","translateX("+t[5]+"px) translateY("+t[6]+"px)"),Se(e,"display",t[17]),de(e,"data-cursor-uid",t[0])},m(u,c){to(u,e,c),l&&l.m(e,null),Nt(e,i),Nt(e,n),Nt(n,r)},p(u,[c]){u[14]?l&&(l.d(1),l=null):l?l.p(u,c):(l=ac(u),l.c(),l.m(e,i)),c&32784&&s!==(s="netless-window-manager-cursor-"+u[4]+"-image "+u[15])&&de(r,"class",s),c&128&&!Ms(r.src,o=u[7])&&de(r,"src",o),c&16&&de(r,"alt",u[4]),c&8192&&a!==(a="netless-window-manager-cursor-mid"+(u[13]?" netless-window-manager-cursor-custom":""))&&de(e,"class",a),c&96&&Se(e,"transform","translateX("+u[5]+"px) translateY("+u[6]+"px)"),c&131072&&Se(e,"display",u[17]),c&1&&de(e,"data-cursor-uid",u[0])},i:ir,o:ir,d(u){u&&mr(e),l&&l.d()}}}function hw(t,e,i){let n,r,s,o,a,l,u,c,{uid:d}=e,{cursorName:f}=e,{tagName:v}=e,{backgroundColor:w}=e,{appliance:y}=e,{x:h}=e,{y:p}=e,{src:g}=e,{visible:m}=e,{avatar:x}=e,{theme:M}=e,{color:T}=e,{cursorTagBackgroundColor:z}=e,{opacity:P}=e,{pencilEraserSize:D}=e,{custom:S}=e;const N=()=>Object.entries({width:(n?19:28)+"px",height:(n?19:28)+"px",position:n?"initial":"absolute","border-color":n?"white":w,"margin-right":(n?4:0)+"px"}).map(([I,U])=>`${I}: ${U}`).join(";");return t.$$set=I=>{"uid"in I&&i(0,d=I.uid),"cursorName"in I&&i(1,f=I.cursorName),"tagName"in I&&i(2,v=I.tagName),"backgroundColor"in I&&i(3,w=I.backgroundColor),"appliance"in I&&i(4,y=I.appliance),"x"in I&&i(5,h=I.x),"y"in I&&i(6,p=I.y),"src"in I&&i(7,g=I.src),"visible"in I&&i(21,m=I.visible),"avatar"in I&&i(8,x=I.avatar),"theme"in I&&i(9,M=I.theme),"color"in I&&i(10,T=I.color),"cursorTagBackgroundColor"in I&&i(11,z=I.cursorTagBackgroundColor),"opacity"in I&&i(12,P=I.opacity),"pencilEraserSize"in I&&i(22,D=I.pencilEraserSize),"custom"in I&&i(13,S=I.custom)},t.$$.update=()=>{t.$$.dirty&2&&(n=!b.isEmpty(f)),t.$$.dirty&4&&i(19,r=!b.isEmpty(v)),t.$$.dirty&256&&i(18,s=!b.isEmpty(x)),t.$$.dirty&2097152&&i(17,o=m?"":"none"),t.$$.dirty&16&&i(14,a=y===A.ApplianceNames.laserPointer),t.$$.dirty&16400&&i(23,l=a||y===A.ApplianceNames.pencilEraser),t.$$.dirty&8388608&&i(16,u=l?"netless-window-manager-laserPointer-pencilEraser-offset":""),t.$$.dirty&4194304&&i(15,c=D===3?"netless-window-manager-pencilEraser-3-offset":"")},[d,f,v,w,y,h,p,g,x,M,T,z,P,S,a,c,u,o,s,r,N,m,D,l]}class pw extends cw{constructor(e){super(),uw(this,e,hw,dw,Jv,{uid:0,cursorName:1,tagName:2,backgroundColor:3,appliance:4,x:5,y:6,src:7,visible:21,avatar:8,theme:9,color:10,cursorTagBackgroundColor:11,opacity:12,pencilEraserSize:22,custom:13})}}const Ph="data:image/svg+xml,%3Csvg width='24' height='24' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Ccircle cx='12' cy='12' r='2.5' stroke='%23000' stroke-linejoin='square'/%3E%3Ccircle cx='12' cy='12' r='3.5' stroke='%23FFF'/%3E%3C/g%3E%3C/svg%3E";function kh(t){return`data:image/svg+xml,%3Csvg width='24' height='24' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Ccircle cx='12' cy='12' r='2.5' stroke='%23${t}' stroke-linejoin='square'/%3E%3Ccircle cx='12' cy='12' r='3.5' stroke='%23${t}'/%3E%3C/g%3E%3C/svg%3E`}function Vi(t){return`data:image/svg+xml,%3Csvg width='24' height='24' xmlns='http://www.w3.org/2000/svg' fill='none'%3E%3Cpath d='M5 12H19' stroke='%23${t}' stroke-linejoin='round'/%3E%3Cpath d='M12 5V19' stroke='%23${t}' stroke-linejoin='round'/%3E%3C/svg%3E`}function si(t){return`url("${t}") 12 12, auto`}function fw(t){let e="";for(const i in t)e+=`.netless-whiteboard.${i} {cursor: ${t[i]}}
`;return e}const Lr=document.createElement("style");function gw(t){const[e,i,n]=t.strokeColor,r=((1<<24)+(e<<16)+(i<<8)+n).toString(16).slice(1);return Lr.textContent=fw({"cursor-pencil":si(kh(r)),"cursor-eraser":si(Ph),"cursor-rectangle":si(Vi(r)),"cursor-ellipse":si(Vi(r)),"cursor-straight":si(Vi(r)),"cursor-arrow":si(Vi(r)),"cursor-shape":si(Vi(r))}),document.head.appendChild(Lr),()=>{Lr.parentNode!=null&&document.head.removeChild(Lr)}}const mw=new Set([A.ApplianceNames.rectangle,A.ApplianceNames.ellipse,A.ApplianceNames.straight,A.ApplianceNames.arrow,A.ApplianceNames.shape]);function cc(t,e){if(t===A.ApplianceNames.pencil)return kh(e);if(t===A.ApplianceNames.eraser)return Ph;if(mw.has(t))return Vi(e)}class vw{constructor(e,i,n,r){this.manager=e,this.memberId=i,this.cursorManager=n,this.wrapper=r,this.style="default",this.move=s=>{var o;if(s.type==="main"){const a=this.cursorManager.wrapperRect;this.component&&a&&(this.autoHidden(),this.moveCursor(s,a,this.manager.mainView))}else{const a=this.cursorManager.focusView,l=(o=a==null?void 0:a.divElement)==null?void 0:o.getBoundingClientRect(),u=a==null?void 0:a.camera;a&&l&&u&&this.component&&(this.autoHidden(),this.moveCursor(s,l,a))}},this.setStyle=s=>{this.style=s,this.component&&this.component.$set({src:this.getIcon(),custom:this.isCustomIcon()})},this.leave=()=>{this.hide()},this.updateMember(),this.createCursor(),this.autoHidden(),this.setStyle(n.style)}moveCursor(e,i,n){var l,u;const{x:r,y:s,type:o}=e,a=n==null?void 0:n.screen.convertPointToScreen(r,s);if(a){let c=a.x-2,d=a.y-18;if(this.isCustomIcon()&&(c-=11,d+=4),o==="app"){const f=this.cursorManager.wrapperRect;f&&(c=c+i.x-f.x,d=d+i.y-f.y)}a.x<0||a.x>i.width||a.y<0||a.y>i.height?(l=this.component)==null||l.$set({visible:!1,x:c,y:d}):(u=this.component)==null||u.$set({visible:!0,x:c,y:d})}}get memberApplianceName(){var e,i;return(i=(e=this.member)==null?void 0:e.memberState)==null?void 0:i.currentApplianceName}get memberColor(){var i,n;return`rgb(${(n=(i=this.member)==null?void 0:i.memberState)==null?void 0:n.strokeColor.join(",")})`}get memberColorHex(){var r,s;const[e,i,n]=((s=(r=this.member)==null?void 0:r.memberState)==null?void 0:s.strokeColor)||[236,52,85];return((1<<24)+(e<<16)+(i<<8)+n).toString(16).slice(1)}get payload(){var e;return(e=this.member)==null?void 0:e.payload}get memberCursorName(){var e,i;return((e=this.payload)==null?void 0:e.nickName)||((i=this.payload)==null?void 0:i.cursorName)||this.memberId}get memberTheme(){var e;return(e=this.payload)!=null&&e.theme?"netless-window-manager-cursor-inner-mellow":"netless-window-manager-cursor-inner"}get memberCursorTextColor(){var e;return((e=this.payload)==null?void 0:e.cursorTextColor)||"#FFFFFF"}get memberCursorTagBackgroundColor(){var e;return((e=this.payload)==null?void 0:e.cursorTagBackgroundColor)||this.memberColor}get memberAvatar(){var e;return(e=this.payload)==null?void 0:e.avatar}get memberOpacity(){return!this.memberCursorName&&!this.memberAvatar?0:1}get memberTagName(){var e;return(e=this.payload)==null?void 0:e.cursorTagName}autoHidden(){this.timer&&clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.hide()},1e3*10)}async createCursor(){this.member&&this.wrapper&&(this.component=new pw({target:this.wrapper,props:this.initProps()}))}initProps(){var e;return{uid:this.memberId,x:0,y:0,appliance:this.memberApplianceName,avatar:this.memberAvatar,src:this.getIcon(),custom:this.isCustomIcon(),visible:!1,backgroundColor:this.memberColor,cursorName:this.memberCursorName,theme:this.memberTheme,color:this.memberCursorTextColor,cursorTagBackgroundColor:this.memberCursorTagBackgroundColor,opacity:this.memberOpacity,tagName:this.memberTagName,pencilEraserSize:(e=this.member)==null?void 0:e.memberState.pencilEraserSize}}getIcon(){var l;if(!this.member)return;const{memberApplianceName:e,memberColorHex:i}=this,{userApplianceIcons:n,applianceIcons:r}=this.cursorManager;let s=this.memberApplianceName;s===A.ApplianceNames.pencilEraser&&(s=`${s}${((l=this.member)==null?void 0:l.memberState.pencilEraserSize)||1}`);const o=s&&n[s];if(o)return o;if(this.style==="custom"&&e){const u=cc(e,i);if(u)return u}return r[s||A.ApplianceNames.shape]||r[A.ApplianceNames.shape]}isCustomIcon(){var o;if(!this.member)return!1;const{memberApplianceName:e,memberColorHex:i}=this,{userApplianceIcons:n}=this.cursorManager;let r=this.memberApplianceName;return r===A.ApplianceNames.pencilEraser&&(r=`${r}${((o=this.member)==null?void 0:o.memberState.pencilEraserSize)||1}`),r&&n[r]?!1:!!(this.style==="custom"&&e&&cc(e,i))}updateMember(){return this.member=xs(this.manager.room,this.memberId),this.updateComponent(),this.member}updateComponent(){var e;(e=this.component)==null||e.$set(b.omit(this.initProps(),["x","y"]))}destroy(){this.component&&this.component.$destroy(),this.cursorManager.cursorInstances.delete(this.memberId),this.timer&&clearTimeout(this.timer)}hide(){this.component&&(this.component.$set({visible:!1}),this.destroy())}}var ww="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQYSURBVHgB7ZhLbBNHHMa/WSdOE1riNBCpiG3TSH2dsFSqNqYqOfSCRFT30qoKVZxTr0GqgKN9KhyqGIRAgYMjJN4SDwkQUi4ICSkHUMxDoEg8AgEHQogdB7N2dr3DzC42sbNebxI/VsKftJqZ/39n5/ftzOyuFqippg9bBFUW3bWrC5T+xqouVj6GIAyR3bvHrfavqgG6Y8cAK/rR0gLtePhQTxASJHv2bLdyjaoZoDt3htDQ4ENvL9DRoQejUWBwUC8JGWIm+opdR0AV9OK/fSG2XHzYuFGHHx4GjhzRk93desnymskiqvgM/D9CQ05Z8v1xdRBts5PAunVAJKIn+TKSJCCZfN8hlRoie/cWnImKGuDwFPDxeoMsIWvCTKoKTE4OkaNHDU1UbAldu3EwC8+Vqm/EqV/+wVTzZ+YdBYbocPhoT8+AYRoVEL21IeSpO+DrrD+YE7dsghC+J/rptm1d+amyG+DwoKqP1z3OQ+hsOZ2TL2oinQZkWa+rqjc/XVYDC+EhOIC2DnjazqOz9UzOeaYm4vGFreb8dNkMGMHD2ag1PWvOWJsJDp9ILDxtNn8cB8ogM3hN7Mkivr7ISgVP1R+y4bSjHmPiBrS/GMOql5H8u8/7/RW4cyeGchqwAo+pB8C8BFG4rj3I803caPkKX96/jtXJHAMBcvz4ufzxSmpgKfAZiZ+wdmMznkrfae14QsKMpGD08+/x7fN7GRMBcuyY32jMkhlYDjxWsTdvqwix6Z7WvDvdjvhrPa+wmeAmvnj1KNB6eL+/0LglMbAS+Ixc0ycx9/IZJvBzNqYQR6Bn+1a/2dgrNlAK+Lknt9hxGyK5pn3baCZUNRD8fa2/2PgrMlBK+Iy4CUoR+Nfr9cOClv0xVw54rRvbsGI3/LCoZRmwCzzXkg3YCZ5rSQbsBs9l2YAd4bksGbArPFdRA3aG15BgCr9pwM7wGpZZUqG9/fyHmV3huQouofnRs24iyKNADHVrr7IvRgq7wXMVngGH7NYrLijRX9l0NL2jsA88l1A4IWzONhi8MrWJQTfYCl7nLCBKqTsnwE08/0k3kVGV4blMNnGeAU1sOeFvrbQDPJehAXn0dFfhLu9MNH+TjVQLnsvQAHveuM27ufQ9wZZVNeG5DA2MTdHNBXtQFVROQJ2TkBpbj8TERE66kvBcdUbB4bty+6zkwI/tjFeR2JEETafYBn7D+OWcc1d/1Id4MgSVxioOz7XoReb19rs+bVsTnZmZg9dN8GdnY9GLpGk0FksGA+u3IogKa9EMJBW4I5FprX5iRI8tNMH2R4wQEqYqvUkIDWMeVz7eEhxHlbTIAPuT7aY0W4+dGEmGxVbhpudrpwbbtMU/DhvJaA+Ms8XcJzgRvnQuGOaByxdQU0012VRvAXMqptxy2zoQAAAAAElFTkSuQmCC",yw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAxCAYAAABznEEcAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAZoSURBVHgB7VlLSCRXFL3ljNEhEXTGhMQJmOjCz8ZNVLKICz9xIYhCNi7UgINkGEk2En8hW5cBUQNxo05GAoKikuCAmvGzGMdPcCUGjDPxD/4Vv/3JvWW97luvq7ur+hMZ8MKlqrteNfe8e965970GuLVbC5kpJr53+hjHx9yY3TUxJgLMAQG4ITARfp5T4Mri4uL9q6urnxwOxz/oY5eXl1/Pzs7e195X2FX4jZsIhAK7gx5ps9m6nGj9/f3OtbU1pzAE0318fPwVjYHrrN7R3AjU/wpOBwA9Cmf/9ejoqDMtLU31iooKGdA+ATo4OMiXAEWAHhBAGEApXj4rPAik0vPt7e0vCgoKPH4gMzMTSktLIS8vD2JiYgABvcHMTZyennbHxsaOg3udOJmLzwqEYB0ZgRCZENm4u7e39yQuLq65srISZmZmvP5Ybm4u5OfnQ0lJyXWUCAgzNLS+vt6SnJz8WgvYwV5xSlcRgyVg3ha2Dkxzc3MvfZmVlQW+bGxsDBobGyE7O1u94uJPjIqKqklKSvrbbrfPnp+ff7e8vJwMnlSTKWfJjDKhywJo6wLp0YcZ+dyIUr7s4cOHLsrRlQwBTSBFuzc2NiZYhjjVAIyzZBqEwgCQv0OOM/gNzuiP/ijlDxBRjgClpqa6AF1cXDydmpoaLCws3JcAGYHyC4JMzoKaibKysvienp6FtrY2IA/WCFB5ebkqCHSvARo8Ozt7igIxwIJ2gJ+seFMnDoIyEUV+dHT0G3qWVUr5M043DdAB0m2IKZwAYpgZX+qkywR6NFbuR0iDxmAoZRUQKRxSLTMnJ8eIaqqSeVMnIYUOdu+sq6vrp4f+VCoYo8khZaNs01VRlERUu2/BrWAA7sl2Anink1Ao18JGjyY/PDx8hq1GZqgp5c2mp6chMjLy2b179x7hRzvoqeUUwXIzqq4O5nZsNUaEbIbLqPLTou/s7FTvT05OpsA9sXJG1AVsZDwjutqBIN6gUlWjxod8XRBNKXgsrqpqYZfwEqX9h8TExD7wbFm8LmzxHQ0QHSlXKZVSqFC/hkqlaKapTaGgCQTK7PHW1lb/wsLC86KiokkccoV+qV1tcE0pO7AWxmhTxBszDzqRr66ujqanp2cRpQLNBgUsCh8BwQ54bn5+/s+mpqa+4eHhfS1gb52vwuP0trPjhSZCBtLQ0NA3MDDQQIFYAUHBYhuvzjpVbJr1lZWVP3p7e19UVVXNgHumXYrI4uBx6Yqevz02b0FcRQ8CoBQF3dXVpQLZ3d39C7n+ora29vfJyclDYFnWgFyxK3cxhss/+KoT/N6DVkQpKypFGUCp3Ozo6HgSHx//GLW/BwHsg57zl5pzADajwLn52mPL1ZHPloMoRYPMFL6EhAR18e7s7MxVV1fPsAAp4Avteq7dC/c1+wKI4g+EfGzDM+EYHBw8RDrNiA2QL6upqVGvKJ2/gHu2L1nA5wwEB2YDfSYMO1x/px0cgEc2zBY+eo67u6H29vZ/wU2VC8l58JxKNjDOgojNEp08aFVfX++3l6JMEdDx8fEB0FNIBsDXBc8ArwuW1EkeI1RKdLWmCx+1DhkZGRvR0dFfSsHKxYtnW0iqvJAN9xNm6MR/QO5sfapUSkqKmqW5ubmfwVgyZdpw/vPZl2kUEAinBMSUStG+gwra0NDQSynQKyloIxnlewafjDFLJzLRBJqiFMnqyMgIbG5uDuD996Dnv8iAPOMAPmbcm5lVJwA/vZRMKZGZlpaWVtAvUL4GZMqE1fjRJrUd76LHoX+InlhcXPwZnWW2tra6jjrpiBM3UK/weQr6J+gfodMh9HtwncG7YLA3CMSsLmxx5WuDCt8B7vZeicInTjCWlpb6wc15mfey7oc9E8LElpVmMgb9AXoC+qcTExOPKRu4NlTHs6Q10GfhgfYOvRsJQZ76BWMKuDtaolQs+gfoH6Mn436gDg+e+5BKXUQx/C5Je/a+NpbeiQJPKgUdlNXx/BCBKxVdxW5Q0I3XBqFKRhU4KLtjYawi3csuTKdc4FnIXNvKUJkVEGRG20QZAAUpA5DbaYAQLmQzfzxyk/ffdnCD4NWVnGdE7kQBQvQHC5lVEDxgMaM29lkxGCNLKrDnIbFAMkFmBIaDkHstU41coGZ1TZD5UjReCGUAYbNgdNqoXZB/T67yYbFAMiGML3BhYeH8rb0t9h/zgcTBcTNGiQAAAABJRU5ErkJggg==",xw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAYAAADFeBvrAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAgrSURBVHgB7ZprTBRXFIDP7gIt8lQppTwE5V0KaAn6o1pqNGkDDTEmTUhsgKRp+gNJw68CFkLbVC2QkDS+gD8KJdWmARvbFBNNWpuIRGPFWBXQRMPDqIki+KLATs+ZnTvcvXtnX8w2beJJToaduTP3fHPOPffcOwC8kP+2WCDwIvahGFxTuN8KmNSZmULPNjLeqF9F8rdPkIEGEn+r+vjx46LQ0NA8/Dsader58+e/h4WFDWntFO7ot6fMFAt3JLWi2lCDpqamCux2+2+KROj82NhYGrXT2lu5Z/DP/deFByElA4Pv3LlTiHY/nJ6eVnbv3q1s2bJFyc7OVrZu3arU1dUp4+PjxPUQoT+g9tp9PkMFgpo9kxljHRoaWp2Xl3duYmIiurKyEvDoclNCQgIcPnxYPc7MzHwcGRnZhaft4Ag7O9fUbRhaITCie4lgcnNzT7qDIaHz27dvh+vXr0NEREQneqoCHKFnAR+8ZCaQGGq2CxcurCGYycnJZHcwTNAzUFFRoUJFRUV1IFQ5OKBsXB9uxSwgl0TQ3d29Yt26dccwoyVXV1d7hGEiQmGi2AzOUHx/hob4K2yuYS9G987s7OwPISEh7xPM6dOnwVfBsIMjR45AZmbmo5s3b76Xnp7+J55egMVxBSAZT0v1ED+76yn66dOnLQSzd+9ev2BIyFP0MjBco1JTU/sxfFeDazp3cYgZHmKqdoaGNISHh9fv378fSJcqlPV6e3sBJ+I/goOD34VFL0k95Y+HxPHCYGxmw5DQ2NuzZw8EBQVtunXr1jvgwUP+hhz/QDXMMCNVE8zx48dNg2FCz6QQjI2N/RA8VBFmANnu3btXihnpG8pM9fX1EAi5du0aeWkVOAMBCF7yN+R0z4yOjq6NiYlpp9CgdBtIwXpPH6vgDKWLt0CygtM6MDCwBuUYZSKaOCksAiVY9wFOBePgDOOytPAGSKzNVCCC2bBhw69YdK7ypgpYimzbtk2dl7CM+hFcveOUHDylbTFO1YdhFbByx44dA1QFUP0VSJj4+Hjo6+sDq9U6iEmHKvFZTedQ50GYbN15SITVlwNlZWUnLRZL8s6dOwMOQ9UCTtKTra2ttdppt9V2kMF5cbmsjxuM43bMNrmUzc6fP6+GQiDGDoOJi4ubwb4qm5ubafyIE6nLxGqTPEsGo1cBOGNX0TyDYafC0CyOaxcVziyh53Z2dkJycvLMvn37PmpoaBgFR4jxYSbWdVIgI89Iq4CjR48CZjlYv369+tssqI6ODsjPz4f+/v668vLycxrEHHfkYdwC8SB6mGEV8Cl64cuuri5oa2tTG+EyGjZu3AiXLl1qefDgwV8lJSUFZkDV1tZCcXExXLx4sbWoqKgPFj0zx8GI9ZwO5W4M6ekZYeqpaqbqmaSqqkpNpcPDw4dwzfM9nrLduHEjEs+X0XV/Sx96LnqE1kLtBQUF3eDwCO8dGQyzV5rl+JyuegfXI29jRotiRlKnpFghHMzKyjqotVXS0tLacKPjF3bdHxjSq1evduAkepAD+ZsDYlC8V5w8ZBVg+PPq2MGMlkInqE4joTf45MmT4YyMjAPcA+ltLSQlJX2BafxnX6HI29QeK44TOTk57mCYZ0QoJ8OBM4yB6dkNkwGlSygsLFQvYtYB3BTMxFL+M+0eFgZqp4mJiU2+QKGX1fGIk/QIrn0aYXGsyDxjmAyMhO2jhaCGoUbX1NSkLSwsPMJqV8Fspu6lIZS6OYhjiOLwdU7fQM1HfRPD7wS1obZ0j0xpb4726Z49ezaJf2/S7s9ATUGNR41BjdJseRnke3WGwhrRTS9pD1mOGoeG15BxOOfoxuCkp0Ih6NeaEaSZGlieJyiCoc1FgsGldokGk8nBvAKOrWIGQ5uPsm0tt0BWDiicAaGuGhkZ+YqMw9StGzU4OKhCnT179hNsswY1FTXdE5QEJhc1S3tGogazXLOBwQSBl3tzIhQPtAL1VQJCTcNx8y1vHIUghSKFZE9PT7H2dlM1b+Wgrr1y5Uq77J75+fnplpaWMg2ch4nlYEI5z7hdensDpI4hrYNErcMMXJ32koG4ztf3pultz83NjWG99Ra2WQ0OL2VjZjwgeufUqVOqV8+cOdPIwdBLSNJeHg8TAh5WqJ6EfSmgt7IMNRJ1JThiOlnrOAMHshprmMKdoGSCpb9s3B3SYLIFGIqICJB7xisYi+RvfiypXw40DWGdlJaWRmMd141hk8V2OWm7ieYTXhBc3+BgaZyqAISjOYxSMVvXsBTNlzdiNQDgRao2AtK3pjggpmrqbGpqSsLPIN/dv38/gaBwUjTshMHcvn27JyUlpRmc5xpPMD599LIYnLNyUKKndKjGxsakXbt2deMCLIE8IVvs0YRM1fjdu3d/wrXN5+BcnzEgvor2uN3rjzAYMp5lPEoQlE5fA0fWo8GfhlCbKVFQ1pKNIfzcOHH58mWqaimVUwJI0+6n59D4pIlzmdZPMPiZzXjDjX47Le5g0Uu8x2zgPqWyKpjVe7x3+AUbq9NYjQbgp2dsBud5o8TP7d5kHAWcQchQfoEmLgn8HjOiBIF7o5hI1x6CEbLNP3bdqYAF44JzyWLzcN1i8DcT/o3awbm8Fz3DAy2A62INwPV/E3wWdx5inmBHuwChCBD6R2JwHge80TIQRQLjt7e8DTkGZgfX8cUMZTDAteFDkveaIlzjX9ySQs8X18r2t2VHUURPKoICmDR+eCO9aSdmOIub3/w9RgpgUpiJhvraXpa6jZKHGEqyusw0GLFzX+5RhN/8kYnMSNMMfyH/V/kHST6OYVElTPAAAAAASUVORK5CYII=",Mw="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDBweCIgaGVpZ2h0PSI0MHB4IiB2aWV3Qm94PSIwIDAgNDAgNDAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYwLjEgKDg4MTMzKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5zaGFwZS1jdXJzb3I8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBkPSJNMjAsMjEuNSBDMjAuMjQ1NDU5OSwyMS41IDIwLjQ0OTYwODQsMjEuNjc2ODc1MiAyMC40OTE5NDQzLDIxLjkxMDEyNDQgTDIwLjUsMjIgTDIwLjUsMjcgQzIwLjUsMjcuMjc2MTQyNCAyMC4yNzYxNDI0LDI3LjUgMjAsMjcuNSBDMTkuNzU0NTQwMSwyNy41IDE5LjU1MDM5MTYsMjcuMzIzMTI0OCAxOS41MDgwNTU3LDI3LjA4OTg3NTYgTDE5LjUsMjcgTDE5LjUsMjIgQzE5LjUsMjEuNzIzODU3NiAxOS43MjM4NTc2LDIxLjUgMjAsMjEuNSBaIE0yNywxOS41IEMyNy4yNzYxNDI0LDE5LjUgMjcuNSwxOS43MjM4NTc2IDI3LjUsMjAgQzI3LjUsMjAuMjQ1NDU5OSAyNy4zMjMxMjQ4LDIwLjQ0OTYwODQgMjcuMDg5ODc1NiwyMC40OTE5NDQzIEwyNywyMC41IEwyMiwyMC41IEMyMS43MjM4NTc2LDIwLjUgMjEuNSwyMC4yNzYxNDI0IDIxLjUsMjAgQzIxLjUsMTkuNzU0NTQwMSAyMS42NzY4NzUyLDE5LjU1MDM5MTYgMjEuOTEwMTI0NCwxOS41MDgwNTU3IEwyMiwxOS41IEwyNywxOS41IFogTTE4LDE5LjUgQzE4LjI3NjE0MjQsMTkuNSAxOC41LDE5LjcyMzg1NzYgMTguNSwyMCBDMTguNSwyMC4yNDU0NTk5IDE4LjMyMzEyNDgsMjAuNDQ5NjA4NCAxOC4wODk4NzU2LDIwLjQ5MTk0NDMgTDE4LDIwLjUgTDEzLDIwLjUgQzEyLjcyMzg1NzYsMjAuNSAxMi41LDIwLjI3NjE0MjQgMTIuNSwyMCBDMTIuNSwxOS43NTQ1NDAxIDEyLjY3Njg3NTIsMTkuNTUwMzkxNiAxMi45MTAxMjQ0LDE5LjUwODA1NTcgTDEzLDE5LjUgTDE4LDE5LjUgWiBNMjAsMTIuNSBDMjAuMjQ1NDU5OSwxMi41IDIwLjQ0OTYwODQsMTIuNjc2ODc1MiAyMC40OTE5NDQzLDEyLjkxMDEyNDQgTDIwLjUsMTMgTDIwLjUsMTggQzIwLjUsMTguMjc2MTQyNCAyMC4yNzYxNDI0LDE4LjUgMjAsMTguNSBDMTkuNzU0NTQwMSwxOC41IDE5LjU1MDM5MTYsMTguMzIzMTI0OCAxOS41MDgwNTU3LDE4LjA4OTg3NTYgTDE5LjUsMTggTDE5LjUsMTMgQzE5LjUsMTIuNzIzODU3NiAxOS43MjM4NTc2LDEyLjUgMjAsMTIuNSBaIiBpZD0icGF0aC0xIj48L3BhdGg+CiAgICAgICAgPGZpbHRlciB4PSItNjQuNiUiIHk9Ii01OS41JSIgd2lkdGg9IjIyOS4zJSIgaGVpZ2h0PSIyNDYuMSUiIGZpbHRlclVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgaWQ9ImZpbHRlci0yIj4KICAgICAgICAgICAgPGZlTW9ycGhvbG9neSByYWRpdXM9IjEiIG9wZXJhdG9yPSJkaWxhdGUiIGluPSJTb3VyY2VBbHBoYSIgcmVzdWx0PSJzaGFkb3dTcHJlYWRPdXRlcjEiPjwvZmVNb3JwaG9sb2d5PgogICAgICAgICAgICA8ZmVPZmZzZXQgZHg9IjAiIGR5PSIyIiBpbj0ic2hhZG93U3ByZWFkT3V0ZXIxIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMSI+PC9mZU9mZnNldD4KICAgICAgICAgICAgPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMyIgaW49InNoYWRvd09mZnNldE91dGVyMSIgcmVzdWx0PSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlR2F1c3NpYW5CbHVyPgogICAgICAgICAgICA8ZmVDb21wb3NpdGUgaW49InNoYWRvd0JsdXJPdXRlcjEiIGluMj0iU291cmNlQWxwaGEiIG9wZXJhdG9yPSJvdXQiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUNvbXBvc2l0ZT4KICAgICAgICAgICAgPGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAgICAwIDAgMCAwIDAgICAwIDAgMCAwIDAgIDAgMCAwIDAuMTYgMCIgdHlwZT0ibWF0cml4IiBpbj0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUNvbG9yTWF0cml4PgogICAgICAgIDwvZmlsdGVyPgogICAgPC9kZWZzPgogICAgPGcgaWQ9Iumhtemdoi00IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iV2hpdGVib2FyZC1HdWlkZWxpbmVzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzQ0LjAwMDAwMCwgLTc1MS4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9InNoYXBlLWN1cnNvciIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQ0LjAwMDAwMCwgNzUxLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9ouWkh+S7vS00NCIgZmlsbD0iI0ZGRkZGRiIgb3BhY2l0eT0iMC4wMSIgeD0iMCIgeT0iMCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiByeD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPGcgaWQ9IuW9oueKtue7k+WQiCIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgICAgICA8dXNlIGZpbGw9ImJsYWNrIiBmaWxsLW9wYWNpdHk9IjEiIGZpbHRlcj0idXJsKCNmaWx0ZXItMikiIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIHN0cm9rZT0iI0ZGRkZGRiIgc3Ryb2tlLXdpZHRoPSIxIiBkPSJNMjAsMjEgQzIwLjQ4NTQxMDMsMjEgMjAuODk4MDg1LDIxLjM0Nzk5OTMgMjAuOTg5OTQ3OSwyMS44NjU0ODc3IEwyMSwyMiBMMjEsMjcgQzIxLDI3LjU1MjI4NDcgMjAuNTUyMjg0NywyOCAyMCwyOCBDMTkuNTE0NTg5NywyOCAxOS4xMDE5MTUsMjcuNjUyMDAwNyAxOS4wMTAwNTIxLDI3LjEzNDUxMjMgTDE5LDI3IEwxOSwyMiBDMTksMjEuNDQ3NzE1MyAxOS40NDc3MTUzLDIxIDIwLDIxIFogTTI3LDE5IEMyNy41NTIyODQ3LDE5IDI4LDE5LjQ0NzcxNTMgMjgsMjAgQzI4LDIwLjQ4NTQxMDMgMjcuNjUyMDAwNywyMC44OTgwODUgMjcuMTM0NTEyMywyMC45ODk5NDc5IEwyNywyMSBMMjIsMjEgQzIxLjQ0NzcxNTMsMjEgMjEsMjAuNTUyMjg0NyAyMSwyMCBDMjEsMTkuNTE0NTg5NyAyMS4zNDc5OTkzLDE5LjEwMTkxNSAyMS44NjU0ODc3LDE5LjAxMDA1MjEgTDIyLDE5IEwyNywxOSBaIE0xOCwxOSBDMTguNTUyMjg0NywxOSAxOSwxOS40NDc3MTUzIDE5LDIwIEMxOSwyMC40ODU0MTAzIDE4LjY1MjAwMDcsMjAuODk4MDg1IDE4LjEzNDUxMjMsMjAuOTg5OTQ3OSBMMTgsMjEgTDEzLDIxIEMxMi40NDc3MTUzLDIxIDEyLDIwLjU1MjI4NDcgMTIsMjAgQzEyLDE5LjUxNDU4OTcgMTIuMzQ3OTk5MywxOS4xMDE5MTUgMTIuODY1NDg3NywxOS4wMTAwNTIxIEwxMywxOSBMMTgsMTkgWiBNMjAsMTIgQzIwLjQ4NTQxMDMsMTIgMjAuODk4MDg1LDEyLjM0Nzk5OTMgMjAuOTg5OTQ3OSwxMi44NjU0ODc3IEwyMSwxMyBMMjEsMTggQzIxLDE4LjU1MjI4NDcgMjAuNTUyMjg0NywxOSAyMCwxOSBDMTkuNTE0NTg5NywxOSAxOS4xMDE5MTUsMTguNjUyMDAwNyAxOS4wMTAwNTIxLDE4LjEzNDUxMjMgTDE5LDE4IEwxOSwxMyBDMTksMTIuNDQ3NzE1MyAxOS40NDc3MTUzLDEyIDIwLDEyIFoiIGZpbGw9IiMyMTIzMjQiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMTguNSIgeT0iMTciIHdpZHRoPSIzIiBoZWlnaHQ9IjYiPjwvcmVjdD4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjE3IiB5PSIxOC41IiB3aWR0aD0iNiIgaGVpZ2h0PSIzIj48L3JlY3Q+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMjAsMjEuNSBDMjAuMjQ1NDU5OSwyMS41IDIwLjQ0OTYwODQsMjEuNjc2ODc1MiAyMC40OTE5NDQzLDIxLjkxMDEyNDQgTDIwLjUsMjIgTDIwLjUsMjcgQzIwLjUsMjcuMjc2MTQyNCAyMC4yNzYxNDI0LDI3LjUgMjAsMjcuNSBDMTkuNzU0NTQwMSwyNy41IDE5LjU1MDM5MTYsMjcuMzIzMTI0OCAxOS41MDgwNTU3LDI3LjA4OTg3NTYgTDE5LjUsMjcgTDE5LjUsMjIgQzE5LjUsMjEuNzIzODU3NiAxOS43MjM4NTc2LDIxLjUgMjAsMjEuNSBaIE0yNywxOS41IEMyNy4yNzYxNDI0LDE5LjUgMjcuNSwxOS43MjM4NTc2IDI3LjUsMjAgQzI3LjUsMjAuMjQ1NDU5OSAyNy4zMjMxMjQ4LDIwLjQ0OTYwODQgMjcuMDg5ODc1NiwyMC40OTE5NDQzIEwyNywyMC41IEwyMiwyMC41IEMyMS43MjM4NTc2LDIwLjUgMjEuNSwyMC4yNzYxNDI0IDIxLjUsMjAgQzIxLjUsMTkuNzU0NTQwMSAyMS42NzY4NzUyLDE5LjU1MDM5MTYgMjEuOTEwMTI0NCwxOS41MDgwNTU3IEwyMiwxOS41IEwyNywxOS41IFogTTE4LDE5LjUgQzE4LjI3NjE0MjQsMTkuNSAxOC41LDE5LjcyMzg1NzYgMTguNSwyMCBDMTguNSwyMC4yNDU0NTk5IDE4LjMyMzEyNDgsMjAuNDQ5NjA4NCAxOC4wODk4NzU2LDIwLjQ5MTk0NDMgTDE4LDIwLjUgTDEzLDIwLjUgQzEyLjcyMzg1NzYsMjAuNSAxMi41LDIwLjI3NjE0MjQgMTIuNSwyMCBDMTIuNSwxOS43NTQ1NDAxIDEyLjY3Njg3NTIsMTkuNTUwMzkxNiAxMi45MTAxMjQ0LDE5LjUwODA1NTcgTDEzLDE5LjUgTDE4LDE5LjUgWiBNMjAsMTIuNSBDMjAuMjQ1NDU5OSwxMi41IDIwLjQ0OTYwODQsMTIuNjc2ODc1MiAyMC40OTE5NDQzLDEyLjkxMDEyNDQgTDIwLjUsMTMgTDIwLjUsMTggQzIwLjUsMTguMjc2MTQyNCAyMC4yNzYxNDI0LDE4LjUgMjAsMTguNSBDMTkuNzU0NTQwMSwxOC41IDE5LjU1MDM5MTYsMTguMzIzMTI0OCAxOS41MDgwNTU3LDE4LjA4OTg3NTYgTDE5LjUsMTggTDE5LjUsMTMgQzE5LjUsMTIuNzIzODU3NiAxOS43MjM4NTc2LDEyLjUgMjAsMTIuNSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjMjEyMzI0IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",Sw="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDdweCIgaGVpZ2h0PSI0MHB4IiB2aWV3Qm94PSIwIDAgNDcgNDAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYwLjEgKDg4MTMzKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT50ZXh0LWN1cnNvcjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGQ9Ik0xNiwyNi41IEMxNS43MjM4NTc2LDI2LjUgMTUuNSwyNi4yNzYxNDI0IDE1LjUsMjYgQzE1LjUsMjUuNzU0NTQwMSAxNS42NzY4NzUyLDI1LjU1MDM5MTYgMTUuOTEwMTI0NCwyNS41MDgwNTU3IEwxNiwyNS41IEwxOS41LDI1LjUgTDE5LjUsMTQuNSBMMTYsMTQuNSBDMTUuNzIzODU3NiwxNC41IDE1LjUsMTQuMjc2MTQyNCAxNS41LDE0IEMxNS41LDEzLjc1NDU0MDEgMTUuNjc2ODc1MiwxMy41NTAzOTE2IDE1LjkxMDEyNDQsMTMuNTA4MDU1NyBMMTYsMTMuNSBMMjQsMTMuNSBDMjQuMjc2MTQyNCwxMy41IDI0LjUsMTMuNzIzODU3NiAyNC41LDE0IEMyNC41LDE0LjI0NTQ1OTkgMjQuMzIzMTI0OCwxNC40NDk2MDg0IDI0LjA4OTg3NTYsMTQuNDkxOTQ0MyBMMjQsMTQuNSBMMjAuNSwxNC41IEwyMC41LDI1LjUgTDI0LDI1LjUgQzI0LjI3NjE0MjQsMjUuNSAyNC41LDI1LjcyMzg1NzYgMjQuNSwyNiBDMjQuNSwyNi4yNDU0NTk5IDI0LjMyMzEyNDgsMjYuNDQ5NjA4NCAyNC4wODk4NzU2LDI2LjQ5MTk0NDMgTDI0LDI2LjUgTDE2LDI2LjUgWiIgaWQ9InBhdGgtMSI+PC9wYXRoPgogICAgICAgIDxmaWx0ZXIgeD0iLTI4NC4wJSIgeT0iLTgxLjUlIiB3aWR0aD0iNjY4LjElIiBoZWlnaHQ9IjI5My45JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0iZmlsdGVyLTIiPgogICAgICAgICAgICA8ZmVNb3JwaG9sb2d5IHJhZGl1cz0iMSIgb3BlcmF0b3I9ImRpbGF0ZSIgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd1NwcmVhZE91dGVyMSI+PC9mZU1vcnBob2xvZ3k+CiAgICAgICAgICAgIDxmZU9mZnNldCBkeD0iMCIgZHk9IjIiIGluPSJzaGFkb3dTcHJlYWRPdXRlcjEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PgogICAgICAgICAgICA8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzIiBpbj0ic2hhZG93T2Zmc2V0T3V0ZXIxIiByZXN1bHQ9InNoYWRvd0JsdXJPdXRlcjEiPjwvZmVHYXVzc2lhbkJsdXI+CiAgICAgICAgICAgIDxmZUNvbXBvc2l0ZSBpbj0ic2hhZG93Qmx1ck91dGVyMSIgaW4yPSJTb3VyY2VBbHBoYSIgb3BlcmF0b3I9Im91dCIgcmVzdWx0PSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlQ29tcG9zaXRlPgogICAgICAgICAgICA8ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAgIDAgMCAwIDAgMCAgIDAgMCAwIDAgMCAgMCAwIDAgMC4xNiAwIiB0eXBlPSJtYXRyaXgiIGluPSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlQ29sb3JNYXRyaXg+CiAgICAgICAgPC9maWx0ZXI+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0i6aG16Z2iLTQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJXaGl0ZWJvYXJkLUd1aWRlbGluZXMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zODguMDAwMDAwLCAtNjcyLjAwMDAwMCkiPgogICAgICAgICAgICA8ZyBpZD0idGV4dC1jdXJzb3IiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM5Mi4wMDAwMDAsIDY3Mi4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaLlpIfku70tNDAiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuMDEiIHg9IjAiIHk9IjAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcng9IjIiPjwvcmVjdD4KICAgICAgICAgICAgICAgIDxnIGlkPSLlvaLnirbnu5PlkIgiIGZpbGwtcnVsZT0ibm9uemVybyI+CiAgICAgICAgICAgICAgICAgICAgPHVzZSBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIxIiBmaWx0ZXI9InVybCgjZmlsdGVyLTIpIiB4bGluazpocmVmPSIjcGF0aC0xIj48L3VzZT4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMSIgZD0iTTE5LDI1IEwxOSwxNSBMMTYsMTUgQzE1LjQ0NzcxNTMsMTUgMTUsMTQuNTUyMjg0NyAxNSwxNCBDMTUsMTMuNTE0NTg5NyAxNS4zNDc5OTkzLDEzLjEwMTkxNSAxNS44NjU0ODc3LDEzLjAxMDA1MjEgTDE2LDEzIEwyNCwxMyBDMjQuNTUyMjg0NywxMyAyNSwxMy40NDc3MTUzIDI1LDE0IEMyNSwxNC40ODU0MTAzIDI0LjY1MjAwMDcsMTQuODk4MDg1IDI0LjEzNDUxMjMsMTQuOTg5OTQ3OSBMMjQsMTUgTDIxLDE1IEwyMSwyNSBMMjQsMjUgQzI0LjU1MjI4NDcsMjUgMjUsMjUuNDQ3NzE1MyAyNSwyNiBDMjUsMjYuNDg1NDEwMyAyNC42NTIwMDA3LDI2Ljg5ODA4NSAyNC4xMzQ1MTIzLDI2Ljk4OTk0NzkgTDI0LDI3IEwxNiwyNyBDMTUuNDQ3NzE1MywyNyAxNSwyNi41NTIyODQ3IDE1LDI2IEMxNSwyNS41MTQ1ODk3IDE1LjM0Nzk5OTMsMjUuMTAxOTE1IDE1Ljg2NTQ4NzcsMjUuMDEwMDUyMSBMMTYsMjUgTDE5LDI1IFoiIGZpbGw9IiMyMTIzMjQiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",Iw="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjhweCIgaGVpZ2h0PSIyOHB4IiB2aWV3Qm94PSIwIDAgMjggMjgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1LjEgKDc4MTM2KSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT7nvJbnu4QgMjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPgogICAgICAgIDxmaWx0ZXIgeD0iLTEyMC4wJSIgeT0iLTEyMC4wJSIgd2lkdGg9IjM0MC4wJSIgaGVpZ2h0PSIzNDAuMCUiIGZpbHRlclVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgaWQ9ImZpbHRlci0xIj4KICAgICAgICAgICAgPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iNCIgaW49IlNvdXJjZUdyYXBoaWMiPjwvZmVHYXVzc2lhbkJsdXI+CiAgICAgICAgPC9maWx0ZXI+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0i6aG16Z2iMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hC0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5LjAwMDAwMCwgOS4wMDAwMDApIiBmaWxsPSIjRkYwMTAwIj4KICAgICAgICAgICAgPGNpcmNsZSBpZD0i5qSt5ZyG5b2iIiBmaWx0ZXI9InVybCgjZmlsdGVyLTEpIiBjeD0iNSIgY3k9IjUiIHI9IjUiPjwvY2lyY2xlPgogICAgICAgICAgICA8cGF0aCBkPSJNNSw4IEM2LjY1Njg1NDI1LDggOCw2LjY1Njg1NDI1IDgsNSBDOCwzLjM0MzE0NTc1IDYuNjU2ODU0MjUsMiA1LDIgQzMuMzQzMTQ1NzUsMiAyLDMuMzQzMTQ1NzUgMiw1IEMyLDYuNjU2ODU0MjUgMy4zNDMxNDU3NSw4IDUsOCBaIE01LDYuMjg1NzE0MjkgQzQuMjg5OTE5NjEsNi4yODU3MTQyOSAzLjcxNDI4NTcxLDUuNzEwMDgwMzkgMy43MTQyODU3MSw1IEMzLjcxNDI4NTcxLDQuMjg5OTE5NjEgNC4yODk5MTk2MSwzLjcxNDI4NTcxIDUsMy43MTQyODU3MSBDNS43MTAwODAzOSwzLjcxNDI4NTcxIDYuMjg1NzE0MjksNC4yODk5MTk2MSA2LjI4NTcxNDI5LDUgQzYuMjg1NzE0MjksNS43MTAwODAzOSA1LjcxMDA4MDM5LDYuMjg1NzE0MjkgNSw2LjI4NTcxNDI5IFoiIGlkPSLmpK3lnIblvaIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",Cw="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCAxOCAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIxNyIgaGVpZ2h0PSIyNSIgcng9IjMuNSIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC4zNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8L3N2Zz4K",bw="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjYiIGhlaWdodD0iMzQiIHZpZXdCb3g9IjAgMCAyNiAzNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNSIgaGVpZ2h0PSIzMyIgcng9IjMuNSIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC4zNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8L3N2Zz4K",Aw="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzQiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCAzNCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIzMyIgaGVpZ2h0PSI0OSIgcng9IjMuNSIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC4zNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8L3N2Zz4K";const Ew={[A.ApplianceNames.pencil]:ww,[A.ApplianceNames.selector]:yw,[A.ApplianceNames.eraser]:xw,[A.ApplianceNames.shape]:Mw,[A.ApplianceNames.text]:Sw,[A.ApplianceNames.laserPointer]:Iw,pencilEraser1:Cw,pencilEraser2:bw,pencilEraser3:Aw},dc="local-cursor";class Tw{constructor(e,i,n,r){var a;this.manager=e,this.enableCursor=i,this.cursorInstances=new Map,this.userApplianceIcons={},this.sideEffectManager=new pn,this.store=this.manager.store,this.leaveFlag=!0,this._style="default",this.onCursorMove=l=>{const u=this.initCursorInstance(l.uid);if(l.state===ta.Leave)u.leave();else{const c=u.updateMember();this.canMoveCursor(c)&&u.move(l.position)}},this.initCursorInstance=l=>{let u=this.cursorInstances.get(l);return u||(u=new vw(this.manager,l,this,q.wrapper),this.cursorInstances.set(l,u)),u},this.mouseMoveListener_=(l,u)=>{const c=this.getType(l);this.updateCursor(c,l.clientX,l.clientY),u&&this.showPencilEraserIfNeeded(c,l.clientX,l.clientY)},this.mouseMoveTimer=0,this.mouseMoveListener=l=>{const u=l.pointerType==="touch";if(u&&!l.isPrimary)return;const c=Date.now();if(c-this.mouseMoveTimer>48){if(this.mouseMoveTimer=c,q.supportAppliancePlugin&&A.isRoom(q.displayer)&&q.displayer.disableDeviceInputs){this.leaveFlag&&(this.manager.dispatchInternalEvent(re.CursorMove,{uid:this.manager.uid,state:ta.Leave}),this.leaveFlag=!1);return}this.mouseMoveListener_(l,u),this.leaveFlag=!0}},this.mouseLeaveListener=()=>{this.hideCursor(this.manager.uid)},this.getPoint=(l,u,c)=>{var f;const d=(f=l==null?void 0:l.divElement)==null?void 0:f.getBoundingClientRect();if(d)return l==null?void 0:l.convertToPointInWorld({x:u-d.x,y:c-d.y})},this.getType=l=>{var d;const u=l.target,c=this.manager.focusApp;switch(u.parentElement){case this.mainViewElement:return{type:"main"};case((d=c==null?void 0:c.view)==null?void 0:d.divElement):return{type:"app"};default:return{type:"main"}}},this.roomMembers=(a=this.manager.room)==null?void 0:a.state.roomMembers;const s=q.wrapper;s&&this.setupWrapper(s),this.sideEffectManager.add(()=>R.on("cursorMove",this.onCursorMove)),this.sideEffectManager.add(()=>R.on("playgroundSizeChange",()=>this.updateContainerRect()));const o=this.manager.room;o&&this.sideEffectManager.add(()=>{const l=u=>{this.style==="custom"&&u.memberState&&this.enableCustomCursor()};return o.callbacks.on("onRoomStateChanged",l),()=>o.callbacks.off("onRoomStateChanged",l)}),r&&(this.userApplianceIcons=r),this.style=(n==null?void 0:n.style)||"default"}get applianceIcons(){return{...Ew,...this.userApplianceIcons}}get style(){return this._style}set style(e){this._style!==e&&(this._style=e,this.cursorInstances.forEach(i=>{i.setStyle(e)}),e==="custom"?this.enableCustomCursor():this.sideEffectManager.flush(dc))}enableCustomCursor(){this.sideEffectManager.add(()=>gw(this.manager.getMemberState()),dc)}canMoveCursor(e){const i=(e==null?void 0:e.memberState.currentApplianceName)===A.ApplianceNames.laserPointer;return this.enableCursor||i}setupWrapper(e){this.sideEffectManager.add(()=>(e.addEventListener("pointerenter",this.mouseMoveListener),e.addEventListener("pointermove",this.mouseMoveListener),e.addEventListener("pointerleave",this.mouseLeaveListener),()=>{e.removeEventListener("pointerenter",this.mouseMoveListener),e.removeEventListener("pointermove",this.mouseMoveListener),e.removeEventListener("pointerleave",this.mouseLeaveListener)})),this.wrapperRect=e.getBoundingClientRect()}setMainViewDivElement(e){this.mainViewElement=e}get boxState(){return this.store.getBoxState()}get focusView(){var e;return(e=this.manager.focusApp)==null?void 0:e.view}showPencilEraserIfNeeded(e,i,n){const r=xs(this.manager.room,this.manager.uid),s=(r==null?void 0:r.memberState.currentApplianceName)===A.ApplianceNames.pencilEraser;if(this.wrapperRect&&this.manager.canOperate&&this.canMoveCursor(r)&&s){const o=e.type==="main"?this.manager.mainView:this.focusView,a=this.getPoint(o,i,n);a&&this.onCursorMove({uid:this.manager.uid,position:{x:a.x,y:a.y,type:e.type}})}}updateCursor(e,i,n){const r=xs(this.manager.room,this.manager.uid);if(this.wrapperRect&&this.manager.canOperate&&this.canMoveCursor(r)){const s=e.type==="main"?this.manager.mainView:this.focusView,o=this.getPoint(s,i,n);o&&this.manager.dispatchInternalEvent(re.CursorMove,{uid:this.manager.uid,position:{x:o.x,y:o.y,type:e.type}})}}updateContainerRect(){var e,i;this.containerRect=(e=q.container)==null?void 0:e.getBoundingClientRect(),this.wrapperRect=(i=q.wrapper)==null?void 0:i.getBoundingClientRect()}deleteCursor(e){this.store.cleanCursor(e);const i=this.cursorInstances.get(e);i&&i.destroy()}hideCursor(e){const i=this.cursorInstances.get(e);i&&i.hide()}destroy(){this.sideEffectManager.flushAll(),this.cursorInstances.size&&(this.cursorInstances.forEach(e=>{e.destroy()}),this.cursorInstances.clear())}}class Nw{constructor(e){this.manager=e,R.on("changePageState",()=>{J.emit("pageStateChange",this.toObject())})}get index(){return this.manager.store.getMainViewSceneIndex()||0}get length(){return this.manager.mainViewScenesLength||0}toObject(){return{index:this.index>=this.length?this.length-1:this.index,length:this.length}}}class Pw{constructor(e){this.ctx=e,this.reactors=new Map,this.disposers=new Map,this.onPhaseChanged=async i=>{var n,r;i===A.RoomPhase.Reconnecting&&this.ctx.emitter.emit("startReconnect"),i===A.RoomPhase.Connected&&this.phase===A.RoomPhase.Reconnecting&&((n=this.room)!=null&&n.isWritable?(r=this.room)==null||r.dispatchMagixEvent(So,{}):(await Yd(500),this.onReconnected())),this.phase=i},this.onReconnected=b.debounce(()=>{this._onReconnected()},1e3),this._onReconnected=()=>{nt("onReconnected refresh reactors"),this.releaseDisposers(),this.reactors.forEach((i,n)=>{b.isFunction(i)&&this.disposers.set(n,i())}),this.ctx.emitter.emit("onReconnected")}}setRoom(e){this.room=e,this.phase=e==null?void 0:e.phase,e&&(e.callbacks.off("onPhaseChanged",this.onPhaseChanged),e.callbacks.on("onPhaseChanged",this.onPhaseChanged),e.addMagixEventListener(So,i=>{i.authorId===e.observerId&&this.onReconnected()},{fireSelfEventAfterCommit:!0}))}setContext(e){this.ctx=e}releaseDisposers(){this.disposers.forEach(e=>{b.isFunction(e)&&e()}),this.disposers.clear()}refresh(){this._onReconnected()}add(e,i){const n=this.disposers.get(e);n&&b.isFunction(n)&&n(),b.isFunction(i)&&(this.reactors.set(e,i),this.disposers.set(e,i()))}remove(e){this.reactors.has(e)&&this.reactors.delete(e);const i=this.disposers.get(e);i&&(b.isFunction(i)&&i(),this.disposers.delete(e))}hasReactor(e){return this.reactors.has(e)}destroy(){var e,i;(e=this.room)==null||e.callbacks.off("onPhaseChanged",this.onPhaseChanged),(i=this.room)==null||i.removeMagixEventListener(So,this.onReconnected),this.releaseDisposers()}}const kw=(t,e)=>{if(A.isPlayer(t))Dw(t);else{if(t=t,Object.getOwnPropertyDescriptor(t,"disableCameraTransform"))return;Object.defineProperty(t,"disableCameraTransform",{get(){return e.mainView.disableCameraTransform},set(n){e.mainView.disableCameraTransform=n}}),Object.defineProperty(t,"canUndoSteps",{get(){return e.canUndoSteps}}),Object.defineProperty(t,"canRedoSteps",{get(){return e.canRedoSteps}}),t.moveCamera=n=>e.moveCamera(n),t.moveCameraToContain=(...n)=>e.moveCameraToContain(...n),t.convertToPointInWorld=(...n)=>e.mainView.convertToPointInWorld(...n),t.setCameraBound=(...n)=>e.mainView.setCameraBound(...n),t.scenePreview=(...n)=>e.mainView.scenePreview(...n),t.fillSceneSnapshot=(...n)=>e.mainView.fillSceneSnapshot(...n),t.generateScreenshot=(...n)=>e.mainView.generateScreenshot(...n),t.setMemberState=(...n)=>e.mainView.setMemberState(...n),t.redo=()=>e.redo(),t.undo=()=>e.undo(),t.cleanCurrentScene=()=>e.cleanCurrentScene(),t.delete=()=>e.delete(),t.copy=()=>e.copy(),t.paste=()=>e.paste(),t.duplicate=()=>e.duplicate(),t.insertImage=(...n)=>e.insertImage(...n),t.completeImageUpload=(...n)=>e.completeImageUpload(...n),t.insertText=(...n)=>e.insertText(...n),t.lockImage=(...n)=>e.lockImage(...n),t.lockImages=(...n)=>e.lockImages(...n),Bw(t,e)}},Bw=(t,e)=>{const i=t.removeScenes;t.removeScenes=(n,r)=>{var o;n===We&&((o=e.appManager)==null||o.updateRootDirRemoving(!0));const s=i.call(t,n);return R.emit("removeScenes",{scenePath:n,index:r}),s}},Dw=t=>{const e=t.seekToProgressTime;async function i(n){await R.emit("seekStart");const r=await e.call(t,n);return R.emit("seek",n),r}t.seekToProgressTime=i};var hc,zw=`.netless-app-docs-viewer-content{position:relative;height:100%;overflow:hidden}.netless-app-docs-viewer-preview-mask{display:block;position:absolute;z-index:200;top:0;left:0;width:100%;height:100%}.netless-app-docs-viewer-preview{display:flex;flex-direction:column;align-items:center;z-index:300;top:0;right:0;width:23%;padding:12px;box-shadow:-4.8px -3.2px 20px #20233826;transition:transform .4s;background:#f5f5fc;border-radius:4px;-webkit-box-shadow:-4.8px -3.2px 20px rgba(32,35,56,.15);height:100%;position:absolute}.netless-app-docs-viewer-preview-active .netless-app-docs-viewer-preview-mask{display:block}.netless-app-docs-viewer-preview-active .netless-app-docs-viewer-preview{transform:translate(0);opacity:1}.netless-app-docs-viewer-preview-head{display:flex;align-items:center;justify-content:space-between;width:100%;margin-bottom:10px}.netless-app-docs-viewer-preview-head>h3{color:#484c70;font-weight:400;font-size:14px;width:calc(100% - 20px);overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.netless-app-docs-viewer-preview-head .netless-app-docs-viewer-close{width:25px;height:25px;padding:0;outline:none;border:none;background:#fff;display:flex;justify-content:center;align-items:center;border-radius:100%;cursor:pointer}.netless-app-docs-viewer-preview-head .netless-app-docs-viewer-close button{width:22px;height:22px;padding:0;outline:none;border:none;background:center/cover no-repeat;background-image:url(./icons/close.svg)}.netless-app-docs-viewer-preview-page{position:relative;display:flex;width:100%;margin-bottom:10px;font-size:0;color:transparent;outline:none;border-radius:4px;transition:border-color .3s;user-select:none;align-items:flex-end}.netless-app-docs-viewer-preview-page>img{width:calc(90% - 10px);height:auto;box-sizing:border-box;border:2px solid rgba(0,0,0,.5);border-radius:2px;background-color:#fff}.netless-app-docs-viewer-preview-page>img.netless-app-docs-viewer-active{border-color:#ff5353}.netless-app-docs-viewer-preview-page-name{text-align:right;font-size:12px;color:#8d8fa6;user-select:none;margin-right:10px;width:5%}.netless-app-docs-viewer-footer{box-sizing:border-box;height:2.778vw;display:flex;align-items:center;padding:0 1.11vw;color:#191919;background:#ebecfa}.netless-app-docs-viewer-float-footer{width:100%;min-height:2.778vw;position:absolute;left:0;bottom:0;z-index:2000;transition:opacity .4s;color:#191919}.netless-app-docs-viewer-footer-btn{box-sizing:border-box;width:1.81vw;height:1.81vw;font-size:0;margin:0;padding:3px;border:none;border-radius:4px;outline:none;color:currentColor;background:transparent;transition:background .4s;cursor:pointer;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);color:#8d8fa6}.netless-app-docs-viewer-footer-btn.netless-app-docs-viewer-footer-btn-disable{color:#c6c7d2;cursor:not-allowed}.netless-app-docs-viewer-footer-btn.netless-app-docs-viewer-footer-btn-disable .arrow{fill:#c6c7d2}.netless-app-docs-viewer-footer-btn .arrow{fill:#8d8fa6}.netless-app-docs-viewer-footer-btn:hover{background-color:#1b1f4d0a}@media (hover: none){.netless-app-docs-viewer-footer-btn:hover{background:transparent!important}}.netless-app-docs-viewer-footer-btn>svg{width:100%;height:100%}.netless-app-docs-viewer-footer-btn>svg:nth-of-type(2){display:none}.netless-app-docs-viewer-footer-btn.netless-app-docs-viewer-footer-btn-playing>svg:nth-of-type(1){display:none}.netless-app-docs-viewer-footer-btn.netless-app-docs-viewer-footer-btn-playing>svg:nth-of-type(2){display:initial}.netless-app-docs-viewer-hide{display:none}.netless-app-docs-viewer-page-jumps{flex:1;display:flex;justify-content:center;align-items:center;gap:.556vw}.netless-app-docs-viewer-page-number{font-size:1vw;color:#8d8fa6;user-select:none;white-space:nowrap;word-break:keep-all}.netless-app-docs-viewer-page-number-input{border:none;outline:none;width:3em;margin:0;padding:0 2px;text-align:right;font-size:1vw;line-height:1;font-weight:400;font-family:inherit;border-radius:2px;color:currentColor;background:transparent;transition:background .4s;user-select:text;-webkit-tap-highlight-color:rgba(0,0,0,0)}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-footer-btn{cursor:not-allowed}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-footer-btn:hover{background:transparent}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-page-number-input{cursor:not-allowed}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-page-number-input:hover,.netless-app-docs-viewer-readonly .netless-app-docs-viewer-page-number-input:focus,.netless-app-docs-viewer-readonly .netless-app-docs-viewer-page-number-input:active{background:transparent;box-shadow:none}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-page-number-input:disabled{color:inherit}.netless-app-docs-viewer-readonly.netless-app-docs-viewer-float-footer{display:none}.telebox-color-scheme-dark .netless-app-docs-viewer-page-number-input{color:#a6a6a8}.telebox-color-scheme-dark .netless-app-docs-viewer-page-number-input:active,.telebox-color-scheme-dark .netless-app-docs-viewer-page-number-input:focus,.telebox-color-scheme-dark .netless-app-docs-viewer-page-number-input:hover{color:#222}.telebox-color-scheme-dark .netless-app-docs-viewer-footer{color:#a6a6a8;background:#2d2d33;border-top:none}.telebox-color-scheme-dark .netless-app-docs-viewer-footer-btn:hover{background:#212126}.telebox-color-scheme-dark .netless-app-docs-viewer-preview{background:rgba(50,50,50,.9)}.netless-app-docs-viewer-static-scrollbar{position:absolute;top:0;right:0;z-index:2147483647;width:8px;min-height:30px;margin:0;padding:0;border:none;outline:none;border-radius:4px;background:rgba(68,78,96,.4);box-shadow:1px 1px 8px #ffffffb3;opacity:0;transition:background .4s,opacity .4s 3s,transform .2s;user-select:none}.netless-app-docs-viewer-static-scrollbar.netless-app-docs-viewer-static-scrollbar-dragging{background:rgba(68,78,96,.6);opacity:1;transition:background .4s,opacity .4s 3s!important}.netless-app-docs-viewer-static-scrollbar:hover,.netless-app-docs-viewer-static-scrollbar:focus{background:rgba(68,78,96,.5)}.netless-app-docs-viewer-static-scrollbar:active{background:rgba(68,78,96,.6)}.netless-app-docs-viewer-content:hover .netless-app-docs-viewer-static-scrollbar{opacity:1;transition:background .4s,opacity .4s,transform .2s}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-static-scrollbar{display:none}.netless-app-docs-viewer-static-pages:hover .netless-app-docs-viewer-static-scrollbar{opacity:1;transition:background .4s,opacity .4s,transform .2s}.page-renderer-pages-container{position:relative;overflow:hidden}.page-renderer-page{position:absolute;top:0;left:0;background-position:center;background-size:cover;background-repeat:no-repeat}.page-renderer-pages-container.is-hwa .page-renderer-page{will-change:transform}.page-renderer-page-img{display:block;width:100%;height:auto;user-select:none}.netless-app-docs-viewer-static-pages{overflow:hidden;position:relative;height:100%;user-select:none}.netless-app-docs-viewer-static-page{display:block;width:100%;height:auto;user-select:none}.netless-app-docs-viewer-static-wb-view,.netless-app-docs-viewer-dynamic-wb-view{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;overflow:auto}.netless-app-docs-viewer-dynamic-wb-view .cursor-clicker .ppt-event-source{cursor:pointer}
`;const _w=(t,e,i,n)=>{if(i==="length"||i==="prototype"||i==="arguments"||i==="caller")return;const r=Object.getOwnPropertyDescriptor(t,i),s=Object.getOwnPropertyDescriptor(e,i);!Lw(r,s)&&n||Object.defineProperty(t,i,s)},Lw=function(t,e){return t===void 0||t.configurable||t.writable===e.writable&&t.enumerable===e.enumerable&&t.configurable===e.configurable&&(t.writable||t.value===e.value)},jw=(t,e)=>{const i=Object.getPrototypeOf(e);i!==Object.getPrototypeOf(t)&&Object.setPrototypeOf(t,i)},Rw=(t,e)=>`/* Wrapped ${t}*/
${e}`,Vw=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),Ow=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),$w=(t,e,i)=>{const n=i===""?"":`with ${i.trim()}() `,r=Rw.bind(null,n,e.toString());Object.defineProperty(r,"name",Ow),Object.defineProperty(t,"toString",{...Vw,value:r})};function Fw(t,e,{ignoreNonConfigurable:i=!1}={}){const{name:n}=t;for(const r of Reflect.ownKeys(e))_w(t,e,r,i);return jw(t,e),$w(t,e,n),t}const Ww=(t,e={})=>{if(typeof t!="function")throw new TypeError(`Expected the first argument to be a function, got \`${typeof t}\``);const{wait:i=0,maxWait:n=Number.POSITIVE_INFINITY,before:r=!1,after:s=!0}=e;if(!r&&!s)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let o,a,l;const u=function(...c){const d=this,f=()=>{o=void 0,a&&(clearTimeout(a),a=void 0),s&&(l=t.apply(d,c))},v=()=>{a=void 0,o&&(clearTimeout(o),o=void 0),s&&(l=t.apply(d,c))},w=r&&!o;return clearTimeout(o),o=setTimeout(f,i),n>0&&n!==Number.POSITIVE_INFINITY&&!a&&(a=setTimeout(v,n)),w&&(l=t.apply(d,c)),l};return Fw(u,t),u.cancel=()=>{o&&(clearTimeout(o),o=void 0),a&&(clearTimeout(a),a=void 0)},u};var Uw="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Hw=87,Zw=20,pc=[],Qw=()=>{for(let t=0;t<Zw;t++)pc[t]=Uw.charAt(Math.random()*Hw);return pc.join("")};function Bh(t){try{return t()}catch(e){console.error(e)}}var io=class{constructor(){this.push=this.addDisposer,this.disposers=new Map}addDisposer(t,e=this.genUID()){return this.flush(e),this.disposers.set(e,Array.isArray(t)?Gw(t):t),e}add(t,e=this.genUID()){const i=t();return i?this.addDisposer(i,e):e}addEventListener(t,e,i,n,r=this.genUID()){return t.addEventListener(e,i,n),this.addDisposer(()=>t.removeEventListener(e,i,n),r),r}setTimeout(t,e,i=this.genUID()){const n=window.setTimeout(()=>{this.remove(i),t()},e);return this.addDisposer(()=>window.clearTimeout(n),i)}setInterval(t,e,i=this.genUID()){const n=window.setInterval(t,e);return this.addDisposer(()=>window.clearInterval(n),i)}remove(t){const e=this.disposers.get(t);return this.disposers.delete(t),e}flush(t){const e=this.remove(t);e&&e()}flushAll(){this.disposers.forEach(Bh),this.disposers.clear()}genUID(){let t;do t=Qw();while(this.disposers.has(t));return t}};function Gw(t){return()=>t.forEach(Bh)}var pi=[],Yw=function(){return pi.some(function(t){return t.activeTargets.length>0})},Xw=function(){return pi.some(function(t){return t.skippedTargets.length>0})},fc="ResizeObserver loop completed with undelivered notifications.",Jw=function(){var t;typeof ErrorEvent=="function"?t=new ErrorEvent("error",{message:fc}):(t=document.createEvent("Event"),t.initEvent("error",!1,!1),t.message=fc),window.dispatchEvent(t)},nr;(function(t){t.BORDER_BOX="border-box",t.CONTENT_BOX="content-box",t.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(nr||(nr={}));var fi=function(t){return Object.freeze(t)},Kw=function(){function t(e,i){this.inlineSize=e,this.blockSize=i,fi(this)}return t}(),Dh=function(){function t(e,i,n,r){return this.x=e,this.y=i,this.width=n,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,fi(this)}return t.prototype.toJSON=function(){var e=this,i=e.x,n=e.y,r=e.top,s=e.right,o=e.bottom,a=e.left,l=e.width,u=e.height;return{x:i,y:n,top:r,right:s,bottom:o,left:a,width:l,height:u}},t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t}(),Pl=function(t){return t instanceof SVGElement&&"getBBox"in t},zh=function(t){if(Pl(t)){var e=t.getBBox(),i=e.width,n=e.height;return!i&&!n}var r=t,s=r.offsetWidth,o=r.offsetHeight;return!(s||o||t.getClientRects().length)},gc=function(t){var e;if(t instanceof Element)return!0;var i=(e=t==null?void 0:t.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(i&&t instanceof i.Element)},qw=function(t){switch(t.tagName){case"INPUT":if(t.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},Wn=typeof window!="undefined"?window:{},jr=new WeakMap,mc=/auto|scroll/,ey=/^tb|vertical/,ty=/msie|trident/i.test(Wn.navigator&&Wn.navigator.userAgent),ct=function(t){return parseFloat(t||"0")},Xi=function(t,e,i){return t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=!1),new Kw((i?e:t)||0,(i?t:e)||0)},vc=fi({devicePixelContentBoxSize:Xi(),borderBoxSize:Xi(),contentBoxSize:Xi(),contentRect:new Dh(0,0,0,0)}),_h=function(t,e){if(e===void 0&&(e=!1),jr.has(t)&&!e)return jr.get(t);if(zh(t))return jr.set(t,vc),vc;var i=getComputedStyle(t),n=Pl(t)&&t.ownerSVGElement&&t.getBBox(),r=!ty&&i.boxSizing==="border-box",s=ey.test(i.writingMode||""),o=!n&&mc.test(i.overflowY||""),a=!n&&mc.test(i.overflowX||""),l=n?0:ct(i.paddingTop),u=n?0:ct(i.paddingRight),c=n?0:ct(i.paddingBottom),d=n?0:ct(i.paddingLeft),f=n?0:ct(i.borderTopWidth),v=n?0:ct(i.borderRightWidth),w=n?0:ct(i.borderBottomWidth),y=n?0:ct(i.borderLeftWidth),h=d+u,p=l+c,g=y+v,m=f+w,x=a?t.offsetHeight-m-t.clientHeight:0,M=o?t.offsetWidth-g-t.clientWidth:0,T=r?h+g:0,z=r?p+m:0,P=n?n.width:ct(i.width)-T-M,D=n?n.height:ct(i.height)-z-x,S=P+h+M+g,N=D+p+x+m,I=fi({devicePixelContentBoxSize:Xi(Math.round(P*devicePixelRatio),Math.round(D*devicePixelRatio),s),borderBoxSize:Xi(S,N,s),contentBoxSize:Xi(P,D,s),contentRect:new Dh(d,l,P,D)});return jr.set(t,I),I},Lh=function(t,e,i){var n=_h(t,i),r=n.borderBoxSize,s=n.contentBoxSize,o=n.devicePixelContentBoxSize;switch(e){case nr.DEVICE_PIXEL_CONTENT_BOX:return o;case nr.BORDER_BOX:return r;default:return s}},iy=function(){function t(e){var i=_h(e);this.target=e,this.contentRect=i.contentRect,this.borderBoxSize=fi([i.borderBoxSize]),this.contentBoxSize=fi([i.contentBoxSize]),this.devicePixelContentBoxSize=fi([i.devicePixelContentBoxSize])}return t}(),jh=function(t){if(zh(t))return 1/0;for(var e=0,i=t.parentNode;i;)e+=1,i=i.parentNode;return e},ny=function(){var t=1/0,e=[];pi.forEach(function(o){if(o.activeTargets.length!==0){var a=[];o.activeTargets.forEach(function(u){var c=new iy(u.target),d=jh(u.target);a.push(c),u.lastReportedSize=Lh(u.target,u.observedBox),d<t&&(t=d)}),e.push(function(){o.callback.call(o.observer,a,o.observer)}),o.activeTargets.splice(0,o.activeTargets.length)}});for(var i=0,n=e;i<n.length;i++){var r=n[i];r()}return t},wc=function(t){pi.forEach(function(i){i.activeTargets.splice(0,i.activeTargets.length),i.skippedTargets.splice(0,i.skippedTargets.length),i.observationTargets.forEach(function(r){r.isActive()&&(jh(r.target)>t?i.activeTargets.push(r):i.skippedTargets.push(r))})})},ry=function(){var t=0;for(wc(t);Yw();)t=ny(),wc(t);return Xw()&&Jw(),t>0},zo,Rh=[],sy=function(){return Rh.splice(0).forEach(function(t){return t()})},oy=function(t){if(!zo){var e=0,i=document.createTextNode(""),n={characterData:!0};new MutationObserver(function(){return sy()}).observe(i,n),zo=function(){i.textContent="".concat(e?e--:e++)}}Rh.push(t),zo()},ay=function(t){oy(function(){requestAnimationFrame(t)})},is=0,ly=function(){return!!is},uy=250,cy={attributes:!0,characterData:!0,childList:!0,subtree:!0},yc=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],xc=function(t){return t===void 0&&(t=0),Date.now()+t},_o=!1,dy=function(){function t(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return t.prototype.run=function(e){var i=this;if(e===void 0&&(e=uy),!_o){_o=!0;var n=xc(e);ay(function(){var r=!1;try{r=ry()}finally{if(_o=!1,e=n-xc(),!ly())return;r?i.run(1e3):e>0?i.run(e):i.start()}})}},t.prototype.schedule=function(){this.stop(),this.run()},t.prototype.observe=function(){var e=this,i=function(){return e.observer&&e.observer.observe(document.body,cy)};document.body?i():Wn.addEventListener("DOMContentLoaded",i)},t.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),yc.forEach(function(i){return Wn.addEventListener(i,e.listener,!0)}))},t.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),yc.forEach(function(i){return Wn.removeEventListener(i,e.listener,!0)}),this.stopped=!0)},t}(),pa=new dy,Mc=function(t){!is&&t>0&&pa.start(),is+=t,!is&&pa.stop()},hy=function(t){return!Pl(t)&&!qw(t)&&getComputedStyle(t).display==="inline"},py=function(){function t(e,i){this.target=e,this.observedBox=i||nr.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return t.prototype.isActive=function(){var e=Lh(this.target,this.observedBox,!0);return hy(this.target)&&(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},t}(),fy=function(){function t(e,i){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=i}return t}(),Rr=new WeakMap,Sc=function(t,e){for(var i=0;i<t.length;i+=1)if(t[i].target===e)return i;return-1},Vr=function(){function t(){}return t.connect=function(e,i){var n=new fy(e,i);Rr.set(e,n)},t.observe=function(e,i,n){var r=Rr.get(e),s=r.observationTargets.length===0;Sc(r.observationTargets,i)<0&&(s&&pi.push(r),r.observationTargets.push(new py(i,n&&n.box)),Mc(1),pa.schedule())},t.unobserve=function(e,i){var n=Rr.get(e),r=Sc(n.observationTargets,i),s=n.observationTargets.length===1;r>=0&&(s&&pi.splice(pi.indexOf(n),1),n.observationTargets.splice(r,1),Mc(-1))},t.disconnect=function(e){var i=this,n=Rr.get(e);n.observationTargets.slice().forEach(function(r){return i.unobserve(e,r.target)}),n.activeTargets.splice(0,n.activeTargets.length)},t}(),gy=function(){function t(e){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof e!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Vr.connect(this,e)}return t.prototype.observe=function(e,i){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!gc(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Vr.observe(this,e,i)},t.prototype.unobserve=function(e){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!gc(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Vr.unobserve(this,e)},t.prototype.disconnect=function(){Vr.disconnect(this)},t.toString=function(){return"function ResizeObserver () { [polyfill code] }"},t}();function my(t){const e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"svg");return i.setAttribute("class",`${t}-footer-icon-arrow-left`),i.setAttribute("viewBox","0 0 20 20"),i.innerHTML=`<g clip-path="url(#clip0_11800_99864)">
<path fill-rule="evenodd" clip-rule="evenodd" d="M11.5283 4.86182L12.4711 5.80463L8.22849 10.0473L12.4711 14.2899L11.5283 15.2327L6.34287 10.0473L11.5283 4.86182Z" class="arrow" />
</g>
<defs>
<clipPath id="clip0_11800_99864">
<rect width="16" height="16" fill="white" transform="translate(2 2)"/>
</clipPath>
</defs>`,i}function vy(t){const e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"svg");return i.setAttribute("class",`${t}-footer-icon-arrow-right`),i.setAttribute("viewBox","0 0 20 20"),i.innerHTML=`<g clip-path="url(#clip0_11800_99870)">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8.1377 4.86182L7.19489 5.80463L11.4375 10.0473L7.19489 14.2899L8.1377 15.2327L13.3231 10.0473L8.1377 4.86182Z" class="arrow" />
</g>
<defs>
<clipPath id="clip0_11800_99870">
<rect width="16" height="16" fill="white" transform="translate(2 2)"/>
</clipPath>
</defs>`,i}function wy(t){const e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"svg");i.setAttribute("class",`${t}-footer-icon-play`),i.setAttribute("viewBox","0 0 500 500");const n=document.createElementNS(e,"path");return n.setAttribute("fill","currentColor"),n.setAttribute("d","M418.158 257.419L174.663 413.33c-6.017 3.919-15.708 3.772-21.291-.29-2.791-2.018-4.295-4.483-4.295-7.084V94.109c0-5.65 6.883-10.289 15.271-10.289 4.298 0 8.391 1.307 11.181 3.332l242.629 155.484c6.016 3.917 6.451 10.292.649 14.491-.216.154-.432.154-.649.292zM170.621 391.288l223.116-141.301L170.71 107.753l-.089 283.535z"),i.appendChild(n),i}function yy(t){const e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"svg");i.setAttribute("class",`${t}-footer-icon-pause`),i.setAttribute("viewBox","0 0 500 500");const n=document.createElementNS(e,"path");return n.setAttribute("fill","currentColor"),n.setAttribute("d","M312.491 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261zM165.257 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261z"),i.appendChild(n),i}const ti=typeof window!="undefined",Vh=ti&&!("onscroll"in window)||typeof navigator!="undefined"&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),Oh=ti&&"IntersectionObserver"in window,$h=ti&&"classList"in document.createElement("p"),Fh=ti&&window.devicePixelRatio>1,xy={elements_selector:".lazy",container:Vh||ti?document:null,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",data_bg_hidpi:"bg-hidpi",data_bg_multi:"bg-multi",data_bg_multi_hidpi:"bg-multi-hidpi",data_bg_set:"bg-set",data_poster:"poster",class_applied:"applied",class_loading:"loading",class_loaded:"loaded",class_error:"error",class_entered:"entered",class_exited:"exited",unobserve_completed:!0,unobserve_entered:!1,cancel_on_exit:!0,callback_enter:null,callback_exit:null,callback_applied:null,callback_loading:null,callback_loaded:null,callback_error:null,callback_finish:null,callback_cancel:null,use_native:!1,restore_on_error:!1},Wh=t=>Object.assign({},xy,t),Ic=function(t,e){let i;const n="LazyLoad::Initialized",r=new t(e);try{i=new CustomEvent(n,{detail:{instance:r}})}catch{i=document.createEvent("CustomEvent"),i.initCustomEvent(n,!1,!1,{instance:r})}window.dispatchEvent(i)},My=(t,e)=>{if(!!e)if(!e.length)Ic(t,e);else for(let i=0,n;n=e[i];i+=1)Ic(t,n)},zt="src",kl="srcset",Bl="sizes",Uh="poster",vr="llOriginalAttrs",Hh="data",Dl="loading",Zh="loaded",Qh="applied",Sy="entered",zl="error",Gh="native",Yh="data-",Xh="ll-status",_e=(t,e)=>t.getAttribute(Yh+e),Iy=(t,e,i)=>{const n=Yh+e;if(i===null){t.removeAttribute(n);return}t.setAttribute(n,i)},wr=t=>_e(t,Xh),Ei=(t,e)=>Iy(t,Xh,e),no=t=>Ei(t,null),_l=t=>wr(t)===null,Cy=t=>wr(t)===Dl,by=t=>wr(t)===zl,Ll=t=>wr(t)===Gh,Ay=[Dl,Zh,Qh,zl],Ey=t=>Ay.indexOf(wr(t))>=0,ii=(t,e,i,n)=>{if(!(!t||typeof t!="function")){if(n!==void 0){t(e,i,n);return}if(i!==void 0){t(e,i);return}t(e)}},fn=(t,e)=>{if(e!==""){if($h){t.classList.add(e);return}t.className+=(t.className?" ":"")+e}},pt=(t,e)=>{if(e!==""){if($h){t.classList.remove(e);return}t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")}},Ty=t=>{t.llTempImage=document.createElement("IMG")},Ny=t=>{delete t.llTempImage},Jh=t=>t.llTempImage,ro=(t,e)=>{if(!e)return;const i=e._observer;!i||i.unobserve(t)},Py=t=>{t.disconnect()},ky=(t,e,i)=>{e.unobserve_entered&&ro(t,i)},jl=(t,e)=>{!t||(t.loadingCount+=e)},By=t=>{!t||(t.toLoadCount-=1)},Kh=(t,e)=>{!t||(t.toLoadCount=e)},Dy=t=>t.loadingCount>0,zy=t=>t.toLoadCount>0,qh=t=>{let e=[];for(let i=0,n;n=t.children[i];i+=1)n.tagName==="SOURCE"&&e.push(n);return e},Rl=(t,e)=>{const i=t.parentNode;if(!i||i.tagName!=="PICTURE")return;qh(i).forEach(e)},ep=(t,e)=>{qh(t).forEach(e)},so=[zt],tp=[zt,Uh],rr=[zt,kl,Bl],ip=[Hh],oo=t=>!!t[vr],np=t=>t[vr],rp=t=>delete t[vr],sn=(t,e)=>{if(oo(t))return;const i={};e.forEach(n=>{i[n]=t.getAttribute(n)}),t[vr]=i},_y=t=>{oo(t)||(t[vr]={backgroundImage:t.style.backgroundImage})},Ly=(t,e,i)=>{if(!i){t.removeAttribute(e);return}t.setAttribute(e,i)},Mi=(t,e)=>{if(!oo(t))return;const i=np(t);e.forEach(n=>{Ly(t,n,i[n])})},jy=t=>{if(!oo(t))return;const e=np(t);t.style.backgroundImage=e.backgroundImage},sp=(t,e,i)=>{fn(t,e.class_applied),Ei(t,Qh),i&&(e.unobserve_completed&&ro(t,e),ii(e.callback_applied,t,i))},op=(t,e,i)=>{fn(t,e.class_loading),Ei(t,Dl),i&&(jl(i,1),ii(e.callback_loading,t,i))},Ut=(t,e,i)=>{!i||t.setAttribute(e,i)},Cc=(t,e)=>{Ut(t,Bl,_e(t,e.data_sizes)),Ut(t,kl,_e(t,e.data_srcset)),Ut(t,zt,_e(t,e.data_src))},Ry=(t,e)=>{Rl(t,i=>{sn(i,rr),Cc(i,e)}),sn(t,rr),Cc(t,e)},Vy=(t,e)=>{sn(t,so),Ut(t,zt,_e(t,e.data_src))},Oy=(t,e)=>{ep(t,i=>{sn(i,so),Ut(i,zt,_e(i,e.data_src))}),sn(t,tp),Ut(t,Uh,_e(t,e.data_poster)),Ut(t,zt,_e(t,e.data_src)),t.load()},$y=(t,e)=>{sn(t,ip),Ut(t,Hh,_e(t,e.data_src))},Fy=(t,e,i)=>{const n=_e(t,e.data_bg),r=_e(t,e.data_bg_hidpi),s=Fh&&r?r:n;!s||(t.style.backgroundImage=`url("${s}")`,Jh(t).setAttribute(zt,s),op(t,e,i))},Wy=(t,e,i)=>{const n=_e(t,e.data_bg_multi),r=_e(t,e.data_bg_multi_hidpi),s=Fh&&r?r:n;!s||(t.style.backgroundImage=s,sp(t,e,i))},Uy=(t,e,i)=>{const n=_e(t,e.data_bg_set);if(!n)return;const r=n.split("|");let s=r.map(o=>`image-set(${o})`);t.style.backgroundImage=s.join(),t.style.backgroundImage===""&&(s=r.map(o=>`-webkit-image-set(${o})`),t.style.backgroundImage=s.join()),sp(t,e,i)},ap={IMG:Ry,IFRAME:Vy,VIDEO:Oy,OBJECT:$y},Hy=(t,e)=>{const i=ap[t.tagName];!i||i(t,e)},Zy=(t,e,i)=>{const n=ap[t.tagName];!n||(n(t,e),op(t,e,i))},Qy=["IMG","IFRAME","VIDEO","OBJECT"],Gy=t=>Qy.indexOf(t.tagName)>-1,lp=(t,e)=>{e&&!Dy(e)&&!zy(e)&&ii(t.callback_finish,e)},bc=(t,e,i)=>{t.addEventListener(e,i),t.llEvLisnrs[e]=i},Yy=(t,e,i)=>{t.removeEventListener(e,i)},Vl=t=>!!t.llEvLisnrs,Xy=(t,e,i)=>{Vl(t)||(t.llEvLisnrs={});const n=t.tagName==="VIDEO"?"loadeddata":"load";bc(t,n,e),bc(t,"error",i)},fa=t=>{if(!Vl(t))return;const e=t.llEvLisnrs;for(let i in e){const n=e[i];Yy(t,i,n)}delete t.llEvLisnrs},up=(t,e,i)=>{Ny(t),jl(i,-1),By(i),pt(t,e.class_loading),e.unobserve_completed&&ro(t,i)},Jy=(t,e,i,n)=>{const r=Ll(e);up(e,i,n),fn(e,i.class_loaded),Ei(e,Zh),ii(i.callback_loaded,e,n),r||lp(i,n)},Ky=(t,e,i,n)=>{const r=Ll(e);up(e,i,n),fn(e,i.class_error),Ei(e,zl),ii(i.callback_error,e,n),i.restore_on_error&&Mi(e,rr),r||lp(i,n)},Ol=(t,e,i)=>{const n=Jh(t)||t;if(Vl(n))return;Xy(n,o=>{Jy(o,t,e,i),fa(n)},o=>{Ky(o,t,e,i),fa(n)})},qy=(t,e,i)=>{Ty(t),Ol(t,e,i),_y(t),Fy(t,e,i),Wy(t,e,i),Uy(t,e,i)},e0=(t,e,i)=>{Ol(t,e,i),Zy(t,e,i)},$l=(t,e,i)=>{Gy(t)?e0(t,e,i):qy(t,e,i)},t0=(t,e,i)=>{t.setAttribute("loading","lazy"),Ol(t,e,i),Hy(t,e),Ei(t,Gh)},Ac=t=>{t.removeAttribute(zt),t.removeAttribute(kl),t.removeAttribute(Bl)},i0=t=>{Rl(t,e=>{Ac(e)}),Ac(t)},cp=t=>{Rl(t,e=>{Mi(e,rr)}),Mi(t,rr)},n0=t=>{ep(t,e=>{Mi(e,so)}),Mi(t,tp),t.load()},r0=t=>{Mi(t,so)},s0=t=>{Mi(t,ip)},o0={IMG:cp,IFRAME:r0,VIDEO:n0,OBJECT:s0},a0=t=>{const e=o0[t.tagName];if(!e){jy(t);return}e(t)},l0=(t,e)=>{_l(t)||Ll(t)||(pt(t,e.class_entered),pt(t,e.class_exited),pt(t,e.class_applied),pt(t,e.class_loading),pt(t,e.class_loaded),pt(t,e.class_error))},u0=(t,e)=>{a0(t),l0(t,e),no(t),rp(t)},c0=(t,e,i,n)=>{!i.cancel_on_exit||!Cy(t)||t.tagName==="IMG"&&(fa(t),i0(t),cp(t),pt(t,i.class_loading),jl(n,-1),no(t),ii(i.callback_cancel,t,e,n))},d0=(t,e,i,n)=>{const r=Ey(t);Ei(t,Sy),fn(t,i.class_entered),pt(t,i.class_exited),ky(t,i,n),ii(i.callback_enter,t,e,n),!r&&$l(t,i,n)},h0=(t,e,i,n)=>{_l(t)||(fn(t,i.class_exited),c0(t,e,i,n),ii(i.callback_exit,t,e,n))},p0=["IMG","IFRAME","VIDEO"],dp=t=>t.use_native&&"loading"in HTMLImageElement.prototype,f0=(t,e,i)=>{t.forEach(n=>{p0.indexOf(n.tagName)!==-1&&t0(n,e,i)}),Kh(i,0)},g0=t=>t.isIntersecting||t.intersectionRatio>0,m0=t=>({root:t.container===document?null:t.container,rootMargin:t.thresholds||t.threshold+"px"}),v0=(t,e,i)=>{t.forEach(n=>g0(n)?d0(n.target,n,e,i):h0(n.target,n,e,i))},w0=(t,e)=>{e.forEach(i=>{t.observe(i)})},y0=(t,e)=>{Py(t),w0(t,e)},x0=(t,e)=>{!Oh||dp(t)||(e._observer=new IntersectionObserver(i=>{v0(i,t,e)},m0(t)))},hp=t=>Array.prototype.slice.call(t),Ss=t=>t.container.querySelectorAll(t.elements_selector),M0=t=>hp(t).filter(_l),S0=t=>by(t),I0=t=>hp(t).filter(S0),Ec=(t,e)=>M0(t||Ss(e)),C0=(t,e)=>{I0(Ss(t)).forEach(n=>{pt(n,t.class_error),no(n)}),e.update()},b0=(t,e)=>{!ti||(e._onlineHandler=()=>{C0(t,e)},window.addEventListener("online",e._onlineHandler))},A0=t=>{!ti||window.removeEventListener("online",t._onlineHandler)},yr=function(t,e){const i=Wh(t);this._settings=i,this.loadingCount=0,x0(i,this),b0(i,this),this.update(e)};yr.prototype={update:function(t){const e=this._settings,i=Ec(t,e);if(Kh(this,i.length),Vh||!Oh){this.loadAll(i);return}if(dp(e)){f0(i,e,this);return}y0(this._observer,i)},destroy:function(){this._observer&&this._observer.disconnect(),A0(this),Ss(this._settings).forEach(t=>{rp(t)}),delete this._observer,delete this._settings,delete this._onlineHandler,delete this.loadingCount,delete this.toLoadCount},loadAll:function(t){const e=this._settings;Ec(t,e).forEach(n=>{ro(n,this),$l(n,e,this)})},restoreAll:function(){const t=this._settings;Ss(t).forEach(e=>{u0(e,t)})}};yr.load=(t,e)=>{const i=Wh(e);$l(t,i)};yr.resetStatus=t=>{no(t)};ti&&My(yr,window.lazyLoadOptions);const Is=(hc=window.navigator)==null?void 0:hc.userAgent;Is==null||Is.match(/(Edge?)\/(\d+)/);const Tc=()=>typeof navigator!="undefined"&&typeof window!="undefined"&&/iPad|iPhone|iPod/.test(Is),Nc=()=>typeof navigator!="undefined"&&/Android/.test(Is);class pp{constructor({context:e,readonly:i,box:n,pages:r,onNewPageIndex:s,onPlay:o}){if(this.pageIndex=0,this.namespace="netless-app-docs-viewer",this.isShowPreview=!1,this.isSmallBox=!1,this.sideEffect=new io,r.length<=0)throw new Error("[DocsViewer] Empty pages.");this.context=e,this.readonly=i,this.box=n,this.pages=r,this.onNewPageIndex=s,this.onPlay=o,this.onPageIndexChanged=()=>{},this.render()}mount(){this.box.mountContent(this.$content),this.box.mountFooter(this.$footer),this.box.events.on("maximized",e=>{this.$footer.classList.toggle(this.wrapClassName("hide"),e)}),this.$footer.classList.toggle(this.wrapClassName("hide"),this.box.maximized)}unmount(){this.$content.remove(),this.$footer.remove()}setReadonly(e){this.readonly!==e&&(this.readonly=e,this.$content.classList.toggle(this.wrapClassName("readonly"),e),this.$footer.classList.toggle(this.wrapClassName("readonly"),e))}destroy(){this.sideEffect.flushAll(),this.unmount()}setPageIndex(e){Number.isNaN(e)||(this.scrollPreview(e),this.pageIndex=e,this.$pageNumberInput.textContent=String(e+1),this.onPageIndexChanged(e),this.$btnPageBack.classList.toggle(this.wrapClassName("footer-btn-disable"),e==0),this.$btnPageNext.classList.toggle(this.wrapClassName("footer-btn-disable"),e==this.pages.length-1))}scrollPreview(e){var i;const n=(i=this.$preview)==null?void 0:i.querySelectorAll("."+this.wrapClassName("preview-page"));if(n==null||n.forEach((l,u)=>{var c;(c=l.querySelector("img"))==null||c.classList.toggle(this.wrapClassName("active"),Number(e)==u)}),!n)return;const r=Array.prototype.slice.call(n).find(l=>l.querySelector("img").className.includes(this.wrapClassName("active")));if(!r)return;const s=this.$preview.getBoundingClientRect(),o=r==null?void 0:r.getBoundingClientRect();o.top>=s.top&&o.bottom<=s.bottom||this.$preview.scrollTo({top:r.offsetTop-16,behavior:this.isShowPreview?"smooth":"auto"})}setSmallBox(e){this.isSmallBox!==e&&(this.isSmallBox=e,this.$footer.classList.toggle(this.wrapClassName("float-footer"),e))}render(){return this.renderContent(),this.renderFooter(),this.$content}renderContent(){if(!this.$content){const e=document.createElement("div");e.className=this.wrapClassName("content"),this.$content=e,this.readonly&&e.classList.add(this.wrapClassName("readonly"))}return this.$content}renderPreview(){if(!this.$preview){const e=document.createElement("div");e.className=this.wrapClassName("preview")+" tele-fancy-scrollbar",this.$preview=e;const i=document.createElement("div");i.className=this.wrapClassName("preview-head");const n=document.createElement("h3");n.textContent=this.box.title,i.appendChild(n),this.$preview.appendChild(i);const r=this.wrapClassName("preview-page"),s=this.wrapClassName("preview-page-name");this.pages.forEach((o,a)=>{var l;const u=(l=o.thumbnail)!=null?l:o.src.startsWith("ppt")?void 0:o.src;if(!u)return;const c=String(a),d=document.createElement("a");d.className=r+" "+this.wrapClassName(`preview-page-${a}`),d.setAttribute("href","#"),d.dataset.pageIndex=c;const f=document.createElement("span");f.className=s,f.textContent=String(a+1),f.dataset.pageIndex=c;const v=document.createElement("img");v.width=o.width,v.height=o.height,v.dataset.src=u,v.dataset.pageIndex=c,d.appendChild(f),d.appendChild(v),e.appendChild(d),v.classList.toggle(this.wrapClassName("active"),this.pageIndex==a)}),this.sideEffect.addEventListener(e,"click",o=>{var a;if(this.readonly)return;const l=(a=o.target.dataset)==null?void 0:a.pageIndex;l&&(o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation(),this.onNewPageIndex(Number(l)))})}return this.$preview}renderPreviewMask(){return this.$previewMask||(this.$previewMask=document.createElement("div"),this.$previewMask.className=this.wrapClassName("preview-mask"),this.sideEffect.addEventListener(this.$previewMask,"click",e=>{this.readonly||e.target===this.$previewMask&&this.togglePreview(!1)})),this.$previewMask}renderFooter(){if(!this.$footer){const e=document.createElement("div");e.className=this.wrapClassName("footer"),this.$footer=e,this.readonly&&e.classList.add(this.wrapClassName("readonly")),this.isSmallBox&&e.classList.add(this.wrapClassName("float-footer"));const i=document.createElement("div");i.className=this.wrapClassName("page-jumps");const n=this.renderFooterBtn("btn-page-back",my(this.namespace));if(this.sideEffect.addEventListener(n,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex-1)}),i.appendChild(n),this.$btnPageBack=n,this.onPlay){const l=this.renderFooterBtn("btn-page-play",wy(this.namespace),yy(this.namespace)),u=()=>{this.sideEffect.setTimeout(()=>{l.classList.toggle(this.wrapClassName("footer-btn-playing"),!1)},500,"returnPlay")};this.sideEffect.addEventListener(l,"click",()=>{var c;this.readonly||(l.classList.toggle(this.wrapClassName("footer-btn-playing"),!0),(c=this.onPlay)==null||c.call(this),u())}),!this.context.getIsAppReadonly()&&!Tc()&&!Nc()&&this.$footer.appendChild(l)}const r=document.createElement("div");r.className=this.wrapClassName("page-number");const s=document.createElement("span");s.className=this.wrapClassName("page-number-input"),s.textContent=String(this.pageIndex+1),this.$pageNumberInput=s;const o=document.createElement("span");o.textContent=" / "+this.pages.length,r.appendChild(s),r.appendChild(o),i.appendChild(r);const a=this.renderFooterBtn("btn-page-next",vy(this.namespace));this.sideEffect.addEventListener(a,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex+1)}),i.appendChild(a),this.$btnPageNext=a,!this.context.getIsAppReadonly()&&!Tc()&&!Nc()&&this.$footer.appendChild(i)}return this.$footer}renderFooterBtn(e,i,n){const r=document.createElement("button");return r.className=this.wrapClassName("footer-btn")+" "+this.wrapClassName(e),r.appendChild(i),n&&r.appendChild(n),r}togglePreview(e){var i,n,r,s,o,a,l;this.isShowPreview=e!=null?e:!this.isShowPreview,console.log((i=this.context)==null?void 0:i.extendWrapper),this.$content.classList.toggle(this.wrapClassName("preview-active"),this.isShowPreview),this.isShowPreview?((n=this.context)!=null&&n.extendWrapper&&((s=(r=this.context)==null?void 0:r.extendWrapper)==null||s.appendChild(this.renderPreviewMask()),(a=(o=this.context)==null?void 0:o.extendWrapper)==null||a.appendChild(this.renderPreview()),this.context.extendWrapper.style.display="block"),setTimeout(()=>{const u=this.$preview.querySelector("."+this.wrapClassName(`preview-page-${this.pageIndex}`));u&&(this.sideEffect.add(()=>{const c=new yr({container:this.$preview,elements_selector:`.${this.wrapClassName("preview-page>img")}`});return()=>c.destroy()},"preview-lazyload"),this.$preview.scrollTo({top:u.offsetTop-16})),u&&this.$preview.scrollTo({top:u.offsetTop-16})})):(l=this.context)!=null&&l.extendWrapper&&(this.context.extendWrapper.style.display="none",this.context.extendWrapper.innerHTML="")}wrapClassName(e){return`${this.namespace}-${e}`}}function on(t,e,i){return Math.min(Math.max(t,e),i)}function Pc(t){return t.touches?t.touches[0]:t}function fp(t){t.stopPropagation(),t.cancelable&&t.preventDefault()}function gp(t){if(!t)return!1;const e=t.tagName;return e==="INPUT"||e==="TEXTAREA"||e==="SELECT"}class E0{constructor(e){var i,n,r;this.velocity=0,this.paused=!0,this._animationFrameID=null,this._loopTimestamp=0,this.looper=s=>{if(this.paused)return;let o=Math.floor((s-this._loopTimestamp)/1e3*60)+1;for(this._loopTimestamp=s;o-- >0;)this.stepper();this.onStep(this.current,this),!this.paused&&this.current!==this.target&&window.requestAnimationFrame(this.looper)},this.current=(i=e.start)!=null?i:0,this.target=this.current,this.stiffness=(n=e.stiffness)!=null?n:170,this.damping=(r=e.damping)!=null?r:26,this.onStep=e.onStep}stepTo(e,i){this.paused&&i!=null&&(this.current=i),this.paused=!1,this.target=e,this.onStep(this.current,this),this._loopTimestamp=Date.now(),window.requestAnimationFrame(this.looper)}pause(){this.paused=!0}destroy(){this.pause()}stepper(){const e=-this.stiffness*(this.current-this.target),i=-this.damping*this.velocity,n=this.velocity+(e+i)/60,r=this.current+n/60;Math.abs(n-0)<.01&&Math.abs(r-this.target)<.01?(this.current=this.target,this.velocity=0):(this.current=r,this.velocity=n)}}class T0{constructor(e,i,n,r){this.scale=1,this.lastVisit=Date.now(),this.pageOffsetY=0,this.pageOffsetX=0,this.visible=!0,this.index=e,this.page=i,this.scale=n,this.pageOffsetX=(r-i.width)/2;const s=document.createElement("div");s.className="page-renderer-page",s.dataset.index=`${e}`,s.style.width=`${i.width*n}px`,s.style.height=`${i.height*n}px`,i.thumbnail&&(s.style.backgroundImage=`url("${i.thumbnail}")`);const o=document.createElement("img");o.className="page-renderer-page-img",o.width=i.width,o.height=i.height,o.src=i.src,s.appendChild(o),this.$page=s}translateY(e){Math.abs(e-this.pageOffsetY)>=.001&&(this.pageOffsetY=e,this.$page.style.transform=`translate(${this.pageOffsetX*this.scale}px, ${this.pageOffsetY*this.scale}px)`)}setScale(e){Math.abs(e-this.scale)>=.001&&(this.scale=e,this.$page.style.width=`${this.page.width*this.scale}px`,this.$page.style.height=`${this.page.height*this.scale}px`,this.$page.style.transform=`translate(${this.pageOffsetX*this.scale}px, ${this.pageOffsetY*this.scale}px)`)}setVisible(e){e!==this.visible&&(this.visible=e,this.$page.style.opacity=e?"1":"0")}}const N0=window.requestIdleCallback||(t=>window.setTimeout(t,5e3)),P0=window.cancelIdleCallback||window.clearTimeout;class k0{constructor(e,i,n){this.pages=e,this.pagesIntrinsicWidth=i,this.scale=n,this.els=new Map,this.maxElCount=200,this.gcTimer=null,this.gc=()=>{if(this.gcTimer=null,this.els.size>this.maxElCount){const r=[...this.els.values()].sort((s,o)=>o.lastVisit-s.lastVisit);for(let s=Math.floor(this.maxElCount/4);s<r.length;s++)this.els.delete(r[s].index)}}}getEl(e){let i=this.els.get(e);return i||(i=new T0(e,this.pages[e],this.scale,this.pagesIntrinsicWidth),this.els.set(e,i)),i.lastVisit=Date.now(),this.els.size>this.maxElCount&&this.gcTimer===null&&(this.gcTimer=N0(this.gc)),i}setScale(e){e!==this.scale&&(this.scale=e,this.els.forEach(i=>i.setScale(e)))}destroy(){this.els.clear(),this.gcTimer!==null&&(P0(this.gcTimer),this.gcTimer=null)}}class B0{constructor(e){this._hwaTimeout=NaN,this._turnOffHWA=()=>{window.clearTimeout(this._hwaTimeout),this._hwaTimeout=NaN,this.$pages.classList.toggle("is-hwa",!1)},this.pagesScrollTop=e.pagesScrollTop||0,this.containerWidth=e.containerWidth||1,this.containerHeight=e.containerHeight||1,this.pages=e.pages.map(s=>{if(s.thumbnail)return s;try{const o=new URL(s.src);return o.searchParams.set("x-oss-process","image/resize,l_50"),{...s,thumbnail:o.toString()}}catch(o){return console.error(o),s}});const i=Array(this.pages.length);let n=1/0,r=0;this.pagesIntrinsicHeight=this.pages.reduce((s,o,a)=>(i[a]=s,o.width>r&&(r=o.width),o.height<=n&&(n=o.height),s+o.height),0),this.pagesIntrinsicWidth=r,this.pagesMinHeight=n,this.pagesIntrinsicYs=i,this.scale=this._calcScale(),this.threshold=this._calcThreshold(),this.onPageIndexChanged=e.onPageIndexChanged,this.pageScrollIndex=0,this.pagesScrollTop!==0&&(this.pageScrollIndex=this.findScrollPageIndex(),this.onPageIndexChanged&&this.pageScrollIndex>0&&this.onPageIndexChanged(this.pageScrollIndex)),this.pageElManager=new k0(this.pages,r,this.scale),this.$pages=this.renderPages()}setContainerSize(e,i){e>0&&i>0&&(e!==this.containerWidth||i!==this.containerHeight)&&(this.containerWidth=e,this.containerHeight=i,this.$pages.style.width=`${this.containerWidth}px`,this.$pages.style.height=`${this.containerHeight}px`,this.scale=this._calcScale(),this.threshold=this._calcThreshold(),this.pageElManager.setScale(this.scale),this.$pages.parentElement&&this.pagesScrollTo(this.pagesScrollTop,!0))}renderPages(){const e=document.createElement("div");return e.className="page-renderer-pages-container",e.style.width=`${this.containerWidth}px`,e.style.height=`${this.containerHeight}px`,e}pagesScrollTo(e,i){if(e=on(e,0,this.pagesIntrinsicHeight-this.containerHeight/this.scale),i||Math.abs(e-this.pagesScrollTop)>=.001){this._turnOnHWA(),this.pagesScrollTop=e;const n=this.findScrollPageIndex(),r=Math.max(n-this.threshold,0),s=Math.min(n+this.threshold,this.pages.length-1);for(let o=0;o<this.$pages.children.length;o++){const a=this.$pages.children[o],l=Number(a.dataset.index);l>=r&&l<=s||(a.remove(),o--)}for(let o=r;o<=s;o++){const a=this.pageElManager.getEl(o);a.$page.parentElement!==this.$pages&&this.$pages.appendChild(a.$page),a.translateY(this.pagesIntrinsicYs[o]-this.pagesScrollTop)}n!==this.pageScrollIndex&&(this.pageScrollIndex=n,this.onPageIndexChanged&&this.onPageIndexChanged(n))}}findScrollPageIndex(){for(let e=0;e<this.pagesIntrinsicYs.length;e++)if(this.pagesIntrinsicYs[e]+this.pages[e].height-this.pagesScrollTop>=.001)return e;return this.pagesIntrinsicYs.length-1}mount(e){e.appendChild(this.$pages),this.pagesScrollTo(this.pagesScrollTop,!0)}unmount(){this.$pages.remove()}destroy(){this.unmount(),this.onPageIndexChanged=void 0,this.pageElManager.destroy(),this._hwaTimeout&&(window.clearTimeout(this._hwaTimeout),this._hwaTimeout=NaN)}_calcScale(){return this.containerWidth/this.pagesIntrinsicWidth||1}_calcThreshold(){return on(Math.ceil(this.containerHeight/this.scale/this.pagesMinHeight/2),1,this.pages.length)}_turnOnHWA(){this._hwaTimeout?window.clearTimeout(this._hwaTimeout):this.$pages.classList.toggle("is-hwa",!0),this._hwaTimeout=window.setTimeout(this._turnOffHWA,1e3)}}const D0=30;class z0{constructor(e){this.sideEffect=new io,this.pagesScrollTop=e.pagesScrollTop||0,this.containerWidth=e.containerWidth||1,this.containerHeight=e.containerHeight||1,this.pagesWidth=e.pagesWidth||1,this.pagesHeight=e.pagesHeight||1,this.scale=this._calcScale(),this.scrollbarMinHeight=e.scrollbarMinHeight||D0,this.scrollbarHeight=this._calcScrollbarHeight(),this.readonly=e.readonly,this.wrapClassName=e.wrapClassName,this.onDragScroll=e.onDragScroll,this.$scrollbar=this.renderScrollbar()}mount(e){e.appendChild(this.$scrollbar),this.pagesScrollTo(this.pagesScrollTop,!0)}unmount(){this.$scrollbar.remove()}setReadonly(e){this.readonly=e}setContainerSize(e,i){e>0&&i>0&&(e!==this.containerWidth||i!==this.containerHeight)&&(this.containerWidth=e,this.containerHeight=i,this.scale=this._calcScale(),this._updateScrollbarHeight(),this.$scrollbar.parentElement&&this.pagesScrollTo(this.pagesScrollTop,!0))}pagesScrollTo(e,i){if(e=on(e,0,this.pagesHeight-this.containerHeight/this.scale),i||Math.abs(e-this.pagesScrollTop)>=.001){this.pagesScrollTop=e;const n=this.pagesScrollTop*this.scale,r=this.pagesHeight*this.scale,s=n/(r-this.containerHeight)*(this.containerHeight-this.scrollbarHeight);window.requestAnimationFrame?window.requestAnimationFrame(()=>{this.$scrollbar.style.transform=`translateY(${s}px)`}):this.$scrollbar.style.transform=`translateY(${s}px)`}}destroy(){this.unmount(),this.onDragScroll=void 0,this.sideEffect.flushAll()}renderScrollbar(){const e=document.createElement("button");e.className=this.wrapClassName("scrollbar"),e.style.minHeight=`${this.scrollbarMinHeight}px`,e.style.height=`${this.scrollbarHeight}px`;const i=n=>{if(this.readonly||n.button!=null&&n.button!==0)return;fp(n);const r=this.wrapClassName("scrollbar-dragging");e.classList.toggle(r,!0);const s=this.pagesScrollTop,{clientY:o}=Pc(n),a=u=>{if(this.readonly)return;const{clientY:c}=Pc(u),d=(c-o)/this.scale;Math.abs(d)>0&&this.onDragScroll&&this.onDragScroll(s+d*(this.pagesHeight*this.scale/this.containerHeight))},l=()=>{e.classList.toggle(r,!1),window.removeEventListener("mousemove",a,!0),window.removeEventListener("touchmove",a,!0),window.removeEventListener("mouseup",l,!0),window.removeEventListener("touchend",l,!0),window.removeEventListener("touchcancel",l,!0)};window.addEventListener("mousemove",a,!0),window.addEventListener("touchmove",a,!0),window.addEventListener("mouseup",l,!0),window.addEventListener("touchend",l,!0),window.addEventListener("touchcancel",l,!0)};return this.sideEffect.addEventListener(e,"mousedown",i),this.sideEffect.addEventListener(e,"touchstart",i),e}_calcScale(){return this.containerWidth/this.pagesWidth||1}_calcScrollbarHeight(){return on(this.containerHeight/(this.pagesHeight*this.scale)*this.containerHeight,this.scrollbarMinHeight,this.containerHeight)}_updateScrollbarHeight(){const e=this._calcScrollbarHeight();Math.abs(e-this.scrollbarHeight)>.001&&(this.scrollbarHeight=e,this.$scrollbar.style.height=`${e}px`)}}const _0=window.ResizeObserver||gy,L0=640;class j0{constructor({context:e,whiteboardView:i,readonly:n,box:r,pages:s,pageScrollTop:o=0,mountWhiteboard:a,onUserScroll:l,baseScenePath:u,appId:c}){this.sideEffect=new io,this.userScrolling=!1,this.onNewPageIndex=w=>{this.scrollToPage(w)},this.toPdf=async()=>{const w=document.createElement("canvas"),y=w.getContext("2d");if(!y||!this.baseScenePath){this.reportProgress(100,null);return}const h=this.whiteboardView.focusScenePath||`${this.baseScenePath}/1`,p=this.pages[0],{jsPDF:g}=await Promise.resolve().then(function(){return Gg(require("jspdf"))}),m=new g({format:[p.width,p.height],orientation:p.width>p.height?"l":"p",compress:!0});for(const[M,T]of this.pages.entries()){const{width:z,height:P,src:D}=T;w.width=z,w.height=P;const S=z>P?"l":"p";M>0&&m.addPage([z,P],S);const N=await this.getBase64FromUrl(D),I=document.createElement("img");I.src=N,await new Promise(Ae=>I.onload=Ae),y.drawImage(I,0,0);const U=w.toDataURL("image/jpeg",.6);y.clearRect(0,0,z,P);const $={centerX:z/2,centerY:P/2+M*P,scale:1},F=this.context.manager.windowManger;F._appliancePlugin?await F._appliancePlugin.screenshotToCanvasAsync(y,h,z,P,$):this.whiteboardView.screenshotToCanvas(y,h,z,P,$);const pe=w.toDataURL("image/png");m.addImage(U,"JPEG",0,0,z,P,"","FAST"),m.addImage(pe,"PNG",0,0,z,P,"","FAST"),y.clearRect(0,0,z,P),Math.ceil((M+1)/this.pages.length*100)<100&&this.reportProgress(Math.ceil((M+1)/this.pages.length*100),null)}const x=m.output("arraybuffer");this.reportProgress(100,{pdf:x,title:this.box.title})},this.context=e,this.whiteboardView=i,this.readonly=n,this.box=r,this.pages=s,this.baseScenePath=u,this.appId=c,this.mountWhiteboard=a,this._onUserScroll=l;const d=this.debounce(()=>{this.userScrolling=!1,this._onUserScroll&&this._onUserScroll(this.pageRenderer.pagesScrollTop)},{wait:80},"debounce-updateUserScroll");this.updateUserScroll=()=>{this.userScrolling=!0,d()},this.viewer=new pp({context:e,readonly:n,box:r,pages:s,onNewPageIndex:this.onNewPageIndex});const{width:f,height:v}=this.whiteboardView.size;this.pageRenderer=new B0({pagesScrollTop:o,pages:this.pages,containerWidth:f,containerHeight:v,onPageIndexChanged:this.viewer.setPageIndex.bind(this.viewer)}),this.scrollbar=new z0({pagesScrollTop:this.pageRenderer.pagesScrollTop,containerWidth:f,containerHeight:v,pagesWidth:this.pageRenderer.pagesIntrinsicWidth,pagesHeight:this.pageRenderer.pagesIntrinsicHeight,readonly:this.readonly,wrapClassName:this.wrapClassName.bind(this),onDragScroll:w=>{this.pageScrollTo(w),this.updateUserScroll()}}),this.pageScrollStepper=new E0({start:this.pageRenderer.pagesScrollTop,onStep:w=>{this.pageScrollTo(w)}}),this.render()}mount(){this.viewer.mount(),this.setupScrollListener();const e=this.debounce(this.renderRatioHeight.bind(this),{wait:80});return this.sideEffect.add(()=>{const i=new _0(e);return i.observe(this.viewer.$content),()=>i.disconnect()}),this.sideEffect.setTimeout(()=>{this.userScrolling||this.pageScrollTo(this.pageRenderer.pagesScrollTop)},100),this.sideEffect.add(()=>{const i=n=>{n.data.type==="@netless/_request_save_pdf_"&&n.data.appId===this.appId&&this.toPdf().catch(()=>this.reportProgress(100,null))};return window.addEventListener("message",i),()=>{window.removeEventListener("message",i)}}),this}unmount(){return this.viewer.unmount(),this}setReadonly(e){this.readonly!==e&&(this.readonly=e,this.viewer.setReadonly(e),this.scrollbar.setReadonly(e))}destroy(){this.sideEffect.flushAll(),this.pageScrollStepper.destroy(),this._onUserScroll=void 0,this.unmount(),this.viewer.destroy(),this.pageRenderer.destroy(),this.scrollbar.destroy()}syncPageScrollTop(e){!this.userScrolling&&e>=0&&Math.abs(this.pageRenderer.pagesScrollTop-e)>.01&&this.pageScrollStepper.stepTo(e,this.pageRenderer.pagesScrollTop)}render(){this.pageRenderer.mount(this.viewer.$content),this.viewer.$content.appendChild(this.renderWhiteboardView()),this.scrollbar.mount(this.viewer.$content),this.renderRatioHeight()}renderRatioHeight(){const i=Math.round(this.box.absoluteHeight)<=L0;this.viewer.setSmallBox(i),this.box.$titleBar&&(this.box.$titleBar.style.height="2.778vw"),this.box.$footer&&(this.box.$footer.style.height="2.778vw")}renderWhiteboardView(){return this.$whiteboardView||(this.$whiteboardView=document.createElement("div"),this.$whiteboardView.className=this.wrapClassName("wb-view"),this.mountWhiteboard(this.$whiteboardView),this.sideEffect.addEventListener(this.$whiteboardView,"wheel",e=>{fp(e),this.readonly||(this.pageScrollTo(this.pageRenderer.pagesScrollTop+e.deltaY),this.updateUserScroll())},{passive:!1,capture:!0}),this.sideEffect.addEventListener(this.$whiteboardView,"touchmove",e=>{this.readonly||e.touches.length<=1||this.updateUserScroll()},{passive:!0,capture:!0})),this.$whiteboardView}scrollTopPageToEl(e){return e*this.pageRenderer.scale}scrollTopElToPage(e){return e/this.pageRenderer.scale}elScrollTo(e){this.pageScrollTo(this.scrollTopElToPage(e))}pageScrollTo(e){const i=this.scrollTopElToPage(this.whiteboardView.size.height/2);this.whiteboardView.moveCamera({centerY:on(e+i,i,this.pageRenderer.pagesIntrinsicHeight-i),animationMode:"immediately"})}scrollToPage(e){if(!this.readonly&&!Number.isNaN(e)){const i=this.pageRenderer.pagesIntrinsicYs[e];i>=0&&(this.pageScrollTo(i+5/this.pageRenderer.scale),this.updateUserScroll())}}setupScrollListener(){this.sideEffect.add(()=>{const e=i=>{const{width:n,height:r}=this.whiteboardView.size;if(n<=0||r<=0)return;const s=i.centerY-this.pageRenderer.containerHeight/this.pageRenderer.scale/2;this.pageRenderer.pagesScrollTo(s),this.scrollbar.pagesScrollTo(s)};return this.whiteboardView.callbacks.on("onCameraUpdated",e),()=>this.whiteboardView.callbacks.off("onCameraUpdated",e)}),this.sideEffect.add(()=>{const{updateUserScroll:e}=this;return this.whiteboardView.callbacks.on("onCameraUpdatedByDevice",e),()=>this.whiteboardView.callbacks.off("onCameraUpdatedByDevice",e)}),this.sideEffect.add(()=>{const e=({width:i,height:n})=>{if(i<=0||n<=0)return;this.pageRenderer.setContainerSize(i,n),this.scrollbar.setContainerSize(i,n);const{pagesIntrinsicWidth:r,pagesIntrinsicHeight:s}=this.pageRenderer;this.whiteboardView.moveCameraToContain({originX:0,originY:this.pageRenderer.pagesScrollTop,width:r,height:n/this.pageRenderer.scale,animationMode:"immediately"}),this.whiteboardView.setCameraBound({damping:1,maxContentMode:()=>this.pageRenderer.scale,minContentMode:()=>this.pageRenderer.scale,centerX:r/2,centerY:s/2,width:r,height:s})};return this.whiteboardView.callbacks.on("onSizeUpdated",e),()=>{this.whiteboardView.callbacks.off("onSizeUpdated",e)}},"whiteboard-size-update"),this.sideEffect.addEventListener(window,"keyup",e=>{if(this.readonly||!this.box.focus||this.box.minimized||gp(e.target))return;let i=null;switch(e.key){case"PageDown":{i=this.pageRenderer.pagesScrollTop+this.pageRenderer.containerHeight/this.pageRenderer.scale;break}case"PageUp":{i=this.pageRenderer.pagesScrollTop-this.pageRenderer.containerHeight/this.pageRenderer.scale;break}case"ArrowDown":{i=this.pageRenderer.pagesScrollTop+this.pageRenderer.containerHeight/4/this.pageRenderer.scale;break}case"ArrowUp":{i=this.pageRenderer.pagesScrollTop-this.pageRenderer.containerHeight/4/this.pageRenderer.scale;break}}i!==null&&(this._onUserScroll?this._onUserScroll(i):(this.pageScrollTo(i),this.updateUserScroll()))},{capture:!0})}debounce(e,i,n){const r=Ww(e,i);return this.sideEffect.addDisposer(()=>r.cancel(),n),r}wrapClassName(e){return"netless-app-docs-viewer-static-"+e}async getBase64FromUrl(e){const n=await(await fetch(this._invalidate(e))).blob();return new Promise(r=>{const s=new FileReader;s.readAsDataURL(n),s.onloadend=()=>{const o=s.result;r(o)}})}_invalidate(e){try{const i=new URL(e);return i.searchParams.set("t",Date.now().toString()),i.toString()}catch{return e}}reportProgress(e,i){window.postMessage({type:"@netless/_result_save_pdf_",appId:this.appId,progress:e,result:i})}}class R0{constructor({context:e,whiteboardView:i,box:n,pages:r}){this.sideEffect=new io,this.onPlayPPT=()=>{const s=this.context.getRoom();s&&s.pptNextStep()},this._scaleDocsToFitImpl=()=>{const s=this.pages[this.getPageIndex()];s&&(this.whiteboardView.moveCameraToContain({originX:-s.width/2,originY:-s.height/2,width:s.width,height:s.height,animationMode:"immediately"}),this.whiteboardView.setCameraBound({damping:1,maxContentMode:()=>this.whiteboardView.camera.scale,minContentMode:()=>this.whiteboardView.camera.scale,centerX:0,centerY:0,width:s.width,height:s.height}))},this._scaleDocsToFitDebounced=()=>{this.sideEffect.setTimeout(this._scaleDocsToFitImpl,1e3,"_scaleDocsToFitDebounced")},this.scaleDocsToFit=()=>{this._scaleDocsToFitImpl(),this._scaleDocsToFitDebounced()},this.onNewPageIndex=s=>{this.jumpToPage(s,!0)},this.context=e,this.whiteboardView=i,this.box=n,this.pages=r,this.displayer=e.getDisplayer(),this.viewer=new pp({context:e,readonly:!e.getIsWritable(),box:n,pages:r,onNewPageIndex:this.onNewPageIndex,onPlay:this.onPlayPPT}),this.render(),this.sideEffect.add(()=>{const s=o=>{this.viewer.setReadonly(!o)};return this.context.emitter.on("writableChange",s),()=>this.context.emitter.off("writableChange",s)}),this.sideEffect.add(()=>{const s=o=>{this.jumpToPage(o.index)};return this.context.emitter.on("sceneStateChange",s),()=>this.context.emitter.off("sceneStateChange",s)}),this.sideEffect.add(()=>{const s=o=>{this.jumpToPage(o.index)};return this.context.emitter.on("pageStateChange",s),()=>this.context.emitter.off("pageStateChange",s)}),this.sideEffect.add(()=>{const s=o=>{this.viewer.togglePreview(o)};return this.context.emitter.on("togglePreview",s),()=>this.context.emitter.off("togglePreview",s)})}mount(){this.viewer.mount();const e=this.getPageIndex();return e!==0&&this.jumpToPage(e),this.scaleDocsToFit(),this.sideEffect.add(()=>(this.whiteboardView.callbacks.on("onSizeUpdated",this.scaleDocsToFit),()=>{this.whiteboardView.callbacks.off("onSizeUpdated",this.scaleDocsToFit)})),this}unmount(){return this.viewer.unmount(),this}destroy(){this.sideEffect.flushAll(),this.unmount(),this.viewer.destroy()}getPageIndex(){return this.displayer.state.sceneState.index}jumpToPage(e,i){var n,r;if(e=on(e,0,this.pages.length-1),e!==this.getPageIndex()&&this.context.getIsWritable()){const s=this.context.getInitScenePath(),o=(r=(n=this.context.getScenes())==null?void 0:n[e])==null?void 0:r.name;s&&o&&this.context.setScenePath(`${s}/${o}`),this.scaleDocsToFit()}if(e!==this.viewer.pageIndex&&this.viewer.setPageIndex(e),i){const s=this.context.getRoom();if(s){const o=s.state.globalState.__pptState;s.setGlobalState({__pptState:o&&{uuid:o.uuid,pageIndex:e,disableAutoPlay:o.disableAutoPlay}})}}}render(){this.viewer.$content.appendChild(this.renderMask()),this.viewer.$content.appendChild(this.renderWhiteboardView()),this.sideEffect.addEventListener(window,"keydown",e=>{var i;if(this.box.focus&&!gp(e.target))switch(e.key){case"ArrowUp":case"ArrowLeft":{this.jumpToPage(this.getPageIndex()-1,!0);break}case"ArrowRight":case"ArrowDown":{(i=this.context.getRoom())==null||i.pptNextStep();break}}})}renderMask(){if(!this.$mask){const e=document.createElement("div");e.className=this.wrapClassName("mask"),this.$mask=e;const i=document.createElement("button");i.className=this.wrapClassName("back");const n=document.createElement("button");n.className=this.wrapClassName("next")}return this.$mask}renderWhiteboardView(){return this.$whiteboardView||(this.$whiteboardView=document.createElement("div"),this.$whiteboardView.className=this.wrapClassName("wb-view"),this.sideEffect.addEventListener(this.$whiteboardView,"click",e=>{var i;const n=this.context.getRoom();if(n&&n.state.memberState.currentApplianceName==="clicker"){for(let r=e.target;r;r=r.parentElement)if((i=r.classList)!=null&&i.contains("ppt-event-source"))return;n.pptNextStep()}}),this.context.mountView(this.$whiteboardView)),this.$whiteboardView}wrapClassName(e){return"netless-app-docs-viewer-dynamic-"+e}}const V0="DocsViewer",ga={kind:V0,setup(t){const e=t.getBox(),i=t.getScenes();if(!i)throw new Error("[Docs Viewer]: scenes not found.");const n=t.getView();if(!n)throw new Error("[Docs Viewer]: no whiteboard view.");const r=i.map(({ppt:s})=>s?{width:s.width,height:s.height,src:s.src,thumbnail:s.previewURL}:null).filter(s=>Boolean(s));if(r.length<=0)throw new Error("[Docs Viewer]: empty scenes.");return e.mountStyles(zw),r[0].src.startsWith("ppt")?$0(t,n,e,r):O0(t,n,e,r)}};function O0(t,e,i,n){var r,s,o,a;e.disableCameraTransform=!t.getIsWritable();const l=new j0({context:t,whiteboardView:e,readonly:!t.getIsWritable(),box:i,pages:n,pageScrollTop:(r=t.getAttributes())==null?void 0:r.pageScrollTop,mountWhiteboard:t.mountView.bind(t),onUserScroll:c=>{var d;((d=t.getAttributes())==null?void 0:d.pageScrollTop)!==c&&!i.readonly&&t.updateAttributes(["pageScrollTop"],c)},baseScenePath:t.getInitScenePath(),appId:t.appId}).mount();l.viewer.onPageIndexChanged=c=>{t.dispatchAppEvent("pageStateChange",{index:c,length:n.length})},t.dispatchAppEvent("pageStateChange",{index:l.viewer.pageIndex,length:n.length}),t.emitter.on("attributesUpdate",c=>{c&&c.pageScrollTop!=null&&l.syncPageScrollTop(c.pageScrollTop)}),t.emitter.on("writableChange",c=>{l.setReadonly(!c),e.disableCameraTransform=!c});const u={viewer:()=>l,position:()=>{const c=l==null?void 0:l.viewer;if(c)return[c.pageIndex,l.pages.length]}};return((a=(o=(s=t.getInitScenePath())==null?void 0:s.toLowerCase())==null?void 0:o.indexOf("pdf"))!=null?a:0)>0?{...u,togglePreview:c=>{l.viewer.togglePreview(c)}}:u}function $0(t,e,i,n){e.disableCameraTransform=!0;const r=new R0({context:t,whiteboardView:e,box:i,pages:n}).mount();return r.viewer.onPageIndexChanged=s=>{t.dispatchAppEvent("pageStateChange",{index:s,length:n.length})},t.dispatchAppEvent("pageStateChange",{index:r.getPageIndex(),length:n.length}),t.mountView(r.$whiteboardView),t.isAddApp&&e.callbacks.once("onSizeUpdated",({width:s,height:o})=>{if(n.length>0&&i.state!=="maximized"){const{width:a,height:l}=n[0],c=l/a*s-o;c!==0&&t.getIsWritable()&&t.emitter.emit("setBoxSize",{width:i.width,height:i.height+c/i.containerRect.height})}}),{viewer:()=>r,position:()=>{const s=r==null?void 0:r.viewer;if(s)return[s.pageIndex,r.pages.length]},nextStep:()=>r.onPlayPPT(),nextPage:()=>r.jumpToPage(r.getPageIndex()+1,!0),prevPage:()=>r.jumpToPage(r.getPageIndex()+1,!0),jumpToPage:s=>{typeof s=="number"&&r.jumpToPage(s,!0)},togglePreview:s=>{r.viewer.togglePreview(s)}}}var Ti={exports:{}},ie={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var kc=Object.getOwnPropertySymbols,F0=Object.prototype.hasOwnProperty,W0=Object.prototype.propertyIsEnumerable;function U0(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function H0(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;var n=Object.getOwnPropertyNames(e).map(function(s){return e[s]});if(n.join("")!=="0123456789")return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(s){r[s]=s}),Object.keys(Object.assign({},r)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var mp=H0()?Object.assign:function(t,e){for(var i,n=U0(t),r,s=1;s<arguments.length;s++){i=Object(arguments[s]);for(var o in i)F0.call(i,o)&&(n[o]=i[o]);if(kc){r=kc(i);for(var a=0;a<r.length;a++)W0.call(i,r[a])&&(n[r[a]]=i[r[a]])}}return n};/** @license React v16.14.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fl=mp,ot=typeof Symbol=="function"&&Symbol.for,xr=ot?Symbol.for("react.element"):60103,Z0=ot?Symbol.for("react.portal"):60106,Q0=ot?Symbol.for("react.fragment"):60107,G0=ot?Symbol.for("react.strict_mode"):60108,Y0=ot?Symbol.for("react.profiler"):60114,X0=ot?Symbol.for("react.provider"):60109,J0=ot?Symbol.for("react.context"):60110,K0=ot?Symbol.for("react.forward_ref"):60112,q0=ot?Symbol.for("react.suspense"):60113,ex=ot?Symbol.for("react.memo"):60115,tx=ot?Symbol.for("react.lazy"):60116,Bc=typeof Symbol=="function"&&Symbol.iterator;function Mr(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var vp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wp={};function gn(t,e,i){this.props=t,this.context=e,this.refs=wp,this.updater=i||vp}gn.prototype.isReactComponent={};gn.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error(Mr(85));this.updater.enqueueSetState(this,t,e,"setState")};gn.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function yp(){}yp.prototype=gn.prototype;function Wl(t,e,i){this.props=t,this.context=e,this.refs=wp,this.updater=i||vp}var Ul=Wl.prototype=new yp;Ul.constructor=Wl;Fl(Ul,gn.prototype);Ul.isPureReactComponent=!0;var Hl={current:null},xp=Object.prototype.hasOwnProperty,Mp={key:!0,ref:!0,__self:!0,__source:!0};function Sp(t,e,i){var n,r={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)xp.call(e,n)&&!Mp.hasOwnProperty(n)&&(r[n]=e[n]);var a=arguments.length-2;if(a===1)r.children=i;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)r[n]===void 0&&(r[n]=a[n]);return{$$typeof:xr,type:t,key:s,ref:o,props:r,_owner:Hl.current}}function ix(t,e){return{$$typeof:xr,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Zl(t){return typeof t=="object"&&t!==null&&t.$$typeof===xr}function nx(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(i){return e[i]})}var Ip=/\/+/g,Cs=[];function Cp(t,e,i,n){if(Cs.length){var r=Cs.pop();return r.result=t,r.keyPrefix=e,r.func=i,r.context=n,r.count=0,r}return{result:t,keyPrefix:e,func:i,context:n,count:0}}function bp(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>Cs.length&&Cs.push(t)}function ma(t,e,i,n){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(r){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case xr:case Z0:s=!0}}if(s)return i(n,t,e===""?"."+Lo(t,0):e),1;if(s=0,e=e===""?".":e+":",Array.isArray(t))for(var o=0;o<t.length;o++){r=t[o];var a=e+Lo(r,o);s+=ma(r,a,i,n)}else if(t===null||typeof t!="object"?a=null:(a=Bc&&t[Bc]||t["@@iterator"],a=typeof a=="function"?a:null),typeof a=="function")for(t=a.call(t),o=0;!(r=t.next()).done;)r=r.value,a=e+Lo(r,o++),s+=ma(r,a,i,n);else if(r==="object")throw i=""+t,Error(Mr(31,i==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":i,""));return s}function va(t,e,i){return t==null?0:ma(t,"",e,i)}function Lo(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nx(t.key):e.toString(36)}function rx(t,e){t.func.call(t.context,e,t.count++)}function sx(t,e,i){var n=t.result,r=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?wa(t,n,i,function(s){return s}):t!=null&&(Zl(t)&&(t=ix(t,r+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(Ip,"$&/")+"/")+i)),n.push(t))}function wa(t,e,i,n,r){var s="";i!=null&&(s=(""+i).replace(Ip,"$&/")+"/"),e=Cp(e,s,n,r),va(t,sx,e),bp(e)}var Ap={current:null};function _t(){var t=Ap.current;if(t===null)throw Error(Mr(321));return t}var ox={ReactCurrentDispatcher:Ap,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:Hl,IsSomeRendererActing:{current:!1},assign:Fl};ie.Children={map:function(t,e,i){if(t==null)return t;var n=[];return wa(t,n,null,e,i),n},forEach:function(t,e,i){if(t==null)return t;e=Cp(null,null,e,i),va(t,rx,e),bp(e)},count:function(t){return va(t,function(){return null},null)},toArray:function(t){var e=[];return wa(t,e,null,function(i){return i}),e},only:function(t){if(!Zl(t))throw Error(Mr(143));return t}};ie.Component=gn;ie.Fragment=Q0;ie.Profiler=Y0;ie.PureComponent=Wl;ie.StrictMode=G0;ie.Suspense=q0;ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ox;ie.cloneElement=function(t,e,i){if(t==null)throw Error(Mr(267,t));var n=Fl({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Hl.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)xp.call(e,l)&&!Mp.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=i;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:xr,type:t.type,key:r,ref:s,props:n,_owner:o}};ie.createContext=function(t,e){return e===void 0&&(e=null),t={$$typeof:J0,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider={$$typeof:X0,_context:t},t.Consumer=t};ie.createElement=Sp;ie.createFactory=function(t){var e=Sp.bind(null,t);return e.type=t,e};ie.createRef=function(){return{current:null}};ie.forwardRef=function(t){return{$$typeof:K0,render:t}};ie.isValidElement=Zl;ie.lazy=function(t){return{$$typeof:tx,_ctor:t,_status:-1,_result:null}};ie.memo=function(t,e){return{$$typeof:ex,type:t,compare:e===void 0?null:e}};ie.useCallback=function(t,e){return _t().useCallback(t,e)};ie.useContext=function(t,e){return _t().useContext(t,e)};ie.useDebugValue=function(){};ie.useEffect=function(t,e){return _t().useEffect(t,e)};ie.useImperativeHandle=function(t,e,i){return _t().useImperativeHandle(t,e,i)};ie.useLayoutEffect=function(t,e){return _t().useLayoutEffect(t,e)};ie.useMemo=function(t,e){return _t().useMemo(t,e)};ie.useReducer=function(t,e,i){return _t().useReducer(t,e,i)};ie.useRef=function(t){return _t().useRef(t)};ie.useState=function(t){return _t().useState(t)};ie.version="16.14.0";Ti.exports=ie;var G=Ti.exports,Ep={exports:{}},qe={},Tp={exports:{}},Np={};/** @license React v0.19.1
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){var e,i,n,r,s;if(typeof window=="undefined"||typeof MessageChannel!="function"){var o=null,a=null,l=function(){if(o!==null)try{var E=t.unstable_now();o(!0,E),o=null}catch(V){throw setTimeout(l,0),V}},u=Date.now();t.unstable_now=function(){return Date.now()-u},e=function(E){o!==null?setTimeout(e,0,E):(o=E,setTimeout(l,0))},i=function(E,V){a=setTimeout(E,V)},n=function(){clearTimeout(a)},r=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var c=window.performance,d=window.Date,f=window.setTimeout,v=window.clearTimeout;if(typeof console!="undefined"){var w=window.cancelAnimationFrame;typeof window.requestAnimationFrame!="function"&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),typeof w!="function"&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if(typeof c=="object"&&typeof c.now=="function")t.unstable_now=function(){return c.now()};else{var y=d.now();t.unstable_now=function(){return d.now()-y}}var h=!1,p=null,g=-1,m=5,x=0;r=function(){return t.unstable_now()>=x},s=function(){},t.unstable_forceFrameRate=function(E){0>E||125<E?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):m=0<E?Math.floor(1e3/E):5};var M=new MessageChannel,T=M.port2;M.port1.onmessage=function(){if(p!==null){var E=t.unstable_now();x=E+m;try{p(!0,E)?T.postMessage(null):(h=!1,p=null)}catch(V){throw T.postMessage(null),V}}else h=!1},e=function(E){p=E,h||(h=!0,T.postMessage(null))},i=function(E,V){g=f(function(){E(t.unstable_now())},V)},n=function(){v(g),g=-1}}function z(E,V){var Y=E.length;E.push(V);e:for(;;){var ae=Y-1>>>1,ce=E[ae];if(ce!==void 0&&0<S(ce,V))E[ae]=V,E[Y]=ce,Y=ae;else break e}}function P(E){return E=E[0],E===void 0?null:E}function D(E){var V=E[0];if(V!==void 0){var Y=E.pop();if(Y!==V){E[0]=Y;e:for(var ae=0,ce=E.length;ae<ce;){var at=2*(ae+1)-1,lt=E[at],Ge=at+1,Oe=E[Ge];if(lt!==void 0&&0>S(lt,Y))Oe!==void 0&&0>S(Oe,lt)?(E[ae]=Oe,E[Ge]=Y,ae=Ge):(E[ae]=lt,E[at]=Y,ae=at);else if(Oe!==void 0&&0>S(Oe,Y))E[ae]=Oe,E[Ge]=Y,ae=Ge;else break e}}return V}return null}function S(E,V){var Y=E.sortIndex-V.sortIndex;return Y!==0?Y:E.id-V.id}var N=[],I=[],U=1,$=null,F=3,pe=!1,X=!1,Ae=!1;function Ee(E){for(var V=P(I);V!==null;){if(V.callback===null)D(I);else if(V.startTime<=E)D(I),V.sortIndex=V.expirationTime,z(N,V);else break;V=P(I)}}function Mt(E){if(Ae=!1,Ee(E),!X)if(P(N)!==null)X=!0,e(St);else{var V=P(I);V!==null&&i(Mt,V.startTime-E)}}function St(E,V){X=!1,Ae&&(Ae=!1,n()),pe=!0;var Y=F;try{for(Ee(V),$=P(N);$!==null&&(!($.expirationTime>V)||E&&!r());){var ae=$.callback;if(ae!==null){$.callback=null,F=$.priorityLevel;var ce=ae($.expirationTime<=V);V=t.unstable_now(),typeof ce=="function"?$.callback=ce:$===P(N)&&D(N),Ee(V)}else D(N);$=P(N)}if($!==null)var at=!0;else{var lt=P(I);lt!==null&&i(Mt,lt.startTime-V),at=!1}return at}finally{$=null,F=Y,pe=!1}}function ki(E){switch(E){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var wn=s;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(E){E.callback=null},t.unstable_continueExecution=function(){X||pe||(X=!0,e(St))},t.unstable_getCurrentPriorityLevel=function(){return F},t.unstable_getFirstCallbackNode=function(){return P(N)},t.unstable_next=function(E){switch(F){case 1:case 2:case 3:var V=3;break;default:V=F}var Y=F;F=V;try{return E()}finally{F=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=wn,t.unstable_runWithPriority=function(E,V){switch(E){case 1:case 2:case 3:case 4:case 5:break;default:E=3}var Y=F;F=E;try{return V()}finally{F=Y}},t.unstable_scheduleCallback=function(E,V,Y){var ae=t.unstable_now();if(typeof Y=="object"&&Y!==null){var ce=Y.delay;ce=typeof ce=="number"&&0<ce?ae+ce:ae,Y=typeof Y.timeout=="number"?Y.timeout:ki(E)}else Y=ki(E),ce=ae;return Y=ce+Y,E={id:U++,callback:V,priorityLevel:E,startTime:ce,expirationTime:Y,sortIndex:-1},ce>ae?(E.sortIndex=ce,z(I,E),P(N)===null&&E===P(I)&&(Ae?n():Ae=!0,i(Mt,ce-ae))):(E.sortIndex=Y,z(N,E),X||pe||(X=!0,e(St))),E},t.unstable_shouldYield=function(){var E=t.unstable_now();Ee(E);var V=P(N);return V!==$&&$!==null&&V!==null&&V.callback!==null&&V.startTime<=E&&V.expirationTime<$.expirationTime||r()},t.unstable_wrapCallback=function(E){var V=F;return function(){var Y=F;F=V;try{return E.apply(this,arguments)}finally{F=Y}}}})(Np);Tp.exports=Np;/** @license React v16.14.0
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ao=Ti.exports,Pe=mp,xe=Tp.exports;function C(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!ao)throw Error(C(227));function ax(t,e,i,n,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(i,u)}catch(c){this.onError(c)}}var Un=!1,bs=null,As=!1,ya=null,lx={onError:function(t){Un=!0,bs=t}};function ux(t,e,i,n,r,s,o,a,l){Un=!1,bs=null,ax.apply(lx,arguments)}function cx(t,e,i,n,r,s,o,a,l){if(ux.apply(this,arguments),Un){if(Un){var u=bs;Un=!1,bs=null}else throw Error(C(198));As||(As=!0,ya=u)}}var Ql=null,Pp=null,kp=null;function Dc(t,e,i){var n=t.type||"unknown-event";t.currentTarget=kp(i),cx(n,e,void 0,t),t.currentTarget=null}var Es=null,$i={};function Bp(){if(Es)for(var t in $i){var e=$i[t],i=Es.indexOf(t);if(!(-1<i))throw Error(C(96,t));if(!Ts[i]){if(!e.extractEvents)throw Error(C(97,t));Ts[i]=e,i=e.eventTypes;for(var n in i){var r=void 0,s=i[n],o=e,a=n;if(xa.hasOwnProperty(a))throw Error(C(99,a));xa[a]=s;var l=s.phasedRegistrationNames;if(l){for(r in l)l.hasOwnProperty(r)&&zc(l[r],o,a);r=!0}else s.registrationName?(zc(s.registrationName,o,a),r=!0):r=!1;if(!r)throw Error(C(98,n,t))}}}}function zc(t,e,i){if(an[t])throw Error(C(100,t));an[t]=e,Gl[t]=e.eventTypes[i].dependencies}var Ts=[],xa={},an={},Gl={};function Dp(t){var e=!1,i;for(i in t)if(t.hasOwnProperty(i)){var n=t[i];if(!$i.hasOwnProperty(i)||$i[i]!==n){if($i[i])throw Error(C(102,i));$i[i]=n,e=!0}}e&&Bp()}var ni=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),Ma=null,Ji=null,Ki=null;function _c(t){if(t=Pp(t)){if(typeof Ma!="function")throw Error(C(280));var e=t.stateNode;e&&(e=Ql(e),Ma(t.stateNode,t.type,e))}}function zp(t){Ji?Ki?Ki.push(t):Ki=[t]:Ji=t}function _p(){if(Ji){var t=Ji,e=Ki;if(Ki=Ji=null,_c(t),e)for(t=0;t<e.length;t++)_c(e[t])}}function Yl(t,e){return t(e)}function Lp(t,e,i,n,r){return t(e,i,n,r)}function Xl(){}var jp=Yl,li=!1,jo=!1;function Jl(){(Ji!==null||Ki!==null)&&(Xl(),_p())}function Rp(t,e,i){if(jo)return t(e,i);jo=!0;try{return jp(t,e,i)}finally{jo=!1,Jl()}}var dx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Lc=Object.prototype.hasOwnProperty,jc={},Rc={};function hx(t){return Lc.call(Rc,t)?!0:Lc.call(jc,t)?!1:dx.test(t)?Rc[t]=!0:(jc[t]=!0,!1)}function px(t,e,i,n){if(i!==null&&i.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:i!==null?!i.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function fx(t,e,i,n){if(e===null||typeof e=="undefined"||px(t,e,i,n))return!0;if(n)return!1;if(i!==null)switch(i.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ke(t,e,i,n,r,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=s}var Me={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Me[t]=new ke(t,0,!1,t,null,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Me[e]=new ke(e,1,!1,t[1],null,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Me[t]=new ke(t,2,!1,t.toLowerCase(),null,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Me[t]=new ke(t,2,!1,t,null,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Me[t]=new ke(t,3,!1,t.toLowerCase(),null,!1)});["checked","multiple","muted","selected"].forEach(function(t){Me[t]=new ke(t,3,!0,t,null,!1)});["capture","download"].forEach(function(t){Me[t]=new ke(t,4,!1,t,null,!1)});["cols","rows","size","span"].forEach(function(t){Me[t]=new ke(t,6,!1,t,null,!1)});["rowSpan","start"].forEach(function(t){Me[t]=new ke(t,5,!1,t.toLowerCase(),null,!1)});var Kl=/[\-:]([a-z])/g;function ql(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Kl,ql);Me[e]=new ke(e,1,!1,t,null,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Kl,ql);Me[e]=new ke(e,1,!1,t,"http://www.w3.org/1999/xlink",!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Kl,ql);Me[e]=new ke(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1)});["tabIndex","crossOrigin"].forEach(function(t){Me[t]=new ke(t,1,!1,t.toLowerCase(),null,!1)});Me.xlinkHref=new ke("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0);["src","href","action","formAction"].forEach(function(t){Me[t]=new ke(t,1,!1,t.toLowerCase(),null,!0)});var rt=ao.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;rt.hasOwnProperty("ReactCurrentDispatcher")||(rt.ReactCurrentDispatcher={current:null});rt.hasOwnProperty("ReactCurrentBatchConfig")||(rt.ReactCurrentBatchConfig={suspense:null});function eu(t,e,i,n){var r=Me.hasOwnProperty(e)?Me[e]:null,s=r!==null?r.type===0:n?!1:!(!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N");s||(fx(e,i,r,n)&&(i=null),n||r===null?hx(e)&&(i===null?t.removeAttribute(e):t.setAttribute(e,""+i)):r.mustUseProperty?t[r.propertyName]=i===null?r.type===3?!1:"":i:(e=r.attributeName,n=r.attributeNamespace,i===null?t.removeAttribute(e):(r=r.type,i=r===3||r===4&&i===!0?"":""+i,n?t.setAttributeNS(n,e,i):t.setAttribute(e,i))))}var gx=/^(.*)[\\\/]/,Ve=typeof Symbol=="function"&&Symbol.for,Or=Ve?Symbol.for("react.element"):60103,Fi=Ve?Symbol.for("react.portal"):60106,ai=Ve?Symbol.for("react.fragment"):60107,Vp=Ve?Symbol.for("react.strict_mode"):60108,ns=Ve?Symbol.for("react.profiler"):60114,Op=Ve?Symbol.for("react.provider"):60109,$p=Ve?Symbol.for("react.context"):60110,mx=Ve?Symbol.for("react.concurrent_mode"):60111,tu=Ve?Symbol.for("react.forward_ref"):60112,rs=Ve?Symbol.for("react.suspense"):60113,Sa=Ve?Symbol.for("react.suspense_list"):60120,iu=Ve?Symbol.for("react.memo"):60115,Fp=Ve?Symbol.for("react.lazy"):60116,Wp=Ve?Symbol.for("react.block"):60121,Vc=typeof Symbol=="function"&&Symbol.iterator;function In(t){return t===null||typeof t!="object"?null:(t=Vc&&t[Vc]||t["@@iterator"],typeof t=="function"?t:null)}function vx(t){if(t._status===-1){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then(function(i){t._status===0&&(i=i.default,t._status=1,t._result=i)},function(i){t._status===0&&(t._status=2,t._result=i)})}}function Dt(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ai:return"Fragment";case Fi:return"Portal";case ns:return"Profiler";case Vp:return"StrictMode";case rs:return"Suspense";case Sa:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case $p:return"Context.Consumer";case Op:return"Context.Provider";case tu:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case iu:return Dt(t.type);case Wp:return Dt(t.render);case Fp:if(t=t._status===1?t._result:null)return Dt(t)}return null}function nu(t){var e="";do{e:switch(t.tag){case 3:case 4:case 6:case 7:case 10:case 9:var i="";break e;default:var n=t._debugOwner,r=t._debugSource,s=Dt(t.type);i=null,n&&(i=Dt(n.type)),n=s,s="",r?s=" (at "+r.fileName.replace(gx,"")+":"+r.lineNumber+")":i&&(s=" (created by "+i+")"),i=`
    in `+(n||"Unknown")+s}e+=i,t=t.return}while(t);return e}function Kt(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function Up(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wx(t){var e=Up(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof i!="undefined"&&typeof i.get=="function"&&typeof i.set=="function"){var r=i.get,s=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function $r(t){t._valueTracker||(t._valueTracker=wx(t))}function Hp(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),n="";return t&&(n=Up(t)?t.checked?"true":"false":t.value),t=n,t!==i?(e.setValue(t),!0):!1}function Ia(t,e){var i=e.checked;return Pe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i!=null?i:t._wrapperState.initialChecked})}function Oc(t,e){var i=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;i=Kt(e.value!=null?e.value:i),t._wrapperState={initialChecked:n,initialValue:i,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Zp(t,e){e=e.checked,e!=null&&eu(t,"checked",e,!1)}function Ca(t,e){Zp(t,e);var i=Kt(e.value),n=e.type;if(i!=null)n==="number"?(i===0&&t.value===""||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ba(t,e.type,i):e.hasOwnProperty("defaultValue")&&ba(t,e.type,Kt(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function $c(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}i=t.name,i!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,i!==""&&(t.name=i)}function ba(t,e,i){(e!=="number"||t.ownerDocument.activeElement!==t)&&(i==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}function yx(t){var e="";return ao.Children.forEach(t,function(i){i!=null&&(e+=i)}),e}function Aa(t,e){return t=Pe({children:void 0},e),(e=yx(e.children))&&(t.children=e),t}function qi(t,e,i,n){if(t=t.options,e){e={};for(var r=0;r<i.length;r++)e["$"+i[r]]=!0;for(i=0;i<t.length;i++)r=e.hasOwnProperty("$"+t[i].value),t[i].selected!==r&&(t[i].selected=r),r&&n&&(t[i].defaultSelected=!0)}else{for(i=""+Kt(i),e=null,r=0;r<t.length;r++){if(t[r].value===i){t[r].selected=!0,n&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Ea(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(C(91));return Pe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Fc(t,e){var i=e.value;if(i==null){if(i=e.children,e=e.defaultValue,i!=null){if(e!=null)throw Error(C(92));if(Array.isArray(i)){if(!(1>=i.length))throw Error(C(93));i=i[0]}e=i}e==null&&(e=""),i=e}t._wrapperState={initialValue:Kt(i)}}function Qp(t,e){var i=Kt(e.value),n=Kt(e.defaultValue);i!=null&&(i=""+i,i!==t.value&&(t.value=i),e.defaultValue==null&&t.defaultValue!==i&&(t.defaultValue=i)),n!=null&&(t.defaultValue=""+n)}function Wc(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}var Gp={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function Yp(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ta(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Yp(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Fr,Xp=function(t){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(e,i,n,r){MSApp.execUnsafeLocalFunction(function(){return t(e,i,n,r)})}:t}(function(t,e){if(t.namespaceURI!==Gp.svg||"innerHTML"in t)t.innerHTML=e;else{for(Fr=Fr||document.createElement("div"),Fr.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fr.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function sr(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&i.nodeType===3){i.nodeValue=e;return}}t.textContent=e}function Wr(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var Wi={animationend:Wr("Animation","AnimationEnd"),animationiteration:Wr("Animation","AnimationIteration"),animationstart:Wr("Animation","AnimationStart"),transitionend:Wr("Transition","TransitionEnd")},Ro={},Jp={};ni&&(Jp=document.createElement("div").style,"AnimationEvent"in window||(delete Wi.animationend.animation,delete Wi.animationiteration.animation,delete Wi.animationstart.animation),"TransitionEvent"in window||delete Wi.transitionend.transition);function lo(t){if(Ro[t])return Ro[t];if(!Wi[t])return t;var e=Wi[t],i;for(i in e)if(e.hasOwnProperty(i)&&i in Jp)return Ro[t]=e[i];return t}var Kp=lo("animationend"),qp=lo("animationiteration"),ef=lo("animationstart"),tf=lo("transitionend"),Dn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Uc=new(typeof WeakMap=="function"?WeakMap:Map);function ru(t){var e=Uc.get(t);return e===void 0&&(e=new Map,Uc.set(t,e)),e}function Ni(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,(e.effectTag&1026)!==0&&(i=e.return),t=e.return;while(t)}return e.tag===3?i:null}function nf(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Hc(t){if(Ni(t)!==t)throw Error(C(188))}function xx(t){var e=t.alternate;if(!e){if(e=Ni(t),e===null)throw Error(C(188));return e!==t?null:t}for(var i=t,n=e;;){var r=i.return;if(r===null)break;var s=r.alternate;if(s===null){if(n=r.return,n!==null){i=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===i)return Hc(r),t;if(s===n)return Hc(r),e;s=s.sibling}throw Error(C(188))}if(i.return!==n.return)i=r,n=s;else{for(var o=!1,a=r.child;a;){if(a===i){o=!0,i=r,n=s;break}if(a===n){o=!0,n=r,i=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===i){o=!0,i=s,n=r;break}if(a===n){o=!0,n=s,i=r;break}a=a.sibling}if(!o)throw Error(C(189))}}if(i.alternate!==n)throw Error(C(190))}if(i.tag!==3)throw Error(C(188));return i.stateNode.current===i?t:e}function rf(t){if(t=xx(t),!t)return null;for(var e=t;;){if(e.tag===5||e.tag===6)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function ln(t,e){if(e==null)throw Error(C(30));return t==null?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function su(t,e,i){Array.isArray(t)?t.forEach(e,i):t&&e.call(i,t)}var Cn=null;function Mx(t){if(t){var e=t._dispatchListeners,i=t._dispatchInstances;if(Array.isArray(e))for(var n=0;n<e.length&&!t.isPropagationStopped();n++)Dc(t,e[n],i[n]);else e&&Dc(t,e,i);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function uo(t){if(t!==null&&(Cn=ln(Cn,t)),t=Cn,Cn=null,t){if(su(t,Mx),Cn)throw Error(C(95));if(As)throw t=ya,As=!1,ya=null,t}}function ou(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}function sf(t){if(!ni)return!1;t="on"+t;var e=t in document;return e||(e=document.createElement("div"),e.setAttribute(t,"return;"),e=typeof e[t]=="function"),e}var Ns=[];function of(t){t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>Ns.length&&Ns.push(t)}function af(t,e,i,n){if(Ns.length){var r=Ns.pop();return r.topLevelType=t,r.eventSystemFlags=n,r.nativeEvent=e,r.targetInst=i,r}return{topLevelType:t,eventSystemFlags:n,nativeEvent:e,targetInst:i,ancestors:[]}}function lf(t){var e=t.targetInst,i=e;do{if(!i){t.ancestors.push(i);break}var n=i;if(n.tag===3)n=n.stateNode.containerInfo;else{for(;n.return;)n=n.return;n=n.tag!==3?null:n.stateNode.containerInfo}if(!n)break;e=i.tag,e!==5&&e!==6||t.ancestors.push(i),i=Ir(n)}while(i);for(i=0;i<t.ancestors.length;i++){e=t.ancestors[i];var r=ou(t.nativeEvent);n=t.topLevelType;var s=t.nativeEvent,o=t.eventSystemFlags;i===0&&(o|=64);for(var a=null,l=0;l<Ts.length;l++){var u=Ts[l];u&&(u=u.extractEvents(n,e,s,r,o))&&(a=ln(a,u))}uo(a)}}function Na(t,e,i){if(!i.has(t)){switch(t){case"scroll":zn(e,"scroll",!0);break;case"focus":case"blur":zn(e,"focus",!0),zn(e,"blur",!0),i.set("blur",null),i.set("focus",null);break;case"cancel":case"close":sf(t)&&zn(e,t,!0);break;case"invalid":case"submit":case"reset":break;default:Dn.indexOf(t)===-1&&le(t,e)}i.set(t,null)}}var uf,au,cf,Pa=!1,ft=[],Ht=null,Zt=null,Qt=null,or=new Map,ar=new Map,bn=[],ka="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Sx="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function Ix(t,e){var i=ru(e);ka.forEach(function(n){Na(n,e,i)}),Sx.forEach(function(n){Na(n,e,i)})}function Ba(t,e,i,n,r){return{blockedOn:t,topLevelType:e,eventSystemFlags:i|32,nativeEvent:r,container:n}}function Zc(t,e){switch(t){case"focus":case"blur":Ht=null;break;case"dragenter":case"dragleave":Zt=null;break;case"mouseover":case"mouseout":Qt=null;break;case"pointerover":case"pointerout":or.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ar.delete(e.pointerId)}}function An(t,e,i,n,r,s){return t===null||t.nativeEvent!==s?(t=Ba(e,i,n,r,s),e!==null&&(e=Cr(e),e!==null&&au(e)),t):(t.eventSystemFlags|=n,t)}function Cx(t,e,i,n,r){switch(e){case"focus":return Ht=An(Ht,t,e,i,n,r),!0;case"dragenter":return Zt=An(Zt,t,e,i,n,r),!0;case"mouseover":return Qt=An(Qt,t,e,i,n,r),!0;case"pointerover":var s=r.pointerId;return or.set(s,An(or.get(s)||null,t,e,i,n,r)),!0;case"gotpointercapture":return s=r.pointerId,ar.set(s,An(ar.get(s)||null,t,e,i,n,r)),!0}return!1}function bx(t){var e=Ir(t.target);if(e!==null){var i=Ni(e);if(i!==null){if(e=i.tag,e===13){if(e=nf(i),e!==null){t.blockedOn=e,xe.unstable_runWithPriority(t.priority,function(){cf(i)});return}}else if(e===3&&i.stateNode.hydrate){t.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ss(t){if(t.blockedOn!==null)return!1;var e=cu(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);if(e!==null){var i=Cr(e);return i!==null&&au(i),t.blockedOn=e,!1}return!0}function Qc(t,e,i){ss(t)&&i.delete(e)}function Ax(){for(Pa=!1;0<ft.length;){var t=ft[0];if(t.blockedOn!==null){t=Cr(t.blockedOn),t!==null&&uf(t);break}var e=cu(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);e!==null?t.blockedOn=e:ft.shift()}Ht!==null&&ss(Ht)&&(Ht=null),Zt!==null&&ss(Zt)&&(Zt=null),Qt!==null&&ss(Qt)&&(Qt=null),or.forEach(Qc),ar.forEach(Qc)}function En(t,e){t.blockedOn===e&&(t.blockedOn=null,Pa||(Pa=!0,xe.unstable_scheduleCallback(xe.unstable_NormalPriority,Ax)))}function df(t){function e(r){return En(r,t)}if(0<ft.length){En(ft[0],t);for(var i=1;i<ft.length;i++){var n=ft[i];n.blockedOn===t&&(n.blockedOn=null)}}for(Ht!==null&&En(Ht,t),Zt!==null&&En(Zt,t),Qt!==null&&En(Qt,t),or.forEach(e),ar.forEach(e),i=0;i<bn.length;i++)n=bn[i],n.blockedOn===t&&(n.blockedOn=null);for(;0<bn.length&&(i=bn[0],i.blockedOn===null);)bx(i),i.blockedOn===null&&bn.shift()}var hf={},pf=new Map,lu=new Map,Ex=["abort","abort",Kp,"animationEnd",qp,"animationIteration",ef,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",tf,"transitionEnd","waiting","waiting"];function uu(t,e){for(var i=0;i<t.length;i+=2){var n=t[i],r=t[i+1],s="on"+(r[0].toUpperCase()+r.slice(1));s={phasedRegistrationNames:{bubbled:s,captured:s+"Capture"},dependencies:[n],eventPriority:e},lu.set(n,e),pf.set(n,s),hf[r]=s}}uu("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0);uu("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);uu(Ex,2);for(var Gc="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Vo=0;Vo<Gc.length;Vo++)lu.set(Gc[Vo],0);var Tx=xe.unstable_UserBlockingPriority,Nx=xe.unstable_runWithPriority,os=!0;function le(t,e){zn(e,t,!1)}function zn(t,e,i){var n=lu.get(e);switch(n===void 0?2:n){case 0:n=Px.bind(null,e,1,t);break;case 1:n=kx.bind(null,e,1,t);break;default:n=co.bind(null,e,1,t)}i?t.addEventListener(e,n,!0):t.addEventListener(e,n,!1)}function Px(t,e,i,n){li||Xl();var r=co,s=li;li=!0;try{Lp(r,t,e,i,n)}finally{(li=s)||Jl()}}function kx(t,e,i,n){Nx(Tx,co.bind(null,t,e,i,n))}function co(t,e,i,n){if(os)if(0<ft.length&&-1<ka.indexOf(t))t=Ba(null,t,e,i,n),ft.push(t);else{var r=cu(t,e,i,n);if(r===null)Zc(t,n);else if(-1<ka.indexOf(t))t=Ba(r,t,e,i,n),ft.push(t);else if(!Cx(r,t,e,i,n)){Zc(t,n),t=af(t,n,null,e);try{Rp(lf,t)}finally{of(t)}}}}function cu(t,e,i,n){if(i=ou(n),i=Ir(i),i!==null){var r=Ni(i);if(r===null)i=null;else{var s=r.tag;if(s===13){if(i=nf(r),i!==null)return i;i=null}else if(s===3){if(r.stateNode.hydrate)return r.tag===3?r.stateNode.containerInfo:null;i=null}else r!==i&&(i=null)}}t=af(t,n,i,e);try{Rp(lf,t)}finally{of(t)}return null}var Hn={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Bx=["Webkit","ms","Moz","O"];Object.keys(Hn).forEach(function(t){Bx.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Hn[e]=Hn[t]})});function ff(t,e,i){return e==null||typeof e=="boolean"||e===""?"":i||typeof e!="number"||e===0||Hn.hasOwnProperty(t)&&Hn[t]?(""+e).trim():e+"px"}function gf(t,e){t=t.style;for(var i in e)if(e.hasOwnProperty(i)){var n=i.indexOf("--")===0,r=ff(i,e[i],n);i==="float"&&(i="cssFloat"),n?t.setProperty(i,r):t[i]=r}}var Dx=Pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Da(t,e){if(e){if(Dx[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(C(137,t,""));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(C(60));if(!(typeof e.dangerouslySetInnerHTML=="object"&&"__html"in e.dangerouslySetInnerHTML))throw Error(C(61))}if(e.style!=null&&typeof e.style!="object")throw Error(C(62,""))}}function za(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yc=Gp.html;function Ct(t,e){t=t.nodeType===9||t.nodeType===11?t:t.ownerDocument;var i=ru(t);e=Gl[e];for(var n=0;n<e.length;n++)Na(e[n],t,i)}function Ps(){}function _a(t){if(t=t||(typeof document!="undefined"?document:void 0),typeof t=="undefined")return null;try{return t.activeElement||t.body}catch{return t.body}}function Xc(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Jc(t,e){var i=Xc(t);t=0;for(var n;i;){if(i.nodeType===3){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Xc(i)}}function mf(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?mf(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Kc(){for(var t=window,e=_a();e instanceof t.HTMLIFrameElement;){try{var i=typeof e.contentWindow.location.href=="string"}catch{i=!1}if(i)t=e.contentWindow;else break;e=_a(t.document)}return e}function La(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var vf="$",wf="/$",du="$?",hu="$!",Oo=null,$o=null;function yf(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function ja(t,e){return t==="textarea"||t==="option"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Fo=typeof setTimeout=="function"?setTimeout:void 0,zx=typeof clearTimeout=="function"?clearTimeout:void 0;function en(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break}return t}function qc(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var i=t.data;if(i===vf||i===hu||i===du){if(e===0)return t;e--}else i===wf&&e++}t=t.previousSibling}return null}var pu=Math.random().toString(36).slice(2),Rt="__reactInternalInstance$"+pu,ks="__reactEventHandlers$"+pu,Sr="__reactContainere$"+pu;function Ir(t){var e=t[Rt];if(e)return e;for(var i=t.parentNode;i;){if(e=i[Sr]||i[Rt]){if(i=e.alternate,e.child!==null||i!==null&&i.child!==null)for(t=qc(t);t!==null;){if(i=t[Rt])return i;t=qc(t)}return e}t=i,i=t.parentNode}return null}function Cr(t){return t=t[Rt]||t[Sr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Si(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(C(33))}function fu(t){return t[ks]||null}function bt(t){do t=t.return;while(t&&t.tag!==5);return t||null}function xf(t,e){var i=t.stateNode;if(!i)return null;var n=Ql(i);if(!n)return null;i=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(i&&typeof i!="function")throw Error(C(231,e,typeof i));return i}function ed(t,e,i){(e=xf(t,i.dispatchConfig.phasedRegistrationNames[e]))&&(i._dispatchListeners=ln(i._dispatchListeners,e),i._dispatchInstances=ln(i._dispatchInstances,t))}function _x(t){if(t&&t.dispatchConfig.phasedRegistrationNames){for(var e=t._targetInst,i=[];e;)i.push(e),e=bt(e);for(e=i.length;0<e--;)ed(i[e],"captured",t);for(e=0;e<i.length;e++)ed(i[e],"bubbled",t)}}function Ra(t,e,i){t&&i&&i.dispatchConfig.registrationName&&(e=xf(t,i.dispatchConfig.registrationName))&&(i._dispatchListeners=ln(i._dispatchListeners,e),i._dispatchInstances=ln(i._dispatchInstances,t))}function Lx(t){t&&t.dispatchConfig.registrationName&&Ra(t._targetInst,null,t)}function un(t){su(t,_x)}var Vt=null,gu=null,as=null;function Mf(){if(as)return as;var t,e=gu,i=e.length,n,r="value"in Vt?Vt.value:Vt.textContent,s=r.length;for(t=0;t<i&&e[t]===r[t];t++);var o=i-t;for(n=1;n<=o&&e[i-n]===r[s-n];n++);return as=r.slice(t,1<n?1-n:void 0)}function ls(){return!0}function Bs(){return!1}function Qe(t,e,i,n){this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=i,t=this.constructor.Interface;for(var r in t)t.hasOwnProperty(r)&&((e=t[r])?this[r]=e(i):r==="target"?this.target=n:this[r]=i[r]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ls:Bs,this.isPropagationStopped=Bs,this}Pe(Qe.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=ls)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=ls)},persist:function(){this.isPersistent=ls},isPersistent:Bs,destructor:function(){var t=this.constructor.Interface,e;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Bs,this._dispatchInstances=this._dispatchListeners=null}});Qe.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};Qe.extend=function(t){function e(){}function i(){return n.apply(this,arguments)}var n=this;e.prototype=n.prototype;var r=new e;return Pe(r,i.prototype),i.prototype=r,i.prototype.constructor=i,i.Interface=Pe({},n.Interface,t),i.extend=n.extend,Sf(i),i};Sf(Qe);function jx(t,e,i,n){if(this.eventPool.length){var r=this.eventPool.pop();return this.call(r,t,e,i,n),r}return new this(t,e,i,n)}function Rx(t){if(!(t instanceof this))throw Error(C(279));t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function Sf(t){t.eventPool=[],t.getPooled=jx,t.release=Rx}var Vx=Qe.extend({data:null}),Ox=Qe.extend({data:null}),$x=[9,13,27,32],mu=ni&&"CompositionEvent"in window,Zn=null;ni&&"documentMode"in document&&(Zn=document.documentMode);var Fx=ni&&"TextEvent"in window&&!Zn,If=ni&&(!mu||Zn&&8<Zn&&11>=Zn),td=String.fromCharCode(32),It={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},id=!1;function Cf(t,e){switch(t){case"keyup":return $x.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function bf(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ui=!1;function Wx(t,e){switch(t){case"compositionend":return bf(e);case"keypress":return e.which!==32?null:(id=!0,td);case"textInput":return t=e.data,t===td&&id?null:t;default:return null}}function Ux(t,e){if(Ui)return t==="compositionend"||!mu&&Cf(t,e)?(t=Mf(),as=gu=Vt=null,Ui=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return If&&e.locale!=="ko"?null:e.data;default:return null}}var Hx={eventTypes:It,extractEvents:function(t,e,i,n){var r;if(mu)e:{switch(t){case"compositionstart":var s=It.compositionStart;break e;case"compositionend":s=It.compositionEnd;break e;case"compositionupdate":s=It.compositionUpdate;break e}s=void 0}else Ui?Cf(t,i)&&(s=It.compositionEnd):t==="keydown"&&i.keyCode===229&&(s=It.compositionStart);return s?(If&&i.locale!=="ko"&&(Ui||s!==It.compositionStart?s===It.compositionEnd&&Ui&&(r=Mf()):(Vt=n,gu="value"in Vt?Vt.value:Vt.textContent,Ui=!0)),s=Vx.getPooled(s,e,i,n),r?s.data=r:(r=bf(i),r!==null&&(s.data=r)),un(s),r=s):r=null,(t=Fx?Wx(t,i):Ux(t,i))?(e=Ox.getPooled(It.beforeInput,e,i,n),e.data=t,un(e)):e=null,r===null?e:e===null?r:[r,e]}},Zx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Af(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Zx[t.type]:e==="textarea"}var Ef={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function Tf(t,e,i){return t=Qe.getPooled(Ef.change,t,e,i),t.type="change",zp(i),un(t),t}var Qn=null,lr=null;function Qx(t){uo(t)}function ho(t){var e=Si(t);if(Hp(e))return t}function Gx(t,e){if(t==="change")return e}var Va=!1;ni&&(Va=sf("input")&&(!document.documentMode||9<document.documentMode));function nd(){Qn&&(Qn.detachEvent("onpropertychange",Nf),lr=Qn=null)}function Nf(t){if(t.propertyName==="value"&&ho(lr))if(t=Tf(lr,t,ou(t)),li)uo(t);else{li=!0;try{Yl(Qx,t)}finally{li=!1,Jl()}}}function Yx(t,e,i){t==="focus"?(nd(),Qn=e,lr=i,Qn.attachEvent("onpropertychange",Nf)):t==="blur"&&nd()}function Xx(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ho(lr)}function Jx(t,e){if(t==="click")return ho(e)}function Kx(t,e){if(t==="input"||t==="change")return ho(e)}var qx={eventTypes:Ef,_isInputEventSupported:Va,extractEvents:function(t,e,i,n){var r=e?Si(e):window,s=r.nodeName&&r.nodeName.toLowerCase();if(s==="select"||s==="input"&&r.type==="file")var o=Gx;else if(Af(r))if(Va)o=Kx;else{o=Xx;var a=Yx}else(s=r.nodeName)&&s.toLowerCase()==="input"&&(r.type==="checkbox"||r.type==="radio")&&(o=Jx);if(o&&(o=o(t,e)))return Tf(o,i,n);a&&a(t,r,e),t==="blur"&&(t=r._wrapperState)&&t.controlled&&r.type==="number"&&ba(r,"number",r.value)}},br=Qe.extend({view:null,detail:null}),eM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tM(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=eM[t])?!!e[t]:!1}function vu(){return tM}var rd=0,sd=0,od=!1,ad=!1,Ar=br.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:vu,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},movementX:function(t){if("movementX"in t)return t.movementX;var e=rd;return rd=t.screenX,od?t.type==="mousemove"?t.screenX-e:0:(od=!0,0)},movementY:function(t){if("movementY"in t)return t.movementY;var e=sd;return sd=t.screenY,ad?t.type==="mousemove"?t.screenY-e:0:(ad=!0,0)}}),Pf=Ar.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Tn={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},iM={eventTypes:Tn,extractEvents:function(t,e,i,n,r){var s=t==="mouseover"||t==="pointerover",o=t==="mouseout"||t==="pointerout";if(s&&(r&32)===0&&(i.relatedTarget||i.fromElement)||!o&&!s)return null;if(s=n.window===n?n:(s=n.ownerDocument)?s.defaultView||s.parentWindow:window,o){if(o=e,e=(e=i.relatedTarget||i.toElement)?Ir(e):null,e!==null){var a=Ni(e);(e!==a||e.tag!==5&&e.tag!==6)&&(e=null)}}else o=null;if(o===e)return null;if(t==="mouseout"||t==="mouseover")var l=Ar,u=Tn.mouseLeave,c=Tn.mouseEnter,d="mouse";else(t==="pointerout"||t==="pointerover")&&(l=Pf,u=Tn.pointerLeave,c=Tn.pointerEnter,d="pointer");if(t=o==null?s:Si(o),s=e==null?s:Si(e),u=l.getPooled(u,o,i,n),u.type=d+"leave",u.target=t,u.relatedTarget=s,i=l.getPooled(c,e,i,n),i.type=d+"enter",i.target=s,i.relatedTarget=t,n=o,d=e,n&&d)e:{for(l=n,c=d,o=0,t=l;t;t=bt(t))o++;for(t=0,e=c;e;e=bt(e))t++;for(;0<o-t;)l=bt(l),o--;for(;0<t-o;)c=bt(c),t--;for(;o--;){if(l===c||l===c.alternate)break e;l=bt(l),c=bt(c)}l=null}else l=null;for(c=l,l=[];n&&n!==c&&(o=n.alternate,!(o!==null&&o===c));)l.push(n),n=bt(n);for(n=[];d&&d!==c&&(o=d.alternate,!(o!==null&&o===c));)n.push(d),d=bt(d);for(d=0;d<l.length;d++)Ra(l[d],"bubbled",u);for(d=n.length;0<d--;)Ra(n[d],"captured",i);return(r&64)===0?[u]:[u,i]}};function nM(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ii=typeof Object.is=="function"?Object.is:nM,rM=Object.prototype.hasOwnProperty;function ur(t,e){if(Ii(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++)if(!rM.call(e,i[n])||!Ii(t[i[n]],e[i[n]]))return!1;return!0}var sM=ni&&"documentMode"in document&&11>=document.documentMode,kf={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Hi=null,Oa=null,Gn=null,$a=!1;function ld(t,e){var i=e.window===e?e.document:e.nodeType===9?e:e.ownerDocument;return $a||Hi==null||Hi!==_a(i)?null:(i=Hi,"selectionStart"in i&&La(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Gn&&ur(Gn,i)?null:(Gn=i,t=Qe.getPooled(kf.select,Oa,t,e),t.type="select",t.target=Hi,un(t),t))}var oM={eventTypes:kf,extractEvents:function(t,e,i,n,r,s){if(r=s||(n.window===n?n.document:n.nodeType===9?n:n.ownerDocument),!(s=!r)){e:{r=ru(r),s=Gl.onSelect;for(var o=0;o<s.length;o++)if(!r.has(s[o])){r=!1;break e}r=!0}s=!r}if(s)return null;switch(r=e?Si(e):window,t){case"focus":(Af(r)||r.contentEditable==="true")&&(Hi=r,Oa=e,Gn=null);break;case"blur":Gn=Oa=Hi=null;break;case"mousedown":$a=!0;break;case"contextmenu":case"mouseup":case"dragend":return $a=!1,ld(i,n);case"selectionchange":if(sM)break;case"keydown":case"keyup":return ld(i,n)}return null}},aM=Qe.extend({animationName:null,elapsedTime:null,pseudoElement:null}),lM=Qe.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uM=br.extend({relatedTarget:null});function us(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}var cM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hM=br.extend({key:function(t){if(t.key){var e=cM[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=us(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?dM[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:vu,charCode:function(t){return t.type==="keypress"?us(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?us(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),pM=Ar.extend({dataTransfer:null}),fM=br.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:vu}),gM=Qe.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),mM=Ar.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),vM={eventTypes:hf,extractEvents:function(t,e,i,n){var r=pf.get(t);if(!r)return null;switch(t){case"keypress":if(us(i)===0)return null;case"keydown":case"keyup":t=hM;break;case"blur":case"focus":t=uM;break;case"click":if(i.button===2)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":t=Ar;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":t=pM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":t=fM;break;case Kp:case qp:case ef:t=aM;break;case tf:t=gM;break;case"scroll":t=br;break;case"wheel":t=mM;break;case"copy":case"cut":case"paste":t=lM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":t=Pf;break;default:t=Qe}return e=t.getPooled(r,e,i,n),un(e),e}};if(Es)throw Error(C(101));Es=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" "));Bp();var wM=Cr;Ql=fu;Pp=wM;kp=Si;Dp({SimpleEventPlugin:vM,EnterLeaveEventPlugin:iM,ChangeEventPlugin:qx,SelectEventPlugin:oM,BeforeInputEventPlugin:Hx});var Fa=[],Zi=-1;function oe(t){0>Zi||(t.current=Fa[Zi],Fa[Zi]=null,Zi--)}function he(t,e){Zi++,Fa[Zi]=t.current,t.current=e}var qt={},be={current:qt},Le={current:!1},Ci=qt;function cn(t,e){var i=t.type.contextTypes;if(!i)return qt;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in i)r[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function je(t){return t=t.childContextTypes,t!=null}function Ds(){oe(Le),oe(be)}function ud(t,e,i){if(be.current!==qt)throw Error(C(168));he(be,e),he(Le,i)}function Bf(t,e,i){var n=t.stateNode;if(t=e.childContextTypes,typeof n.getChildContext!="function")return i;n=n.getChildContext();for(var r in n)if(!(r in t))throw Error(C(108,Dt(e)||"Unknown",r));return Pe({},i,{},n)}function cs(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qt,Ci=be.current,he(be,t),he(Le,Le.current),!0}function cd(t,e,i){var n=t.stateNode;if(!n)throw Error(C(169));i?(t=Bf(t,e,Ci),n.__reactInternalMemoizedMergedChildContext=t,oe(Le),oe(be),he(be,t)):oe(Le),he(Le,i)}var yM=xe.unstable_runWithPriority,wu=xe.unstable_scheduleCallback,Df=xe.unstable_cancelCallback,dd=xe.unstable_requestPaint,Wa=xe.unstable_now,xM=xe.unstable_getCurrentPriorityLevel,po=xe.unstable_ImmediatePriority,zf=xe.unstable_UserBlockingPriority,_f=xe.unstable_NormalPriority,Lf=xe.unstable_LowPriority,jf=xe.unstable_IdlePriority,Rf={},MM=xe.unstable_shouldYield,SM=dd!==void 0?dd:function(){},Tt=null,ds=null,Wo=!1,hd=Wa(),Ye=1e4>hd?Wa:function(){return Wa()-hd};function fo(){switch(xM()){case po:return 99;case zf:return 98;case _f:return 97;case Lf:return 96;case jf:return 95;default:throw Error(C(332))}}function Vf(t){switch(t){case 99:return po;case 98:return zf;case 97:return _f;case 96:return Lf;case 95:return jf;default:throw Error(C(332))}}function ei(t,e){return t=Vf(t),yM(t,e)}function Of(t,e,i){return t=Vf(t),wu(t,e,i)}function pd(t){return Tt===null?(Tt=[t],ds=wu(po,$f)):Tt.push(t),Rf}function xt(){if(ds!==null){var t=ds;ds=null,Df(t)}$f()}function $f(){if(!Wo&&Tt!==null){Wo=!0;var t=0;try{var e=Tt;ei(99,function(){for(;t<e.length;t++){var i=e[t];do i=i(!0);while(i!==null)}}),Tt=null}catch(i){throw Tt!==null&&(Tt=Tt.slice(t+1)),wu(po,xt),i}finally{Wo=!1}}}function hs(t,e,i){return i/=10,1073741821-(((1073741821-t+e/10)/i|0)+1)*i}function it(t,e){if(t&&t.defaultProps){e=Pe({},e),t=t.defaultProps;for(var i in t)e[i]===void 0&&(e[i]=t[i])}return e}var zs={current:null},_s=null,Qi=null,Ls=null;function yu(){Ls=Qi=_s=null}function xu(t){var e=zs.current;oe(zs),t.type._context._currentValue=e}function Ff(t,e){for(;t!==null;){var i=t.alternate;if(t.childExpirationTime<e)t.childExpirationTime=e,i!==null&&i.childExpirationTime<e&&(i.childExpirationTime=e);else if(i!==null&&i.childExpirationTime<e)i.childExpirationTime=e;else break;t=t.return}}function tn(t,e){_s=t,Ls=Qi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.expirationTime>=e&&(gt=!0),t.firstContext=null)}function Ke(t,e){if(Ls!==t&&e!==!1&&e!==0)if((typeof e!="number"||e===1073741823)&&(Ls=t,e=1073741823),e={context:t,observedBits:e,next:null},Qi===null){if(_s===null)throw Error(C(308));Qi=e,_s.dependencies={expirationTime:0,firstContext:e,responders:null}}else Qi=Qi.next=e;return t._currentValue}var jt=!1;function Mu(t){t.updateQueue={baseState:t.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function Su(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,baseQueue:t.baseQueue,shared:t.shared,effects:t.effects})}function Gt(t,e){return t={expirationTime:t,suspenseConfig:e,tag:0,payload:null,callback:null,next:null},t.next=t}function Yt(t,e){if(t=t.updateQueue,t!==null){t=t.shared;var i=t.pending;i===null?e.next=e:(e.next=i.next,i.next=e),t.pending=e}}function fd(t,e){var i=t.alternate;i!==null&&Su(i,t),t=t.updateQueue,i=t.baseQueue,i===null?(t.baseQueue=e.next=e,e.next=e):(e.next=i.next,i.next=e)}function cr(t,e,i,n){var r=t.updateQueue;jt=!1;var s=r.baseQueue,o=r.shared.pending;if(o!==null){if(s!==null){var a=s.next;s.next=o.next,o.next=a}s=o,r.shared.pending=null,a=t.alternate,a!==null&&(a=a.updateQueue,a!==null&&(a.baseQueue=o))}if(s!==null){a=s.next;var l=r.baseState,u=0,c=null,d=null,f=null;if(a!==null){var v=a;do{if(o=v.expirationTime,o<n){var w={expirationTime:v.expirationTime,suspenseConfig:v.suspenseConfig,tag:v.tag,payload:v.payload,callback:v.callback,next:null};f===null?(d=f=w,c=l):f=f.next=w,o>u&&(u=o)}else{f!==null&&(f=f.next={expirationTime:1073741823,suspenseConfig:v.suspenseConfig,tag:v.tag,payload:v.payload,callback:v.callback,next:null}),wg(o,v.suspenseConfig);e:{var y=t,h=v;switch(o=e,w=i,h.tag){case 1:if(y=h.payload,typeof y=="function"){l=y.call(w,l,o);break e}l=y;break e;case 3:y.effectTag=y.effectTag&-4097|64;case 0:if(y=h.payload,o=typeof y=="function"?y.call(w,l,o):y,o==null)break e;l=Pe({},l,o);break e;case 2:jt=!0}}v.callback!==null&&(t.effectTag|=32,o=r.effects,o===null?r.effects=[v]:o.push(v))}if(v=v.next,v===null||v===a){if(o=r.shared.pending,o===null)break;v=s.next=o.next,o.next=a,r.baseQueue=s=o,r.shared.pending=null}}while(1)}f===null?c=l:f.next=d,r.baseState=c,r.baseQueue=f,yo(u),t.expirationTime=u,t.memoizedState=l}}function gd(t,e,i){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],r=n.callback;if(r!==null){if(n.callback=null,n=r,r=i,typeof n!="function")throw Error(C(191,n));n.call(r)}}}var Yn=rt.ReactCurrentBatchConfig,Wf=new ao.Component().refs;function js(t,e,i,n){e=t.memoizedState,i=i(n,e),i=i==null?e:Pe({},e,i),t.memoizedState=i,t.expirationTime===0&&(t.updateQueue.baseState=i)}var go={isMounted:function(t){return(t=t._reactInternalFiber)?Ni(t)===t:!1},enqueueSetState:function(t,e,i){t=t._reactInternalFiber;var n=wt(),r=Yn.suspense;n=wi(n,t,r),r=Gt(n,r),r.payload=e,i!=null&&(r.callback=i),Yt(t,r),Jt(t,n)},enqueueReplaceState:function(t,e,i){t=t._reactInternalFiber;var n=wt(),r=Yn.suspense;n=wi(n,t,r),r=Gt(n,r),r.tag=1,r.payload=e,i!=null&&(r.callback=i),Yt(t,r),Jt(t,n)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var i=wt(),n=Yn.suspense;i=wi(i,t,n),n=Gt(i,n),n.tag=2,e!=null&&(n.callback=e),Yt(t,n),Jt(t,i)}};function md(t,e,i,n,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!ur(i,n)||!ur(r,s):!0}function Uf(t,e,i){var n=!1,r=qt,s=e.contextType;return typeof s=="object"&&s!==null?s=Ke(s):(r=je(e)?Ci:be.current,n=e.contextTypes,s=(n=n!=null)?cn(t,r):qt),e=new e(i,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=go,t.stateNode=e,e._reactInternalFiber=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function vd(t,e,i,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(i,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(i,n),e.state!==t&&go.enqueueReplaceState(e,e.state,null)}function Ua(t,e,i,n){var r=t.stateNode;r.props=i,r.state=t.memoizedState,r.refs=Wf,Mu(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Ke(s):(s=je(e)?Ci:be.current,r.context=cn(t,s)),cr(t,i,r,n),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(js(t,e,s,i),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&go.enqueueReplaceState(r,r.state,null),cr(t,i,r,n),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.effectTag|=4)}var Ur=Array.isArray;function Nn(t,e,i){if(t=i.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(C(309));var n=i.stateNode}if(!n)throw Error(C(147,t));var r=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(s){var o=n.refs;o===Wf&&(o=n.refs={}),s===null?delete o[r]:o[r]=s},e._stringRef=r,e)}if(typeof t!="string")throw Error(C(284));if(!i._owner)throw Error(C(290,t))}return t}function Hr(t,e){if(t.type!=="textarea")throw Error(C(31,Object.prototype.toString.call(e)==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":e,""))}function Hf(t){function e(h,p){if(t){var g=h.lastEffect;g!==null?(g.nextEffect=p,h.lastEffect=p):h.firstEffect=h.lastEffect=p,p.nextEffect=null,p.effectTag=8}}function i(h,p){if(!t)return null;for(;p!==null;)e(h,p),p=p.sibling;return null}function n(h,p){for(h=new Map;p!==null;)p.key!==null?h.set(p.key,p):h.set(p.index,p),p=p.sibling;return h}function r(h,p){return h=bi(h,p),h.index=0,h.sibling=null,h}function s(h,p,g){return h.index=g,t?(g=h.alternate,g!==null?(g=g.index,g<p?(h.effectTag=2,p):g):(h.effectTag=2,p)):p}function o(h){return t&&h.alternate===null&&(h.effectTag=2),h}function a(h,p,g,m){return p===null||p.tag!==6?(p=Yo(g,h.mode,m),p.return=h,p):(p=r(p,g),p.return=h,p)}function l(h,p,g,m){return p!==null&&p.elementType===g.type?(m=r(p,g.props),m.ref=Nn(h,p,g),m.return=h,m):(m=ms(g.type,g.key,g.props,null,h.mode,m),m.ref=Nn(h,p,g),m.return=h,m)}function u(h,p,g,m){return p===null||p.tag!==4||p.stateNode.containerInfo!==g.containerInfo||p.stateNode.implementation!==g.implementation?(p=Xo(g,h.mode,m),p.return=h,p):(p=r(p,g.children||[]),p.return=h,p)}function c(h,p,g,m,x){return p===null||p.tag!==7?(p=Ft(g,h.mode,m,x),p.return=h,p):(p=r(p,g),p.return=h,p)}function d(h,p,g){if(typeof p=="string"||typeof p=="number")return p=Yo(""+p,h.mode,g),p.return=h,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Or:return g=ms(p.type,p.key,p.props,null,h.mode,g),g.ref=Nn(h,null,p),g.return=h,g;case Fi:return p=Xo(p,h.mode,g),p.return=h,p}if(Ur(p)||In(p))return p=Ft(p,h.mode,g,null),p.return=h,p;Hr(h,p)}return null}function f(h,p,g,m){var x=p!==null?p.key:null;if(typeof g=="string"||typeof g=="number")return x!==null?null:a(h,p,""+g,m);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Or:return g.key===x?g.type===ai?c(h,p,g.props.children,m,x):l(h,p,g,m):null;case Fi:return g.key===x?u(h,p,g,m):null}if(Ur(g)||In(g))return x!==null?null:c(h,p,g,m,null);Hr(h,g)}return null}function v(h,p,g,m,x){if(typeof m=="string"||typeof m=="number")return h=h.get(g)||null,a(p,h,""+m,x);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Or:return h=h.get(m.key===null?g:m.key)||null,m.type===ai?c(p,h,m.props.children,x,m.key):l(p,h,m,x);case Fi:return h=h.get(m.key===null?g:m.key)||null,u(p,h,m,x)}if(Ur(m)||In(m))return h=h.get(g)||null,c(p,h,m,x,null);Hr(p,m)}return null}function w(h,p,g,m){for(var x=null,M=null,T=p,z=p=0,P=null;T!==null&&z<g.length;z++){T.index>z?(P=T,T=null):P=T.sibling;var D=f(h,T,g[z],m);if(D===null){T===null&&(T=P);break}t&&T&&D.alternate===null&&e(h,T),p=s(D,p,z),M===null?x=D:M.sibling=D,M=D,T=P}if(z===g.length)return i(h,T),x;if(T===null){for(;z<g.length;z++)T=d(h,g[z],m),T!==null&&(p=s(T,p,z),M===null?x=T:M.sibling=T,M=T);return x}for(T=n(h,T);z<g.length;z++)P=v(T,h,z,g[z],m),P!==null&&(t&&P.alternate!==null&&T.delete(P.key===null?z:P.key),p=s(P,p,z),M===null?x=P:M.sibling=P,M=P);return t&&T.forEach(function(S){return e(h,S)}),x}function y(h,p,g,m){var x=In(g);if(typeof x!="function")throw Error(C(150));if(g=x.call(g),g==null)throw Error(C(151));for(var M=x=null,T=p,z=p=0,P=null,D=g.next();T!==null&&!D.done;z++,D=g.next()){T.index>z?(P=T,T=null):P=T.sibling;var S=f(h,T,D.value,m);if(S===null){T===null&&(T=P);break}t&&T&&S.alternate===null&&e(h,T),p=s(S,p,z),M===null?x=S:M.sibling=S,M=S,T=P}if(D.done)return i(h,T),x;if(T===null){for(;!D.done;z++,D=g.next())D=d(h,D.value,m),D!==null&&(p=s(D,p,z),M===null?x=D:M.sibling=D,M=D);return x}for(T=n(h,T);!D.done;z++,D=g.next())D=v(T,h,z,D.value,m),D!==null&&(t&&D.alternate!==null&&T.delete(D.key===null?z:D.key),p=s(D,p,z),M===null?x=D:M.sibling=D,M=D);return t&&T.forEach(function(N){return e(h,N)}),x}return function(h,p,g,m){var x=typeof g=="object"&&g!==null&&g.type===ai&&g.key===null;x&&(g=g.props.children);var M=typeof g=="object"&&g!==null;if(M)switch(g.$$typeof){case Or:e:{for(M=g.key,x=p;x!==null;){if(x.key===M){switch(x.tag){case 7:if(g.type===ai){i(h,x.sibling),p=r(x,g.props.children),p.return=h,h=p;break e}break;default:if(x.elementType===g.type){i(h,x.sibling),p=r(x,g.props),p.ref=Nn(h,x,g),p.return=h,h=p;break e}}i(h,x);break}else e(h,x);x=x.sibling}g.type===ai?(p=Ft(g.props.children,h.mode,m,g.key),p.return=h,h=p):(m=ms(g.type,g.key,g.props,null,h.mode,m),m.ref=Nn(h,p,g),m.return=h,h=m)}return o(h);case Fi:e:{for(x=g.key;p!==null;){if(p.key===x)if(p.tag===4&&p.stateNode.containerInfo===g.containerInfo&&p.stateNode.implementation===g.implementation){i(h,p.sibling),p=r(p,g.children||[]),p.return=h,h=p;break e}else{i(h,p);break}else e(h,p);p=p.sibling}p=Xo(g,h.mode,m),p.return=h,h=p}return o(h)}if(typeof g=="string"||typeof g=="number")return g=""+g,p!==null&&p.tag===6?(i(h,p.sibling),p=r(p,g),p.return=h,h=p):(i(h,p),p=Yo(g,h.mode,m),p.return=h,h=p),o(h);if(Ur(g))return w(h,p,g,m);if(In(g))return y(h,p,g,m);if(M&&Hr(h,g),typeof g=="undefined"&&!x)switch(h.tag){case 1:case 0:throw h=h.type,Error(C(152,h.displayName||h.name||"Component"))}return i(h,p)}}var dn=Hf(!0),Iu=Hf(!1),Er={},vt={current:Er},dr={current:Er},hr={current:Er};function ui(t){if(t===Er)throw Error(C(174));return t}function Ha(t,e){switch(he(hr,e),he(dr,t),he(vt,Er),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ta(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ta(e,t)}oe(vt),he(vt,e)}function hn(){oe(vt),oe(dr),oe(hr)}function wd(t){ui(hr.current);var e=ui(vt.current),i=Ta(e,t.type);e!==i&&(he(dr,t),he(vt,i))}function Cu(t){dr.current===t&&(oe(vt),oe(dr))}var ue={current:0};function Rs(t){for(var e=t;e!==null;){if(e.tag===13){var i=e.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data===du||i.data===hu))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.effectTag&64)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function bu(t,e){return{responder:t,props:e}}var ps=rt.ReactCurrentDispatcher,Xe=rt.ReactCurrentBatchConfig,Ot=0,fe=null,Ie=null,Ce=null,Vs=!1;function $e(){throw Error(C(321))}function Au(t,e){if(e===null)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!Ii(t[i],e[i]))return!1;return!0}function Eu(t,e,i,n,r,s){if(Ot=s,fe=e,e.memoizedState=null,e.updateQueue=null,e.expirationTime=0,ps.current=t===null||t.memoizedState===null?IM:CM,t=i(n,r),e.expirationTime===Ot){s=0;do{if(e.expirationTime=0,!(25>s))throw Error(C(301));s+=1,Ce=Ie=null,e.updateQueue=null,ps.current=bM,t=i(n,r)}while(e.expirationTime===Ot)}if(ps.current=Fs,e=Ie!==null&&Ie.next!==null,Ot=0,Ce=Ie=fe=null,Vs=!1,e)throw Error(C(300));return t}function nn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ce===null?fe.memoizedState=Ce=t:Ce=Ce.next=t,Ce}function mn(){if(Ie===null){var t=fe.alternate;t=t!==null?t.memoizedState:null}else t=Ie.next;var e=Ce===null?fe.memoizedState:Ce.next;if(e!==null)Ce=e,Ie=t;else{if(t===null)throw Error(C(310));Ie=t,t={memoizedState:Ie.memoizedState,baseState:Ie.baseState,baseQueue:Ie.baseQueue,queue:Ie.queue,next:null},Ce===null?fe.memoizedState=Ce=t:Ce=Ce.next=t}return Ce}function gi(t,e){return typeof e=="function"?e(t):e}function Zr(t){var e=mn(),i=e.queue;if(i===null)throw Error(C(311));i.lastRenderedReducer=t;var n=Ie,r=n.baseQueue,s=i.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,i.pending=null}if(r!==null){r=r.next,n=n.baseState;var a=o=s=null,l=r;do{var u=l.expirationTime;if(u<Ot){var c={expirationTime:l.expirationTime,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null};a===null?(o=a=c,s=n):a=a.next=c,u>fe.expirationTime&&(fe.expirationTime=u,yo(u))}else a!==null&&(a=a.next={expirationTime:1073741823,suspenseConfig:l.suspenseConfig,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),wg(u,l.suspenseConfig),n=l.eagerReducer===t?l.eagerState:t(n,l.action);l=l.next}while(l!==null&&l!==r);a===null?s=n:a.next=o,Ii(n,e.memoizedState)||(gt=!0),e.memoizedState=n,e.baseState=s,e.baseQueue=a,i.lastRenderedState=n}return[e.memoizedState,i.dispatch]}function Qr(t){var e=mn(),i=e.queue;if(i===null)throw Error(C(311));i.lastRenderedReducer=t;var n=i.dispatch,r=i.pending,s=e.memoizedState;if(r!==null){i.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);Ii(s,e.memoizedState)||(gt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),i.lastRenderedState=s}return[s,n]}function Uo(t){var e=nn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t=e.queue={pending:null,dispatch:null,lastRenderedReducer:gi,lastRenderedState:t},t=t.dispatch=Jf.bind(null,fe,t),[e.memoizedState,t]}function Za(t,e,i,n){return t={tag:t,create:e,destroy:i,deps:n,next:null},e=fe.updateQueue,e===null?(e={lastEffect:null},fe.updateQueue=e,e.lastEffect=t.next=t):(i=e.lastEffect,i===null?e.lastEffect=t.next=t:(n=i.next,i.next=t,t.next=n,e.lastEffect=t)),t}function Zf(){return mn().memoizedState}function Qa(t,e,i,n){var r=nn();fe.effectTag|=t,r.memoizedState=Za(1|e,i,void 0,n===void 0?null:n)}function Tu(t,e,i,n){var r=mn();n=n===void 0?null:n;var s=void 0;if(Ie!==null){var o=Ie.memoizedState;if(s=o.destroy,n!==null&&Au(n,o.deps)){Za(e,i,s,n);return}}fe.effectTag|=t,r.memoizedState=Za(1|e,i,s,n)}function yd(t,e){return Qa(516,4,t,e)}function Os(t,e){return Tu(516,4,t,e)}function Qf(t,e){return Tu(4,2,t,e)}function Gf(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Yf(t,e,i){return i=i!=null?i.concat([t]):null,Tu(4,2,Gf.bind(null,e,t),i)}function Nu(){}function xd(t,e){return nn().memoizedState=[t,e===void 0?null:e],t}function $s(t,e){var i=mn();e=e===void 0?null:e;var n=i.memoizedState;return n!==null&&e!==null&&Au(e,n[1])?n[0]:(i.memoizedState=[t,e],t)}function Xf(t,e){var i=mn();e=e===void 0?null:e;var n=i.memoizedState;return n!==null&&e!==null&&Au(e,n[1])?n[0]:(t=t(),i.memoizedState=[t,e],t)}function Pu(t,e,i){var n=fo();ei(98>n?98:n,function(){t(!0)}),ei(97<n?97:n,function(){var r=Xe.suspense;Xe.suspense=e===void 0?null:e;try{t(!1),i()}finally{Xe.suspense=r}})}function Jf(t,e,i){var n=wt(),r=Yn.suspense;n=wi(n,t,r),r={expirationTime:n,suspenseConfig:r,action:i,eagerReducer:null,eagerState:null,next:null};var s=e.pending;if(s===null?r.next=r:(r.next=s.next,s.next=r),e.pending=r,s=t.alternate,t===fe||s!==null&&s===fe)Vs=!0,r.expirationTime=Ot,fe.expirationTime=Ot;else{if(t.expirationTime===0&&(s===null||s.expirationTime===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,i);if(r.eagerReducer=s,r.eagerState=a,Ii(a,o))return}catch{}finally{}Jt(t,n)}}var Fs={readContext:Ke,useCallback:$e,useContext:$e,useEffect:$e,useImperativeHandle:$e,useLayoutEffect:$e,useMemo:$e,useReducer:$e,useRef:$e,useState:$e,useDebugValue:$e,useResponder:$e,useDeferredValue:$e,useTransition:$e},IM={readContext:Ke,useCallback:xd,useContext:Ke,useEffect:yd,useImperativeHandle:function(t,e,i){return i=i!=null?i.concat([t]):null,Qa(4,2,Gf.bind(null,e,t),i)},useLayoutEffect:function(t,e){return Qa(4,2,t,e)},useMemo:function(t,e){var i=nn();return e=e===void 0?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var n=nn();return e=i!==void 0?i(e):e,n.memoizedState=n.baseState=e,t=n.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},t=t.dispatch=Jf.bind(null,fe,t),[n.memoizedState,t]},useRef:function(t){var e=nn();return t={current:t},e.memoizedState=t},useState:Uo,useDebugValue:Nu,useResponder:bu,useDeferredValue:function(t,e){var i=Uo(t),n=i[0],r=i[1];return yd(function(){var s=Xe.suspense;Xe.suspense=e===void 0?null:e;try{r(t)}finally{Xe.suspense=s}},[t,e]),n},useTransition:function(t){var e=Uo(!1),i=e[0];return e=e[1],[xd(Pu.bind(null,e,t),[e,t]),i]}},CM={readContext:Ke,useCallback:$s,useContext:Ke,useEffect:Os,useImperativeHandle:Yf,useLayoutEffect:Qf,useMemo:Xf,useReducer:Zr,useRef:Zf,useState:function(){return Zr(gi)},useDebugValue:Nu,useResponder:bu,useDeferredValue:function(t,e){var i=Zr(gi),n=i[0],r=i[1];return Os(function(){var s=Xe.suspense;Xe.suspense=e===void 0?null:e;try{r(t)}finally{Xe.suspense=s}},[t,e]),n},useTransition:function(t){var e=Zr(gi),i=e[0];return e=e[1],[$s(Pu.bind(null,e,t),[e,t]),i]}},bM={readContext:Ke,useCallback:$s,useContext:Ke,useEffect:Os,useImperativeHandle:Yf,useLayoutEffect:Qf,useMemo:Xf,useReducer:Qr,useRef:Zf,useState:function(){return Qr(gi)},useDebugValue:Nu,useResponder:bu,useDeferredValue:function(t,e){var i=Qr(gi),n=i[0],r=i[1];return Os(function(){var s=Xe.suspense;Xe.suspense=e===void 0?null:e;try{r(t)}finally{Xe.suspense=s}},[t,e]),n},useTransition:function(t){var e=Qr(gi),i=e[0];return e=e[1],[$s(Pu.bind(null,e,t),[e,t]),i]}},kt=null,$t=null,mi=!1;function Kf(t,e){var i=mt(5,null,null,0);i.elementType="DELETED",i.type="DELETED",i.stateNode=e,i.return=t,i.effectTag=8,t.lastEffect!==null?(t.lastEffect.nextEffect=i,t.lastEffect=i):t.firstEffect=t.lastEffect=i}function Md(t,e){switch(t.tag){case 5:var i=t.type;return e=e.nodeType!==1||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,!0):!1;case 13:return!1;default:return!1}}function Ga(t){if(mi){var e=$t;if(e){var i=e;if(!Md(t,e)){if(e=en(i.nextSibling),!e||!Md(t,e)){t.effectTag=t.effectTag&-1025|2,mi=!1,kt=t;return}Kf(kt,i)}kt=t,$t=en(e.firstChild)}else t.effectTag=t.effectTag&-1025|2,mi=!1,kt=t}}function Sd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;kt=t}function Gr(t){if(t!==kt)return!1;if(!mi)return Sd(t),mi=!0,!1;var e=t.type;if(t.tag!==5||e!=="head"&&e!=="body"&&!ja(e,t.memoizedProps))for(e=$t;e;)Kf(t,e),e=en(e.nextSibling);if(Sd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(C(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var i=t.data;if(i===wf){if(e===0){$t=en(t.nextSibling);break e}e--}else i!==vf&&i!==hu&&i!==du||e++}t=t.nextSibling}$t=null}}else $t=kt?en(t.stateNode.nextSibling):null;return!0}function Ho(){$t=kt=null,mi=!1}var AM=rt.ReactCurrentOwner,gt=!1;function Fe(t,e,i,n){e.child=t===null?Iu(e,null,i,n):dn(e,t.child,i,n)}function Id(t,e,i,n,r){i=i.render;var s=e.ref;return tn(e,r),n=Eu(t,e,i,n,s,r),t!==null&&!gt?(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=r&&(t.expirationTime=0),Bt(t,e,r)):(e.effectTag|=1,Fe(t,e,n,r),e.child)}function Cd(t,e,i,n,r,s){if(t===null){var o=i.type;return typeof o=="function"&&!_u(o)&&o.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(e.tag=15,e.type=o,qf(t,e,o,n,r,s)):(t=ms(i.type,null,n,null,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}return o=t.child,r<s&&(r=o.memoizedProps,i=i.compare,i=i!==null?i:ur,i(r,n)&&t.ref===e.ref)?Bt(t,e,s):(e.effectTag|=1,t=bi(o,n),t.ref=e.ref,t.return=e,e.child=t)}function qf(t,e,i,n,r,s){return t!==null&&ur(t.memoizedProps,n)&&t.ref===e.ref&&(gt=!1,r<s)?(e.expirationTime=t.expirationTime,Bt(t,e,s)):Ya(t,e,i,n,s)}function eg(t,e){var i=e.ref;(t===null&&i!==null||t!==null&&t.ref!==i)&&(e.effectTag|=128)}function Ya(t,e,i,n,r){var s=je(i)?Ci:be.current;return s=cn(e,s),tn(e,r),i=Eu(t,e,i,n,s,r),t!==null&&!gt?(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=r&&(t.expirationTime=0),Bt(t,e,r)):(e.effectTag|=1,Fe(t,e,i,r),e.child)}function bd(t,e,i,n,r){if(je(i)){var s=!0;cs(e)}else s=!1;if(tn(e,r),e.stateNode===null)t!==null&&(t.alternate=null,e.alternate=null,e.effectTag|=2),Uf(e,i,n),Ua(e,i,n,r),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=i.contextType;typeof u=="object"&&u!==null?u=Ke(u):(u=je(i)?Ci:be.current,u=cn(e,u));var c=i.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==u)&&vd(e,o,n,u),jt=!1;var f=e.memoizedState;o.state=f,cr(e,n,o,r),l=e.memoizedState,a!==n||f!==l||Le.current||jt?(typeof c=="function"&&(js(e,i,c,n),l=e.memoizedState),(a=jt||md(e,i,a,n,f,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.effectTag|=4)):(typeof o.componentDidMount=="function"&&(e.effectTag|=4),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=u,n=a):(typeof o.componentDidMount=="function"&&(e.effectTag|=4),n=!1)}else o=e.stateNode,Su(t,e),a=e.memoizedProps,o.props=e.type===e.elementType?a:it(e.type,a),l=o.context,u=i.contextType,typeof u=="object"&&u!==null?u=Ke(u):(u=je(i)?Ci:be.current,u=cn(e,u)),c=i.getDerivedStateFromProps,(d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==u)&&vd(e,o,n,u),jt=!1,l=e.memoizedState,o.state=l,cr(e,n,o,r),f=e.memoizedState,a!==n||l!==f||Le.current||jt?(typeof c=="function"&&(js(e,i,c,n),f=e.memoizedState),(c=jt||md(e,i,a,n,l,f,u))?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,f,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,f,u)),typeof o.componentDidUpdate=="function"&&(e.effectTag|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.effectTag|=256)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),e.memoizedProps=n,e.memoizedState=f),o.props=n,o.state=f,o.context=u,n=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&l===t.memoizedState||(e.effectTag|=256),n=!1);return Xa(t,e,i,n,s,r)}function Xa(t,e,i,n,r,s){eg(t,e);var o=(e.effectTag&64)!==0;if(!n&&!o)return r&&cd(e,i,!1),Bt(t,e,s);n=e.stateNode,AM.current=e;var a=o&&typeof i.getDerivedStateFromError!="function"?null:n.render();return e.effectTag|=1,t!==null&&o?(e.child=dn(e,t.child,null,s),e.child=dn(e,null,a,s)):Fe(t,e,a,s),e.memoizedState=n.state,r&&cd(e,i,!0),e.child}function Ad(t){var e=t.stateNode;e.pendingContext?ud(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ud(t,e.context,!1),Ha(t,e.containerInfo)}var Zo={dehydrated:null,retryTime:0};function Ed(t,e,i){var n=e.mode,r=e.pendingProps,s=ue.current,o=!1,a;if((a=(e.effectTag&64)!==0)||(a=(s&2)!==0&&(t===null||t.memoizedState!==null)),a?(o=!0,e.effectTag&=-65):t!==null&&t.memoizedState===null||r.fallback===void 0||r.unstable_avoidThisFallback===!0||(s|=1),he(ue,s&1),t===null){if(r.fallback!==void 0&&Ga(e),o){if(o=r.fallback,r=Ft(null,n,0,null),r.return=e,(e.mode&2)===0)for(t=e.memoizedState!==null?e.child.child:e.child,r.child=t;t!==null;)t.return=r,t=t.sibling;return i=Ft(o,n,i,null),i.return=e,r.sibling=i,e.memoizedState=Zo,e.child=r,i}return n=r.children,e.memoizedState=null,e.child=Iu(e,null,n,i)}if(t.memoizedState!==null){if(t=t.child,n=t.sibling,o){if(r=r.fallback,i=bi(t,t.pendingProps),i.return=e,(e.mode&2)===0&&(o=e.memoizedState!==null?e.child.child:e.child,o!==t.child))for(i.child=o;o!==null;)o.return=i,o=o.sibling;return n=bi(n,r),n.return=e,i.sibling=n,i.childExpirationTime=0,e.memoizedState=Zo,e.child=i,n}return i=dn(e,t.child,r.children,i),e.memoizedState=null,e.child=i}if(t=t.child,o){if(o=r.fallback,r=Ft(null,n,0,null),r.return=e,r.child=t,t!==null&&(t.return=r),(e.mode&2)===0)for(t=e.memoizedState!==null?e.child.child:e.child,r.child=t;t!==null;)t.return=r,t=t.sibling;return i=Ft(o,n,i,null),i.return=e,r.sibling=i,i.effectTag|=2,r.childExpirationTime=0,e.memoizedState=Zo,e.child=r,i}return e.memoizedState=null,e.child=dn(e,t,r.children,i)}function Td(t,e){t.expirationTime<e&&(t.expirationTime=e);var i=t.alternate;i!==null&&i.expirationTime<e&&(i.expirationTime=e),Ff(t.return,e)}function Qo(t,e,i,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:i,tailExpiration:0,tailMode:r,lastEffect:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=i,o.tailExpiration=0,o.tailMode=r,o.lastEffect=s)}function Nd(t,e,i){var n=e.pendingProps,r=n.revealOrder,s=n.tail;if(Fe(t,e,n.children,i),n=ue.current,(n&2)!==0)n=n&1|2,e.effectTag|=64;else{if(t!==null&&(t.effectTag&64)!==0)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Td(t,i);else if(t.tag===19)Td(t,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(he(ue,n),(e.mode&2)===0)e.memoizedState=null;else switch(r){case"forwards":for(i=e.child,r=null;i!==null;)t=i.alternate,t!==null&&Rs(t)===null&&(r=i),i=i.sibling;i=r,i===null?(r=e.child,e.child=null):(r=i.sibling,i.sibling=null),Qo(e,!1,r,i,s,e.lastEffect);break;case"backwards":for(i=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Rs(t)===null){e.child=r;break}t=r.sibling,r.sibling=i,i=r,r=t}Qo(e,!0,i,null,s,e.lastEffect);break;case"together":Qo(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function Bt(t,e,i){t!==null&&(e.dependencies=t.dependencies);var n=e.expirationTime;if(n!==0&&yo(n),e.childExpirationTime<i)return null;if(t!==null&&e.child!==t.child)throw Error(C(153));if(e.child!==null){for(t=e.child,i=bi(t,t.pendingProps),e.child=i,i.return=e;t.sibling!==null;)t=t.sibling,i=i.sibling=bi(t,t.pendingProps),i.return=e;i.sibling=null}return e.child}var tg,Ja,ig,ng;tg=function(t,e){for(var i=e.child;i!==null;){if(i.tag===5||i.tag===6)t.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Ja=function(){};ig=function(t,e,i,n,r){var s=t.memoizedProps;if(s!==n){var o=e.stateNode;switch(ui(vt.current),t=null,i){case"input":s=Ia(o,s),n=Ia(o,n),t=[];break;case"option":s=Aa(o,s),n=Aa(o,n),t=[];break;case"select":s=Pe({},s,{value:void 0}),n=Pe({},n,{value:void 0}),t=[];break;case"textarea":s=Ea(o,s),n=Ea(o,n),t=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(o.onclick=Ps)}Da(i,n);var a,l;i=null;for(a in s)if(!n.hasOwnProperty(a)&&s.hasOwnProperty(a)&&s[a]!=null)if(a==="style")for(l in o=s[a],o)o.hasOwnProperty(l)&&(i||(i={}),i[l]="");else a!=="dangerouslySetInnerHTML"&&a!=="children"&&a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(an.hasOwnProperty(a)?t||(t=[]):(t=t||[]).push(a,null));for(a in n){var u=n[a];if(o=s!=null?s[a]:void 0,n.hasOwnProperty(a)&&u!==o&&(u!=null||o!=null))if(a==="style")if(o){for(l in o)!o.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(i||(i={}),i[l]="");for(l in u)u.hasOwnProperty(l)&&o[l]!==u[l]&&(i||(i={}),i[l]=u[l])}else i||(t||(t=[]),t.push(a,i)),i=u;else a==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(t=t||[]).push(a,u)):a==="children"?o===u||typeof u!="string"&&typeof u!="number"||(t=t||[]).push(a,""+u):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&(an.hasOwnProperty(a)?(u!=null&&Ct(r,a),t||o===u||(t=[])):(t=t||[]).push(a,u))}i&&(t=t||[]).push("style",i),r=t,(e.updateQueue=r)&&(e.effectTag|=4)}};ng=function(t,e,i,n){i!==n&&(e.effectTag|=4)};function Yr(t,e){switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var n=null;i!==null;)i.alternate!==null&&(n=i),i=i.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function EM(t,e,i){var n=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return je(e.type)&&Ds(),null;case 3:return hn(),oe(Le),oe(be),i=e.stateNode,i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),t!==null&&t.child!==null||!Gr(e)||(e.effectTag|=4),Ja(e),null;case 5:Cu(e),i=ui(hr.current);var r=e.type;if(t!==null&&e.stateNode!=null)ig(t,e,r,n,i),t.ref!==e.ref&&(e.effectTag|=128);else{if(!n){if(e.stateNode===null)throw Error(C(166));return null}if(t=ui(vt.current),Gr(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Rt]=e,n[ks]=s,r){case"iframe":case"object":case"embed":le("load",n);break;case"video":case"audio":for(t=0;t<Dn.length;t++)le(Dn[t],n);break;case"source":le("error",n);break;case"img":case"image":case"link":le("error",n),le("load",n);break;case"form":le("reset",n),le("submit",n);break;case"details":le("toggle",n);break;case"input":Oc(n,s),le("invalid",n),Ct(i,"onChange");break;case"select":n._wrapperState={wasMultiple:!!s.multiple},le("invalid",n),Ct(i,"onChange");break;case"textarea":Fc(n,s),le("invalid",n),Ct(i,"onChange")}Da(r,s),t=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(t=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(t=["children",""+a]):an.hasOwnProperty(o)&&a!=null&&Ct(i,o)}switch(r){case"input":$r(n),$c(n,s,!0);break;case"textarea":$r(n),Wc(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Ps)}i=t,e.updateQueue=i,i!==null&&(e.effectTag|=4)}else{switch(o=i.nodeType===9?i:i.ownerDocument,t===Yc&&(t=Yp(r)),t===Yc?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Rt]=e,t[ks]=n,tg(t,e,!1,!1),e.stateNode=t,o=za(r,n),r){case"iframe":case"object":case"embed":le("load",t),a=n;break;case"video":case"audio":for(a=0;a<Dn.length;a++)le(Dn[a],t);a=n;break;case"source":le("error",t),a=n;break;case"img":case"image":case"link":le("error",t),le("load",t),a=n;break;case"form":le("reset",t),le("submit",t),a=n;break;case"details":le("toggle",t),a=n;break;case"input":Oc(t,n),a=Ia(t,n),le("invalid",t),Ct(i,"onChange");break;case"option":a=Aa(t,n);break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=Pe({},n,{value:void 0}),le("invalid",t),Ct(i,"onChange");break;case"textarea":Fc(t,n),a=Ea(t,n),le("invalid",t),Ct(i,"onChange");break;default:a=n}Da(r,a);var l=a;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?gf(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Xp(t,u)):s==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&sr(t,u):typeof u=="number"&&sr(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(an.hasOwnProperty(s)?u!=null&&Ct(i,s):u!=null&&eu(t,s,u,o))}switch(r){case"input":$r(t),$c(t,n,!1);break;case"textarea":$r(t),Wc(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Kt(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?qi(t,!!n.multiple,i,!1):n.defaultValue!=null&&qi(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Ps)}yf(r,n)&&(e.effectTag|=4)}e.ref!==null&&(e.effectTag|=128)}return null;case 6:if(t&&e.stateNode!=null)ng(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(C(166));i=ui(hr.current),ui(vt.current),Gr(e)?(i=e.stateNode,n=e.memoizedProps,i[Rt]=e,i.nodeValue!==n&&(e.effectTag|=4)):(i=(i.nodeType===9?i:i.ownerDocument).createTextNode(n),i[Rt]=e,e.stateNode=i)}return null;case 13:return oe(ue),n=e.memoizedState,(e.effectTag&64)!==0?(e.expirationTime=i,e):(i=n!==null,n=!1,t===null?e.memoizedProps.fallback!==void 0&&Gr(e):(r=t.memoizedState,n=r!==null,i||r===null||(r=t.child.sibling,r!==null&&(s=e.firstEffect,s!==null?(e.firstEffect=r,r.nextEffect=s):(e.firstEffect=e.lastEffect=r,r.nextEffect=null),r.effectTag=8))),i&&!n&&(e.mode&2)!==0&&(t===null&&e.memoizedProps.unstable_avoidThisFallback!==!0||(ue.current&1)!==0?we===vi&&(we=Hs):((we===vi||we===Hs)&&(we=mo),fr!==0&&He!==null&&(hi(He,Re),Ig(He,fr)))),(i||n)&&(e.effectTag|=4),null);case 4:return hn(),Ja(e),null;case 10:return xu(e),null;case 17:return je(e.type)&&Ds(),null;case 19:if(oe(ue),n=e.memoizedState,n===null)return null;if(r=(e.effectTag&64)!==0,s=n.rendering,s===null){if(r)Yr(n,!1);else if(we!==vi||t!==null&&(t.effectTag&64)!==0)for(s=e.child;s!==null;){if(t=Rs(s),t!==null){for(e.effectTag|=64,Yr(n,!1),r=t.updateQueue,r!==null&&(e.updateQueue=r,e.effectTag|=4),n.lastEffect===null&&(e.firstEffect=null),e.lastEffect=n.lastEffect,n=e.child;n!==null;)r=n,s=i,r.effectTag&=2,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null,t=r.alternate,t===null?(r.childExpirationTime=0,r.expirationTime=s,r.child=null,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null):(r.childExpirationTime=t.childExpirationTime,r.expirationTime=t.expirationTime,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,s=t.dependencies,r.dependencies=s===null?null:{expirationTime:s.expirationTime,firstContext:s.firstContext,responders:s.responders}),n=n.sibling;return he(ue,ue.current&1|2),e.child}s=s.sibling}}else{if(!r)if(t=Rs(s),t!==null){if(e.effectTag|=64,r=!0,i=t.updateQueue,i!==null&&(e.updateQueue=i,e.effectTag|=4),Yr(n,!0),n.tail===null&&n.tailMode==="hidden"&&!s.alternate)return e=e.lastEffect=n.lastEffect,e!==null&&(e.nextEffect=null),null}else 2*Ye()-n.renderingStartTime>n.tailExpiration&&1<i&&(e.effectTag|=64,r=!0,Yr(n,!1),e.expirationTime=e.childExpirationTime=i-1);n.isBackwards?(s.sibling=e.child,e.child=s):(i=n.last,i!==null?i.sibling=s:e.child=s,n.last=s)}return n.tail!==null?(n.tailExpiration===0&&(n.tailExpiration=Ye()+500),i=n.tail,n.rendering=i,n.tail=i.sibling,n.lastEffect=e.lastEffect,n.renderingStartTime=Ye(),i.sibling=null,e=ue.current,he(ue,r?e&1|2:e&1),i):null}throw Error(C(156,e.tag))}function TM(t){switch(t.tag){case 1:je(t.type)&&Ds();var e=t.effectTag;return e&4096?(t.effectTag=e&-4097|64,t):null;case 3:if(hn(),oe(Le),oe(be),e=t.effectTag,(e&64)!==0)throw Error(C(285));return t.effectTag=e&-4097|64,t;case 5:return Cu(t),null;case 13:return oe(ue),e=t.effectTag,e&4096?(t.effectTag=e&-4097|64,t):null;case 19:return oe(ue),null;case 4:return hn(),null;case 10:return xu(t),null;default:return null}}function ku(t,e){return{value:t,source:e,stack:nu(e)}}var NM=typeof WeakSet=="function"?WeakSet:Set;function Ka(t,e){var i=e.source,n=e.stack;n===null&&i!==null&&(n=nu(i)),i!==null&&Dt(i.type),e=e.value,t!==null&&t.tag===1&&Dt(t.type);try{console.error(e)}catch(r){setTimeout(function(){throw r})}}function PM(t,e){try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(i){yi(t,i)}}function Pd(t){var e=t.ref;if(e!==null)if(typeof e=="function")try{e(null)}catch(i){yi(t,i)}else e.current=null}function kM(t,e){switch(e.tag){case 0:case 11:case 15:case 22:return;case 1:if(e.effectTag&256&&t!==null){var i=t.memoizedProps,n=t.memoizedState;t=e.stateNode,e=t.getSnapshotBeforeUpdate(e.elementType===e.type?i:it(e.type,i),n),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(C(163))}function rg(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&t)===t){var n=i.destroy;i.destroy=void 0,n!==void 0&&n()}i=i.next}while(i!==e)}}function sg(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&t)===t){var n=i.create;i.destroy=n()}i=i.next}while(i!==e)}}function BM(t,e,i){switch(i.tag){case 0:case 11:case 15:case 22:sg(3,i);return;case 1:if(t=i.stateNode,i.effectTag&4)if(e===null)t.componentDidMount();else{var n=i.elementType===i.type?e.memoizedProps:it(i.type,e.memoizedProps);t.componentDidUpdate(n,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate)}e=i.updateQueue,e!==null&&gd(i,e,t);return;case 3:if(e=i.updateQueue,e!==null){if(t=null,i.child!==null)switch(i.child.tag){case 5:t=i.child.stateNode;break;case 1:t=i.child.stateNode}gd(i,e,t)}return;case 5:t=i.stateNode,e===null&&i.effectTag&4&&yf(i.type,i.memoizedProps)&&t.focus();return;case 6:return;case 4:return;case 12:return;case 13:i.memoizedState===null&&(i=i.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&df(i))));return;case 19:case 17:case 20:case 21:return}throw Error(C(163))}function kd(t,e,i){switch(typeof ol=="function"&&ol(e),e.tag){case 0:case 11:case 14:case 15:case 22:if(t=e.updateQueue,t!==null&&(t=t.lastEffect,t!==null)){var n=t.next;ei(97<i?97:i,function(){var r=n;do{var s=r.destroy;if(s!==void 0){var o=e;try{s()}catch(a){yi(o,a)}}r=r.next}while(r!==n)})}break;case 1:Pd(e),i=e.stateNode,typeof i.componentWillUnmount=="function"&&PM(e,i);break;case 5:Pd(e);break;case 4:ag(t,e,i)}}function og(t){var e=t.alternate;t.return=null,t.child=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.alternate=null,t.firstEffect=null,t.lastEffect=null,t.pendingProps=null,t.memoizedProps=null,t.stateNode=null,e!==null&&og(e)}function Bd(t){return t.tag===5||t.tag===3||t.tag===4}function Dd(t){e:{for(var e=t.return;e!==null;){if(Bd(e)){var i=e;break e}e=e.return}throw Error(C(160))}switch(e=i.stateNode,i.tag){case 5:var n=!1;break;case 3:e=e.containerInfo,n=!0;break;case 4:e=e.containerInfo,n=!0;break;default:throw Error(C(161))}i.effectTag&16&&(sr(e,""),i.effectTag&=-17);e:t:for(i=t;;){for(;i.sibling===null;){if(i.return===null||Bd(i.return)){i=null;break e}i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.effectTag&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.effectTag&2)){i=i.stateNode;break e}}n?qa(t,i,e):el(t,i,e)}function qa(t,e,i){var n=t.tag,r=n===5||n===6;if(r)t=r?t.stateNode:t.stateNode.instance,e?i.nodeType===8?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(i.nodeType===8?(e=i.parentNode,e.insertBefore(t,i)):(e=i,e.appendChild(t)),i=i._reactRootContainer,i!=null||e.onclick!==null||(e.onclick=Ps));else if(n!==4&&(t=t.child,t!==null))for(qa(t,e,i),t=t.sibling;t!==null;)qa(t,e,i),t=t.sibling}function el(t,e,i){var n=t.tag,r=n===5||n===6;if(r)t=r?t.stateNode:t.stateNode.instance,e?i.insertBefore(t,e):i.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(el(t,e,i),t=t.sibling;t!==null;)el(t,e,i),t=t.sibling}function ag(t,e,i){for(var n=e,r=!1,s,o;;){if(!r){r=n.return;e:for(;;){if(r===null)throw Error(C(160));switch(s=r.stateNode,r.tag){case 5:o=!1;break e;case 3:s=s.containerInfo,o=!0;break e;case 4:s=s.containerInfo,o=!0;break e}r=r.return}r=!0}if(n.tag===5||n.tag===6){e:for(var a=t,l=n,u=i,c=l;;)if(kd(a,c,u),c.child!==null&&c.tag!==4)c.child.return=c,c=c.child;else{if(c===l)break e;for(;c.sibling===null;){if(c.return===null||c.return===l)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}o?(a=s,l=n.stateNode,a.nodeType===8?a.parentNode.removeChild(l):a.removeChild(l)):s.removeChild(n.stateNode)}else if(n.tag===4){if(n.child!==null){s=n.stateNode.containerInfo,o=!0,n.child.return=n,n=n.child;continue}}else if(kd(t,n,i),n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return,n.tag===4&&(r=!1)}n.sibling.return=n.return,n=n.sibling}}function Go(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:rg(3,e);return;case 1:return;case 5:var i=e.stateNode;if(i!=null){var n=e.memoizedProps,r=t!==null?t.memoizedProps:n;t=e.type;var s=e.updateQueue;if(e.updateQueue=null,s!==null){for(i[ks]=n,t==="input"&&n.type==="radio"&&n.name!=null&&Zp(i,n),za(t,r),e=za(t,n),r=0;r<s.length;r+=2){var o=s[r],a=s[r+1];o==="style"?gf(i,a):o==="dangerouslySetInnerHTML"?Xp(i,a):o==="children"?sr(i,a):eu(i,o,a,e)}switch(t){case"input":Ca(i,n);break;case"textarea":Qp(i,n);break;case"select":e=i._wrapperState.wasMultiple,i._wrapperState.wasMultiple=!!n.multiple,t=n.value,t!=null?qi(i,!!n.multiple,t,!1):e!==!!n.multiple&&(n.defaultValue!=null?qi(i,!!n.multiple,n.defaultValue,!0):qi(i,!!n.multiple,n.multiple?[]:"",!1))}}}return;case 6:if(e.stateNode===null)throw Error(C(162));e.stateNode.nodeValue=e.memoizedProps;return;case 3:e=e.stateNode,e.hydrate&&(e.hydrate=!1,df(e.containerInfo));return;case 12:return;case 13:if(i=e,e.memoizedState===null?n=!1:(n=!0,i=e.child,zu=Ye()),i!==null)e:for(t=i;;){if(t.tag===5)s=t.stateNode,n?(s=s.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(s=t.stateNode,r=t.memoizedProps.style,r=r!=null&&r.hasOwnProperty("display")?r.display:null,s.style.display=ff("display",r));else if(t.tag===6)t.stateNode.nodeValue=n?"":t.memoizedProps;else if(t.tag===13&&t.memoizedState!==null&&t.memoizedState.dehydrated===null){s=t.child.sibling,s.return=t,t=s;continue}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}zd(e);return;case 19:zd(e);return;case 17:return}throw Error(C(163))}function zd(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var i=t.stateNode;i===null&&(i=t.stateNode=new NM),e.forEach(function(n){var r=FM.bind(null,t,n);i.has(n)||(i.add(n),n.then(r,r))})}}var DM=typeof WeakMap=="function"?WeakMap:Map;function lg(t,e,i){i=Gt(i,null),i.tag=3,i.payload={element:null};var n=e.value;return i.callback=function(){Gs||(Gs=!0,tl=n),Ka(t,e)},i}function ug(t,e,i){i=Gt(i,null),i.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var r=e.value;i.payload=function(){return Ka(t,e),n(r)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(i.callback=function(){typeof n!="function"&&(Xt===null?Xt=new Set([this]):Xt.add(this),Ka(t,e));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),i}var zM=Math.ceil,Ws=rt.ReactCurrentDispatcher,cg=rt.ReactCurrentOwner,ye=0,Bu=8,st=16,yt=32,vi=0,Us=1,dg=2,Hs=3,mo=4,Du=5,W=ye,He=null,Q=null,Re=0,we=vi,vo=null,Pt=1073741823,pr=1073741823,Zs=null,fr=0,Qs=!1,zu=0,hg=500,_=null,Gs=!1,tl=null,Xt=null,Ys=!1,Xn=null,_n=90,ci=null,Jn=0,il=null,fs=0;function wt(){return(W&(st|yt))!==ye?1073741821-(Ye()/10|0):fs!==0?fs:fs=1073741821-(Ye()/10|0)}function wi(t,e,i){if(e=e.mode,(e&2)===0)return 1073741823;var n=fo();if((e&4)===0)return n===99?1073741823:1073741822;if((W&st)!==ye)return Re;if(i!==null)t=hs(t,i.timeoutMs|0||5e3,250);else switch(n){case 99:t=1073741823;break;case 98:t=hs(t,150,100);break;case 97:case 96:t=hs(t,5e3,250);break;case 95:t=2;break;default:throw Error(C(326))}return He!==null&&t===Re&&--t,t}function Jt(t,e){if(50<Jn)throw Jn=0,il=null,Error(C(185));if(t=wo(t,e),t!==null){var i=fo();e===1073741823?(W&Bu)!==ye&&(W&(st|yt))===ye?nl(t):(Ze(t),W===ye&&xt()):Ze(t),(W&4)===ye||i!==98&&i!==99||(ci===null?ci=new Map([[t,e]]):(i=ci.get(t),(i===void 0||i>e)&&ci.set(t,e)))}}function wo(t,e){t.expirationTime<e&&(t.expirationTime=e);var i=t.alternate;i!==null&&i.expirationTime<e&&(i.expirationTime=e);var n=t.return,r=null;if(n===null&&t.tag===3)r=t.stateNode;else for(;n!==null;){if(i=n.alternate,n.childExpirationTime<e&&(n.childExpirationTime=e),i!==null&&i.childExpirationTime<e&&(i.childExpirationTime=e),n.return===null&&n.tag===3){r=n.stateNode;break}n=n.return}return r!==null&&(He===r&&(yo(e),we===mo&&hi(r,Re)),Ig(r,e)),r}function gs(t){var e=t.lastExpiredTime;if(e!==0||(e=t.firstPendingTime,!Sg(t,e)))return e;var i=t.lastPingedTime;return t=t.nextKnownPendingLevel,t=i>t?i:t,2>=t&&e!==t?0:t}function Ze(t){if(t.lastExpiredTime!==0)t.callbackExpirationTime=1073741823,t.callbackPriority=99,t.callbackNode=pd(nl.bind(null,t));else{var e=gs(t),i=t.callbackNode;if(e===0)i!==null&&(t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90);else{var n=wt();if(e===1073741823?n=99:e===1||e===2?n=95:(n=10*(1073741821-e)-10*(1073741821-n),n=0>=n?99:250>=n?98:5250>=n?97:95),i!==null){var r=t.callbackPriority;if(t.callbackExpirationTime===e&&r>=n)return;i!==Rf&&Df(i)}t.callbackExpirationTime=e,t.callbackPriority=n,e=e===1073741823?pd(nl.bind(null,t)):Of(n,pg.bind(null,t),{timeout:10*(1073741821-e)-Ye()}),t.callbackNode=e}}}function pg(t,e){if(fs=0,e)return e=wt(),al(t,e),Ze(t),null;var i=gs(t);if(i!==0){if(e=t.callbackNode,(W&(st|yt))!==ye)throw Error(C(327));if(vn(),t===He&&i===Re||di(t,i),Q!==null){var n=W;W|=st;var r=vg();do try{jM();break}catch(a){mg(t,a)}while(1);if(yu(),W=n,Ws.current=r,we===Us)throw e=vo,di(t,i),hi(t,i),Ze(t),e;if(Q===null)switch(r=t.finishedWork=t.current.alternate,t.finishedExpirationTime=i,n=we,He=null,n){case vi:case Us:throw Error(C(345));case dg:al(t,2<i?2:i);break;case Hs:if(hi(t,i),n=t.lastSuspendedTime,i===n&&(t.nextKnownPendingLevel=rl(r)),Pt===1073741823&&(r=zu+hg-Ye(),10<r)){if(Qs){var s=t.lastPingedTime;if(s===0||s>=i){t.lastPingedTime=i,di(t,i);break}}if(s=gs(t),s!==0&&s!==i)break;if(n!==0&&n!==i){t.lastPingedTime=n;break}t.timeoutHandle=Fo(oi.bind(null,t),r);break}oi(t);break;case mo:if(hi(t,i),n=t.lastSuspendedTime,i===n&&(t.nextKnownPendingLevel=rl(r)),Qs&&(r=t.lastPingedTime,r===0||r>=i)){t.lastPingedTime=i,di(t,i);break}if(r=gs(t),r!==0&&r!==i)break;if(n!==0&&n!==i){t.lastPingedTime=n;break}if(pr!==1073741823?n=10*(1073741821-pr)-Ye():Pt===1073741823?n=0:(n=10*(1073741821-Pt)-5e3,r=Ye(),i=10*(1073741821-i)-r,n=r-n,0>n&&(n=0),n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*zM(n/1960))-n,i<n&&(n=i)),10<n){t.timeoutHandle=Fo(oi.bind(null,t),n);break}oi(t);break;case Du:if(Pt!==1073741823&&Zs!==null){s=Pt;var o=Zs;if(n=o.busyMinDurationMs|0,0>=n?n=0:(r=o.busyDelayMs|0,s=Ye()-(10*(1073741821-s)-(o.timeoutMs|0||5e3)),n=s<=r?0:r+n-s),10<n){hi(t,i),t.timeoutHandle=Fo(oi.bind(null,t),n);break}}oi(t);break;default:throw Error(C(329))}if(Ze(t),t.callbackNode===e)return pg.bind(null,t)}}return null}function nl(t){var e=t.lastExpiredTime;if(e=e!==0?e:1073741823,(W&(st|yt))!==ye)throw Error(C(327));if(vn(),t===He&&e===Re||di(t,e),Q!==null){var i=W;W|=st;var n=vg();do try{LM();break}catch(r){mg(t,r)}while(1);if(yu(),W=i,Ws.current=n,we===Us)throw i=vo,di(t,e),hi(t,e),Ze(t),i;if(Q!==null)throw Error(C(261));t.finishedWork=t.current.alternate,t.finishedExpirationTime=e,He=null,oi(t),Ze(t)}return null}function _M(){if(ci!==null){var t=ci;ci=null,t.forEach(function(e,i){al(i,e),Ze(i)}),xt()}}function fg(t,e){var i=W;W|=1;try{return t(e)}finally{W=i,W===ye&&xt()}}function gg(t,e){var i=W;W&=-2,W|=Bu;try{return t(e)}finally{W=i,W===ye&&xt()}}function di(t,e){t.finishedWork=null,t.finishedExpirationTime=0;var i=t.timeoutHandle;if(i!==-1&&(t.timeoutHandle=-1,zx(i)),Q!==null)for(i=Q.return;i!==null;){var n=i;switch(n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ds();break;case 3:hn(),oe(Le),oe(be);break;case 5:Cu(n);break;case 4:hn();break;case 13:oe(ue);break;case 19:oe(ue);break;case 10:xu(n)}i=i.return}He=t,Q=bi(t.current,null),Re=e,we=vi,vo=null,pr=Pt=1073741823,Zs=null,fr=0,Qs=!1}function mg(t,e){do{try{if(yu(),ps.current=Fs,Vs)for(var i=fe.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}if(Ot=0,Ce=Ie=fe=null,Vs=!1,Q===null||Q.return===null)return we=Us,vo=e,Q=null;e:{var r=t,s=Q.return,o=Q,a=e;if(e=Re,o.effectTag|=2048,o.firstEffect=o.lastEffect=null,a!==null&&typeof a=="object"&&typeof a.then=="function"){var l=a;if((o.mode&2)===0){var u=o.alternate;u?(o.updateQueue=u.updateQueue,o.memoizedState=u.memoizedState,o.expirationTime=u.expirationTime):(o.updateQueue=null,o.memoizedState=null)}var c=(ue.current&1)!==0,d=s;do{var f;if(f=d.tag===13){var v=d.memoizedState;if(v!==null)f=v.dehydrated!==null;else{var w=d.memoizedProps;f=w.fallback===void 0?!1:w.unstable_avoidThisFallback!==!0?!0:!c}}if(f){var y=d.updateQueue;if(y===null){var h=new Set;h.add(l),d.updateQueue=h}else y.add(l);if((d.mode&2)===0){if(d.effectTag|=64,o.effectTag&=-2981,o.tag===1)if(o.alternate===null)o.tag=17;else{var p=Gt(1073741823,null);p.tag=2,Yt(o,p)}o.expirationTime=1073741823;break e}a=void 0,o=e;var g=r.pingCache;if(g===null?(g=r.pingCache=new DM,a=new Set,g.set(l,a)):(a=g.get(l),a===void 0&&(a=new Set,g.set(l,a))),!a.has(o)){a.add(o);var m=$M.bind(null,r,l,o);l.then(m,m)}d.effectTag|=4096,d.expirationTime=e;break e}d=d.return}while(d!==null);a=Error((Dt(o.type)||"A React component")+` suspended while rendering, but no fallback UI was specified.

Add a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.`+nu(o))}we!==Du&&(we=dg),a=ku(a,o),d=s;do{switch(d.tag){case 3:l=a,d.effectTag|=4096,d.expirationTime=e;var x=lg(d,l,e);fd(d,x);break e;case 1:l=a;var M=d.type,T=d.stateNode;if((d.effectTag&64)===0&&(typeof M.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Xt===null||!Xt.has(T)))){d.effectTag|=4096,d.expirationTime=e;var z=ug(d,l,e);fd(d,z);break e}}d=d.return}while(d!==null)}Q=xg(Q)}catch(P){e=P;continue}break}while(1)}function vg(){var t=Ws.current;return Ws.current=Fs,t===null?Fs:t}function wg(t,e){t<Pt&&2<t&&(Pt=t),e!==null&&t<pr&&2<t&&(pr=t,Zs=e)}function yo(t){t>fr&&(fr=t)}function LM(){for(;Q!==null;)Q=yg(Q)}function jM(){for(;Q!==null&&!MM();)Q=yg(Q)}function yg(t){var e=Mg(t.alternate,t,Re);return t.memoizedProps=t.pendingProps,e===null&&(e=xg(t)),cg.current=null,e}function xg(t){Q=t;do{var e=Q.alternate;if(t=Q.return,(Q.effectTag&2048)===0){if(e=EM(e,Q,Re),Re===1||Q.childExpirationTime!==1){for(var i=0,n=Q.child;n!==null;){var r=n.expirationTime,s=n.childExpirationTime;r>i&&(i=r),s>i&&(i=s),n=n.sibling}Q.childExpirationTime=i}if(e!==null)return e;t!==null&&(t.effectTag&2048)===0&&(t.firstEffect===null&&(t.firstEffect=Q.firstEffect),Q.lastEffect!==null&&(t.lastEffect!==null&&(t.lastEffect.nextEffect=Q.firstEffect),t.lastEffect=Q.lastEffect),1<Q.effectTag&&(t.lastEffect!==null?t.lastEffect.nextEffect=Q:t.firstEffect=Q,t.lastEffect=Q))}else{if(e=TM(Q),e!==null)return e.effectTag&=2047,e;t!==null&&(t.firstEffect=t.lastEffect=null,t.effectTag|=2048)}if(e=Q.sibling,e!==null)return e;Q=t}while(Q!==null);return we===vi&&(we=Du),null}function rl(t){var e=t.expirationTime;return t=t.childExpirationTime,e>t?e:t}function oi(t){var e=fo();return ei(99,RM.bind(null,t,e)),null}function RM(t,e){do vn();while(Xn!==null);if((W&(st|yt))!==ye)throw Error(C(327));var i=t.finishedWork,n=t.finishedExpirationTime;if(i===null)return null;if(t.finishedWork=null,t.finishedExpirationTime=0,i===t.current)throw Error(C(177));t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90,t.nextKnownPendingLevel=0;var r=rl(i);if(t.firstPendingTime=r,n<=t.lastSuspendedTime?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:n<=t.firstSuspendedTime&&(t.firstSuspendedTime=n-1),n<=t.lastPingedTime&&(t.lastPingedTime=0),n<=t.lastExpiredTime&&(t.lastExpiredTime=0),t===He&&(Q=He=null,Re=0),1<i.effectTag?i.lastEffect!==null?(i.lastEffect.nextEffect=i,r=i.firstEffect):r=i:r=i.firstEffect,r!==null){var s=W;W|=yt,cg.current=null,Oo=os;var o=Kc();if(La(o)){if("selectionStart"in o)var a={start:o.selectionStart,end:o.selectionEnd};else e:{a=(a=o.ownerDocument)&&a.defaultView||window;var l=a.getSelection&&a.getSelection();if(l&&l.rangeCount!==0){a=l.anchorNode;var u=l.anchorOffset,c=l.focusNode;l=l.focusOffset;try{a.nodeType,c.nodeType}catch{a=null;break e}var d=0,f=-1,v=-1,w=0,y=0,h=o,p=null;t:for(;;){for(var g;h!==a||u!==0&&h.nodeType!==3||(f=d+u),h!==c||l!==0&&h.nodeType!==3||(v=d+l),h.nodeType===3&&(d+=h.nodeValue.length),(g=h.firstChild)!==null;)p=h,h=g;for(;;){if(h===o)break t;if(p===a&&++w===u&&(f=d),p===c&&++y===l&&(v=d),(g=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=g}a=f===-1||v===-1?null:{start:f,end:v}}else a=null}a=a||{start:0,end:0}}else a=null;$o={activeElementDetached:null,focusedElem:o,selectionRange:a},os=!1,_=r;do try{VM()}catch(D){if(_===null)throw Error(C(330));yi(_,D),_=_.nextEffect}while(_!==null);_=r;do try{for(o=t,a=e;_!==null;){var m=_.effectTag;if(m&16&&sr(_.stateNode,""),m&128){var x=_.alternate;if(x!==null){var M=x.ref;M!==null&&(typeof M=="function"?M(null):M.current=null)}}switch(m&1038){case 2:Dd(_),_.effectTag&=-3;break;case 6:Dd(_),_.effectTag&=-3,Go(_.alternate,_);break;case 1024:_.effectTag&=-1025;break;case 1028:_.effectTag&=-1025,Go(_.alternate,_);break;case 4:Go(_.alternate,_);break;case 8:u=_,ag(o,u,a),og(u)}_=_.nextEffect}}catch(D){if(_===null)throw Error(C(330));yi(_,D),_=_.nextEffect}while(_!==null);if(M=$o,x=Kc(),m=M.focusedElem,a=M.selectionRange,x!==m&&m&&m.ownerDocument&&mf(m.ownerDocument.documentElement,m)){for(a!==null&&La(m)&&(x=a.start,M=a.end,M===void 0&&(M=x),"selectionStart"in m?(m.selectionStart=x,m.selectionEnd=Math.min(M,m.value.length)):(M=(x=m.ownerDocument||document)&&x.defaultView||window,M.getSelection&&(M=M.getSelection(),u=m.textContent.length,o=Math.min(a.start,u),a=a.end===void 0?o:Math.min(a.end,u),!M.extend&&o>a&&(u=a,a=o,o=u),u=Jc(m,o),c=Jc(m,a),u&&c&&(M.rangeCount!==1||M.anchorNode!==u.node||M.anchorOffset!==u.offset||M.focusNode!==c.node||M.focusOffset!==c.offset)&&(x=x.createRange(),x.setStart(u.node,u.offset),M.removeAllRanges(),o>a?(M.addRange(x),M.extend(c.node,c.offset)):(x.setEnd(c.node,c.offset),M.addRange(x)))))),x=[],M=m;M=M.parentNode;)M.nodeType===1&&x.push({element:M,left:M.scrollLeft,top:M.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<x.length;m++)M=x[m],M.element.scrollLeft=M.left,M.element.scrollTop=M.top}os=!!Oo,$o=Oo=null,t.current=i,_=r;do try{for(m=t;_!==null;){var T=_.effectTag;if(T&36&&BM(m,_.alternate,_),T&128){x=void 0;var z=_.ref;if(z!==null){var P=_.stateNode;switch(_.tag){case 5:x=P;break;default:x=P}typeof z=="function"?z(x):z.current=x}}_=_.nextEffect}}catch(D){if(_===null)throw Error(C(330));yi(_,D),_=_.nextEffect}while(_!==null);_=null,SM(),W=s}else t.current=i;if(Ys)Ys=!1,Xn=t,_n=e;else for(_=r;_!==null;)e=_.nextEffect,_.nextEffect=null,_=e;if(e=t.firstPendingTime,e===0&&(Xt=null),e===1073741823?t===il?Jn++:(Jn=0,il=t):Jn=0,typeof sl=="function"&&sl(i.stateNode,n),Ze(t),Gs)throw Gs=!1,t=tl,tl=null,t;return(W&Bu)!==ye||xt(),null}function VM(){for(;_!==null;){var t=_.effectTag;(t&256)!==0&&kM(_.alternate,_),(t&512)===0||Ys||(Ys=!0,Of(97,function(){return vn(),null})),_=_.nextEffect}}function vn(){if(_n!==90){var t=97<_n?97:_n;return _n=90,ei(t,OM)}}function OM(){if(Xn===null)return!1;var t=Xn;if(Xn=null,(W&(st|yt))!==ye)throw Error(C(331));var e=W;for(W|=yt,t=t.current.firstEffect;t!==null;){try{var i=t;if((i.effectTag&512)!==0)switch(i.tag){case 0:case 11:case 15:case 22:rg(5,i),sg(5,i)}}catch(n){if(t===null)throw Error(C(330));yi(t,n)}i=t.nextEffect,t.nextEffect=null,t=i}return W=e,xt(),!0}function _d(t,e,i){e=ku(i,e),e=lg(t,e,1073741823),Yt(t,e),t=wo(t,1073741823),t!==null&&Ze(t)}function yi(t,e){if(t.tag===3)_d(t,t,e);else for(var i=t.return;i!==null;){if(i.tag===3){_d(i,t,e);break}else if(i.tag===1){var n=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Xt===null||!Xt.has(n))){t=ku(e,t),t=ug(i,t,1073741823),Yt(i,t),i=wo(i,1073741823),i!==null&&Ze(i);break}}i=i.return}}function $M(t,e,i){var n=t.pingCache;n!==null&&n.delete(e),He===t&&Re===i?we===mo||we===Hs&&Pt===1073741823&&Ye()-zu<hg?di(t,Re):Qs=!0:Sg(t,i)&&(e=t.lastPingedTime,e!==0&&e<i||(t.lastPingedTime=i,Ze(t)))}function FM(t,e){var i=t.stateNode;i!==null&&i.delete(e),e=0,e===0&&(e=wt(),e=wi(e,t,null)),t=wo(t,e),t!==null&&Ze(t)}var Mg;Mg=function(t,e,i){var n=e.expirationTime;if(t!==null){var r=e.pendingProps;if(t.memoizedProps!==r||Le.current)gt=!0;else{if(n<i){switch(gt=!1,e.tag){case 3:Ad(e),Ho();break;case 5:if(wd(e),e.mode&4&&i!==1&&r.hidden)return e.expirationTime=e.childExpirationTime=1,null;break;case 1:je(e.type)&&cs(e);break;case 4:Ha(e,e.stateNode.containerInfo);break;case 10:n=e.memoizedProps.value,r=e.type._context,he(zs,r._currentValue),r._currentValue=n;break;case 13:if(e.memoizedState!==null)return n=e.child.childExpirationTime,n!==0&&n>=i?Ed(t,e,i):(he(ue,ue.current&1),e=Bt(t,e,i),e!==null?e.sibling:null);he(ue,ue.current&1);break;case 19:if(n=e.childExpirationTime>=i,(t.effectTag&64)!==0){if(n)return Nd(t,e,i);e.effectTag|=64}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null),he(ue,ue.current),!n)return null}return Bt(t,e,i)}gt=!1}}else gt=!1;switch(e.expirationTime=0,e.tag){case 2:if(n=e.type,t!==null&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,r=cn(e,be.current),tn(e,i),r=Eu(null,e,n,t,r,i),e.effectTag|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,je(n)){var s=!0;cs(e)}else s=!1;e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Mu(e);var o=n.getDerivedStateFromProps;typeof o=="function"&&js(e,n,o,t),r.updater=go,e.stateNode=r,r._reactInternalFiber=e,Ua(e,n,t,i),e=Xa(null,e,n,!0,s,i)}else e.tag=0,Fe(null,e,r,i),e=e.child;return e;case 16:e:{if(r=e.elementType,t!==null&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,vx(r),r._status!==1)throw r._result;switch(r=r._result,e.type=r,s=e.tag=HM(r),t=it(r,t),s){case 0:e=Ya(null,e,r,t,i);break e;case 1:e=bd(null,e,r,t,i);break e;case 11:e=Id(null,e,r,t,i);break e;case 14:e=Cd(null,e,r,it(r.type,t),n,i);break e}throw Error(C(306,r,""))}return e;case 0:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:it(n,r),Ya(t,e,n,r,i);case 1:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:it(n,r),bd(t,e,n,r,i);case 3:if(Ad(e),n=e.updateQueue,t===null||n===null)throw Error(C(282));if(n=e.pendingProps,r=e.memoizedState,r=r!==null?r.element:null,Su(t,e),cr(e,n,null,i),n=e.memoizedState.element,n===r)Ho(),e=Bt(t,e,i);else{if((r=e.stateNode.hydrate)&&($t=en(e.stateNode.containerInfo.firstChild),kt=e,r=mi=!0),r)for(i=Iu(e,null,n,i),e.child=i;i;)i.effectTag=i.effectTag&-3|1024,i=i.sibling;else Fe(t,e,n,i),Ho();e=e.child}return e;case 5:return wd(e),t===null&&Ga(e),n=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,ja(n,r)?o=null:s!==null&&ja(n,s)&&(e.effectTag|=16),eg(t,e),e.mode&4&&i!==1&&r.hidden?(e.expirationTime=e.childExpirationTime=1,e=null):(Fe(t,e,o,i),e=e.child),e;case 6:return t===null&&Ga(e),null;case 13:return Ed(t,e,i);case 4:return Ha(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=dn(e,null,n,i):Fe(t,e,n,i),e.child;case 11:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:it(n,r),Id(t,e,n,r,i);case 7:return Fe(t,e,e.pendingProps,i),e.child;case 8:return Fe(t,e,e.pendingProps.children,i),e.child;case 12:return Fe(t,e,e.pendingProps.children,i),e.child;case 10:e:{n=e.type._context,r=e.pendingProps,o=e.memoizedProps,s=r.value;var a=e.type._context;if(he(zs,a._currentValue),a._currentValue=s,o!==null)if(a=o.value,s=Ii(a,s)?0:(typeof n._calculateChangedBits=="function"?n._calculateChangedBits(a,s):1073741823)|0,s===0){if(o.children===r.children&&!Le.current){e=Bt(t,e,i);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var u=l.firstContext;u!==null;){if(u.context===n&&(u.observedBits&s)!==0){a.tag===1&&(u=Gt(i,null),u.tag=2,Yt(a,u)),a.expirationTime<i&&(a.expirationTime=i),u=a.alternate,u!==null&&u.expirationTime<i&&(u.expirationTime=i),Ff(a.return,i),l.expirationTime<i&&(l.expirationTime=i);break}u=u.next}}else o=a.tag===10&&a.type===e.type?null:a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Fe(t,e,r.children,i),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps,n=s.children,tn(e,i),r=Ke(r,s.unstable_observedBits),n=n(r),e.effectTag|=1,Fe(t,e,n,i),e.child;case 14:return r=e.type,s=it(r,e.pendingProps),s=it(r.type,s),Cd(t,e,r,s,n,i);case 15:return qf(t,e,e.type,e.pendingProps,n,i);case 17:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:it(n,r),t!==null&&(t.alternate=null,e.alternate=null,e.effectTag|=2),e.tag=1,je(n)?(t=!0,cs(e)):t=!1,tn(e,i),Uf(e,n,r),Ua(e,n,r,i),Xa(null,e,n,!0,t,i);case 19:return Nd(t,e,i)}throw Error(C(156,e.tag))};var sl=null,ol=null;function WM(t){if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined")return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var i=e.inject(t);sl=function(n){try{e.onCommitFiberRoot(i,n,void 0,(n.current.effectTag&64)===64)}catch{}},ol=function(n){try{e.onCommitFiberUnmount(i,n)}catch{}}}catch{}return!0}function UM(t,e,i,n){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function mt(t,e,i,n){return new UM(t,e,i,n)}function _u(t){return t=t.prototype,!(!t||!t.isReactComponent)}function HM(t){if(typeof t=="function")return _u(t)?1:0;if(t!=null){if(t=t.$$typeof,t===tu)return 11;if(t===iu)return 14}return 2}function bi(t,e){var i=t.alternate;return i===null?(i=mt(t.tag,e,t.key,t.mode),i.elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.effectTag=0,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null),i.childExpirationTime=t.childExpirationTime,i.expirationTime=t.expirationTime,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=e===null?null:{expirationTime:e.expirationTime,firstContext:e.firstContext,responders:e.responders},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function ms(t,e,i,n,r,s){var o=2;if(n=t,typeof t=="function")_u(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ai:return Ft(i.children,r,s,e);case mx:o=8,r|=7;break;case Vp:o=8,r|=1;break;case ns:return t=mt(12,i,e,r|8),t.elementType=ns,t.type=ns,t.expirationTime=s,t;case rs:return t=mt(13,i,e,r),t.type=rs,t.elementType=rs,t.expirationTime=s,t;case Sa:return t=mt(19,i,e,r),t.elementType=Sa,t.expirationTime=s,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Op:o=10;break e;case $p:o=9;break e;case tu:o=11;break e;case iu:o=14;break e;case Fp:o=16,n=null;break e;case Wp:o=22;break e}throw Error(C(130,t==null?t:typeof t,""))}return e=mt(o,i,e,r),e.elementType=t,e.type=n,e.expirationTime=s,e}function Ft(t,e,i,n){return t=mt(7,t,n,e),t.expirationTime=i,t}function Yo(t,e,i){return t=mt(6,t,null,e),t.expirationTime=i,t}function Xo(t,e,i){return e=mt(4,t.children!==null?t.children:[],t.key,e),e.expirationTime=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ZM(t,e,i){this.tag=e,this.current=null,this.containerInfo=t,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=i,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Sg(t,e){var i=t.firstSuspendedTime;return t=t.lastSuspendedTime,i!==0&&i>=e&&t<=e}function hi(t,e){var i=t.firstSuspendedTime,n=t.lastSuspendedTime;i<e&&(t.firstSuspendedTime=e),(n>e||i===0)&&(t.lastSuspendedTime=e),e<=t.lastPingedTime&&(t.lastPingedTime=0),e<=t.lastExpiredTime&&(t.lastExpiredTime=0)}function Ig(t,e){e>t.firstPendingTime&&(t.firstPendingTime=e);var i=t.firstSuspendedTime;i!==0&&(e>=i?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:e>=t.lastSuspendedTime&&(t.lastSuspendedTime=e+1),e>t.nextKnownPendingLevel&&(t.nextKnownPendingLevel=e))}function al(t,e){var i=t.lastExpiredTime;(i===0||i>e)&&(t.lastExpiredTime=e)}function Xs(t,e,i,n){var r=e.current,s=wt(),o=Yn.suspense;s=wi(s,r,o);e:if(i){i=i._reactInternalFiber;t:{if(Ni(i)!==i||i.tag!==1)throw Error(C(170));var a=i;do{switch(a.tag){case 3:a=a.stateNode.context;break t;case 1:if(je(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break t}}a=a.return}while(a!==null);throw Error(C(171))}if(i.tag===1){var l=i.type;if(je(l)){i=Bf(i,l,a);break e}}i=a}else i=qt;return e.context===null?e.context=i:e.pendingContext=i,e=Gt(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),Yt(r,e),Jt(r,s),s}function Jo(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ld(t,e){t=t.memoizedState,t!==null&&t.dehydrated!==null&&t.retryTime<e&&(t.retryTime=e)}function Lu(t,e){Ld(t,e),(t=t.alternate)&&Ld(t,e)}function ju(t,e,i){i=i!=null&&i.hydrate===!0;var n=new ZM(t,e,i),r=mt(3,null,null,e===2?7:e===1?3:0);n.current=r,r.stateNode=n,Mu(r),t[Sr]=n.current,i&&e!==0&&Ix(t,t.nodeType===9?t:t.ownerDocument),this._internalRoot=n}ju.prototype.render=function(t){Xs(t,this._internalRoot,null,null)};ju.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Xs(null,t,null,function(){e[Sr]=null})};function Tr(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function QM(t,e){if(e||(e=t?t.nodeType===9?t.documentElement:t.firstChild:null,e=!(!e||e.nodeType!==1||!e.hasAttribute("data-reactroot"))),!e)for(var i;i=t.lastChild;)t.removeChild(i);return new ju(t,0,e?{hydrate:!0}:void 0)}function xo(t,e,i,n,r){var s=i._reactRootContainer;if(s){var o=s._internalRoot;if(typeof r=="function"){var a=r;r=function(){var u=Jo(o);a.call(u)}}Xs(e,o,t,r)}else{if(s=i._reactRootContainer=QM(i,n),o=s._internalRoot,typeof r=="function"){var l=r;r=function(){var u=Jo(o);l.call(u)}}gg(function(){Xs(e,o,t,r)})}return Jo(o)}function GM(t,e,i){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fi,key:n==null?null:""+n,children:t,containerInfo:e,implementation:i}}uf=function(t){if(t.tag===13){var e=hs(wt(),150,100);Jt(t,e),Lu(t,e)}};au=function(t){t.tag===13&&(Jt(t,3),Lu(t,3))};cf=function(t){if(t.tag===13){var e=wt();e=wi(e,t,null),Jt(t,e),Lu(t,e)}};Ma=function(t,e,i){switch(e){case"input":if(Ca(t,i),e=i.name,i.type==="radio"&&e!=null){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var n=i[e];if(n!==t&&n.form===t.form){var r=fu(n);if(!r)throw Error(C(90));Hp(n),Ca(n,r)}}}break;case"textarea":Qp(t,i);break;case"select":e=i.value,e!=null&&qi(t,!!i.multiple,e,!1)}};Yl=fg;Lp=function(t,e,i,n,r){var s=W;W|=4;try{return ei(98,t.bind(null,e,i,n,r))}finally{W=s,W===ye&&xt()}};Xl=function(){(W&(1|st|yt))===ye&&(_M(),vn())};jp=function(t,e){var i=W;W|=2;try{return t(e)}finally{W=i,W===ye&&xt()}};function Cg(t,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tr(e))throw Error(C(200));return GM(t,e,null,i)}var YM={Events:[Cr,Si,fu,Dp,xa,un,function(t){su(t,Lx)},zp,_p,co,uo,vn,{current:!1}]};(function(t){var e=t.findFiberByHostInstance;return WM(Pe({},t,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:rt.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=rf(i),i===null?null:i.stateNode},findFiberByHostInstance:function(i){return e?e(i):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:Ir,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"});qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YM;qe.createPortal=Cg;qe.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternalFiber;if(e===void 0)throw typeof t.render=="function"?Error(C(188)):Error(C(268,Object.keys(t)));return t=rf(e),t=t===null?null:t.stateNode,t};qe.flushSync=function(t,e){if((W&(st|yt))!==ye)throw Error(C(187));var i=W;W|=1;try{return ei(99,t.bind(null,e))}finally{W=i,xt()}};qe.hydrate=function(t,e,i){if(!Tr(e))throw Error(C(200));return xo(null,t,e,!0,i)};qe.render=function(t,e,i){if(!Tr(e))throw Error(C(200));return xo(null,t,e,!1,i)};qe.unmountComponentAtNode=function(t){if(!Tr(t))throw Error(C(40));return t._reactRootContainer?(gg(function(){xo(null,null,t,!1,function(){t._reactRootContainer=null,t[Sr]=null})}),!0):!1};qe.unstable_batchedUpdates=fg;qe.unstable_createPortal=function(t,e){return Cg(t,e,2<arguments.length&&arguments[2]!==void 0?arguments[2]:null)};qe.unstable_renderSubtreeIntoContainer=function(t,e,i,n){if(!Tr(i))throw Error(C(200));if(t==null||t._reactInternalFiber===void 0)throw Error(C(38));return xo(t,e,i,!1,n)};qe.version="16.14.0";function bg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bg)}catch(t){console.error(t)}}bg(),Ep.exports=qe;var Xr=Ep.exports,XM=Object.defineProperty,JM=Object.defineProperties,KM=Object.getOwnPropertyDescriptors,jd=Object.getOwnPropertySymbols,qM=Object.prototype.hasOwnProperty,eS=Object.prototype.propertyIsEnumerable,Rd=(t,e,i)=>e in t?XM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,Ue=(t,e)=>{for(var i in e||(e={}))qM.call(e,i)&&Rd(t,i,e[i]);if(jd)for(var i of jd(e))eS.call(e,i)&&Rd(t,i,e[i]);return t};const Ag={src:"",currentTime:0,hostTime:0,muted:!1,paused:!0,volume:1},Eg={currentTimeMaxError:1,syncInterval:1e3,retryInterval:15e3,verbose:!1,log:console.log.bind(console)};let Et=Eg;function Tg(t){Et=Ue(Ue({},Eg),t)}function Jr(t,e){if(t.paused)return t.currentTime;const i=function(n){if(n.player)return n.player.beginTimestamp+n.player.progressTime;if(n.room)return n.room.calibrationTimestamp}(e);return i?t.currentTime+(i-t.hostTime)/1e3:t.currentTime}const tS=navigator.userAgent.includes("Safari"),iS=navigator.userAgent.includes("iPhone")||navigator.userAgent.includes("iPad"),Ng=[".aac",".mid",".midi",".mp3",".ogg",".oga",".wav",".weba"];var nS=typeof global=="object"&&global&&global.Object===Object&&global,rS=typeof self=="object"&&self&&self.Object===Object&&self,Pg=nS||rS||Function("return this")(),Js=Pg.Symbol,kg=Object.prototype,sS=kg.hasOwnProperty,oS=kg.toString,Pn=Js?Js.toStringTag:void 0,aS=Object.prototype.toString,Vd=Js?Js.toStringTag:void 0;function lS(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Vd&&Vd in Object(t)?function(e){var i=sS.call(e,Pn),n=e[Pn];try{e[Pn]=void 0;var r=!0}catch{}var s=oS.call(e);return r&&(i?e[Pn]=n:delete e[Pn]),s}(t):function(e){return aS.call(e)}(t)}var uS=/\s/,cS=/^\s+/;function dS(t){return t&&t.slice(0,function(e){for(var i=e.length;i--&&uS.test(e.charAt(i)););return i}(t)+1).replace(cS,"")}function ll(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var hS=/^[-+]0x[0-9a-f]+$/i,pS=/^0b[01]+$/i,fS=/^0o[0-7]+$/i,gS=parseInt;function Od(t){if(typeof t=="number")return t;if(function(n){return typeof n=="symbol"||function(r){return r!=null&&typeof r=="object"}(n)&&lS(n)=="[object Symbol]"}(t))return NaN;if(ll(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ll(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=dS(t);var i=pS.test(t);return i||fS.test(t)?gS(t.slice(2),i?2:8):hS.test(t)?NaN:+t}var Ko=function(){return Pg.Date.now()},mS=Math.max,vS=Math.min;function Kr(t,e,i){var n,r,s,o,a,l,u=0,c=!1,d=!1,f=!0;if(typeof t!="function")throw new TypeError("Expected a function");function v(m){var x=n,M=r;return n=r=void 0,u=m,o=t.apply(M,x)}function w(m){return u=m,a=setTimeout(h,e),c?v(m):o}function y(m){var x=m-l;return l===void 0||x>=e||x<0||d&&m-u>=s}function h(){var m=Ko();if(y(m))return p(m);a=setTimeout(h,function(x){var M=e-(x-l);return d?vS(M,s-(x-u)):M}(m))}function p(m){return a=void 0,f&&n?v(m):(n=r=void 0,o)}function g(){var m=Ko(),x=y(m);if(n=arguments,r=this,l=m,x){if(a===void 0)return w(l);if(d)return clearTimeout(a),a=setTimeout(h,e),v(l)}return a===void 0&&(a=setTimeout(h,e)),o}return e=Od(e)||0,ll(i)&&(c=!!i.leading,s=(d="maxWait"in i)?mS(Od(i.maxWait)||0,e):s,f="trailing"in i?!!i.trailing:f),g.cancel=function(){a!==void 0&&clearTimeout(a),u=0,n=l=r=a=void 0},g.flush=function(){return a===void 0?o:p(Ko())},g}class $d extends Ti.exports.Component{constructor(e){super(e),this.seeking=!1,this.mobileSeeking=!1,this.track=null,this.hoverTime=null,this.offset=0,this.secondsPrefix="00:00:",this.minutesPrefix="00:",this.seekPause=!1,this.handleTouchSeeking=i=>{let n=0;for(let r=0;r<i.changedTouches.length;r++)n=i.changedTouches[r].pageX;n=n<0?0:n,this.mobileSeeking&&this.changeCurrentTimePosition(n)},this.handleSeeking=i=>{this.seeking&&this.changeCurrentTimePosition(i.pageX)},this.setTrackWidthState=()=>{this.track&&this.setState({trackWidth:this.track.offsetWidth})},this.handleTrackHover=(i,n)=>{if(this.track){const r=this.props.scale||1;let s;s=i?0:(n.pageX-this.track.getBoundingClientRect().left)/r,this.setState({seekHoverPosition:s,trackWidth:this.track.offsetWidth})}},this.mouseSeekingHandler=i=>{this.setSeeking(!1,i),this.onMouseUp()},this.setSeeking=(i,n)=>{n.preventDefault(),this.handleSeeking(n),this.seeking=i,this.setState({seekHoverPosition:i?this.state.seekHoverPosition:0})},this.mobileTouchSeekingHandler=()=>{this.setMobileSeeking(!1)},this.setMobileSeeking=i=>{this.mobileSeeking=i,this.setState({seekHoverPosition:i?this.state.seekHoverPosition:0})},this.renderBufferProgress=()=>{if(this.props.buffered){const i=Ue(Ue({},this.getPositionStyle(this.props.buffered)),this.props.bufferColor&&{backgroundColor:this.props.bufferColor});return G.createElement("div",{className:"buffered",style:i})}return null},this.renderProgress=()=>{const i=Ue(Ue({},this.getPositionStyle(this.props.current)),this.props.sliderColor&&{backgroundColor:this.props.sliderColor});return G.createElement("div",{className:"connect",style:i})},this.renderHoverProgress=()=>{const i=Ue(Ue({},this.getSeekHoverPosition()),this.props.sliderHoverColor&&{backgroundColor:this.props.sliderHoverColor});return G.createElement("div",{className:"seek-hover",style:i})},this.renderThumb=()=>G.createElement("div",{className:this.isThumbActive()?"thumb active":"thumb",style:this.getThumbHandlerPosition()},G.createElement("div",{style:{backgroundColor:this.props.thumbColor},className:"handler"})),this.onMouseDown=i=>{var n,r;this.props.pause&&!this.props.paused&&(this.props.pause(),this.seekPause=!0),this.setSeeking(!0,i),(r=(n=this.props).onSeekStart)==null||r.call(n)},this.onMouseUp=()=>{var i,n;this.props.play&&this.seekPause&&(this.props.play(),this.seekPause=!1),(n=(i=this.props).onSeekEnd)==null||n.call(i)},this.props.secondsPrefix&&(this.secondsPrefix=this.props.secondsPrefix),this.props.minutesPrefix&&(this.minutesPrefix=this.props.minutesPrefix),this.state={ready:!1,trackWidth:0,seekHoverPosition:0}}componentDidMount(){this.setTrackWidthState(),window.addEventListener("resize",this.setTrackWidthState),window.addEventListener("mousemove",this.handleSeeking),window.addEventListener("mouseup",this.mouseSeekingHandler),window.addEventListener("touchmove",this.handleTouchSeeking),window.addEventListener("touchend",this.mobileTouchSeekingHandler)}componentWillUnmount(){window.removeEventListener("resize",this.setTrackWidthState),window.removeEventListener("mousemove",this.handleSeeking),window.removeEventListener("mouseup",this.mouseSeekingHandler),window.removeEventListener("touchmove",this.handleTouchSeeking),window.removeEventListener("touchend",this.mobileTouchSeekingHandler)}changeCurrentTimePosition(e){if(this.track){const i=this.props.scale||1;let n=(e-this.track.getBoundingClientRect().left)/i;n=Math.min(this.state.trackWidth,Math.max(0,n)),this.setState({seekHoverPosition:n});const r=+(n/this.state.trackWidth*this.props.total).toFixed(0);this.props.onChange(r)}}getPositionStyle(e){return{transform:`scaleX(${100*e/this.props.total/100})`}}getThumbHandlerPosition(){return{transform:`translateX(${this.state.trackWidth/(this.props.total/this.props.current)}px)`}}getSeekHoverPosition(){return{transform:`scaleX(${100*this.state.seekHoverPosition/this.state.trackWidth/100})`}}getHoverTimePosition(){let e=0;return this.hoverTime&&(e=this.state.seekHoverPosition-this.hoverTime.offsetWidth/2,this.props.limitTimeTooltipBySides&&(e<0?e=0:e+this.hoverTime.offsetWidth>this.state.trackWidth&&(e=this.state.trackWidth-this.hoverTime.offsetWidth))),{transform:`translateX(${e}px)`}}secondsToTime(e){e=Math.round(e+this.offset);const i=Math.floor(e/3600),n=e%3600,r=Math.floor(n/60),s=Math.ceil(n%60);return{hh:i.toString(),mm:r<10?"0"+r:r.toString(),ss:s<10?"0"+s:s.toString()}}getHoverTime(){const e=100*this.state.seekHoverPosition/this.state.trackWidth,i=Math.floor(+e*(this.props.total/100)),n=this.secondsToTime(i);return this.props.total+this.offset<60?this.secondsPrefix+n.ss:this.props.total+this.offset<3600?this.minutesPrefix+n.mm+":"+n.ss:n.hh+":"+n.mm+":"+n.ss}isThumbActive(){return this.state.seekHoverPosition>0||this.seeking}drawHoverTime(){return this.props.hideHoverTime?null:G.createElement("div",{className:this.isThumbActive()?"hover-time active":"hover-time",style:this.getHoverTimePosition(),ref:e=>this.hoverTime=e},this.getHoverTime())}render(){return G.createElement("div",{className:"seek-slider"},G.createElement("div",{className:"track",ref:e=>this.track=e,onMouseMove:e=>this.handleTrackHover(!1,e),onMouseLeave:e=>this.handleTrackHover(!0,e),onMouseDown:this.onMouseDown,onTouchStart:e=>{this.setMobileSeeking(!0),this.onMouseDown(e)},onMouseUp:this.onMouseUp,onTouchEnd:this.onMouseUp},G.createElement("div",{className:"main"},this.renderBufferProgress(),this.renderHoverProgress(),this.renderProgress())),this.drawHoverTime(),this.renderThumb())}}class wS extends Ti.exports.Component{constructor(e){super(e),this.stageVolume=0,this.updateVolumeTimer=0,this.onVolumeSeeking=!1,this.onClickOperationButton=()=>{const{paused:i}=this.props;i?this.props.play():this.props.pause()},this.operationButton=()=>{const{paused:i}=this.props;return i?G.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiBjbGFzcz0iaWNvbmlmeSBpY29uaWZ5LS1tZGkiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNOCA1LjE0djE0bDExLTdsLTExLTd6IiBmaWxsPSIjZmZmIj48L3BhdGg+PC9zdmc+Cg=="}):G.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiBjbGFzcz0iaWNvbmlmeSBpY29uaWZ5LS1tZGkiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTQgMTloNFY1aC00TTYgMTloNFY1SDZ2MTR6IiBmaWxsPSIjZmZmIj48L3BhdGg+PC9zdmc+Cg=="})},this.operationVolumeButton=()=>this.props.volume>.9?G.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiBjbGFzcz0iaWNvbmlmeSBpY29uaWZ5LS1tZGkiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTQgMy4yM3YyLjA2YzIuODkuODYgNSAzLjU0IDUgNi43MXMtMi4xMSA1Ljg0LTUgNi43djIuMDdjNC0uOTEgNy00LjQ5IDctOC43N2MwLTQuMjgtMy03Ljg2LTctOC43N00xNi41IDEyYzAtMS43Ny0xLTMuMjktMi41LTQuMDNWMTZjMS41LS43MSAyLjUtMi4yNCAyLjUtNE0zIDl2Nmg0bDUgNVY0TDcgOUgzeiIgZmlsbD0iI2ZmZiI+PC9wYXRoPjwvc3ZnPgo="}):this.props.volume===0?G.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiBjbGFzcz0iaWNvbmlmeSBpY29uaWZ5LS1tZGkiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNNyA5djZoNGw1IDVWNGwtNSA1SDd6IiBmaWxsPSIjZmZmIj48L3BhdGg+PC9zdmc+Cg=="}):G.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiBjbGFzcz0iaWNvbmlmeSBpY29uaWZ5LS1tZGkiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNNSA5djZoNGw1IDVWNEw5IDltOS41IDNjMC0xLjc3LTEtMy4yOS0yLjUtNC4wM1YxNmMxLjUtLjcxIDIuNS0yLjI0IDIuNS00eiIgZmlsbD0iI2ZmZiI+PC9wYXRoPjwvc3ZnPgo="}),this.handleClickVolume=()=>{this.props.volume===0?this.stageVolume!==0?this.props.setVolume(this.stageVolume):this.props.setVolume(1):(this.stageVolume=this.props.volume,this.props.setVolume(0))},this.onChange=i=>{this.setState({currentTime:i}),i&&this.changeTime(i)},this.changeTime=Kr(i=>{this.props.setCurrentTime(i)},50),this.onVolumeChange=i=>{this.changeVolume(i),this.setState({seekVolume:i/100})},this.changeVolume=Kr(i=>{this.props.setVolume(i/100)},50),this.onVolumeSeekStart=()=>{this.onVolumeSeeking=!0},this.onVolumeSeekEnd=Kr(()=>{this.onVolumeSeeking=!1},500),this.onProgressSeekStart=()=>this.setState({isPlayerSeeking:!0}),this.onProgressSeekEnd=Kr(()=>{this.setState({isPlayerSeeking:!1})},500),this.state={isPlayerSeeking:!1,isVolumeHover:!1,seekVolume:1,visible:!0,currentTime:0},this.stageVolume=e.volume}componentDidMount(){this.updateVolumeTimer=setInterval(()=>{this.onVolumeSeeking||this.setState({seekVolume:this.props.volume}),this.state.isPlayerSeeking||this.setState({currentTime:this.props.currentTime})},100)}componentWillUnmount(){this.updateVolumeTimer&&clearInterval(this.updateVolumeTimer)}render(){const{duration:e,currentTime:i}=this.props;return G.createElement("div",{className:"player-controller",style:{opacity:this.props.visible?"1":"0"}},G.createElement("div",{className:"player-controller-progress"},G.createElement($d,{total:e,current:this.state.currentTime,onChange:this.onChange,buffered:this.props.buffered,bufferColor:"rgba(255,255,255,0.3)",hideHoverTime:!0,limitTimeTooltipBySides:!0,onSeekStart:this.onProgressSeekStart,onSeekEnd:this.onProgressSeekEnd,play:this.props.play,pause:this.props.pause,paused:this.props.paused,scale:this.props.scale})),G.createElement("div",{className:"player-controller-actions"},G.createElement("div",{className:"player-controller-actions-left"},G.createElement("div",{onClick:this.onClickOperationButton,className:"player-controller-play"},this.operationButton()),G.createElement("div",{className:"player-volume-box",onMouseEnter:()=>this.setState({isVolumeHover:!0}),onMouseLeave:()=>this.setState({isVolumeHover:!1})},G.createElement("div",{onClick:this.handleClickVolume,className:"player-volume"},this.operationVolumeButton()),G.createElement("div",{className:"player-volume-slider"},G.createElement($d,{total:100,current:100*this.state.seekVolume,onChange:this.onVolumeChange,onSeekStart:this.onVolumeSeekStart,onSeekEnd:this.onVolumeSeekEnd,scale:this.props.scale,limitTimeTooltipBySides:!0,hideHoverTime:!0})))),G.createElement("div",{className:"player-mid-box-time"},Fd(Math.floor(i/1e3))," /"," ",Fd(Math.floor(e/1e3)))))}}function Fd(t){const e=t%60,i=(t-e)/60;if(i>=60){const n=i%60;return`${kn((i-n)/60)}:${kn(n)}:${kn(e)}`}return`${kn(i)}:${kn(e)}`}function kn(t){return t<=9?`0${t}`:`${t}`}let yS=99999;var ul,Di;(Di=ul||(ul={}))[Di.Idle=0]="Idle",Di[Di.Playing=1]="Playing",Di[Di.Paused=2]="Paused";let Te={};function me(t,...e){Et.verbose&&console.log(`[RTCEffect] ${t}`,...e)}function xS(t,e,i){function n(s){Te[s].playState===0?(t.playEffect(s,i,0,1,0,100,!1,0).then(()=>{me(">>> Play Success",{playingId:s})}),Te[s].playState=1):me(">>> Skip Play",{playingId:s,state:Te[s].playState})}function r(s){Te[s].playState=0,Te[s].previousVideoJSAdvance=0,Te[s].previousSeekTargetTime=0,Te[s].previousBeginSeekTime=0}e.one("ready",()=>{var s;const o=((s=e==null?void 0:e.tagAttributes)==null?void 0:s.src)||"";Ng.includes("."+o.split(".").pop()||"")||(me(">>> Mute js player",{src:o}),e.muted(!0),e.muted=l=>!1);const a=function(){const l=yS--,u={playState:ul.Idle,previousVideoJSAdvance:0,previousSeekTargetTime:0,previousBeginSeekTime:0};return Te[l]=u,l}();me(">>> Setup",{playingId:a,src:o}),t.addListener("error",l=>{me(">>> Error",{soundId:l}),r(l)}),t.addListener("effectFinished",l=>{me(">>> Finished",{soundId:l}),r(l)}),e.on("play",()=>{switch(Te[a].playState){case 0:me(">>> Start play",{playingId:a}),n(a);break;case 2:me(">>> Resume play",{playingId:a}),t.resumeEffect(a),Te[a].playState=1}}),e.on("pause",()=>{const l=Te[a].playState;switch(l){case 1:me(">>> Pause play",{playingId:a}),t.pauseEffect(a),Te[a].playState=2;break;default:me(">>> Skip Pause",{playingId:a,currenState:l})}}),e.on("timeupdate",()=>{t.getEffectCurrentPosition(a).then(l=>{const u=Te[a],c=l/1e3,d=e.currentTime(),f=u.previousSeekTargetTime!==0&&u.previousBeginSeekTime!==0;if(me(`>>> EffectSecond rtc: ${c} js: ${d} seeking: ${f}`,{playingId:a}),u.playState==0)return void(e.paused()||(me(">>> Play effect due to time update.",{playingId:a}),n(a)));if(f&&c<u.previousSeekTargetTime)return;if(u.playState!==1)return void me(">>> Skip timupdate",{playingId:a,state:u.playState,jsTime:e.currentTime(),rtcEffectTime:c});function v(y,h){t.setEffectPosition(h,1e3*y),u.previousBeginSeekTime=Date.now()/1e3,u.previousSeekTargetTime=y}const w=u.previousBeginSeekTime;if(l>0){const y=d-c,h=Math.abs(y),p=.5;if(h>p)if(f){const g=u.previousSeekTargetTime-c,m=Date.now()/1e3-w,x=m+(y>0?y:0),M=d+x;v(M,a),me(">>> Start seeking after seeking lag",{jsPlayerTime:d,rtcEffectTime:c,jsPlayerTimerAdvance:y,lastSeekingCost:m,estimatedRTCLag:x,targetRTCSeekTime:M,previousBeginSeekTime:w,timeElapse:g})}else if(h>10)v(d,a),me(">>> DirectSeek",{time:d,rtcEffectTime:c,jsPlayerTimerAdvance:y});else{const g=u.previousVideoJSAdvance,m=0,x=d+m;u.previousVideoJSAdvance=m,v(x,a),me(">>> Start seeking with lag",{jsPlayerTime:d,rtcEffectTime:c,jsPlayerTimerAdvance:y,previousAdvance:g,estimatedRTCLag:m,targetRTCSeekTime:x})}else f&&(me(">>> SeekingFinish no lag",{jsPlayerTime:d,rtcEffectTime:c,jsPlayerTimerAdvance:y,previousBeginSeekTime:w,rtcLagTolerance:p}),u.previousBeginSeekTime=0,u.previousSeekTargetTime=0)}})}),e.on("dispose",()=>{Te[a].playState&&(t.stopEffect(a),delete Te[a],me(">>> Dispose",{playingId:a}))})})}class Wd extends Ti.exports.Component{constructor(){super(...arguments),this.putAttributes=e=>{const{context:i}=this.props,n=i.getAttributes()||{};for(const r in e)n[r]!==e[r]&&i.updateAttributes([r],e[r])}}render(){const{context:e}=this.props,i=e.getRoom(),n=i?void 0:e.getDisplayer(),r=this.putAttributes;return G.createElement(MS,{room:i,player:n,context:e,plugin:{putAttributes:r}})}}class MS extends Ti.exports.Component{constructor(e){super(e),this.alertMask=null,this.container=G.createRef(),this.controllerHiddenTimer=0,this.syncPlayerTimer=0,this.retryCount=0,this.decreaseRetryTimer=0,this.noSoundSyncCount=0,this.everPlayed=!1,this.showController=()=>{this.setState({controllerVisible:!0}),this.debounceHidingController()},this.play=()=>{var i;const n=(i=this.props.room)==null?void 0:i.calibrationTimestamp;this.debug(">>> play",{paused:!1,hostTime:n}),this.isEnabled()&&this.props.plugin.putAttributes({paused:!1,hostTime:n})},this.pause=()=>{const i=Jr(this.getAttributes(),this.props);this.debug(">>> pause",{paused:!0,currentTime:i}),this.isEnabled()&&this.props.plugin.putAttributes({paused:!0,currentTime:i})},this.setVolume=i=>{this.debug(">>> volume",{volume:i}),this.isEnabled()&&this.props.plugin.putAttributes({volume:i}),this.isEnabled()&&this.props.plugin.putAttributes({volume:i,muted:i===0})},this.setCurrentTime=i=>{var n;const r=(n=this.props.room)==null?void 0:n.calibrationTimestamp;this.debug(">>> seek",{currentTime:i/1e3,hostTime:r}),this.isEnabled()&&this.props.plugin.putAttributes({currentTime:i/1e3,hostTime:r})},this.resetPlayer=()=>{var i;(i=this.player)==null||i.autoplay(!1),this.state.NoSound||(this.debug(">>> ended",{paused:!0,currentTime:0}),this.isEnabled()&&this.props.plugin.putAttributes({paused:!0,currentTime:0}))},this.syncPlayerWithAttributes=()=>{var i;const n=this.getAttributes();if(!n)return;const r=this.player;if(!r||this.state.NoSound&&(this.noSoundSyncCount+=1)%8!=0)return;r.paused()!==n.paused&&(this.debug("<<< paused -> %o",n.paused),n.paused?r.pause():((i=r.play())==null||i.catch(this.catchPlayFail),this.everPlayed=!0)),r.muted()!==n.muted&&(this.debug("<<< muted -> %o",n.muted),r.muted(n.muted)),r.volume()!==n.volume&&(this.debug("<<< volume -> %o",n.volume),r.volume(n.volume));const s=Jr(n,this.props);let o=Et.currentTimeMaxError;if(this.state.NoSound&&(o*=3),s>r.duration())this.resetPlayer();else if(Math.abs(r.currentTime()-s)>o){if(this.debug("<<< currentTime -> %o",s),iS)return void(this.everPlayed?r.currentTime(s):this.debug("<<< ignore iOS idle time update. -> %o (ignored)",s));r.currentTime(s)}},this.debounceHidingController=()=>{this.controllerHiddenTimer&&(clearTimeout(this.controllerHiddenTimer),this.controllerHiddenTimer=0),this.controllerHiddenTimer=setTimeout(()=>{this.setState({controllerVisible:!1}),this.controllerHiddenTimer=0},3e3)},this.decreaseRetryCount=()=>{this.player&&this.retryCount>0&&(this.retryCount=this.retryCount-1)},this.catchPlayFail=i=>{var n,r;const s=String(i);if(tS&&s.includes("NotAllowedError")||s.includes("interact"))(n=this.player)==null||n.autoplay("any"),this.setState({NoSound:!0});else{const o=(r=this.player)==null?void 0:r.error();o&&(this.retryCount<=3?(this.initPlayer(),this.retryCount=this.retryCount+1):(this.debug("catch videojs media error",o),this.setState({MediaError:!0}))),this.debug("catch error",i)}},this.fixPlayFail=()=>{this.debug("try to fix play state"),this.setState({NoSound:!1});const{muted:i,volume:n}=this.getAttributes();this.player&&(this.player.muted(i),this.player.volume(n))},this.initPlayer=async()=>{var i;(i=this.player)==null||i.dispose(),this.player=void 0,this.debug("creating elements ...");const{type:n,src:r,poster:s}=this.getAttributes(),o=document.createElement("div");o.setAttribute("data-vjs-player","");const a=document.createElement("video");a.className="video-js",a.crossOrigin="anonymous",s&&(a.poster=s),a.setAttribute("playsInline",""),a.setAttribute("webkit-playsinline","");const l=document.createElement("source");new URL(r).pathname.endsWith(".m3u8")?l.type="application/x-mpegURL":a.src=r,l.src=r,n&&(l.type=n),a.appendChild(l),o.appendChild(a),this.container.current.appendChild(o),await new Promise(f=>(window.requestAnimationFrame||window.setTimeout)(f)),this.debug("initializing videojs() ...");const u=Fu.default(a);this.player=u,window.player=u,u.one("loadedmetadata",this.gracefullyUpdate);const c=window.__mediaPlayerAudioEffectClient;c!==void 0&&xS(c,u,r);const d=window.__pcmProxy;d!==void 0&&(u.one("play",()=>{const f=d.connect(a);this.audioSource=f,this.debug("Connect to PCMProxy ",r)}),u.one("dispose",()=>{this.audioSource&&(this.audioSource.disconnect(),this.audioSource=void 0,this.debug("Disconnect from PCMProxy",r))})),u.on("ready",()=>{var f;(f=Et.onPlayer)==null||f.call(Et,u),u.on("timeupdate",this.gracefullyUpdate),u.on("volumechange",this.gracefullyUpdate),u.on("seeked",this.gracefullyUpdate),u.on("play",this.gracefullyUpdate),u.on("pause",this.gracefullyUpdate),u.on("ended",this.resetPlayer)}),u.on("error",this.catchPlayFail),this.setState({MediaError:!1})},this.gracefullyUpdate=()=>this.setState({updater:!this.state.updater}),this.setupAlert=i=>{i&&(i.addEventListener("touchstart",this.fixPlayFail),i.addEventListener("click",this.fixPlayFail)),this.alertMask=i},this.setupReload=i=>{i&&(i.addEventListener("touchstart",this.initPlayer),i.addEventListener("click",this.initPlayer))},this.state={NoSound:!1,MediaError:!1,updater:!1,controllerVisible:!1},e.room&&function(i){if(!i.calibrationTimestamp)throw new Error("@netless/app-media-player@0.1.0-alpha.5 requires white-web-sdk@^2.13.8 to work properly.")}(e.room)}getAttributes(){const{context:e}=this.props;let i=e.getAttributes();if(i){if(i=Ue(Ue({},Ag),i),this.player){let r=Jr(i,this.props),s=this.player.duration();!i.paused&&r>s&&(n=Ue({},i),i=JM(n,KM({currentTime:0,paused:!0})),this.resetPlayer())}var n;return i}}isShowingPoster(){const e=this.getAttributes();return!(e!=null&&e.src)||Ng.some(i=>e.src.endsWith(i))}render(){var e,i;if(!this.props.room&&!this.props.player)return null;const n=this.getAttributes();if(!n)return null;const r=1e3*(((e=this.player)==null?void 0:e.duration())||1e3),s=((i=this.player)==null?void 0:i.bufferedPercent())||0;return G.createElement("div",{className:this.isEnabled()?"vjs-p":"vjs-p disabled",onMouseEnter:this.showController,onMouseMove:this.showController},G.createElement("div",{className:"video-js-plugin-player",ref:this.container}),this.isShowingPoster()&&G.createElement("div",{className:"video-js-plugin-poster"},n.poster&&G.createElement("img",{src:n.poster,alt:"",draggable:!1})),G.createElement(wS,{duration:r,volume:n.volume,setVolume:this.setVolume,paused:n.paused,play:this.play,pause:this.pause,currentTime:1e3*Jr(n,this.props),setCurrentTime:this.setCurrentTime,buffered:r*s,visible:!0}),this.state.NoSound&&G.createElement("div",{ref:this.setupAlert,className:"videojs-plugin-muted-alert"}),this.state.MediaError&&G.createElement("div",{className:"videojs-plugin-recovery-mode"},G.createElement("button",{ref:this.setupReload},"Reload Player")))}debug(e,...i){Et.verbose&&Et.log(`[MediaPlayer] ${e}`,...i)}componentDidMount(){this.debug("app version =","0.1.0-alpha.5"),this.debug("video.js version =",Fu.default.VERSION),this.initPlayer(),this.props.context.emitter.on("attributesUpdate",this.syncPlayerWithAttributes),this.syncPlayerTimer=setInterval(this.syncPlayerWithAttributes,Et.syncInterval),this.decreaseRetryTimer=setInterval(this.decreaseRetryCount,Et.retryInterval)}componentWillUnmount(){var e;this.debug("unmount"),this.props.context.emitter.off("attributesUpdate",this.syncPlayerWithAttributes),(e=this.player)==null||e.dispose(),clearInterval(this.syncPlayerTimer),clearInterval(this.decreaseRetryTimer)}isEnabled(){return this.props.context.getIsWritable()}}const cl={kind:"MediaPlayer",setup(t){let e=t.getAttributes();if(!e||!e.src)return t.emitter.emit("destroy",{error:new Error("[MediaPlayer]: Missing 'attributes'.'src'.")});e=Ue(Ue({},Ag),e);const i=t.getBox();i.mountStyles(`.vjs-p{display:flex;flex-grow:1}.vjs-p *{pointer-events:auto}.vjs-p.disabled *{pointer-events:none}.vjs-p .video-js-plugin-poster{position:absolute;top:0;left:0;right:0;bottom:0;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgQAAACACAYAAAB0vHFxAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAACBKADAAQAAAABAAAAgAAAAACE3oPTAAAKXUlEQVR4Ae3dYW4ktxEG0LW9FwkC2McycokAOUGAXMLwtQwYvomdP4akHUnNnm6SVUU+/xqpe8ji+yiDWz3a/e7L5v/98se//3pL8K9//O+7t19Hv85eX7RP9vnllz2h4/rkd+wz+ir/0cLfjv/9t1/6igABAgQIENhRwIFgx9StmQABAgQIPAg4EDyA+JIAAQIECOwo8HXHRVvzPIHRzwBHjz9PKudMo31Hj59TdZ2qsueXvb5sO0GHIFsi6iFAgAABAgECOgQB6KbsJ5Dtt0L6rWyPkeRXO+fs+WWvL1v6OgTZElEPAQIECBAIENAhCEA3ZT8Bzwj7WUaMJL8I9X5zZs8ve339kugzkg5BH0ejECBAgACB0gIOBKXjUzwBAgQIEOgj4EDQx9EoBAgQIECgtIADQen4FE+AAAECBPoIOBD0cTQKAQIECBAoLeC3DErHp/iWgE8Zt4RyX5df7nxa1Y3Ob/T4rfWtdl2HYLVErYcAAQIECFwQWL5DsPoJcvX1XdjTpd4iv1JxvStWfu9IfCORwLP7U4cgUXhKIUCAAAECUQIOBFHy5iVAgAABAokEHAgShaEUAgQIECAQJXD7MwTPPqOIWujVeUevb/T4V9ftfecE5HfOKetd8suajLoiBHQIItTNSYAAAQIEkgnc7hAkW0/3ckb/e9qjx+8OYsBvBOT3DUe5L+RXLjIFDxTQIRiIa2gCBAgQIFBFoNkh2P0Z2+j1jx4/+0asvv7q9d/dH9XXX73+3fO7u/7W+3fbHzoErR3hOgECBAgQ2ECg2SHwjG2DXRC4xOj9tdufAHpHLb/eonPHk9+xd7TPcXX9r+oQ9Dc1IgECBAgQKCfgQFAuMgUTIECAAIH+Ag4E/U2NSIAAAQIEygk0P0MQvaLsz3hb9bWu840WOJ5ffsc+2a/KL3tC6jsSmL1/dQiO0nCNAAECBAhsItDsEMw+oTzrHl1f61OorevPrvfZ+6N9WvVmr09+xwnKr7ZP9vyOdcdfze7Tuz4dgvF7ygwECBAgQCC9QLNDkH0F0X+C45NdoHZ99rf8aguofqRA7/8/6BCMTMvYBAgQIECgiED5DkHvZyhFcjtdJp/TVClvlF/KWE4XJb/TVG68INB7f+kQXAjBWwgQIECAwGoCDgSrJWo9BAgQIEDggoADwQU0byFAgAABAqsJfO39DGI1IOuJFbA/Y/3vzi6/u4Kx7189v7vru/v+2HTfz65D8N7EdwgQIECAwHYCw3/LYLUT1HY7pLFg+TaAkl+WX/KAGuXJrwEUfLlaPjoEwRvG9AQIECBAIIPA8A5B779JKQOaGl4F5PtqUfGV/Cqm9lqz/F4tMr6qlo8OQcZdpCYCBAgQIDBZYHiHoNozlMn+5aeTb+0I5Se/2gK5q6/286VDkHs/qY4AAQIECEwRcCCYwmwSAgQIECCQW8CBIHc+qiNAgAABAlMEhn+GYMoqTEKAAAEC7wSqPcN+twDfmCqgQzCV22QECBAgQCCnQHiHoPoJtlV/63rObfFaVfX6X1dy7VX19Vev/1pqr++qvv7q9b8m4dVHAtny1SH4KCXfI0CAAAECmwmEdwiq/U1Om+2PL/Kpnbj85FdbYO3qs/186hCsvd+sjgABAgQInBJwIDjF5CYCBAgQILC2gAPB2vlaHQECBAgQOCUQ/hmCbJ+yPKW20U3yqR22/ORXW2Dt6qN/Ph/n1yFYe79ZHQECBAgQOCXgQHCKyU0ECBAgQGBtAQeCtfO1OgIECBAgcErAgeAUk5sIECBAgMDaAg4Ea+drdQQIECBA4JTA1+///OGnoztd52N/fC7g58PPx+e748sX+8P+qLQ/dAiO0nKNAAECBAhsIuBAsEnQlkmAAAECBI4EHAiOdFwjQIAAAQKbCDgQbBK0ZRIgQIAAgSMBB4IjHdcIECBAgMAmAuH/lsHP//zvb5tYl1ymfErG9lK0/F4oSr6QX8nYThcdne/j/DoEp6NzIwECBAgQWFfAgWDdbK2MAAECBAicFnAgOE3lRgIECBAgsK5A+GcIfv39Pz++5X18pvH2mtfzBeQz37znjPLrqTl/LPnNN585Y7Z8dQhmpm8uAgQIECCQVCC8Q1C9I9Cqv3U96b54Kat6/S8Lufii+vqr138xtpe3VV9/9fpfgvDiQ4Fs+eoQfBiTbxIgQIAAgb0EwjsEe3FbLQECBOYJZPsT6LyVm+mKgA7BFTXvIUCAAAECiwk4ECwWqOUQIECAAIErAg4EV9S8hwABAgQILCYw/DMEnmEttmMeliPfB5BiX8qvWGAP5crvASTZl9Xy0SFItoGUQ4AAAQIEIgSGdwiy/U1MEcgrzynf2unKT361BXJXX+3nS4cg935SHQECBAgQmCIwvENQ7RnKFPWFJpFv7TDlJ7/aArmrr/bzpUOQez+pjgABAgQITBH4Wu0EM0XFJGkE7M80UVwqRH6X2NK8afX87q7v7vvTBP13IToE2RJRDwECBAgQCBBwIAhANyUBAgQIEMgm4ECQLRH1ECBAgACBAIHhv2Uwek2rPcPp7cWnt+jc8eQ317v3bPLrLWq8twK995cOwVtdrwkQIECAwKYC5TsE1f4mqNn7jM9s8b7zya+v5+zR5DdbfK/5eu8vHYK99o/VEiBAgACBDwWaHYLezyg+rOLGN6Pra53QWtdvLP3UW6N9WkVmr09+xwnKr7ZP9vyOdcdfze7Tuz4dgvF7ygwECBAgQCC9QLNDEL2C3ieg3utp1de63rueZ8fLXt+z6+l9f3af7PX1zuPZ8bL7ZK/vWW/39xWYvT90CPrmZzQCBAgQIFBSwIGgZGyKJkCAAAECfQUcCPp6Go0AAQIECJQUaH6GIPpT1iVVFX1aIHp/zX5GdxqmyI3yKxLUJ2XK7xOYv78d7XNcXf+rOgT9TY1IgAABAgTKCTQ7BLv/CWr0+kePn31HVl9/9frv7o/q669e/+753V1/6/277Q8dgtaOcJ0AAQIECGwg0OwQbGBwuMTRz5BGj3+4OBdvC8jvNmHoAPIL5Td5MgEdgmSBKIcAAQIECEQI3O4QrP6MZfT6Ro8fsal2mlN+tdOWX+38VN9XQIegr6fRCBAgQIBASQEHgpKxKZoAAQIECPQVcCDo62k0AgQIECBQUuD2Zwiyr3r1Z4Srry/7/rpbn/zuCsa+X36x/mY/Fnh2f+oQHHu6SoAAAQIEthBYvkOwRYoW+anAsyfkTwdyIURAfiHs3SYdnd/o8btBFBlIh6BIUMokQIAAAQIjBRwIRuoamwABAgQIFBFwICgSlDIJECBAgMBIAQeCkbrGJkCAAAECRQQcCIoEpUwCBAgQIDBSwG8ZjNQ19nABnzIeTjx0AvkN5R0+ePb8stc3PKAnJ9AheBLM7QQIECBAYEUBHYIVU91oTf49+9phy09+IwXsr+d0dQie83I3AQIECBBYUkCHYMlY8yxq9DO80ePnkYypZLTv6PFj1PaZNXt+2evLtlN0CLIloh4CBAgQIBAg4EAQgG5KAgQIECCQTcCBIFsi6iFAgAABAgEC/wdVfx9UuC8B6AAAAABJRU5ErkJggg==);background-repeat:repeat-x;background-position:0 50%;display:flex;align-items:center;justify-content:center}.vjs-p .video-js-plugin-poster img{box-shadow:0 0 5px 10px #0006}.vjs-p .player-controller,.vjs-p .videojs-plugin-muted-alert{pointer-events:auto}.vjs-p.disabled .videojs-plugin-close-icon,.vjs-p.disabled .player-controller{pointer-events:none}.vjs-p .video-js-plugin-player{position:absolute;top:0;left:0;right:0;bottom:0}.video-js,[data-vjs-player]{width:100%;height:100%}.vjs-p .videojs-plugin-muted-alert{pointer-events:auto;cursor:pointer;position:absolute;top:0;left:0;right:0;bottom:0;z-index:43}.vjs-p .videojs-plugin-muted-alert:before{pointer-events:auto;cursor:pointer;position:absolute;top:0;left:0;right:0;bottom:0;z-index:43;content:"\\f104";background:rgba(0,0,0,.3);font-family:VideoJS;font-size:2em;display:flex;align-items:center;justify-content:center;color:#fff}.vjs-p .videojs-plugin-recovery-mode{pointer-events:auto;cursor:pointer;position:absolute;top:0;left:0;right:0;bottom:0;z-index:44}.vjs-p .videojs-plugin-recovery-mode button{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.vjs-p .seek-slider{position:relative;width:100%}.vjs-p .seek-slider:focus{outline:none}.vjs-p .seek-slider .track{padding:10px 0;cursor:pointer;outline:none}.vjs-p .seek-slider .track:focus{border:0;outline:none}.vjs-p .seek-slider .track .main{width:100%;height:3px;background-color:#ffffff4d;border-radius:30px;position:absolute;left:0;top:8.5px;transition:transform .4s;outline:none}.vjs-p .seek-slider .track .main:focus{border:0;outline:none}.vjs-p .seek-slider .track .main .buffered{position:absolute;background-color:#ffffff4d;width:100%;height:100%;transform:scaleX(.8);z-index:2;transform-origin:0 0}.vjs-p .seek-slider .track .main .seek-hover{position:absolute;background-color:#ffffff80;width:100%;height:100%;z-index:1;transform:scaleX(.6);transform-origin:0 0;opacity:0;transition:opacity .4s}.vjs-p .seek-slider .track .main .connect{position:absolute;background-color:#fff;width:100%;height:100%;z-index:3;left:0;transform:scaleX(.13);transform-origin:0 0}.vjs-p .seek-slider .track.active .main{transform:scaleY(2)}.vjs-p .seek-slider .thumb{pointer-events:none;position:absolute;width:12px;height:12px;left:-6px;top:4px;z-index:4;transform:translate(100px)}.vjs-p .seek-slider .thumb .handler{border-radius:100%;width:100%;height:100%;background-color:#fff;opacity:0;transform:scale(.4);cursor:pointer;transition:transform .2s;pointer-events:none}.vjs-p .seek-slider .thumb.active .handler{opacity:1;transform:scale(1)}.vjs-p .seek-slider .hover-time{position:absolute;background-color:#0000004d;line-height:18px;font-size:16px;color:#ddd;top:-25px;left:0;padding:5px 10px;border-radius:5px;box-shadow:0 0 5px #0000004d;opacity:0;transform:translate(150px);pointer-events:none}.vjs-p .seek-slider .hover-time.active{opacity:1}.vjs-p .seek-slider:hover .track .main .seek-hover{opacity:1}.vjs-p .player-controller{position:absolute;z-index:100;bottom:0px;left:0;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:stretch;height:64px;background-image:linear-gradient(0deg,#000,transparent);transition:opacity .2s;color:#fff}.vjs-p .player-menu-box{display:flex;align-items:center;justify-content:center;flex-direction:column;margin-bottom:40px}.vjs-p .player-menu-cell{width:100%;text-align:center;font-size:12px;color:#7a7b7c}.vjs-p .player-multiple-play{width:64px;height:120px}.vjs-p .player-controller-actions-left{display:flex;justify-content:center;align-items:center;flex-shrink:0}.vjs-p .player-right-box{font-size:14px;color:#7a7b7c;cursor:pointer;margin-right:12px}.vjs-p .player-controller-actions{display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding-left:8px;padding-right:8px;margin-top:2px}.vjs-p .player-mid-box-time{font-size:9px;display:flex;justify-content:center;align-items:center;color:#fff;flex-shrink:0;margin-right:8px;font-family:monospace}.vjs-p .player-controller-play{display:flex;align-items:center;justify-content:center;cursor:pointer;padding-right:4px}.vjs-p .player-controller-progress{width:calc(100% - 28px);margin-left:14px;display:flex;align-items:center;justify-content:center;margin-top:8px}.vjs-p .player-volume{display:flex;align-items:center;justify-content:center;cursor:pointer;margin-right:16px;margin-left:8px}.vjs-p .player-volume-slider{width:60px;margin-right:12px;display:flex;align-items:center}.vjs-p .player-volume-box{display:flex;flex-direction:row}.netless-app-media-player-container{display:flex;position:relative;height:100%}
`);const n=document.createElement("div");if(n.classList.add("netless-app-media-player-container"),Xr.render(G.createElement(Wd,{context:t}),n),i.mountContent(n),t.emitter.on("destroy",()=>{console.log("[MediaPlayer]: destroy"),Xr.unmountComponentAtNode(n)}),window.__pcmProxy){const r=()=>{document.visibilityState==="hidden"?(console.log("[MediaPlayer]: visibilitychange -> hidden. unmount for pcmproxy"),Xr.unmountComponentAtNode(n)):(console.log("[MediaPlayer]: visibilitychange -> visible. mount for pcmproxy"),Xr.render(G.createElement(Wd,{context:t}),n))};document.addEventListener("visibilitychange",r),t.emitter.on("destroy",()=>{document.removeEventListener("visibilitychange",r)})}}},SS=()=>{q.debug&&Tg({verbose:!0}),q.register({kind:ga.kind,src:ga}),q.register({kind:cl.kind,src:cl})},IS={DocsViewer:ga.kind,MediaPlayer:cl.kind};var Bg=(t=>(t.Init="Init",t.AttributesUpdate="AttributesUpdate",t.SetAttributes="SetAttributes",t.RegisterMagixEvent="RegisterMagixEvent",t.RemoveMagixEvent="RemoveMagixEvent",t.RemoveAllMagixEvent="RemoveAllMagixEvent",t.RoomStateChanged="RoomStateChanged",t.DispatchMagixEvent="DispatchMagixEvent",t.ReciveMagixEvent="ReciveMagixEvent",t.NextPage="NextPage",t.PrevPage="PrevPage",t.SDKCreate="SDKCreate",t.OnCreate="OnCreate",t.SetPage="SetPage",t.GetAttributes="GetAttributes",t.Ready="Ready",t.Destory="Destory",t.StartCreate="StartCreate",t.WrapperDidUpdate="WrapperDidUpdate",t.DispayIframe="DispayIframe",t.HideIframe="HideIframe",t.GetRootRect="GetRootRect",t.ReplayRootRect="ReplayRootRect",t.PageTo="PageTo",t))(Bg||{}),Dg=(t=>(t.WrapperDidMount="WrapperDidMount",t.IframeLoad="IframeLoad",t))(Dg||{});const Lt={Ready:"Ready",RootRect:"ReplayRootRect",Message:"message",ComputeStyle:"computeStyle",Load:"load",DisplayerState:"displayerState",Show:"show",Hide:"hide"},CS=(t,e)=>new Array(t).fill(0).map((i,n)=>e(n)),se=class{constructor(t,e){this.manager=t,this.appManager=e,this.magixEventMap=new Map,this.cssList=[],this.allowAppliances=["clicker"],this.bridgeDisposer=b.noop,this.rootRect=null,this.sideEffectManager=new pn,this.execListenIframe=b.debounce(i=>{this.listenIframe(i)},50),this.onPhaseChangedListener=i=>{i===A.PlayerPhase.Playing&&this.computedStyleAndIframeDisplay()},this.stateChangeListener=i=>{i={...i},i.cameraState=this.manager.cameraState,this.postMessage({kind:"RoomStateChanged",payload:i}),i.cameraState&&(se.emitter.emit("GetRootRect"),this.computedStyle(i)),i.memberState&&(this.computedZindex(),this.updateStyle()),i.sceneState&&this.computedIframeDisplay(i,this.attributes)},this.displayer=se.displayer=e.displayer,this.iframe=this._createIframe(),this.sideEffectManager.addDisposer(se.emitter.on("ReplayRootRect",i=>{this.rootRect=i}),Lt.RootRect),this.sideEffectManager.addDisposer(se.emitter.on("HideIframe",()=>{this.iframe.className=se.hiddenClass}),Lt.Hide),this.sideEffectManager.addDisposer(se.emitter.on("DispayIframe",()=>{this.iframe.className=""}),Lt.Show),this.sideEffectManager.addDisposer(se.emitter.on("created",()=>{this.bridgeDisposer(),this.bridgeDisposer=A.autorun(()=>{var n;const i=this.attributes;if(i.url){const r=(n=this.iframe)==null?void 0:n.src;r&&r!==i.url&&this.execListenIframe(i)}i.displaySceneDir&&this.computedIframeDisplay(this.displayer.state,i),(i.width||i.height)&&this.iframe&&(this.iframe.width=`${i.width}px`,this.iframe.height=`${i.height}px`),this.postMessage({kind:"AttributesUpdate",payload:i})})})),this.sideEffectManager.addDisposer(t.emitter.on("cameraStateChange",()=>{this.computedStyle(this.displayer.state)})),se.onCreate(this)}static onCreate(t){se.emitter.emit("StartCreate"),se.emitter.emit("OnCreate",t),se.emitter.emit("created")}insert(t){const e={url:t.url,width:t.width,height:t.height,displaySceneDir:t.displaySceneDir,useClicker:t.useClicker||!1,useSelector:t.useSelector};this.setAttributes(e);const i=()=>{this.getIframe(),this.listenIframe(this.attributes),this.listenDisplayerState(),se.emitter.emit("GetRootRect")};if(this.getIframe())i();else{const n=this.sideEffectManager.addDisposer(se.emitter.on("WrapperDidMount",()=>{i(),this.sideEffectManager.flush(n)})),r=this.sideEffectManager.addDisposer(se.emitter.on("WrapperDidUpdate",()=>{i(),this.sideEffectManager.flush(r)}))}return this.attributes.useSelector&&this.allowAppliances.push("selector"),this.computedStyle(this.displayer.state),this.listenDisplayerCallbacks(),this.getComputedIframeStyle(),this.sideEffectManager.addEventListener(window,"message",this.messageListener.bind(this),void 0,Lt.Message),se.alreadyCreate=!0,this}getComputedIframeStyle(){this.sideEffectManager.setTimeout(()=>{this.iframe&&getComputedStyle(this.iframe)},200,Lt.ComputeStyle)}destroy(){this.sideEffectManager.flushAll(),se.emitter.emit("Destory"),se.alreadyCreate=!1,se.emitter.clearListeners()}getIframe(){return this.iframe||(this.iframe=this._createIframe()),this.iframe}setIframeSize(t){this.iframe&&(this.iframe.width=`${t.width}px`,this.iframe.height=`${t.height}px`,this.setAttributes({width:t.width,height:t.height}))}get attributes(){return this.appManager.store.getIframeBridge()}setAttributes(t){this.appManager.store.setIframeBridge(t)}_createIframe(){const t=document.createElement("iframe");return t.id="IframeBridge",t.className=se.hiddenClass,this.appManager.mainView.divElement&&this.appManager.mainView.divElement.appendChild(t),t}scaleIframeToFit(t=A.AnimationMode.Immediately){if(!this.inDisplaySceneDir)return;const{width:e=1280,height:i=720}=this.attributes,n=e?-e/2:0,r=i?-i/2:0;this.manager.moveCameraToContain({originX:n,originY:r,width:e,height:i,animationMode:t})}get isReplay(){return this.manager.isReplay}handleSetPage(t){if(this.isReplay||!this.attributes.displaySceneDir)return;const e=t.payload,i=this.displayer,n=i.entireScenes()[this.attributes.displaySceneDir];if(!n||n.length!==e){const r=CS(e,s=>({name:String(s+1)}));i.putScenes(this.attributes.displaySceneDir,r),this.manager.setMainViewScenePath(this.attributes.displaySceneDir)}}listenIframe(t){const e=i=>{var n;this.postMessage({kind:"Init",payload:{attributes:this.attributes,roomState:(n=se.displayer)==null?void 0:n.state,currentPage:this.currentPage,observerId:this.displayer.observerId}}),se.emitter.emit("IframeLoad",i),this.sideEffectManager.addDisposer(se.emitter.on("Ready",()=>{var r;this.postMessage((r=this.attributes.lastEvent)==null?void 0:r.payload)}),Lt.Ready),this.computedStyleAndIframeDisplay()};t.url&&this.iframe.src!==t.url&&(this.src_url_equal_anchor||(this.src_url_equal_anchor=document.createElement("a")),this.src_url_equal_anchor.href=t.url,this.src_url_equal_anchor.href!==this.iframe.src&&(this.iframe.src=t.url)),this.iframe.width=`${t.width}px`,this.iframe.height=`${t.height}px`,this.sideEffectManager.addEventListener(this.iframe,"load",e,void 0,Lt.Load)}listenDisplayerState(){this.isReplay&&(this.displayer._phase===A.PlayerPhase.Playing&&this.computedStyleAndIframeDisplay(),this.sideEffectManager.add(()=>(this.displayer.callbacks.on("onPhaseChanged",this.onPhaseChangedListener),()=>this.displayer.callbacks.off("onPhaseChanged",this.onPhaseChangedListener)),Lt.DisplayerState)),this.computedStyleAndIframeDisplay()}computedStyleAndIframeDisplay(){this.computedStyle(this.displayer.state),this.computedIframeDisplay(this.displayer.state,this.attributes)}listenDisplayerCallbacks(){this.displayer.callbacks.on(this.callbackName,this.stateChangeListener)}get callbackName(){return this.isReplay?"onPlayerStateChanged":"onRoomStateChanged"}computedStyle(t){const e=this.manager.cameraState,i=this.attributes.width||1280,n=this.attributes.height||720;if(this.iframe){const{width:r,height:s,scale:o,centerX:a,centerY:l}=e,u=this.rootRect||{x:0,y:0},c=`${r/2+u.x}px`,d=`${s/2+u.y}px`,f=`transform-origin: ${c} ${d};`,v=(r-i)/2*o,w=(s-n)/2*o,y=-(a*o)+v,h=-(l*o)+w,p=`transform: translate(${y}px,${h}px) scale(${o}, ${o});`,T=["position: absolute;","border: 0.1px solid rgba(0,0,0,0);","top: 0px;","left: 0px;",f,p];this.cssList=T,this.computedZindex(),this.updateStyle()}}computedIframeDisplay(t,e){this.inDisplaySceneDir?se.emitter.emit("DispayIframe"):se.emitter.emit("HideIframe")}computedZindex(){const t="z-index: -1;",e=this.cssList.findIndex(i=>i===t);e!==-1&&this.cssList.splice(e,1),(!this.isClicker()||this.isDisableInput)&&this.cssList.push(t)}updateStyle(){this.iframe.style.cssText=this.cssList.join(" ")}get iframeOrigin(){if(this.iframe)try{return new URL(this.iframe.src).origin}catch(t){console.warn(t)}}messageListener(t){if(nt("<<<",JSON.stringify(t.data)),t.origin!==this.iframeOrigin)return;const e=t.data;switch(e.kind){case"SetAttributes":{this.handleSetAttributes(e);break}case"RegisterMagixEvent":{this.handleRegisterMagixEvent(e);break}case"RemoveMagixEvent":{this.handleRemoveMagixEvent(e);break}case"DispatchMagixEvent":{this.handleDispatchMagixEvent(e);break}case"RemoveAllMagixEvent":{this.handleRemoveAllMagixEvent();break}case"NextPage":{this.handleNextPage();break}case"PrevPage":{this.handlePrevPage();break}case"SDKCreate":{this.handleSDKCreate();break}case"SetPage":{this.handleSetPage(e);break}case"GetAttributes":{this.handleGetAttributes();break}case"PageTo":{this.handlePageTo(e);break}default:{nt(`${e.kind} not allow event.`);break}}}handleSDKCreate(){this.postMessage({kind:"Init",payload:{attributes:this.attributes,roomState:this.displayer.state,currentPage:this.currentPage,observerId:this.displayer.observerId}})}handleDispatchMagixEvent(t){const e=t.payload;this.appManager.safeDispatchMagixEvent(e.event,e.payload)}handleSetAttributes(t){this.setAttributes(t.payload)}handleRegisterMagixEvent(t){const e=t.payload,i=n=>{n.authorId!==this.displayer.observerId&&this.postMessage({kind:"ReciveMagixEvent",payload:n})};this.magixEventMap.set(e,i),this.displayer.addMagixEventListener(e,i)}handleRemoveMagixEvent(t){const e=t.payload,i=this.magixEventMap.get(e);this.displayer.removeMagixEventListener(e,i)}handleNextPage(){this.manager.canOperate&&(this.manager.nextPage(),this.dispatchMagixEvent("NextPage",{}))}handlePrevPage(){this.manager.canOperate&&(this.manager.prevPage(),this.dispatchMagixEvent("PrevPage",{}))}handlePageTo(t){if(this.manager.canOperate){const e=t.payload;if(!Number.isSafeInteger(e)||e<=0)return;this.manager.setMainViewSceneIndex(e-1),this.dispatchMagixEvent("PageTo",e-1)}}handleRemoveAllMagixEvent(){this.magixEventMap.forEach((t,e)=>{this.displayer.removeMagixEventListener(e,t)}),this.magixEventMap.clear()}handleGetAttributes(){this.postMessage({kind:"GetAttributes",payload:this.attributes})}postMessage(t){var e;this.iframe&&((e=this.iframe.contentWindow)==null||e.postMessage(JSON.parse(JSON.stringify(t)),"*"))}dispatchMagixEvent(t,e){this.manager.canOperate&&(this.setAttributes({lastEvent:{name:t,payload:e}}),this.displayer.dispatchMagixEvent(t,e))}get currentIndex(){return this.manager.mainViewSceneIndex}get currentPage(){return this.currentIndex+1}get totalPage(){return this.manager.mainViewScenesLength}get readonly(){return!this.displayer.isWritable}get inDisplaySceneDir(){return this.manager.mainViewSceneDir===this.attributes.displaySceneDir}isClicker(){if(this.readonly)return!1;const t=this.displayer.state.memberState.currentApplianceName;return this.allowAppliances.includes(t)}get isDisableInput(){return"disableDeviceInputs"in this.displayer?this.displayer.disableDeviceInputs:!0}};let Pi=se;Pi.kind="IframeBridge";Pi.hiddenClass="netless-iframe-brdige-hidden";Pi.emitter=new Ai.default;Pi.displayer=null;Pi.alreadyCreate=!1;class bS extends Ai.default{_inject(e){this.context=e}}class zg{constructor(e){this.extends=new Map,this.context={manager:this,windowManager:e.windowManager,internalEmitter:e.internalEmitter},e.container&&this.refreshContainer(e.container)}refreshContainer(e){this.context.windowManagerContainer=e,this.extends.forEach(i=>{i._inject(this.context)})}hasRegister(e){return Ne.appClasses.has(e)}use(e){this.extends.set(e.kind,e),e._inject(this.context),e.onCreate()}destroy(){this.extends.forEach(e=>{this.extends.delete(e.kind),e.onDestroy()})}}function AS(){let t=new Set;function e(o){return t.add(o),()=>{i(o)}}function i(o){t.delete(o)}function n(...o){t.forEach(a=>{a(...o)})}function r(){return Boolean(t.size)}function s(){t=new Set}return{runCallbacks:n,addCallback:e,removeCallback:i,hasCallbacks:r,removeAll:s}}const zi=t=>b.isNumber(t)&&!Number.isNaN(t);class ES{constructor(e){this.baseScrollTop=0,this.baseScrollLeft=0,this._isInternalUpdate=!1,this._isRemoteSync=!1,this.updateSize=()=>{this.baseScrollTop=this._scrollingElement.scrollHeight-this._scrollingElement.clientHeight,this.baseScrollLeft=this._scrollingElement.scrollWidth-this._scrollingElement.clientWidth,this.scroll()},this.dispatchScrollEvent=b.debounce(({x:r,y:s})=>{var a,l,u,c;console.log(`${te} ViewScrollChange Dispatch Scroll Event`,{appId:this.appId,x:r,y:s});const o=(l=(a=this.manager.appManager)==null?void 0:a.store)==null?void 0:l.getViewScrollChange();if(o&&o.appId===this.appId&&Math.abs(o.x-r)<.01&&Math.abs(o.y-s)<.01){console.log(`${te} ViewScrollChange Skip - No significant change`);return}(c=(u=this.manager.appManager)==null?void 0:u.store)==null||c.setViewScrollChange({appId:this.appId,x:r,y:s})},200),this._sideEffect=new pn;const{createVal:i}=$u.createSideEffectBinder(this._sideEffect);this._scrollingElement=e.scrollElement,this.manager=e.manager,this.appId=e.appId,this.crood=i(this.getAttribute());const n={$crood:this.crood};$u.withValueEnhancer(this,n),this.updateSize(),this._sideEffect.addEventListener(this._scrollingElement,"scroll",this.onScroll.bind(this),!0),this.callbackManager=AS(),this.sizeObserver=new ResizeObserver(this.callbackManager.runCallbacks),this.callbackManager.addCallback(this.updateSize.bind(this)),this.sizeObserver.observe(this._scrollingElement),this.sizeObserver.observe(this._scrollingElement.firstElementChild),this.crood.reaction(()=>{this._isInternalUpdate||this.scroll()}),setTimeout(()=>{this.updateSize(),this.scroll()})}onScroll(){var n,r;if(console.log("window manager scroll readonly",this.manager.readonly||((n=this.manager.wukongRoleManager)==null?void 0:n.wukongCanOperate())!==!0),this.manager.readonly||((r=this.manager.wukongRoleManager)==null?void 0:r.wukongCanOperate())!==!0||this._isInternalUpdate||this._isRemoteSync)return;const{x:e,y:i}=this.calcLocalToCoord(this.getLocalCoord());this.dispatchScrollEvent({x:e,y:i})}scroll(){if(!this._scrollingElement)return;const{x:e,y:i}=this.calcCoordToLocal();this._scrollingElement.scrollTo({left:e,top:i,behavior:"instant"})}setCoord(e){this._isInternalUpdate=!0,console.log(`${te} ViewScrollChange SetCoord`,JSON.stringify(e));try{this.crood.setValue({x:zi(e.x)?e.x:this.crood.value.x,y:zi(e.y)?e.y:this.crood.value.y})}finally{this._isInternalUpdate=!1}}setCoordFromRemote(e){this._isRemoteSync=!0,console.log(`${te} ViewScrollChange SetCoordFromRemote`,JSON.stringify(e));try{this.crood.setValue({x:zi(e.x)?e.x:this.crood.value.x,y:zi(e.y)?e.y:this.crood.value.y})}finally{this._isRemoteSync=!1}}getAttribute(){var i,n;return((n=(i=this.manager.appManager)==null?void 0:i.store)==null?void 0:n.getViewScrollChange())||{x:0,y:0}}calcCoordToLocal(){if(!this._scrollingElement)return{x:0,y:0};const{x:e,y:i}=this.crood.value;return{x:e*this.baseScrollLeft,y:i*this.baseScrollTop}}getLocalCoord(){return{x:this._scrollingElement.scrollLeft,y:this._scrollingElement.scrollTop}}calcLocalToCoord(e){if(!this._scrollingElement)return{x:0,y:0};const{x:i,y:n}=e,r={x:0,y:0};return zi(i)&&(r.x=Number((i/this.baseScrollLeft).toFixed(2))),zi(n)&&(r.y=Number((n/this.baseScrollTop).toFixed(2))),r}destroy(){this._sideEffect.flushAll(),this.callbackManager.removeAll(),this.sizeObserver.disconnect()}}const _g="windowMananerAppScrolling";class TS{constructor({manager:e}){this.scrollers=[],this.manager=e,R.on(_g,this.onAppScrolling.bind(this))}onAppScrolling(e){if(console.log(`${te} ScrollerManager onAppScrolling`,JSON.stringify(e)),e){const{appId:i,x:n,y:r}=e;i&&this.scrollToFromRemote(i,{x:n,y:r})}}add(e){if(this.scrollers.find(n=>n.appId==e.appId))return;const i=new ES(e);this.scrollers.push(i)}scrollTo(e,i){const n=this.getScroller(e);console.log(`${te} ScrollerManager ScrollTo`,JSON.stringify(i)),n&&n.setCoord(i)}scrollToFromRemote(e,i){const n=this.getScroller(e);console.log(`${te} ScrollerManager ScrollToFromRemote`,JSON.stringify(i)),n&&n.setCoordFromRemote(i)}moveToCenter(e){const i={x:.5,y:.5};if(e){const n=this.getScroller(e);n&&this.scrollTo(n==null?void 0:n.appId,i)}else this.scrollers.forEach(n=>this.scrollTo(n==null?void 0:n.appId,i))}getScroller(e){if(!!e)return this.scrollers.find(i=>i.appId==e)}remove(e){const i=this.getScroller(e);!i||(i.destroy(),this.scrollers=this.scrollers.filter(n=>n.appId!=e))}destroy(){this.scrollers.forEach(e=>{e.destroy()}),this.scrollers=[]}}var Ru=(t=>(t[t.teacher=0]="teacher",t[t.assistant=1]="assistant",t[t.inspector=2]="inspector",t[t.student=3]="student",t[t.admin=4]="admin",t[t.auditor=5]="auditor",t[t.course_root=6]="course_root",t[t.recording_robot=7]="recording_robot",t))(Ru||{});class Lg{constructor(){this.wukongCurrentRole=Ru.student,this.wukongPresenter=!1,this.wukongOperableRoles=new Set}getRole(){return this.wukongCurrentRole}setRole(e){this.wukongCurrentRole=e}wukongCanOperate(){return this.wukongPresenter?!0:this.wukongOperableRoles.has(this.wukongCurrentRole)}wukongIsPresenter(){return this.wukongPresenter}wukongSetPresenter(e){this.wukongPresenter=e}wukongSetOperableRoles(e){this.wukongOperableRoles=new Set(e)}wukongGetOperableRoles(){return Array.from(this.wukongOperableRoles)}}class jg{constructor(e){this.info={...e||{}}}getAll(){return{...this.info}}setAll(e,i){const n=this.normalize(e),r=i?this.clean(n,i):n;return this.info={...r},this.getAll()}normalize(e){return{...e||{}}}pruneRemovedBoxes(e){const i=this.clean(this.info,e);return this.info={...i},this.getAll()}getMinimized(){return Object.entries(this.info).filter(([e,i])=>i===B.Minimized).map(([e])=>e)}getMaximized(){return Object.entries(this.info).filter(([e,i])=>i===B.Maximized).map(([e])=>e)}setBoxState(e,i){const n={...this.info};return n[e]=i,this.info=n,this.getAll()}clearState(e){const i={...this.info};return Object.keys(i).forEach(n=>{i[n]===e&&(i[n]=B.Normal)}),this.info=i,this.getAll()}clean(e,i){const n=e||{},r=new Set(i||[]),s={};return Object.keys(n).forEach(o=>{r.has(o)&&(s[o]=n[o])}),s}}const j="[LaserPointer]";class Rg{constructor(e,i,n,r,s,o){this._currentPointActive=!1,this._manager=e,this._room=i,this._displayer=n,this._appManager=r,this._currentUserId=s,this._instanceId=o||`LP_${Math.random().toString(36).substr(2,6)}`,console.log(`${j} [${this._instanceId}] \u6FC0\u5149\u7B14\u7BA1\u7406\u5668\u6784\u9020\u51FD\u6570`,e,i,n,r,s,o),this._initView(),this._setupMagixListener()}_getShowViewDivElement(){var e,i,n,r;if(!this._view)return console.warn(`${j} [${this._instanceId}] \u89C6\u56FE\u5BF9\u8C61\u672A\u521D\u59CB\u5316`),null;if(this._instanceId==="main"){const s=(i=(e=this._view.divElement)==null?void 0:e.children)==null?void 0:i[0];return console.log(`${j} [${this._instanceId}] \u4E3B\u89C6\u56FE\u5BB9\u5668\u68C0\u67E5: \u5BB9\u5668=${s}`),s||null}else{const s=((r=(n=this._view.divElement)==null?void 0:n.children)==null?void 0:r[0])||null;return console.log(`${j} [${this._instanceId}] \u5E94\u7528\u89C6\u56FE\u5BB9\u5668\u68C0\u67E5: \u5BB9\u5668=${s}`),s}}_initView(){var n,r,s,o;const e=this._instanceId==="main",i=this._instanceId.startsWith("app_");if(e)this._view=this._manager.mainView,console.log(`${j} [${this._instanceId}] \u4E3B\u89C6\u56FE\u521D\u59CB\u5316: mainView\u5B58\u5728=${!!this._manager.mainView}, divElement\u5B58\u5728=${!!((n=this._manager.mainView)!=null&&n.divElement)}`);else if(i){const a=this._instanceId.replace("app_",""),l=(s=(r=this._appManager)==null?void 0:r.appProxies)==null?void 0:s.get(a);this._view=l==null?void 0:l.view,console.log(`${j} [${this._instanceId}] \u5E94\u7528\u89C6\u56FE\u521D\u59CB\u5316: appId=${a}, appProxy\u5B58\u5728=${!!l}, view\u5B58\u5728=${!!(l!=null&&l.view)}, divElement\u5B58\u5728=${!!((o=l==null?void 0:l.view)!=null&&o.divElement)}`)}console.log(`${j} [${this._instanceId}] \u521D\u59CB\u5316\u89C6\u56FE\u5B8C\u6210: \u662F\u5426\u4E3B\u89C6\u56FE=${e}, \u662F\u5426\u5E94\u7528\u89C6\u56FE=${i}, \u6709\u89C6\u56FE=${!!this._view}, \u89C6\u56FE\u7C7B\u578B=${e?"\u4E3B\u89C6\u56FE":"\u5E94\u7528\u89C6\u56FE"}`)}setLaserPointer(e){var i,n,r;if(console.log(`${j} [${this._instanceId}] \u8BBE\u7F6E\u6FC0\u5149\u7B14\u72B6\u6001:`,e),this._currentPointActive=e,e){const s=(i=this._manager.appManager)==null?void 0:i.store.getTeacherInfo();if(console.log(`${j} [${this._instanceId}] \u6FC0\u5149\u7B14\u72B6\u6001\u53D8\u66F4`,JSON.stringify(s),this._currentUserId),(s==null?void 0:s.uid)===this._currentUserId){console.log(`${j} [${this._instanceId}] \u5F53\u524D\u7528\u6237\u662F\u8001\u5E08\uFF0C\u5F00\u59CB\u8BBE\u7F6E\u76D1\u542C\u5668`),this._setupTeacherMoveListener();const o=this._getShowViewDivElement();this._instanceId!=="main"?o&&((n=o.parentElement)==null||n.classList.add("teacher-current-pointer-enevnt-auto"),console.log(`${j} [${this._instanceId}] \u8001\u5E08\u7AEF\u8BFE\u4EF6\u5DF2\u6DFB\u52A0pint\u4E8B\u4EF6`,o)):(r=o==null?void 0:o.classList)==null||r.remove("teacher-current-pointer-enevnt-auto")}else console.log(`${j} [${this._instanceId}] \u5F53\u524D\u7528\u6237\u4E0D\u662F\u8001\u5E08\uFF0C\u8DF3\u8FC7\u76D1\u542C\u5668\u8BBE\u7F6E`)}else{const s=this._getShowViewDivElement();s&&this._boundHandleTeacherMouseMove?(console.log(`${j} [${this._instanceId}] \u79FB\u9664\u9F20\u6807\u79FB\u52A8\u76D1\u542C\u5668`),s.removeEventListener("mousemove",this._boundHandleTeacherMouseMove)):console.log(`${j} [${this._instanceId}] \u65E0\u6CD5\u79FB\u9664\u76D1\u542C\u5668 - \u5BB9\u5668:`,!!s,"\u7ED1\u5B9A\u5904\u7406\u5668:",!!this._boundHandleTeacherMouseMove),this._lastTeacherPosition=void 0}this.updateLaserPointerIconVisibility()}_setupTeacherMoveListener(){this._teacherMoveThrottle||(this._teacherMoveThrottle=b.throttle(i=>{console.log(`${j} [${this._instanceId}] \u8282\u6D41\u51FD\u6570\u89E6\u53D1\uFF0C\u53D1\u9001\u4F4D\u7F6E:`,JSON.stringify(i)),this._sendTeacherPosition(i)},150));const e=this._getShowViewDivElement();if(console.log(`${j} [${this._instanceId}] \u5F00\u59CB\u8BBE\u7F6E\u8001\u5E08\u7AEF\u6FC0\u5149\u7B14\u76D1\u542C\u5668\uFF0CshowView:`,e!=null,"\u6FC0\u5149\u7B14\u72B6\u6001:",this._currentPointActive),e){this._boundHandleTeacherMouseMove||(this._boundHandleTeacherMouseMove=this._handleTeacherMouseEvent.bind(this)),this._boundHandleTeacherMouseEnter||(this._boundHandleTeacherMouseEnter=this._handleTeacherMouseEvent.bind(this)),this._boundHandleTeacherMouseLeave||(this._boundHandleTeacherMouseLeave=this._handleTeacherMouseEvent.bind(this)),this._boundHandleTeacherMouseMove&&e.removeEventListener("mousemove",this._boundHandleTeacherMouseMove),this._boundHandleTeacherMouseEnter&&e.removeEventListener("mouseenter",this._boundHandleTeacherMouseEnter),this._boundHandleTeacherMouseLeave&&e.removeEventListener("mouseleave",this._boundHandleTeacherMouseLeave),e.addEventListener("mousemove",this._boundHandleTeacherMouseMove),e.addEventListener("mouseenter",this._boundHandleTeacherMouseEnter),e.addEventListener("mouseleave",this._boundHandleTeacherMouseLeave),console.log(`${j} [${this._instanceId}] \u4E8B\u4EF6\u76D1\u542C\u5668\u6DFB\u52A0\u5B8C\u6210: mousemove=${!!this._boundHandleTeacherMouseMove}, mouseenter=${!!this._boundHandleTeacherMouseEnter}, mouseleave=${!!this._boundHandleTeacherMouseLeave}`),console.log(`${j} [${this._instanceId}] \u5BB9\u5668\u4FE1\u606F: tagName=${e.tagName}, className=${e.className}, id=${e.id}, style.pointerEvents=${e.style.pointerEvents}`),console.log(`${j} [${this._instanceId}] \u5BB9\u5668\u5C3A\u5BF8: width=${e.offsetWidth}, height=${e.offsetHeight}, visible=${e.offsetWidth>0&&e.offsetHeight>0}`),console.log(`${j} [${this._instanceId}] \u5BB9\u5668\u4F4D\u7F6E: left=${e.offsetLeft}, top=${e.offsetTop}, rect=${JSON.stringify(e.getBoundingClientRect())}`);const i=e.parentElement;i&&console.log(`${j} [${this._instanceId}] \u7236\u5143\u7D20\u4FE1\u606F: tagName=${i.tagName}, className=${i.className}, style.pointerEvents=${i.style.pointerEvents}`)}}_handleTeacherMouseEvent(e){var o,a,l,u,c;const i=e.type;if(console.log(`${j} [${this._instanceId}] \u9F20\u6807${i}\u4E8B\u4EF6\u5904\u7406, \u6FC0\u5149\u7B14\u6FC0\u6D3B\u72B6\u6001:`,this._currentPointActive),!this._currentPointActive){console.log(`${j} [${this._instanceId}] \u6FC0\u5149\u7B14\u672A\u6FC0\u6D3B\uFF0C\u63D0\u524D\u8FD4\u56DE`);return}const n=(o=this._room)==null?void 0:o.state.memberState.currentApplianceName;if(A.ApplianceNames.laserPointer===n){(this._lastTeacherPosition==null||this._lastTeacherPosition.x!==-1&&this._lastTeacherPosition.y!==-1)&&(this._lastTeacherPosition={x:-1,y:-1},(a=this._teacherMoveThrottle)==null||a.call(this,{x:-1,y:-1})),console.log(`${j} [${this._instanceId}] \u8001\u5E08\u6559\u5177\u4E3A\u6FC0\u5149\u7B14\uFF0C\u63D0\u524D\u8FD4\u56DE\u5E76\u901A\u77E5\u5B66\u751F\u7AEF\u9690\u85CF`);return}if(i==="mouseleave"){console.log(`${j} [${this._instanceId}] \u9F20\u6807\u79BB\u5F00\u5BB9\u5668`),this._lastTeacherPosition={x:-1,y:-1},(l=this._teacherMoveThrottle)==null||l.call(this,{x:-1,y:-1});return}i==="mouseenter"&&console.log(`${j} [${this._instanceId}] \u9F20\u6807\u8FDB\u5165\u5BB9\u5668`);const r=this._getShowViewDivElement(),s=r==null?void 0:r.getBoundingClientRect();if(s){const d=e.clientX>=s.left&&e.clientX<=s.right&&e.clientY>=s.top&&e.clientY<=s.bottom,f=this._lastTeacherPosition&&this._lastTeacherPosition.x===-1&&this._lastTeacherPosition.y===-1;if(!d){console.log(`${j} [${this._instanceId}] \u9F20\u6807\u5728\u5BB9\u5668\u5916\uFF0C\u9690\u85CF\u6FC0\u5149\u7B14`),(u=this._teacherMoveThrottle)==null||u.call(this,{x:-1,y:-1});return}const v=this._view.convertToPointInWorld({x:e.offsetX,y:e.offsetY});console.log(`${j} [${this._instanceId}] \u9F20\u6807\u79FB\u52A8\u5904\u7406, \u504F\u79FB\u91CF:`,e.offsetX,e.offsetY,"\u8F6C\u6362\u540E\u4F4D\u7F6E:",JSON.stringify(v)),(f||!this._lastTeacherPosition||Math.abs(v.x-this._lastTeacherPosition.x)>.01||Math.abs(v.y-this._lastTeacherPosition.y)>.01)&&(this._lastTeacherPosition=v,(c=this._teacherMoveThrottle)==null||c.call(this,v))}}_sendTeacherPosition(e){if(this._room){const i=this._instanceId==="main",n=this._instanceId.startsWith("app_");let r;i?r="main":n?r=this._instanceId:r=this._instanceId,console.log(`${j} [${this._instanceId}] \u53D1\u9001\u8001\u5E08\u4F4D\u7F6E: \u4F4D\u7F6E=${JSON.stringify(e)}, \u89C6\u56FEID=${r}`),this._room.dispatchMagixEvent("teacherLaserPointerMove",{position:e,instanceId:r,timestamp:Date.now()})}}updateLaserPointerIconVisibility(){var n,r,s;const e=(r=(n=this._appManager)==null?void 0:n.attributes)==null?void 0:r[O.LaserPointerActive],i=(s=this._manager.appManager)==null?void 0:s.store.getTeacherInfo();!(e!=null&&e.active)||(i==null?void 0:i.uid)===this._currentUserId?this._hideLaserPointerIcon():this._setupLaserPointerIcon()}_setupLaserPointerIcon(){if(this._laserPointerIcon)return;const e=this._getShowViewDivElement(),i=e==null?void 0:e.querySelector(".teacher-laser-pointer");if(i){this._laserPointerIcon=i;return}console.log(`${j} [${this._instanceId}] \u4E3A\u89C6\u56FE\u521B\u5EFA\u672C\u5730\u6FC0\u5149\u7B14\u56FE\u6807`),this._laserPointerIcon=document.createElement("div"),this._laserPointerIcon.className="teacher-laser-pointer",this._laserPointerIcon.style.display="none",e&&(e.appendChild(this._laserPointerIcon),console.log(`${j} [${this._instanceId}] \u6FC0\u5149\u7B14\u56FE\u6807\u5DF2\u6DFB\u52A0\u5230\u89C6\u56FE\u5BB9\u5668`))}_hideLaserPointerIcon(){this._laserPointerIcon&&(this._laserPointerIcon.style.display="none",console.log(`${j} [${this._instanceId}] \u9690\u85CF\u672C\u5730\u6FC0\u5149\u7B14\u56FE\u6807`))}_setupMagixListener(){var e;console.log(`${j} [${this._instanceId}] \u8BBE\u7F6E\u6FC0\u5149\u7B14\u79FB\u52A8\u4E8B\u4EF6\u76D1\u542C\u5668`),console.log(`${j} [${this._instanceId}] \u663E\u793A\u5668\u53EF\u7528:`,!!this._displayer),(e=this._displayer)==null||e.addMagixEventListener("teacherLaserPointerMove",i=>{var o;console.log(`${j} [${this._instanceId}] \u6536\u5230\u539F\u59CB\u4E8B\u4EF6:`,i),console.log(`${j} [${this._instanceId}] \u4E8B\u4EF6payload:`,i.payload);const n=(o=this._manager.appManager)==null?void 0:o.store.getTeacherInfo();if(console.log(`${j} [${this._instanceId}] \u8001\u5E08\u4FE1\u606F: ${JSON.stringify(n)}, \u5F53\u524D\u7528\u6237ID: ${this._currentUserId}`),(n==null?void 0:n.uid)===this._currentUserId){console.log(`${j} [${this._instanceId}] \u8DF3\u8FC7\u81EA\u5DF1\u7684\u4E8B\u4EF6`);return}const{position:r,instanceId:s}=i.payload;if(console.log(`${j} [${this._instanceId}] \u6536\u5230\u8001\u5E08\u6FC0\u5149\u7B14\u79FB\u52A8: \u4F4D\u7F6E=${JSON.stringify(r)}, \u5B9E\u4F8BID=${s}, \u5F53\u524D\u5B9E\u4F8BID=${this._instanceId}`),s!==this._instanceId){console.log(`${j} [${this._instanceId}] \u4E0D\u662F\u5F53\u524D\u5B9E\u4F8B\u7684\u4E8B\u4EF6\uFF0C\u8DF3\u8FC7: \u671F\u671B=${this._instanceId}, \u5B9E\u9645=${s}`);return}this._showLaserPointerIcon(r,s)})}_showLaserPointerIcon(e,i){var o,a,l;const n=(a=(o=this._appManager)==null?void 0:o.attributes)==null?void 0:a[O.LaserPointerActive],r=(l=this._manager.appManager)==null?void 0:l.store.getTeacherInfo();if(!(n!=null&&n.active)||(r==null?void 0:r.uid)===this._currentUserId){this._hideLaserPointerIcon();return}if(e.x===-1&&e.y===-1){console.log(`${j} [${this._instanceId}] \u6536\u5230\u9690\u85CF\u4FE1\u53F7\uFF0C\u9690\u85CF\u6FC0\u5149\u7B14`),this._hideLaserPointerIcon();return}if(i!==this._instanceId){console.log(`${j} [${this._instanceId}] \u4E0D\u662F\u5F53\u524D\u5B9E\u4F8B\u7684\u6FC0\u5149\u7B14\uFF0C\u9690\u85CF\u56FE\u6807. \u671F\u671B: ${this._instanceId}, \u5B9E\u9645: ${i}`),this._hideLaserPointerIcon();return}console.log(`${j} [${this._instanceId}] \u4E3A\u5F53\u524D\u89C6\u56FE\u663E\u793A\u6FC0\u5149\u7B14`),this._setupLaserPointerIcon();const s=this._getShowViewDivElement();if(this._laserPointerIcon&&s&&this._view){const u=this._view.convertToPointOnScreen(e.x,e.y);if(console.log(`${j} [${this._instanceId}] \u5F00\u59CB\u8BBE\u7F6E\u4F4D\u7F6E\u8F6C\u6362\u4F4D\u7F6E: ${JSON.stringify(e)}, \u76EE\u6807\u4F4D\u7F6E: ${JSON.stringify(u)}`),u&&typeof u.x=="number"&&typeof u.y=="number"){this._laserPointerIcon.style.left=`${u.x}px`,this._laserPointerIcon.style.top=`${u.y}px`,this._laserPointerIcon.style.display="block";const c=this._instanceId==="main";console.log(`${j} [${this._instanceId}] \u663E\u793A\u672C\u5730\u6FC0\u5149\u7B14\u4F4D\u7F6E: ${JSON.stringify(u)} (\u89C6\u56FE\u7C7B\u578B: ${c?"\u4E3B\u89C6\u56FE":"\u5E94\u7528\u89C6\u56FE"})`)}else console.warn(`${j} [${this._instanceId}] \u5750\u6807\u8F6C\u6362\u8FD4\u56DE\u65E0\u6548\u70B9: ${JSON.stringify(u)}, \u539F\u59CB\u4F4D\u7F6E: ${JSON.stringify(e)}`)}else this._view||console.warn(`${j} [${this._instanceId}] \u6CA1\u6709\u53EF\u7528\u7684\u89C6\u56FE\u8FDB\u884C\u5750\u6807\u8F6C\u6362`)}destroy(){var r,s,o;if(this._hideLaserPointerIcon(),this._instanceId.startsWith("app_")){const a=this._instanceId.replace("app_",""),l=(s=(r=this._appManager)==null?void 0:r.appProxies)==null?void 0:s.get(a);(o=l==null?void 0:l.box)!=null&&o.element&&l.box.element.classList.remove("teacher-laser-pointer")}const i=this._getShowViewDivElement();i&&this._boundHandleTeacherMouseMove&&i.removeEventListener("mousemove",this._boundHandleTeacherMouseMove),i&&this._boundHandleTeacherMouseEnter&&i.removeEventListener("mouseenter",this._boundHandleTeacherMouseEnter),i&&this._boundHandleTeacherMouseLeave&&i.removeEventListener("mouseleave",this._boundHandleTeacherMouseLeave);const n=i==null?void 0:i.querySelectorAll(".teacher-laser-pointer");n&&n.forEach(a=>{a.parentNode&&a.parentNode.removeChild(a)}),this._laserPointerIcon=void 0,this._teacherMoveThrottle=void 0,this._lastTeacherPosition=void 0,this._currentPointActive=!1,this._boundHandleTeacherMouseMove=void 0,this._boundHandleTeacherMouseEnter=void 0,this._boundHandleTeacherMouseLeave=void 0}testAppViewMouseEvents(){const e=this._getShowViewDivElement();if(!e){console.warn(`${j} [${this._instanceId}] \u65E0\u6CD5\u6D4B\u8BD5\uFF1AshowView\u4E3A\u7A7A`);return}console.log(`${j} [${this._instanceId}] \u5F00\u59CB\u6D4B\u8BD5\u5E94\u7528\u89C6\u56FE\u9F20\u6807\u4E8B\u4EF6`),console.log(`${j} [${this._instanceId}] \u5BB9\u5668\u4FE1\u606F: tagName=${e.tagName}, className=${e.className}, id=${e.id}`),console.log(`${j} [${this._instanceId}] \u5BB9\u5668\u5C3A\u5BF8: width=${e.offsetWidth}, height=${e.offsetHeight}`),console.log(`${j} [${this._instanceId}] \u5BB9\u5668\u4F4D\u7F6E: left=${e.offsetLeft}, top=${e.offsetTop}`),console.log(`${j} [${this._instanceId}] \u5BB9\u5668\u6837\u5F0F: pointerEvents=${e.style.pointerEvents}, position=${e.style.position}`);const i=new MouseEvent("mousemove",{clientX:100,clientY:100});Object.defineProperty(i,"offsetX",{value:50}),Object.defineProperty(i,"offsetY",{value:50}),console.log(`${j} [${this._instanceId}] \u6A21\u62DF\u9F20\u6807\u79FB\u52A8\u4E8B\u4EF6`),e.dispatchEvent(i)}}const ne="[LaserPointer]";class NS{constructor(e){this._laserPointerManagers=new Map,this._isDestroyed=!1,this._windowManager=e,this._room=e.room,this._displayer=e.displayer,this._appManager=e.appManager,this._currentUserId=this._getCurrentUserId(),console.log(`${ne} Initialized LaserPointerMultiManager`)}setupEventListeners(){console.log(`${ne} Setting up event listeners`),this._windowManager.emitter.on("onMainViewMounted",e=>{console.log(`${ne} onMainViewMounted event received`),setTimeout(()=>{this._getMainViewContainer()?(console.log(`${ne} Creating main view laser pointer manager`),this.createLaserPointerManagerForView("main")):console.warn(`${ne} Failed to get main view container`)},100)}),this._windowManager.emitter.on("onMainViewRebind",e=>{console.log(`${ne} onMainViewRebind event received`),this.destroyLaserPointerManagerForView("main"),this._getMainViewContainer()&&this.createLaserPointerManagerForView("main")}),this._windowManager.emitter.on("onAppViewMounted",e=>{console.log(`${ne} onAppViewMounted event received for app:`,e);const i=this._getAppBoxView(e.appId);console.log(`${ne} App box view for ${e.appId}:`,!!i),i?(console.log(`${ne} Creating laser pointer manager for app:`,e),this.createLaserPointerManagerForView(`app_${e.appId}`)):console.warn(`${ne} Failed to get app box view for:`,e.appId)}),setTimeout(()=>{console.log(`${ne} Checking if main view manager needs to be created during setup`),this._ensureMainViewManager()},500)}createLaserPointerManagerForView(e){var n;if(this._isDestroyed){console.warn(`${ne} Cannot create LaserPointerManager - manager is destroyed`);return}if(!this._room||!this._displayer||!this._appManager){console.warn(`${ne} Cannot create LaserPointerManager for view ${e} - missing dependencies`);return}if(this._laserPointerManagers.has(e))return console.log(`${ne} LaserPointerManager for view ${e} already exists`),this._laserPointerManagers.get(e);const i=new Rg(this._windowManager,this._room,this._displayer,this._appManager,this._currentUserId,e);return i.setLaserPointer(((n=this._appManager.store.getLaserPointerActive())==null?void 0:n.active)||!1),this._laserPointerManagers.set(e,i),console.log(`${ne} Created LaserPointerManager for view ${e}`),i}destroyLaserPointerManagerForView(e){const i=this._laserPointerManagers.get(e);i&&(i.destroy(),this._laserPointerManagers.delete(e),console.log(`${ne} Destroyed LaserPointerManager for view ${e}`))}setLaserPointerActive(e){const i=this._isCurrentUserTeacher();console.log(`${ne} Setting laser pointer active: ${e}, isTeacher: ${i}, managers: ${this._laserPointerManagers.size}`),this._laserPointerManagers.size===0&&i&&e&&(console.log(`${ne} No managers found, attempting to create main view manager`),this._ensureMainViewManager()),this._laserPointerManagers.forEach((n,r)=>{console.log(`${ne} Updating laser pointer for view: ${r}, active: ${i?e:!1}`),i?n.setLaserPointer(e):n.setLaserPointer(!1)})}destroy(){console.log(`${ne} Destroying LaserPointerMultiManager with ${this._laserPointerManagers.size} managers`),this._laserPointerManagers.forEach((e,i)=>{console.log(`${ne} Destroying LaserPointerManager for view ${i}`),e.destroy()}),this._laserPointerManagers.clear(),this._isDestroyed=!0,console.log(`${ne} LaserPointerMultiManager destroyed`)}_getCurrentUserId(){var e,i;return(e=this._windowManager.appManager)!=null&&e.uid?(i=this._windowManager.appManager)==null?void 0:i.uid:void 0}_isCurrentUserTeacher(){var i,n;const e=(n=(i=this._windowManager.appManager)==null?void 0:i.store)==null?void 0:n.getTeacherInfo();return(e==null?void 0:e.uid)===this._currentUserId}_ensureMainViewManager(){if(this._laserPointerManagers.has("main")){console.log(`${ne} Main view manager already exists`);return}console.log(`${ne} Attempting to create main view manager`),this._getMainViewContainer()?(console.log(`${ne} Successfully creating main view laser pointer manager`),this.createLaserPointerManagerForView("main")):console.warn(`${ne} Still failed to get main view container`)}_getMainViewContainer(){var n,r,s,o,a,l,u,c,d,f,v,w,y,h,p,g;const i=((a=(o=(s=(r=(n=this._windowManager)==null?void 0:n.mainView)==null?void 0:r.divElement)==null?void 0:s.children)==null?void 0:o.length)!=null?a:0)>0?(c=(u=(l=this._windowManager)==null?void 0:l.mainView)==null?void 0:u.divElement)==null?void 0:c.children[0]:this._windowManager.container;return console.log(`${ne} Getting main view container:`,{hasMainView:!!((d=this._windowManager)!=null&&d.mainView),hasDivElement:!!((v=(f=this._windowManager)==null?void 0:f.mainView)!=null&&v.divElement),childrenCount:(g=(p=(h=(y=(w=this._windowManager)==null?void 0:w.mainView)==null?void 0:y.divElement)==null?void 0:h.children)==null?void 0:p.length)!=null?g:0,hasContainer:!!this._windowManager.container,selectedContainer:!!i}),i||null}_getAppBoxView(e){var n,r,s,o,a;const i=(r=(n=this._appManager)==null?void 0:n.appProxies)==null?void 0:r.get(e);return console.log(`${ne} Getting app box view for ${e}:`,{hasAppManager:!!this._appManager,hasAppProxy:!!i,hasBox:!!(i!=null&&i.box),hasElement:!!((s=i==null?void 0:i.box)!=null&&s.$box)}),(o=i==null?void 0:i.box)!=null&&o.$box?(a=i.box)==null?void 0:a.$box:null}}function _i(t,e){let i=!1;return A.autorun(()=>{if(i){console.log(`${te} ${e||"Autorun"} Skipped - Already updating`);return}i=!0;try{console.log(`${te} ${e||"Autorun"} Executing`),t()}finally{i=!1,console.log(`${te} ${e||"Autorun"} Completed`)}})}const Vg=new Pw({emitter:R}),Oi="mainView",te="[TeleBox] WindowManager",k=class extends A.InvisiblePlugin{constructor(t){super(t),this.version="1.0.6-wukongBeta.1",this.dependencies={dependencies:{"@juggle/resize-observer":"^3.4.0","@netless/telebox-insider":"github:veytu/telebox-insider",emittery:"^0.9.2",lodash:"^4.17.21","p-retry":"^4.6.2",uuid:"^7.0.3","value-enhancer":"0.0.8","video.js":"^8.23.4"},peerDependencies:{jspdf:"2.5.1","white-web-sdk":"^2.16.52"},devDependencies:{"@hyrious/dts":"^0.2.11","@netless/app-docs-viewer":"github:veytu/app-docs-viewer","@netless/app-media-player":"0.1.4","@rollup/plugin-commonjs":"^20.0.0","@rollup/plugin-node-resolve":"^13.3.0","@rollup/plugin-url":"^6.1.0","@sveltejs/vite-plugin-svelte":"1.0.0-next.40","@tsconfig/svelte":"^2.0.1","@types/debug":"^4.1.12","@types/lodash":"^4.17.20","@types/lodash-es":"^4.17.12","@types/uuid":"^8.3.4","@typescript-eslint/eslint-plugin":"^4.33.0","@typescript-eslint/parser":"^4.33.0","@vitest/ui":"^0.14.2",cypress:"^8.7.0",dotenv:"^10.0.0",eslint:"^7.32.0","eslint-config-prettier":"^8.10.2","eslint-plugin-svelte3":"^3.4.1",jsdom:"^19.0.0",jspdf:"^2.5.2",less:"^4.4.1",prettier:"^2.8.8","prettier-plugin-svelte":"^2.10.1","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-styles":"^3.14.1","side-effect-manager":"0.1.5",svelte:"^3.59.2",typescript:"^4.9.5",vite:"^2.9.18",vitest:"^0.14.2","white-web-sdk":"^2.16.53"}},this.emitter=J,this.viewMode=A.ViewMode.Broadcaster,this.isReplay=A.isPlayer(this.displayer),this._cursorUIDs=[],this.containerSizeRatio=k.containerSizeRatio,k.displayer=t.displayer,window.NETLESS_DEPS={dependencies:{"@juggle/resize-observer":"^3.4.0","@netless/telebox-insider":"github:veytu/telebox-insider",emittery:"^0.9.2",lodash:"^4.17.21","p-retry":"^4.6.2",uuid:"^7.0.3","value-enhancer":"0.0.8","video.js":"^8.23.4"},peerDependencies:{jspdf:"2.5.1","white-web-sdk":"^2.16.52"},devDependencies:{"@hyrious/dts":"^0.2.11","@netless/app-docs-viewer":"github:veytu/app-docs-viewer","@netless/app-media-player":"0.1.4","@rollup/plugin-commonjs":"^20.0.0","@rollup/plugin-node-resolve":"^13.3.0","@rollup/plugin-url":"^6.1.0","@sveltejs/vite-plugin-svelte":"1.0.0-next.40","@tsconfig/svelte":"^2.0.1","@types/debug":"^4.1.12","@types/lodash":"^4.17.20","@types/lodash-es":"^4.17.12","@types/uuid":"^8.3.4","@typescript-eslint/eslint-plugin":"^4.33.0","@typescript-eslint/parser":"^4.33.0","@vitest/ui":"^0.14.2",cypress:"^8.7.0",dotenv:"^10.0.0",eslint:"^7.32.0","eslint-config-prettier":"^8.10.2","eslint-plugin-svelte3":"^3.4.1",jsdom:"^19.0.0",jspdf:"^2.5.2",less:"^4.4.1",prettier:"^2.8.8","prettier-plugin-svelte":"^2.10.1","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-styles":"^3.14.1","side-effect-manager":"0.1.5",svelte:"^3.59.2",typescript:"^4.9.5",vite:"^2.9.18",vitest:"^0.14.2","white-web-sdk":"^2.16.53"}}}static onCreate(t){k._resolve(t)}static async mount(t){var o,a,l,u,c,d,f,v,w,y,h,p;const e=t.room;k.container=t.container,k.supportAppliancePlugin=t.supportAppliancePlugin;const i=t.containerSizeRatio,n=t.debug,r=t.cursor;k.params=t,k.displayer=t.room,Qv();let s;if(A.isRoom(e)){if(e.phase!==A.RoomPhase.Connected)throw new Error("[WindowManager]: Room only Connected can be mount");e.phase===A.RoomPhase.Connected&&e.isWritable&&(e.disableSerialization=!1),s=await this.initManager(e)}if(k.isCreated)throw new Error("[WindowManager]: Already created cannot be created again");if(this.debug=Boolean(n),this.debug&&Tg({verbose:!0}),nt("Already insert room",s),A.isRoom(this.displayer)){if(!s)throw new Error("[WindowManager]: init InvisiblePlugin failed")}else await Hd.default(async g=>{if(s=e.getInvisiblePlugin(k.kind),!s)throw nt(`manager is empty. retrying ${g}`),new Error},{retries:10,maxTimeout:5e3});if(!s)throw new Error("[WindowManager]: create manager failed");i&&(k.containerSizeRatio=i),await s.ensureAttributes(),s._fullscreen=t.fullscreen,s.appManager=new Hv(s),s.appManager.polling=t.polling||!1,s._pageState=new Nw(s.appManager),s.cursorManager=new Tw(s.appManager,Boolean(r),t.cursorOptions,t.applianceIcons),s.scrollerManager=new TS({manager:s}),s.extendPluginManager=new zg({internalEmitter:R,windowManager:s}),s.wukongRoleManager=new Lg,s.allBoxStatusInfoManager=new jg,i&&(s.containerSizeRatio=i),t.container&&s.bindContainer(t.container),kw(e,s),R.emit("onCreated"),k.isCreated=!0;try{await em()}catch(g){console.warn("[WindowManager]: indexedDB open failed"),console.log(g)}return(a=(o=s.appManager)==null?void 0:o.refresher)==null||a.add(O.Scale,()=>(console.log(`${te} Scale Register Listener`),_i(()=>{const g=b.get(s.appManager.attributes,O.Scale),m=Object.keys(g);if(m.length>0){const x=m[0],M=g[x];console.log(`${te} Scale Target`,JSON.stringify(g)),s==null||s._setScale({appId:x,scale:M},!0)}},"Scale"))),(u=(l=s.appManager)==null?void 0:l.refresher)==null||u.add(O.LaserPointerActive,()=>(console.log(`${te} LaserPointerActive Register Listener`),_i(()=>{var M,T;const g=b.get(s.appManager.attributes,O.LaserPointerActive);console.log(`${te} LaserPointerActive Target`,JSON.stringify(g)),s==null||s._setLaserPointer(g).catch(console.error);const m=((M=s==null?void 0:s.teacherInfo)==null?void 0:M.uid)===(s==null?void 0:s._getCurrentUserId()),x=(g==null?void 0:g.active)||!1;(T=s==null?void 0:s._laserPointerMultiManager)==null||T.setLaserPointerActive(x)},"LaserPointerActive"))),(d=(c=s.appManager)==null?void 0:c.refresher)==null||d.add(O.ViewScrollChange,()=>(console.log(`${te} ViewScrollChange Register Listener`),_i(()=>{const g=b.get(s.appManager.attributes,O.ViewScrollChange);g&&(console.log(`${te} ViewScrollChange Target`,JSON.stringify(g)),R.emit(_g,g))},"ViewScrollChange"))),(v=(f=s.appManager)==null?void 0:f.refresher)==null||v.add(O.MainViewBackgroundInfo,()=>(console.log(`${te} MainViewBackgroundInfo Register Listener`),_i(()=>{const g=b.get(s.appManager.attributes,O.MainViewBackgroundInfo);console.log(`${te} MainViewBackgroundInfo Target`,JSON.stringify(g)),g.img.length>0?s==null||s._setBackgroundImg(g.img):g.color.length>0&&(s==null||s._setBackgroundColor(g.color))},"MainViewBackgroundInfo"))),(y=(w=s.appManager)==null?void 0:w.refresher)==null||y.add(O.AllBoxStatusInfo,()=>(console.log(`${te} AllBoxStatusInfo Register Listener`),_i(()=>{var m,x;const g=b.get(s.appManager.attributes,O.AllBoxStatusInfo);(x=(m=s==null?void 0:s.boxManager)==null?void 0:m.teleBoxManager)==null||x.setAllBoxStatusInfo(g,!0),console.log(`${te} AllBoxStatusInfo Target`,JSON.stringify(g))},"AllBoxStatusInfo"))),(p=(h=s.appManager)==null?void 0:h.refresher)==null||p.add(O.LastNotMinimizedBoxsStatus,()=>(console.log(`${te} LastNotMinimizedBoxsStatus Register Listener`),_i(()=>{var m,x;const g=b.get(s.appManager.attributes,O.LastNotMinimizedBoxsStatus);(x=(m=s==null?void 0:s.boxManager)==null?void 0:m.teleBoxManager)==null||x.setLastLastNotMinimizedBoxsStatus(g,!0),console.log(`${te} LastNotMinimizedBoxsStatus Target`,JSON.stringify(g))},"AllBoxStatusInfo"))),R.on("playgroundSizeChange",()=>{s==null||s._updateMainViewWrapperSize(s.getAttributesValue(O.Scale)[Oi],!0)}),setTimeout(()=>{s==null||s._initAttribute()}),s}static initManager(t){return Gv(t)}static initContainer(t,e,i){var v,w;const{chessboard:n,overwriteStyles:r,fullscreen:s}=i;k.container||(k.container=e);const{playground:o,wrapper:a,sizer:l,mainViewElement:u,mainViewWrapper:c,extendWrapper:d,mainViewScrollWrapper:f}=Zv(e);if(k.playground=o,n&&l.classList.add("netless-window-manager-chess-sizer"),s&&l.classList.add("netless-window-manager-fullscreen"),r){const y=document.createElement("style");y.textContent=r,o.appendChild(y)}return t.containerResizeObserver=El.create(o,l,a,R),k.wrapper=a,k.sizer=l,k.mainViewWrapper=c,k.extendWrapper=d,k.mainViewScrollWrapper=f,(w=k.mainViewScrollWrapper)==null||w.classList.toggle("netless-window-manager-fancy-scrollbar-readonly",((v=t.wukongRoleManager)==null?void 0:v.wukongCanOperate())!==!0),u}static get registered(){return Ne.registered}bindContainer(t){var e,i,n,r,s,o,a,l;if(A.isRoom(this.displayer)&&this.room.phase!==A.RoomPhase.Connected)throw new ih;if(k.isCreated&&k.container)k.container.firstChild&&t.appendChild(k.container.firstChild);else if(k.params){const u=k.params,c=k.initContainer(this,t,u);this.boxManager&&this.boxManager.destroy();const d=jv(this,J,R,At,{collectorContainer:u.collectorContainer,collectorStyles:u.collectorStyles,prefersColorScheme:u.prefersColorScheme});this.boxManager=d,(e=this.appManager)==null||e.setBoxManager(d),k.mainViewScrollWrapper&&((i=this.scrollerManager)==null||i.add({appId:Oi,scrollElement:k.mainViewScrollWrapper,manager:this})),this.bindMainView(c,u.disableCameraTransform),k.wrapper&&((n=this.cursorManager)==null||n.setupWrapper(k.wrapper))}R.emit("updateManagerRect"),(r=this.appManager)==null||r.refresh(),(s=this.appManager)==null||s.resetMaximized(),(o=this.appManager)==null||o.resetMinimized(),(a=this.appManager)==null||a.displayerWritableListener(!this.room.isWritable),k.container=t,(l=this.extendPluginManager)==null||l.refreshContainer(t)}bindCollectorContainer(t){k.isCreated&&this.boxManager?this.boxManager.setCollectorContainer(t):k.params&&(k.params.collectorContainer=t)}static register(t){return Ne.register(t)}static unregister(t){return Ne.unregister(t)}async addApp(t){if(this.appManager)return this.appManager.rootDirRemoving?new Promise((e,i)=>{R.once("rootDirRemoved").then(async()=>{try{const n=await this._addApp(t);e(n)}catch(n){i(n.message)}})}):this._addApp(t);throw new tt}async _addApp(t){var e,i,n;if(this.appManager){if(!t.kind||typeof t.kind!="string")throw new Kd;t.src&&typeof t.src=="string"&&Ne.register({kind:t.kind,src:t.src});const r=await((e=Ne.appClasses.get(t.kind))==null?void 0:e());if(r&&((i=r.config)==null?void 0:i.singleton)&&this.appManager.appProxies.has(t.kind))throw new Xd;const s=this.setupScenePath(t,this.appManager);return s===void 0?void 0:((n=t==null?void 0:t.options)!=null&&n.scenePath&&(t.options.scenePath=wm(t.options.scenePath)),await this.appManager.addApp(t,Boolean(s)))}else throw new tt}setupScenePath(t,e){let i=!1;if(t.options){const{scenePath:n,scenes:r}=t.options;if(n){if(!vm(n))throw new eh;const s=Object.keys(this.apps||{});for(const o of s){const a=e.store.getAppScenePath(o);if(a&&a===n){if(console.warn(`[WindowManager]: ScenePath "${n}" already opened`),this.boxManager){const l=this.boxManager.getTopBox();l&&(this.boxManager.setZIndex(o,l.zIndex+1,!1),this.boxManager.focusBox({appId:o},!1))}return}}}n&&r&&r.length>0&&(this.isDynamicPPT(r)?(i=!0,rn(this.displayer)[n]||Ln(this.room,n,r)):rn(this.displayer)[n]||Ln(this.room,n,[{name:r[0].name}])),n&&r===void 0&&Ln(this.room,n,[{}])}return i}async setMainViewScenePath(t){this.appManager&&await this.appManager.setMainViewScenePath(t)}async setMainViewSceneIndex(t){this.appManager&&await this.appManager.setMainViewSceneIndex(t)}async nextPage(){if(this.appManager){const t=this.mainViewSceneIndex+1;return t>=this.mainViewScenesLength?(console.warn("[WindowManager]: current page is the last page"),!1):(await this.appManager.setMainViewSceneIndex(t),!0)}else return!1}async prevPage(){if(this.appManager){const t=this.mainViewSceneIndex-1;return t<0?(console.warn("[WindowManager]: current page is the first page"),!1):(await this.appManager.setMainViewSceneIndex(t),!0)}else return!1}async jumpPage(t){return this.appManager?t<0||t>=this.pageState.length?(console.warn(`[WindowManager]: index ${t} out of range`),!1):(await this.appManager.setMainViewSceneIndex(t),!0):!1}async addPage(t){if(this.appManager){const e=t==null?void 0:t.after,i=t==null?void 0:t.scene;if(e){const n=this.mainViewSceneIndex+1;this.room.putScenes(We,[i||{}],n)}else this.room.putScenes(We,[i||{}])}}async removePage(t){if(this.appManager){const e=t===void 0?this.pageState.index:t;return this.pageState.length===1?(console.warn("[WindowManager]: can not remove the last page"),!1):e<0||e>=this.pageState.length?(console.warn(`[WindowManager]: index ${t} out of range`),!1):this.appManager.removeSceneByIndex(e)}else return!1}getMainViewScenePath(){var t;return(t=this.appManager)==null?void 0:t.store.getMainViewScenePath()}getMainViewSceneIndex(){var t;return(t=this.appManager)==null?void 0:t.store.getMainViewSceneIndex()}setReadonly(t){var e;this.readonly=t,(e=this.boxManager)==null||e.setReadonly(t),R.emit("setReadonly",t)}switchMainViewToWriter(){var t;return(t=this.appManager)==null?void 0:t.mainViewProxy.mainViewClickHandler()}onAppDestroy(t,e){gm(`destroy-${t}`,e)}onAppEvent(t,e){return R.on(`custom-${t}`,e)}setViewMode(t){var e,i,n,r;(t===A.ViewMode.Broadcaster||t===A.ViewMode.Follower)&&(this.canOperate&&t===A.ViewMode.Broadcaster&&((e=this.appManager)==null||e.mainViewProxy.setCameraAndSize()),(i=this.appManager)==null||i.mainViewProxy.start()),t===A.ViewMode.Freedom&&((n=this.appManager)==null||n.mainViewProxy.stop()),this.viewMode=t,(r=this.appManager)==null||r.mainViewProxy.setViewMode(t)}setBoxState(t){!this.canOperate||console.log(t)}setMaximized(t){var e;!this.canOperate||(e=this.boxManager)==null||e.setMaximized(t,!1)}setMinimized(t){var e;!this.canOperate||(e=this.boxManager)==null||e.setMinimized(t,!1)}setFullscreen(t){var e;this._fullscreen!==t&&(this._fullscreen=t,(e=k.sizer)==null||e.classList.toggle("netless-window-manager-fullscreen",t),J.emit("fullscreenChange",t))}get cursorUIDs(){return this._cursorUIDs}setCursorUIDs(t){var e,i;if(this._cursorUIDs=t||[],this._cursorUIDs.length===0)(e=this._cursorUIDsStyleDOM)==null||e.remove();else{this._cursorUIDsStyleDOM||(this._cursorUIDsStyleDOM=document.createElement("style")),(i=k.playground)==null||i.appendChild(this._cursorUIDsStyleDOM);let n="[data-cursor-uid] { display: none }";for(const r of this._cursorUIDs)n+=`
[data-cursor-uid="${r}"] { display: flex }`;this._cursorUIDsStyleDOM.textContent=n}}maximizedBoxNextPage(){var i,n;const t=this.getTopMaxBoxId();if(!t)return!1;const e=(i=this.appManager)==null?void 0:i.appProxies.get(t);return e?(n=e==null?void 0:e.appContext)==null?void 0:n.nextPage():!1}maximizedBoxPrevPage(){var i,n;const t=this.getTopMaxBoxId();if(!t)return!1;const e=(i=this.appManager)==null?void 0:i.appProxies.get(t);return e?(n=e==null?void 0:e.appContext)==null?void 0:n.prevPage():!1}getMaximizedBoxPageState(){var i,n;const t=this.getTopMaxBoxId();if(!t)return;const e=(i=this.appManager)==null?void 0:i.appProxies.get(t);if(!!e)return(n=e==null?void 0:e.appContext)==null?void 0:n.pageState}getTopMaxBoxId(){var e,i;const t=(i=(e=this.appManager)==null?void 0:e.boxManager)==null?void 0:i.teleBoxManager.getMaximizedBoxes().filter(n=>{var r,s;return!((s=(r=this.appManager)==null?void 0:r.boxManager)!=null&&s.teleBoxManager.getMinimizedBoxes().includes(n))});if(!!(t!=null&&t.length))return t.reduce((n,r)=>{var s,o,a,l,u,c,d,f;return Number((l=(a=(o=(s=this.appManager)==null?void 0:s.boxManager)==null?void 0:o.getBox(n))==null?void 0:a._zIndex$)==null?void 0:l.value)>Number((f=(d=(c=(u=this.appManager)==null?void 0:u.boxManager)==null?void 0:c.getBox(r))==null?void 0:d._zIndex$)==null?void 0:f.value)?n:r})}get mainView(){if(this.appManager)return this.appManager.mainViewProxy.view;throw new tt}get camera(){if(this.appManager)return this.appManager.mainViewProxy.view.camera;throw new tt}get cameraState(){if(this.appManager)return this.appManager.mainViewProxy.cameraState;throw new tt}get apps(){var t;return(t=this.appManager)==null?void 0:t.store.apps()}get boxState(){var t;if(this.appManager)return(t=this.appManager.boxManager)==null?void 0:t.boxState;throw new tt}get darkMode(){var t,e;return Boolean((e=(t=this.appManager)==null?void 0:t.boxManager)==null?void 0:e.darkMode)}get prefersColorScheme(){var t;if(this.appManager)return(t=this.appManager.boxManager)==null?void 0:t.prefersColorScheme;throw new tt}get focused(){return this.attributes.focus}get focusedView(){var t,e;return((e=(t=this.appManager)==null?void 0:t.focusApp)==null?void 0:e.view)||this.mainView}get polling(){var t;return((t=this.appManager)==null?void 0:t.polling)||!1}set polling(t){this.appManager&&(this.appManager.polling=t)}get cursorStyle(){var t;return((t=this.cursorManager)==null?void 0:t.style)||"default"}set cursorStyle(t){if(!this.cursorManager)throw new Error("[WindowManager]: cursor is not enabled, please set { cursor: true }.");this.cursorManager.style=t}get mainViewSceneIndex(){var t;return((t=this._pageState)==null?void 0:t.index)||0}get mainViewSceneDir(){var t;if(this.appManager)return(t=this.appManager)==null?void 0:t.getMainViewSceneDir();throw new tt}get topApp(){var t,e;return(e=(t=this.boxManager)==null?void 0:t.getTopBox())==null?void 0:e.id}get mainViewScenesLength(){var t;return((t=this._pageState)==null?void 0:t.length)||0}get canRedoSteps(){var t;return((t=this.focusedView)==null?void 0:t.canRedoSteps)||0}get canUndoSteps(){var t;return((t=this.focusedView)==null?void 0:t.canUndoSteps)||0}get sceneState(){if(this.appManager)return this.appManager.sceneState;throw new tt}get pageState(){if(this._pageState)return this._pageState.toObject();throw new tt}get fullscreen(){return Boolean(this._fullscreen)}get extendWrapper(){return k.extendWrapper}queryAll(){var t;return Array.from(((t=this.appManager)==null?void 0:t.appProxies.values())||[])}queryOne(t){var e;return(e=this.appManager)==null?void 0:e.appProxies.get(t)}async closeApp(t){var e;return(e=this.appManager)==null?void 0:e.closeApp(t)}focusApp(t){var i,n,r;const e=(i=this.boxManager)==null?void 0:i.getBox(t);e&&((n=this.boxManager)==null||n.focusBox({appId:t},!1),((r=this.boxManager)==null?void 0:r.teleBoxManager).makeBoxTop(e,!1))}moveCamera(t){var n;const e=b.omit(t,["animationMode"]),i={...this.mainView.camera};b.isEqual({...i,...e},i)||(this.mainView.moveCamera(t),(n=this.appManager)==null||n.dispatchInternalEvent(re.MoveCamera,t),setTimeout(()=>{var r;(r=this.appManager)==null||r.mainViewProxy.setCameraAndSize()},500))}moveCameraToContain(t){var e;this.mainView.moveCameraToContain(t),(e=this.appManager)==null||e.dispatchInternalEvent(re.MoveCameraToContain,t),setTimeout(()=>{var i;(i=this.appManager)==null||i.mainViewProxy.setCameraAndSize()},500)}convertToPointInWorld(t){return this.mainView.convertToPointInWorld(t)}setCameraBound(t){this.mainView.setCameraBound(t)}onDestroy(){this._destroy()}destroy(){this._destroy()}_destroy(){var t,e,i,n,r,s;(t=this.containerResizeObserver)==null||t.disconnect(),(e=this.appManager)==null||e.destroy(),(i=this.cursorManager)==null||i.destroy(),(n=this.extendPluginManager)==null||n.destroy(),this._destroyLaserPointerManager(),k.container=void 0,k.wrapper=void 0,k.sizer=void 0,k.isCreated=!1,k.playground&&((r=k.playground.parentNode)==null||r.removeChild(k.playground)),k.params=void 0,(s=this._iframeBridge)==null||s.destroy(),this._iframeBridge=void 0,nt("Destroyed")}bindMainView(t,e){var i;this.appManager&&(this.appManager.bindMainView(t,Boolean(e)),(i=this.cursorManager)==null||i.setMainViewDivElement(t))}get canOperate(){return A.isRoom(this.displayer)?this.displayer.isWritable&&this.displayer.phase===A.RoomPhase.Connected:!1}get room(){return this.displayer}safeSetAttributes(t){this.canOperate&&this.setAttributes(t)}safeUpdateAttributes(t,e){this.canOperate&&this.updateAttributes(t,e)}setPrefersColorScheme(t){var e,i;(i=(e=this.appManager)==null?void 0:e.boxManager)==null||i.setPrefersColorScheme(t)}cleanCurrentScene(){var t;nt("clean current scene"),(t=this.focusedView)==null||t.cleanCurrentScene()}redo(){var t;return((t=this.focusedView)==null?void 0:t.redo())||0}undo(){var t;return((t=this.focusedView)==null?void 0:t.undo())||0}delete(){var t;(t=this.focusedView)==null||t.delete()}copy(){var t;(t=this.focusedView)==null||t.copy()}paste(){var t;(t=this.focusedView)==null||t.paste()}duplicate(){var t;(t=this.focusedView)==null||t.duplicate()}insertText(t,e,i){var n;return((n=this.focusedView)==null?void 0:n.insertText(t,e,i))||""}insertImage(t){var e;return(e=this.focusedView)==null?void 0:e.insertImage(t)}completeImageUpload(t,e){var i;return(i=this.focusedView)==null?void 0:i.completeImageUpload(t,e)}lockImage(t,e){var i;return(i=this.focusedView)==null?void 0:i.lockImage(t,e)}lockImages(t){var e;return(e=this.focusedView)==null?void 0:e.lockImages(t)}refresh(){var t;this._refresh(),(t=this.appManager)==null||t.dispatchInternalEvent(re.Refresh)}_refresh(){var t,e;(t=this.appManager)==null||t.mainViewProxy.rebind(),k.container&&this.bindContainer(k.container),(e=this.appManager)==null||e.refresher.refresh()}setContainerSizeRatio(t){if(!b.isNumber(t)||!(t>0))throw new Error(`[WindowManager]: updateContainerSizeRatio error, ratio must be a positive number. but got ${t}`);k.containerSizeRatio=t,this.containerSizeRatio=t,R.emit("containerSizeRatioUpdate",t)}setScale(t,e){var r;if(!b.isNumber(e))return;let i=e;i<1&&(i=1);const n=(r=this.getScale())==null?void 0:r[t];i!==n&&(console.log(`${te} Scale Set`,{appId:t,newScale:i},b.isNumber(i),this.canOperate),this.safeUpdateAttributes([O.Scale,t],i))}_updateMainViewWrapperSize(t,e){var r;const i=(r=k.wrapper)==null?void 0:r.getBoundingClientRect();if(!i)return!1;const n=t!=null?t:this.getAttributesValue(O.Scale)[Oi];!k.mainViewWrapper||!k.mainViewWrapper||(k.mainViewWrapper.style.width=`${(i==null?void 0:i.width)*n}px`,k.mainViewWrapper.style.height=`${(i==null?void 0:i.height)*n}px`,e||this.readonly||Il()||Cl(),this.room.disableCameraTransform=!0,R.emit("wrapperSizeChange",k.mainViewWrapper.getBoundingClientRect()))}_setScale(t,e){var r;const{appId:i,scale:n}=t;return i==Oi?this._updateMainViewWrapperSize(n,e):R.emit("onScaleChange",{appId:i,scale:n}),(r=this.scrollerManager)==null||r.moveToCenter(i),!0}getScale(){return this.getAttributesValue([O.Scale])}setTeacherInfo(t){var e,i;(i=(e=this.appManager)==null?void 0:e.store)==null||i.setTeacherInfo(t)}get teacherInfo(){var t,e;return((e=(t=this.appManager)==null?void 0:t.store)==null?void 0:e.getTeacherInfo())||{}}setLaserPointer(t){var e;this.safeUpdateAttributes([O.LaserPointerActive],{active:t,uid:(e=this.appManager)==null?void 0:e.uid})}async _setLaserPointer(t){var e,i,n,r;if(!t){(e=this.mutationObserver)==null||e.disconnect(),this.mutationObserver=null,(i=this._laserPointerMultiManager)==null||i.setLaserPointerActive(!1);const s=document.querySelectorAll(".netless-window-manager-cursor-mid");s==null||s.forEach(o=>{o.classList.add("force-none")});return}this._laserPointerMultiManager||await this._initLaserPointerManager(),((n=this.teacherInfo)==null?void 0:n.uid)===this._getCurrentUserId()&&((r=this._laserPointerMultiManager)==null||r.setLaserPointerActive(!0))}async _initLaserPointerManager(){if(console.log(`${te} Initializing LaserPointerMultiManager, existing:`,!!this._laserPointerMultiManager),this._laserPointerMultiManager){console.log(`${te} LaserPointerMultiManager already exists, skipping initialization`);return}if(this.room&&this.displayer&&this.appManager){const{LaserPointerMultiManager:t}=await Promise.resolve().then(function(){return require("./index2.js")});this._laserPointerMultiManager=new t(this),this._laserPointerMultiManager.setupEventListeners(),console.log(`${te} LaserPointerMultiManager created successfully`)}else console.warn(`${te} Cannot initialize LaserPointerMultiManager - missing dependencies`)}_getCurrentUserId(){var t,e,i,n;return(t=this.appManager)!=null&&t.uid?(n=(i=xs(this.room,(e=this.appManager)==null?void 0:e.uid))==null?void 0:i.payload)==null?void 0:n.uid:void 0}_destroyLaserPointerManager(){var t;(t=this._laserPointerMultiManager)==null||t.destroy(),this._laserPointerMultiManager=void 0}get isLaserPointerActive(){return this.getAttributesValue([O.LaserPointerActive]).active||!1}get container(){return k.container}getAppScale(t){return this.getAttributesValue([O.Scale])[t]}isDynamicPPT(t){var i,n;const e=(n=(i=t[0])==null?void 0:i.ppt)==null?void 0:n.src;return e==null?void 0:e.startsWith("pptx://")}async ensureAttributes(){var t;if(b.isNull(this.attributes)&&await Yd(50),b.isObject(this.attributes)){if(this.attributes[O.Apps]||this.safeSetAttributes({[O.Apps]:{}}),this.attributes[O.Cursors]||this.safeSetAttributes({[O.Cursors]:{}}),this.attributes._mainScenePath||this.safeSetAttributes({_mainScenePath:Qd}),this.attributes._mainSceneIndex||this.safeSetAttributes({_mainSceneIndex:0}),this.attributes[O.Registered]||this.safeSetAttributes({[O.Registered]:{}}),this.attributes[O.IframeBridge]||this.safeSetAttributes({[O.IframeBridge]:{}}),this.attributes[O.MainViewBackgroundInfo]||this.safeSetAttributes({[O.MainViewBackgroundInfo]:{img:"",color:""}}),!this.attributes[O.Scale]){if(!((t=this.wukongRoleManager)!=null&&t.wukongCanOperate())||this.readonly)return;this.safeSetAttributes({[O.Scale]:{[Oi]:1}})}this.attributes[O.LaserPointerActive]||this.safeSetAttributes({[O.LaserPointerActive]:{active:!1,uid:""}})}}getIframeBridge(){if(!this.appManager)throw new Error("[WindowManager]: should call getIframeBridge() after await mount()");return this._iframeBridge||(this._iframeBridge=new Pi(this,this.appManager)),this._iframeBridge}useExtendPlugin(t){var e;(e=this.extendPluginManager)==null||e.use(t)}getBackground(){if(this.attributes[O.MainViewBackgroundInfo]){const t=this.attributes[O.MainViewBackgroundInfo];if(t.img.length>0)return{type:"img",value:t.img};if(t.color.length>0)return{type:"color",value:t.color}}}setBackgroundImg(t){this.safeUpdateAttributes([O.MainViewBackgroundInfo],{color:"",img:t})}setBackgroundColor(t){this.safeUpdateAttributes([O.MainViewBackgroundInfo],{color:t,img:""})}_setBackgroundColor(t){!k.mainViewWrapper||(k.mainViewWrapper.style.backgroundColor=t,k.mainViewWrapper.style.backgroundImage="unset")}_setBackgroundImg(t){!k.mainViewWrapper||(k.mainViewWrapper.style.backgroundImage=`url(${t})`,k.mainViewWrapper.style.backgroundColor="unset")}_initAttribute(){const t=this.attributes[O.MainViewBackgroundInfo];if(t&&t.img.length>0?this._setBackgroundImg(t.img):t&&t.color.length>0&&this._setBackgroundColor(t.color),this.attributes[O.Scale]){const e=this.attributes[O.Scale];Object.keys(e).forEach(i=>{this._setScale({appId:i,scale:e[i]},!0)})}if(this.attributes[O.LaserPointerActive]){const{active:e}=this.attributes[O.LaserPointerActive];this._setLaserPointer(e).catch(console.error)}}};let q=k;q.kind="WindowManager";q.debug=!1;q.containerSizeRatio=Jg;q.isCreated=!1;q._resolve=t=>{};SS();exports.AllBoxStatusInfoManager=jg;exports.AppCreateError=Xd;exports.AppManagerNotInitError=tt;exports.AppNotRegisterError=Mm;exports.BindContainerRoomPhaseInvalidError=ih;exports.BoxManagerNotFoundError=th;exports.BoxNotCreatedError=qd;exports.BuiltinApps=IS;exports.DomEvents=Dg;exports.ExtendPlugin=bS;exports.ExtendPluginManager=zg;exports.IframeBridge=Pi;exports.IframeEvents=Bg;exports.InvalidScenePath=eh;exports.LaserPointerManager=Rg;exports.LaserPointerMultiManager=NS;exports.ParamsInvalidError=Kd;exports.WhiteWebSDKInvalidError=Jd;exports.WindowManager=q;exports.WukongRoleManager=Lg;exports.WukongUserRoleType=Ru;exports.calculateNextIndex=bl;exports.logFirstTag=te;exports.mainViewField=Oi;exports.reconnectRefresher=Vg;
//# sourceMappingURL=index.js.map
