"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var _g=require("p-retry"),Vg=require("emittery"),b=require("lodash"),T=require("white-web-sdk"),Og=require("uuid"),$g=require("@juggle/resize-observer"),Wg=require("video.js"),_c=require("value-enhancer");function dl(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}function Ug(t){if(t&&t.__esModule)return t;var e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});return t&&Object.keys(t).forEach(function(i){if(i!=="default"){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}}),e.default=t,Object.freeze(e)}var Ud=dl(_g),bi=dl(Vg),Vc=dl(Wg),ne=(t=>(t.AppMove="AppMove",t.AppFocus="AppFocus",t.AppResize="AppResize",t.AppBoxStateChange="AppBoxStateChange",t.GetAttributes="GetAttributes",t.UpdateWindowManagerWrapper="UpdateWindowManagerWrapper",t.InitReplay="InitReplay",t.WindowCreated="WindowCreated",t.SetMainViewScenePath="SetMainViewScenePath",t.SetMainViewSceneIndex="SetMainViewSceneIndex",t.SetAppFocusIndex="SetAppFocusIndex",t.SwitchViewsToFreedom="SwitchViewsToFreedom",t.MoveCamera="MoveCamera",t.MoveCameraToContain="MoveCameraToContain",t.CursorMove="CursorMove",t.RootDirRemoved="RootDirRemoved",t.Refresh="Refresh",t.InitMainViewCamera="InitMainViewCamera",t))(ne||{});const qo="__WindowManger",So="__WindowMangerEnsureReconnected__";var ze=(t=>(t.Size="size",t.Position="position",t.SceneIndex="SceneIndex",t.ZIndex="zIndex",t))(ze||{}),Hd=(t=>(t.setBoxSize="setBoxSize",t.setBoxMinSize="setBoxMinSize",t.destroy="destroy",t))(Hd||{}),ea=(t=>(t.StartCreate="StartCreate",t))(ea||{}),ta=(t=>(t.Leave="leave",t.Normal="normal",t))(ta||{});const Oc="2.16.1",Hg=340/720,Fg=340/720,Zg=9/16,Ue="/",Fd="/init",Zd=200,J=new bi.default;class Qg{constructor(){this.list=[],this.isEmit=!1,this.invoked=()=>{this.currentInvoker=void 0,this.list.length===0&&(this.clear(),this.emitReady())},this.clear=()=>{clearInterval(this.timer),this.timer=void 0}}initInterval(){return setInterval(()=>{this.invoke()},50)}push(e){this.list.push(e),this.invoke(),this.timer===void 0&&this.list.length>0&&(this.timer=this.initInterval())}invoke(){if(this.list.length===0||this.currentInvoker!==void 0)return;const e=this.list.shift();e&&(this.currentInvoker=e,e().then(()=>{this.invoked()}).catch(i=>{console.error(`[WindowManager]: create app error: ${i.message}`),this.invoked()}))}emitReady(){this.isEmit||setTimeout(()=>{J.emit("ready")},Zd),this.isEmit=!0}empty(){this.list=[],this.clear()}destroy(){this.timer&&this.clear()}}const R=new bi.default,Gg="__WindowManagerAppCache";let Jn,$c;const Yg=async()=>{Jn=await Kg()},Xg=(t,e)=>{if(!!Jn)return em(Jn,{kind:t,sourceCode:e})},Jg=async t=>Jn?await qg(Jn,t):null;function Kg(){return new Promise((t,e)=>{const i=indexedDB.open(Gg,2);i.onerror=n=>{e(n)},i.onupgradeneeded=n=>{const r=n.target.result;r.objectStoreNames.contains("apps")||($c=r.createObjectStore("apps",{keyPath:"kind"}),$c.createIndex("kind","kind",{unique:!0}))},i.onsuccess=()=>{const n=i.result;t(n)}})}function qg(t,e){return new Promise((i,n)=>{const s=t.transaction(["apps"]).objectStore("apps").index("kind").get(e);s.onerror=o=>n(o),s.onsuccess=()=>{s.result?i(s.result):i(null)}})}function em(t,e){return new Promise((i,n)=>{const r=t.transaction(["apps"],"readwrite").objectStore("apps").add(e);r.onsuccess=()=>i(),r.onerror=()=>n()})}const tm="NetlessApp",im=1e4,nm=async t=>{const e=await Jg(t);if(e)return e.sourceCode;{const n=await(await om(t,{timeout:im})).text();return await Xg(t,n),n}},Wc=(t,e)=>{let i=Function(t+`
;return ${e}`)();return typeof i=="undefined"&&(i=window[e]),i},rm=async(t,e,i)=>{const n=i||tm+e;J.emit("loadApp",{kind:e,status:"start"});let r;try{if(r=await nm(t),!r||r.length===0)throw J.emit("loadApp",{kind:e,status:"failed",reason:"script is empty."}),new Error("[WindowManager]: script is empty.")}catch(s){throw J.emit("loadApp",{kind:e,status:"failed",reason:s.message}),s}return sm(r,n,e)},sm=(t,e,i)=>{try{const n=Wc(t,e);return J.emit("loadApp",{kind:i,status:"success"}),n}catch(n){if(n.message.includes("Can only have one anonymous define call per script file")){const r=window.define;typeof r=="function"&&r.amd&&delete r.amd;const s=Wc(t,e);return J.emit("loadApp",{kind:i,status:"success"}),s}throw J.emit("loadApp",{kind:i,status:"failed",reason:n.message}),n}};async function om(t,e){const{timeout:i=1e4}=e,n=new AbortController,r=setTimeout(()=>n.abort(),i),s=await fetch(t,{...e,signal:n.signal,headers:{"content-type":"text/plain"}});return clearTimeout(r),s}class am{constructor(){this.kindEmitters=new Map,this.registered=new Map,this.appClassesCache=new Map,this.appClasses=new Map,this.syncRegisterApp=null,this.onSyncRegisterAppChange=e=>{this.register({kind:e.kind,src:e.src})}}setSyncRegisterApp(e){this.syncRegisterApp=e}async register(e){this.appClassesCache.delete(e.kind),this.registered.set(e.kind,e);const i=e.src;let n;if(typeof i=="string"&&(n=async()=>{const r=await rm(i,e.kind,e.name);return r.__esModule?r.default:r},this.syncRegisterApp&&this.syncRegisterApp({kind:e.kind,src:i,name:e.name})),typeof i=="function"&&(n=async()=>{let r=await i();if(r)return(r.__esModule||r.default)&&(r=r.default),r;throw new Error(`[WindowManager]: load remote script failed, ${i}`)}),typeof i=="object"&&(n=async()=>i),this.appClasses.set(e.kind,async()=>{let r=this.appClassesCache.get(e.kind);return r||(r=n(),this.appClassesCache.set(e.kind,r)),r}),e.addHooks){const r=this.createKindEmitter(e.kind);r&&e.addHooks(r)}}unregister(e){this.appClasses.delete(e),this.appClassesCache.delete(e),this.registered.delete(e);const i=this.kindEmitters.get(e);i&&(i.clearListeners(),this.kindEmitters.delete(e))}async notifyApp(e,i,n){const r=this.kindEmitters.get(e);await(r==null?void 0:r.emit(i,n))}createKindEmitter(e){if(!this.kindEmitters.has(e)){const i=new bi.default;this.kindEmitters.set(e,i)}return this.kindEmitters.get(e)}}const Ee=new am,lm=async t=>{var i,n;const e=await((i=Ee.appClasses.get(t))==null?void 0:i());return e&&((n=e.config)==null?void 0:n.singleton)?t:`${t}-${Og.v4().replace("-","").slice(0,8)}`},yi=(t,e)=>{if(t.focusScenePath!==e)return t.focusScenePath=e,t},ia=(t,e)=>{if(t&&t.isWritable&&t.state.sceneState.scenePath!==e){const i=e==="/"?"":e;t.setScenePath(i)}},cm=(t,e,i)=>{var n;if(t&&e){const s=(n=nn(t)[e])==null?void 0:n[i];if(s)return`${e}/${s.name}`}},na=(t,e,i)=>{t&&t.scenePathType(e)!==T.ScenePathType.None&&t.removeScenes(e,i)},um=(t,e)=>{R.once(t).then(e)};b.debounce((t,e)=>{t.emit("mainViewModeChange",e)},200);const dm=(t,e,i=0)=>{const n=nn(t)[e];if(!n)return;const r=n[i];if(!r)return;const s=r.name;return e===Ue?`/${s}`:`${e}/${s}`},nn=t=>t.entireScenes(),Ln=(t,e,i,n)=>{var r;for(let s=0;s<i.length;++s)if((r=i[s].name)!=null&&r.includes("/"))throw new Error("scenes name can not have '/'");return t==null?void 0:t.putScenes(e,i,n)},hm=t=>t.startsWith("/"),Io=t=>{const e=t.split("/");e.pop();let i=e.join("/");return i===""&&(i="/"),i},pm=t=>t.endsWith("/")?t.slice(0,-1):t,Uc=t=>{const e=t.split(".").map(i=>i.padStart(2,"0")).join("");return parseInt(e)},Qd=t=>new Promise(e=>setTimeout(e,t)),fm=t=>t.split("").reduce((i,n)=>(n===Ue&&(i+=1),i),0)===1;class gm{constructor(e){this.manager=e,this.displayer=this.manager.displayer,this.mainMagixEventListener=i=>{if(i.authorId!==this.displayer.observerId){const n=i.payload;switch(n.eventName){case ne.AppMove:{this.appMoveHandler(n.payload);break}case ne.AppResize:{this.appResizeHandler(n.payload);break}case ne.AppBoxStateChange:{this.boxStateChangeHandler(n.payload);break}case ne.SetMainViewScenePath:{this.setMainViewScenePathHandler(n.payload);break}case ne.MoveCamera:{this.moveCameraHandler(n.payload);break}case ne.MoveCameraToContain:{this.moveCameraToContainHandler(n.payload);break}case ne.CursorMove:{this.cursorMoveHandler(n.payload);break}case ne.RootDirRemoved:{this.rootDirRemovedHandler();break}case ne.Refresh:{this.refreshHandler();break}case ne.InitMainViewCamera:{this.initMainViewCameraHandler();break}case ne.SetAppFocusIndex:{this.setAppFocusViewIndexHandler(n.payload);break}}}},this.appMoveHandler=i=>{var n;(n=this.boxManager)==null||n.moveBox(i)},this.appResizeHandler=i=>{var n,r;(n=this.boxManager)==null||n.resizeBox(Object.assign(i,{skipUpdate:!0})),(r=this.manager.room)==null||r.refreshViewSize()},this.boxStateChangeHandler=i=>{J.emit("boxStateChange",i)},this.setMainViewScenePathHandler=({nextScenePath:i})=>{yi(this.manager.mainView,i),J.emit("mainViewScenePathChange",i)},this.moveCameraHandler=i=>{b.isEqual(b.omit(i,["animationMode"]),{...this.manager.mainView.camera})||this.manager.mainView.moveCamera(i)},this.moveCameraToContainHandler=i=>{this.manager.mainView.moveCameraToContain(i)},this.cursorMoveHandler=i=>{R.emit("cursorMove",i)},this.rootDirRemovedHandler=()=>{this.manager.createRootDirScenesCallback(),this.manager.mainViewProxy.rebind(),R.emit("rootDirRemoved")},this.refreshHandler=()=>{this.manager.windowManger._refresh()},this.initMainViewCameraHandler=()=>{this.manager.mainViewProxy.addCameraReaction()},this.setAppFocusViewIndexHandler=i=>{if(i.type==="main")this.manager.setSceneIndexWithoutSync(i.index);else if(i.type==="app"&&i.appID){const n=this.manager.appProxies.get(i.appID);n&&n.setSceneIndexWithoutSync(i.index)}}}get boxManager(){return this.manager.boxManager}addListeners(){this.displayer.addMagixEventListener(qo,this.mainMagixEventListener)}removeListeners(){this.displayer.removeMagixEventListener(qo,this.mainMagixEventListener)}}class Gd extends Error{constructor(){super(...arguments),this.message="[WindowManager]: app duplicate exists and cannot be created again"}}class mm extends Error{constructor(e){super(`[WindowManager]: app ${e} need register or provide src`)}}class et extends Error{constructor(){super(...arguments),this.message="[WindowManager]: AppManager must be initialized"}}class Yd extends Error{constructor(e){super(`[WindowManager]: white-web-sdk version must large than ${e}`)}}class Xd extends Error{constructor(){super(...arguments),this.message="[WindowManager]: kind must be a valid string"}}class Jd extends Error{constructor(){super(...arguments),this.message="[WindowManager]: box need created"}}class Kd extends Error{constructor(){super(...arguments),this.message='[WindowManager]: ScenePath should start with "/"'}}class qd extends Error{constructor(){super(...arguments),this.message="[WindowManager]: boxManager not found"}}class eh extends Error{constructor(){super(...arguments),this.message="[WindowManager]: room phase only Connected can be bindContainer"}}const th="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",vm=th.length,Hc=Array(20),Li=()=>{for(let t=0;t<20;t++)Hc[t]=th.charAt(Math.random()*vm);return Hc.join("")};class hn{constructor(){this.disposers=new Map}add(e,i=Li()){return this.flush(i),this.disposers.set(i,e()),i}addDisposer(e,i=Li()){return this.flush(i),this.disposers.set(i,e),i}addEventListener(e,i,n,r,s=Li()){return this.add(()=>(e.addEventListener(i,n,r),()=>e.removeEventListener(i,n,r)),s),s}setTimeout(e,i,n=Li()){return this.add(()=>{const r=window.setTimeout(()=>{this.remove(n),e()},i);return()=>window.clearTimeout(r)},n)}setInterval(e,i,n=Li()){return this.add(()=>{const r=window.setInterval(e,i);return()=>window.clearInterval(r)},n)}remove(e){const i=this.disposers.get(e);return this.disposers.delete(e),i}flush(e){const i=this.remove(e);if(i)try{i()}catch(n){console.error(n)}}flushAll(){this.disposers.forEach(e=>{try{e()}catch(i){console.error(i)}}),this.disposers.clear()}}const ih=t=>(e,i)=>{if(e!==void 0)if(T.listenUpdated){const n=r=>{r.map(o=>o.kind).includes(t)&&i()};return T.listenUpdated(e,n),i(),()=>T.unlistenUpdated(e,n)}else return T.reaction(()=>e,()=>{i()},{fireImmediately:!0})},ra=(t,e,i)=>{let n=null;const r=T.reaction(t,()=>{n&&(n(),n=null);const s=t();b.isObject(s)?(n=()=>T.unlistenUpdated(s,e),T.listenUpdated(s,e)):i==null||i(s)},{fireImmediately:!0});return()=>{n==null||n(),r()}};ih(T.UpdateEventKind.Removed);ih(T.UpdateEventKind.Inserted);class wm{constructor(){this.listeners=new Set}get length(){return this.listeners.size}dispatch(e){this.listeners.forEach(i=>i(e))}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}}const Co=Object.keys;function Fc(t){return Boolean(b.has(t,"__isRef"))}function ym(t){return{k:Li(),v:t,__isRef:!0}}const qe="_WM-STORAGE_";class Zc{constructor(e,i,n){if(this.maxIllusionQueueSize=500,this._sideEffect=new hn,this._destroyed=!1,this._refMap=new WeakMap,this._lastValue=new Map,this.onStateChanged=new wm,n&&!b.isObject(n))throw new Error(`Default state for Storage ${i} is not an object.`);this._context=e,this.id=i||null,this._state={};const r=this._getRawState(this._state);this._context.getIsWritable()&&(this.id===null?e.isAddApp&&n&&this.setState(n):(r===this._state||!b.isObject(r))&&(b.get(this._context.getAttributes(),[qe])||this._context.updateAttributes([qe],{}),this._context.updateAttributes([qe,this.id],this._state),n&&this.setState(n))),Co(r).forEach(s=>{if(!(this.id===null&&s===qe))try{const o=b.isObject(r[s])?JSON.parse(JSON.stringify(r[s])):r[s];Fc(o)?(this._state[s]=o.v,b.isObject(o.v)&&this._refMap.set(o.v,o)):this._state[s]=o}catch(o){console.error(o)}}),this._sideEffect.addDisposer(ra(()=>this.id===null?e.getAttributes():b.get(e.getAttributes(),[qe,this.id]),this._updateProperties.bind(this),this.destroy.bind(this)))}get state(){return this._destroyed&&console.warn(`Accessing state on destroyed Storage "${this.id}"`),this._state}addStateChangedListener(e){return this.onStateChanged.addListener(e),()=>this.onStateChanged.removeListener(e)}ensureState(e){return this.setState(Co(e).reduce((i,n)=>(b.has(this._state,n)||(i[n]=e[n]),i),{}))}setState(e){if(this._destroyed){console.error(new Error(`Cannot call setState on destroyed Storage "${this.id}".`));return}if(!this._context.getIsWritable()){console.error(new Error(`Cannot setState on Storage "${this.id}" without writable access`),e);return}const i=Co(e);i.length>0&&i.forEach(n=>{const r=e[n];if(r!==this._state[n])if(r===void 0)this._lastValue.set(n,this._state[n]),delete this._state[n],this._setRawState(n,r);else{this._lastValue.set(n,this._state[n]),this._state[n]=r;let s=r;if(b.isObject(r)){let o=this._refMap.get(r);o||(o=ym(r),this._refMap.set(r,o)),s=o}this._setRawState(n,s)}})}emptyStorage(){if(!(b.size(this._state)<=0)){if(this._destroyed){console.error(new Error(`Cannot empty destroyed Storage "${this.id}".`));return}if(!this._context.getIsWritable()){console.error(new Error(`Cannot empty Storage "${this.id}" without writable access.`));return}this.setState(b.mapValues(this._state,b.noop))}}deleteStorage(){if(this.id===null)throw new Error("Cannot delete main Storage");if(!this._context.getIsWritable()){console.error(new Error(`Cannot delete Storage "${this.id}" without writable access.`));return}this.destroy(),this._context.updateAttributes([qe,this.id],void 0)}get destroyed(){return this._destroyed}destroy(){this._destroyed=!0,this._sideEffect.flushAll()}_getRawState(e){var i;return this.id===null?(i=this._context.getAttributes())!=null?i:e:b.get(this._context.getAttributes(),[qe,this.id],e)}_setRawState(e,i){if(this.id===null){if(e===qe)throw new Error(`Cannot set attribute internal filed "${qe}"`);return this._context.updateAttributes([e],i)}else return this._context.updateAttributes([qe,this.id,e],i)}_updateProperties(e){var i;if(this._destroyed){console.error(new Error(`Cannot call _updateProperties on destroyed Storage "${this.id}".`));return}if(e.length>0){const n={};for(let r=0;r<e.length;r++)try{const s=e[r],o=s.key;if(this.id===null&&o===qe)continue;const a=b.isObject(s.value)?JSON.parse(JSON.stringify(s.value)):s.value;let c;switch(this._lastValue.has(o)&&(c=this._lastValue.get(o),this._lastValue.delete(o)),s.kind){case 2:{b.has(this._state,o)&&(c=this._state[o],delete this._state[o]),n[o]={oldValue:c};break}default:{let l=a;if(Fc(a)){const{k:u,v:d}=a,f=this._state[o];b.isObject(f)&&((i=this._refMap.get(f))==null?void 0:i.k)===u?l=f:(l=d,b.isObject(d)&&this._refMap.set(d,a))}l!==this._state[o]&&(c=this._state[o],this._state[o]=l),n[o]={newValue:l,oldValue:c};break}}}catch(s){console.error(s)}this.onStateChanged.dispatch(n)}}}class xm{constructor(e,i,n,r,s){this.manager=e,this.boxManager=i,this.appId=n,this.appProxy=r,this.appOptions=s,this.mobxUtils={autorun:T.autorun,reaction:T.reaction,toJS:T.toJS},this.objectUtils={listenUpdated:T.listenUpdated,unlistenUpdated:T.unlistenUpdated,listenDisposed:T.listenDisposed,unlistenDisposed:T.unlistenDisposed},this.store=this.manager.store,this.isReplay=this.manager.isReplay,this.getDisplayer=()=>this.manager.displayer,this.getAttributes=()=>this.appProxy.attributes,this.getScenes=()=>{const o=this.store.getAppAttributes(this.appId);return o!=null&&o.isDynamicPPT?this.appProxy.scenes:o==null?void 0:o.options.scenes},this.getView=()=>this.appProxy.view,this.mountView=o=>{const a=this.getView();a&&(a.divElement=o,setTimeout(()=>{var c;(c=this.getRoom())==null||c.refreshViewSize(),J.emit("onAppViewMounted",{appId:this.appId,view:a})},1e3))},this.getInitScenePath=()=>this.manager.getAppInitPath(this.appId),this.getIsWritable=()=>this.manager.canOperate,this.getIsAppReadonly=()=>this.manager.appReadonly,this.getBox=()=>{const o=this.boxManager.getBox(this.appId);if(o)return o;throw new Jd},this.getRoom=()=>this.manager.room,this.setAttributes=o=>{this.manager.safeSetAttributes({[this.appId]:o})},this.updateAttributes=(o,a)=>{this.manager.attributes[this.appId]&&this.manager.safeUpdateAttributes([this.appId,...o],a)},this.setScenePath=async o=>{var a;!this.appProxy.box||(this.appProxy.setFullPath(o),(a=this.getRoom())==null||a.setScenePath(o))},this.getAppOptions=()=>typeof this.appOptions=="function"?this.appOptions():this.appOptions,this.createStorage=(o,a)=>{const c=new Zc(this,o,a);return this.emitter.on("destroy",()=>{c.destroy()}),c},this.dispatchMagixEvent=(...o)=>{var c;const a=`${this.appId}:${o[0]}`;return(c=this.manager.room)==null?void 0:c.dispatchMagixEvent(a,o[1])},this.addMagixEventListener=(o,a,c)=>{const l=`${this.appId}:${o}`;return this.manager.displayer.addMagixEventListener(l,a,c),()=>this.manager.displayer.removeMagixEventListener(l,a)},this.removeMagixEventListener=this.manager.displayer.removeMagixEventListener.bind(this.manager.displayer),this.nextPage=async()=>{const o=this.pageState.index+1;return o>this.pageState.length-1?(console.warn("[WindowManager] nextPage: index out of range"),!1):(this.appProxy.setSceneIndex(o),!0)},this.jumpPage=async o=>0<=o&&o<this.pageState.length?(this.appProxy.setSceneIndex(o),!0):(console.warn("[WindowManager] nextPage: index out of range"),!1),this.prevPage=async()=>{const o=this.pageState.index-1;return o<0?(console.warn("[WindowManager] prevPage: index out of range"),!1):(this.appProxy.setSceneIndex(o),!0)},this.addPage=async o=>{const a=o==null?void 0:o.after,c=o==null?void 0:o.scene,l=this.appProxy.scenePath;if(!!l)if(a){const u=this.pageState.index+1;Ln(this.manager.room,l,[c||{}],u)}else Ln(this.manager.room,l,[c||{}])},this.removePage=async o=>{const a=o===void 0?this.pageState.index:o;return this.pageState.length===1?(console.warn("[WindowManager]: can not remove the last page"),!1):a<0||a>=this.pageState.length?(console.warn(`[WindowManager]: page index ${o} out of range`),!1):this.appProxy.removeSceneByIndex(a)},this.emitter=r.appEmitter,this.isAddApp=r.isAddApp}get storage(){return this._storage||(this._storage=new Zc(this)),this._storage}get pageState(){return this.appProxy.pageState}get kind(){return this.appProxy.kind}dispatchAppEvent(e,i){R.emit(`custom-${this.kind}`,{kind:this.kind,appId:this.appId,type:e,value:i})}get extendWrapper(){return this.manager.extendWrapper}}class Mm{constructor(e){this.params=e,this.sceneNode=null,this.onSceneChange=r=>{this.sceneNode=r,this.params.notifyPageStateChange()};const{displayer:i,scenePath:n}=this.params;n&&(this.sceneNode=i.createScenesCallback(n,{onAddScene:this.onSceneChange,onRemoveScene:this.onSceneChange}))}getFullPath(e){var n;const i=(n=this.sceneNode)==null?void 0:n.scenes;if(this.params.scenePath&&i){const r=i[e];if(r)return`${this.params.scenePath}/${r}`}}toObject(){var e,i;return{index:((e=this.params.view)==null?void 0:e.focusSceneIndex)||0,length:((i=this.sceneNode)==null?void 0:i.scenes.length)||0}}destroy(){var e;(e=this.sceneNode)==null||e.dispose()}}var nh={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,i="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(i=!1));function r(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function s(c,l,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var v=new r(u,d||c,f),w=i?i+l:l;return c._events[w]?c._events[w].fn?c._events[w]=[c._events[w],v]:c._events[w].push(v):(c._events[w]=v,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new n:delete c._events[l]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(i?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=i?i+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,v=d.length,w=new Array(v);f<v;f++)w[f]=d[f].fn;return w},a.prototype.listenerCount=function(l){var u=i?i+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,f,v,w){var x=i?i+l:l;if(!this._events[x])return!1;var h=this._events[x],p=arguments.length,g,m;if(h.fn){switch(h.once&&this.removeListener(l,h.fn,void 0,!0),p){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,u),!0;case 3:return h.fn.call(h.context,u,d),!0;case 4:return h.fn.call(h.context,u,d,f),!0;case 5:return h.fn.call(h.context,u,d,f,v),!0;case 6:return h.fn.call(h.context,u,d,f,v,w),!0}for(m=1,g=new Array(p-1);m<p;m++)g[m-1]=arguments[m];h.fn.apply(h.context,g)}else{var y=h.length,M;for(m=0;m<y;m++)switch(h[m].once&&this.removeListener(l,h[m].fn,void 0,!0),p){case 1:h[m].fn.call(h[m].context);break;case 2:h[m].fn.call(h[m].context,u);break;case 3:h[m].fn.call(h[m].context,u,d);break;case 4:h[m].fn.call(h[m].context,u,d,f);break;default:if(!g)for(M=1,g=new Array(p-1);M<p;M++)g[M-1]=arguments[M];h[m].fn.apply(h[m].context,g)}}return!0},a.prototype.on=function(l,u,d){return s(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return s(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,f){var v=i?i+l:l;if(!this._events[v])return this;if(!u)return o(this,v),this;var w=this._events[v];if(w.fn)w.fn===u&&(!f||w.once)&&(!d||w.context===d)&&o(this,v);else{for(var x=0,h=[],p=w.length;x<p;x++)(w[x].fn!==u||f&&!w[x].once||d&&w[x].context!==d)&&h.push(w[x]);h.length?this._events[v]=h.length===1?h[0]:h:o(this,v)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=i?i+l:l,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=i,a.EventEmitter=a,t.exports=a})(nh);var gs=nh.exports;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ne=function(){return Ne=Object.assign||function(e){for(var i,n=1,r=arguments.length;n<r;n++){i=arguments[n];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Ne.apply(this,arguments)};function hl(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]]);return i}var bo=0,rh=typeof window!="undefined"&&window.requestAnimationFrame!==void 0?function(t){return window.requestAnimationFrame(t)}:function(t){var e=Date.now(),i=Math.max(0,16.7-(e-bo));bo=e+i,setTimeout(function(){return t(bo)},i)},Sm=function(t){var e=[],i=[],n=0,r=!1,s=0,o=new WeakSet,a=new WeakSet,c={cancel:function(l){var u=i.indexOf(l);o.add(l),u!==-1&&i.splice(u,1)},process:function(l){var u;if(r=!0,u=[i,e],e=u[0],i=u[1],i.length=0,n=e.length,n){var d;for(s=0;s<n;s++)d=e[s],d(l),a.has(d)===!0&&!o.has(d)&&(c.schedule(d),t(!0))}r=!1},schedule:function(l,u,d){u===void 0&&(u=!1),d===void 0&&(d=!1);var f=d&&r,v=f?e:i;o.delete(l),u&&a.add(l),v.indexOf(l)===-1&&(v.push(l),f&&(n=e.length))}};return c},Im=40,Qc=1/60*1e3,Jr=!0,Kn=!1,sa=!1,Pn={delta:0,timestamp:0},pl=["read","update","preRender","render","postRender"],Cm=function(t){return Kn=t},sh=pl.reduce(function(t,e){return t[e]=Sm(Cm),t},{}),bm=pl.reduce(function(t,e){var i=sh[e];return t[e]=function(n,r,s){return r===void 0&&(r=!1),s===void 0&&(s=!1),Kn||Tm(),i.schedule(n,r,s),n},t},{}),Am=function(t){return sh[t].process(Pn)},oh=function(t){Kn=!1,Pn.delta=Jr?Qc:Math.max(Math.min(t-Pn.timestamp,Im),1),Jr||(Qc=Pn.delta),Pn.timestamp=t,sa=!0,pl.forEach(Am),sa=!1,Kn&&(Jr=!1,rh(oh))},Tm=function(){Kn=!0,Jr=!0,sa||rh(oh)},ah=function(t,e){return function(i){return Math.max(Math.min(i,e),t)}},Kr=function(t){return t%1?Number(t.toFixed(5)):t},lh=/^(#[0-9a-f]{3}|#(?:[0-9a-f]{2}){2,4}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2,3}\s*\/*\s*[\d\.]+%?\))$/i,Xs={test:function(t){return typeof t=="number"},parse:parseFloat,transform:function(t){return t}},jn=Ne(Ne({},Xs),{transform:ah(0,1)}),Pr=Ne(Ne({},Xs),{default:1}),fl=function(t){return{test:function(e){return typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1},parse:parseFloat,transform:function(e){return""+e+t}}},ni=fl("deg"),Rn=fl("%"),F=fl("px"),Gc=Ne(Ne({},Rn),{parse:function(t){return Rn.parse(t)/100},transform:function(t){return Rn.transform(t*100)}}),Em=function(t){return t.substring(t.indexOf("(")+1,t.lastIndexOf(")"))},Nm=ah(0,255),oa=function(t){return t.red!==void 0},aa=function(t){return t.hue!==void 0};function km(t){return Em(t).replace(/(,|\/)/g," ").split(/ \s*/)}var ch=function(t){return function(e){if(typeof e!="string")return e;for(var i={},n=km(e),r=0;r<4;r++)i[t[r]]=n[r]!==void 0?parseFloat(n[r]):1;return i}},Pm=function(t){var e=t.red,i=t.green,n=t.blue,r=t.alpha,s=r===void 0?1:r;return"rgba("+e+", "+i+", "+n+", "+s+")"},Bm=function(t){var e=t.hue,i=t.saturation,n=t.lightness,r=t.alpha,s=r===void 0?1:r;return"hsla("+e+", "+i+", "+n+", "+s+")"},Ao=Ne(Ne({},Xs),{transform:function(t){return Math.round(Nm(t))}});function gl(t,e){return t.startsWith(e)&&lh.test(t)}var qr={test:function(t){return typeof t=="string"?gl(t,"rgb"):oa(t)},parse:ch(["red","green","blue","alpha"]),transform:function(t){var e=t.red,i=t.green,n=t.blue,r=t.alpha,s=r===void 0?1:r;return Pm({red:Ao.transform(e),green:Ao.transform(i),blue:Ao.transform(n),alpha:Kr(jn.transform(s))})}},To={test:function(t){return typeof t=="string"?gl(t,"hsl"):aa(t)},parse:ch(["hue","saturation","lightness","alpha"]),transform:function(t){var e=t.hue,i=t.saturation,n=t.lightness,r=t.alpha,s=r===void 0?1:r;return Bm({hue:Math.round(e),saturation:Rn.transform(Kr(i)),lightness:Rn.transform(Kr(n)),alpha:Kr(jn.transform(s))})}},Yc=Ne(Ne({},qr),{test:function(t){return typeof t=="string"&&gl(t,"#")},parse:function(t){var e="",i="",n="";return t.length>4?(e=t.substr(1,2),i=t.substr(3,2),n=t.substr(5,2)):(e=t.substr(1,1),i=t.substr(2,1),n=t.substr(3,1),e+=e,i+=i,n+=n),{red:parseInt(e,16),green:parseInt(i,16),blue:parseInt(n,16),alpha:1}}}),lt={test:function(t){return typeof t=="string"&&lh.test(t)||oa(t)||aa(t)},parse:function(t){return qr.test(t)?qr.parse(t):To.test(t)?To.parse(t):Yc.test(t)?Yc.parse(t):t},transform:function(t){return oa(t)?qr.transform(t):aa(t)?To.transform(t):t}},ml=function(t){var e=t.onRead,i=t.onRender,n=t.uncachedValues,r=n===void 0?new Set:n,s=t.useCache,o=s===void 0?!0:s;return function(a){a===void 0&&(a={});var c=hl(a,[]),l={},u=[],d=!1;function f(w,x){w.startsWith("--")&&(c.hasCSSVariable=!0);var h=l[w];l[w]=x,l[w]!==h&&(u.indexOf(w)===-1&&u.push(w),d||(d=!0,bm.render(v.render)))}var v={get:function(w,x){x===void 0&&(x=!1);var h=!x&&o&&!r.has(w)&&l[w]!==void 0;return h?l[w]:e(w,c)},set:function(w,x){if(typeof w=="string")f(w,x);else for(var h in w)f(h,w[h]);return this},render:function(w){return w===void 0&&(w=!1),(d||w===!0)&&(i(l,c,u),d=!1,u.length=0),this}};return v}},zm=/([a-z])([A-Z])/g,Dm="$1-$2",Js=function(t){return t.replace(zm,Dm).toLowerCase()},uh=new Map,vl=new Map,dh=["Webkit","Moz","O","ms",""],Lm=dh.length,jm=typeof document!="undefined",Eo,hh=function(t,e){return vl.set(t,Js(e))},Rm=function(t){Eo=Eo||document.createElement("div");for(var e=0;e<Lm;e++){var i=dh[e],n=i==="",r=n?t:i+t.charAt(0).toUpperCase()+t.slice(1);if(r in Eo.style||n){if(n&&t==="clipPath"&&vl.has(t))return;uh.set(t,r),hh(t,(n?"":"-")+Js(r))}}},_m=function(t){return hh(t,t)},ph=function(t,e){e===void 0&&(e=!1);var i=e?vl:uh;return i.has(t)||(jm?Rm(t):_m(t)),i.get(t)||t},Vm=["","X","Y","Z"],Om=["translate","scale","rotate","skew","transformPerspective"],la=Om.reduce(function(t,e){return Vm.reduce(function(i,n){return i.push(e+n),i},t)},["x","y","z"]),$m=la.reduce(function(t,e){return t[e]=!0,t},{});function wl(t){return $m[t]===!0}function Wm(t,e){return la.indexOf(t)-la.indexOf(e)}var Um=new Set(["originX","originY","originZ"]);function Hm(t){return Um.has(t)}var Xc=Ne(Ne({},Xs),{transform:Math.round}),Fm={color:lt,backgroundColor:lt,outlineColor:lt,fill:lt,stroke:lt,borderColor:lt,borderTopColor:lt,borderRightColor:lt,borderBottomColor:lt,borderLeftColor:lt,borderWidth:F,borderTopWidth:F,borderRightWidth:F,borderBottomWidth:F,borderLeftWidth:F,borderRadius:F,radius:F,borderTopLeftRadius:F,borderTopRightRadius:F,borderBottomRightRadius:F,borderBottomLeftRadius:F,width:F,maxWidth:F,height:F,maxHeight:F,size:F,top:F,right:F,bottom:F,left:F,padding:F,paddingTop:F,paddingRight:F,paddingBottom:F,paddingLeft:F,margin:F,marginTop:F,marginRight:F,marginBottom:F,marginLeft:F,rotate:ni,rotateX:ni,rotateY:ni,rotateZ:ni,scale:Pr,scaleX:Pr,scaleY:Pr,scaleZ:Pr,skew:ni,skewX:ni,skewY:ni,distance:F,translateX:F,translateY:F,translateZ:F,x:F,y:F,z:F,perspective:F,opacity:jn,originX:Gc,originY:Gc,originZ:F,zIndex:Xc,fillOpacity:jn,strokeOpacity:jn,numOctaves:Xc},yl=function(t){return Fm[t]},Zm=function(t,e){return e&&typeof t=="number"?e.transform(t):t},_n="scrollLeft",Vn="scrollTop",fh=new Set([_n,Vn]),Qm=new Set([_n,Vn,"transform"]),Gm={x:"translateX",y:"translateY",z:"translateZ"};function gh(t){return typeof t=="function"}function Ym(t,e,i,n,r,s){s===void 0&&(s=!0);var o="",a=!1;i.sort(Wm);for(var c=i.length,l=0;l<c;l++){var u=i[l];o+=(Gm[u]||u)+"("+e[u]+") ",a=u==="z"?!0:a}return!a&&r?o+="translateZ(0)":o=o.trim(),gh(t.transform)?o=t.transform(e,n?"":o):s&&n&&(o="none"),o}function Xm(t,e,i,n,r,s,o,a){e===void 0&&(e=!0),i===void 0&&(i={}),n===void 0&&(n={}),r===void 0&&(r={}),s===void 0&&(s=[]),o===void 0&&(o=!1),a===void 0&&(a=!0);var c=!0,l=!1,u=!1;for(var d in t){var f=t[d],v=yl(d),w=Zm(f,v);wl(d)?(l=!0,n[d]=w,s.push(d),c&&(v.default&&f!==v.default||!v.default&&f!==0)&&(c=!1)):Hm(d)?(r[d]=w,u=!0):(!Qm.has(d)||!gh(w))&&(i[ph(d,o)]=w)}return(l||typeof t.transform=="function")&&(i.transform=Ym(t,n,s,c,e,a)),u&&(i.transformOrigin=(r.originX||"50%")+" "+(r.originY||"50%")+" "+(r.originZ||0)),i}function xl(t){var e=t===void 0?{}:t,i=e.enableHardwareAcceleration,n=i===void 0?!0:i,r=e.isDashCase,s=r===void 0?!0:r,o=e.allowTransformNone,a=o===void 0?!0:o,c={},l={},u={},d=[];return function(f){return d.length=0,Xm(f,n,c,l,u,d,s,a),c}}function Jm(t,e){var i=e.element,n=e.preparseOutput,r=yl(t);if(wl(t))return r&&r.default||0;if(fh.has(t))return i[t];var s=window.getComputedStyle(i,null).getPropertyValue(ph(t,!0))||0;return n&&r&&r.test(s)&&r.parse?r.parse(s):s}function Km(t,e,i){var n=e.element,r=e.buildStyles,s=e.hasCSSVariable;if(Object.assign(n.style,r(t)),s)for(var o=i.length,a=0;a<o;a++){var c=i[a];c.startsWith("--")&&n.style.setProperty(c,t[c])}i.indexOf(_n)!==-1&&(n[_n]=t[_n]),i.indexOf(Vn)!==-1&&(n[Vn]=t[Vn])}var qm=ml({onRead:Jm,onRender:Km,uncachedValues:fh});function ev(t,e){e===void 0&&(e={});var i=e.enableHardwareAcceleration,n=e.allowTransformNone,r=hl(e,["enableHardwareAcceleration","allowTransformNone"]);return qm(Ne({element:t,buildStyles:xl({enableHardwareAcceleration:i,allowTransformNone:n}),preparseOutput:!0},r))}var mh=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues"]),Jc=.5,vh=function(){return{style:{}}},No=function(t,e){return F.transform(t*e)},tv={x:0,y:0,width:0,height:0};function Kc(t,e,i){return typeof t=="string"?t:F.transform(e+i*t)}function iv(t,e,i){return Kc(e,t.x,t.width)+" "+Kc(i,t.y,t.height)}var wh={enableHardwareAcceleration:!1,isDashCase:!1};function nv(t,e,i,n,r,s){e===void 0&&(e=tv),n===void 0&&(n=xl(wh)),r===void 0&&(r=vh()),s===void 0&&(s=!0);var o=t.attrX,a=t.attrY,c=t.originX,l=t.originY,u=t.pathLength,d=t.pathSpacing,f=d===void 0?1:d,v=t.pathOffset,w=v===void 0?0:v,x=hl(t,["attrX","attrY","originX","originY","pathLength","pathSpacing","pathOffset"]),h=n(x);for(var p in h)if(p==="transform")r.style.transform=h[p];else{var g=s&&!mh.has(p)?Js(p):p;r[g]=h[p]}return(c!==void 0||l!==void 0||h.transform)&&(r.style.transformOrigin=iv(e,c!==void 0?c:Jc,l!==void 0?l:Jc)),o!==void 0&&(r.x=o),a!==void 0&&(r.y=a),i!==void 0&&u!==void 0&&(r[s?"stroke-dashoffset":"strokeDashoffset"]=No(-w,i),r[s?"stroke-dasharray":"strokeDasharray"]=No(u,i)+" "+No(f,i)),r}function rv(t,e,i){i===void 0&&(i=!0);var n=vh(),r=xl(wh);return function(s){return nv(s,t,e,r,n,i)}}var sv=function(t){return typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()},ov=function(t){try{return sv(t)}catch{return{x:0,y:0,width:0,height:0}}},av=function(t){return t.tagName==="path"},lv=ml({onRead:function(t,e){var i=e.element;if(t=mh.has(t)?t:Js(t),wl(t)){var n=yl(t);return n&&n.default||0}else return i.getAttribute(t)},onRender:function(t,e){var i=e.element,n=e.buildAttrs,r=n(t);for(var s in r)s==="style"?Object.assign(i.style,r.style):i.setAttribute(s,r[s])}}),cv=function(t){var e=ov(t),i=av(t)&&t.getTotalLength?t.getTotalLength():void 0;return lv({element:t,buildAttrs:rv(e,i)})},uv=ml({useCache:!1,onRead:function(t){return t==="scrollTop"?window.pageYOffset:window.pageXOffset},onRender:function(t){var e=t.scrollTop,i=e===void 0?0:e,n=t.scrollLeft,r=n===void 0?0:n;return window.scrollTo(r,i)}}),ca=new WeakMap,dv=function(t){return t instanceof HTMLElement||typeof t.click=="function"},hv=function(t){return t instanceof SVGElement||"ownerSVGElement"in t},pv=function(t,e){var i;return t===window?i=uv(t):dv(t)?i=ev(t,e):hv(t)&&(i=cv(t)),ca.set(t,i),i},fv=function(t,e){return ca.has(t)?ca.get(t):pv(t,e)};function gv(t,e){var i=typeof t=="string"?document.querySelector(t):t;return fv(i,e)}var ut=function(e,i,n,r){var s=n?n.call(r,e,i):void 0;if(s!==void 0)return!!s;if(e===i)return!0;if(typeof e!="object"||!e||typeof i!="object"||!i)return!1;var o=Object.keys(e),a=Object.keys(i);if(o.length!==a.length)return!1;for(var c=Object.prototype.hasOwnProperty.bind(i),l=0;l<o.length;l++){var u=o[l];if(!c(u))return!1;var d=e[u],f=i[u];if(s=n?n.call(r,d,f,u):void 0,s===!1||s===void 0&&d!==f)return!1}return!0};const yh="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",mv=yh.length,qc=Array(20),ji=()=>{for(let t=0;t<20;t++)qc[t]=yh.charAt(Math.random()*mv);return qc.join("")};class qn{constructor(){this.disposers=new Map}add(e,i=ji()){return this.flush(i),this.disposers.set(i,e()),i}addDisposer(e,i=ji()){return this.flush(i),this.disposers.set(i,e),i}addEventListener(e,i,n,r,s=ji()){return this.add(()=>(e.addEventListener(i,n,r),()=>e.removeEventListener(i,n,r)),s),s}setTimeout(e,i,n=ji()){return this.add(()=>{const r=window.setTimeout(()=>{this.remove(n),e()},i);return()=>window.clearTimeout(r)},n)}setInterval(e,i,n=ji()){return this.add(()=>{const r=window.setInterval(e,i);return()=>window.clearInterval(r)},n)}remove(e){const i=this.disposers.get(e);return this.disposers.delete(e),i}flush(e){const i=this.remove(e);if(i)try{i()}catch(n){console.error(n)}}flushAll(){this.disposers.forEach(e=>{try{e()}catch(i){console.error(i)}}),this.disposers.clear()}}var vv=Object.defineProperty,ko=(typeof require!="undefined"&&require,(t,e,i)=>(((n,r,s)=>{r in n?vv(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s})(t,typeof e!="symbol"?e+"":e,i),i));class pr{constructor(e,i){ko(this,"_value"),ko(this,"_beforeDestroys"),ko(this,"_subscribers"),this._value=e,i&&(this.compare=i)}get value(){return this._value}setValue(e,i){if(!this.compare(e,this._value)){const n=this._value;this._value=e,this._subscribers&&this._subscribers.forEach(r=>r(e,n,i))}}reaction(e){return this._subscribers||(this._subscribers=new Set),this._subscribers.add(e),()=>{this._subscribers&&this._subscribers.delete(e)}}subscribe(e,i){const n=this.reaction(e);return e(this._value,void 0,i),n}derive(e,i,n){const r=new pr(e(this.value,void 0,n),i),s=this.reaction((o,a,c)=>{r.setValue(e(o,a,c))});return r.addBeforeDestroy(s),r}destroy(){this._beforeDestroys&&(this._beforeDestroys.forEach(e=>e()),this._beforeDestroys.clear()),this._subscribers&&this._subscribers.clear()}addBeforeDestroy(e){return this._beforeDestroys||(this._beforeDestroys=new Set),this._beforeDestroys.add(e),()=>{this._beforeDestroys&&this._beforeDestroys.delete(e)}}compare(e,i){return e===i}}function wv(t,e,i,n){let r=t.map(o=>o.value);const s=new pr(e(r,void 0,n),i);return t.forEach((o,a)=>{const c=o.reaction((l,u,d)=>{const f=r.slice();f[a]=l;const v=r;r=f,s.setValue(e(f,v,d),d)});s.addBeforeDestroy(c)}),s}function xh(t,e){Object.keys(e).forEach(i=>{yv(t,i,e[i])})}function yv(t,e,i){var n;return Object.defineProperties(t,{[e]:{get:()=>i.value},[`_${e}$`]:{value:i},[`set${n=e,n[0].toUpperCase()+n.slice(1)}`]:{value:(r,s)=>i.setValue(r,s)}}),t}function Ml(t){const e=i=>{const n=t.addDisposer(()=>{i.destroy()});return i.addBeforeDestroy(()=>{t.remove(n)}),i};return{bindSideEffect:e,combine:(i,n,r,s)=>e(wv(i,n,r,s)),createVal:(i,n)=>e(new pr(i,n))}}var Sl=(t=>(t.Light="light",t.Dark="dark",t.Auto="auto",t))(Sl||{}),D=(t=>(t.Normal="normal",t.Minimized="minimized",t.Maximized="maximized",t))(D||{}),ge=(t=>(t.DarkMode="dark_mode",t.PrefersColorScheme="prefers_color_scheme",t.Close="close",t.Focus="focus",t.Blur="blur",t.Move="move",t.Resize="resize",t.IntrinsicMove="intrinsic_move",t.IntrinsicResize="intrinsic_resize",t.VisualResize="visual_resize",t.ZIndex="z_index",t.State="state",t.Minimized="minimized",t.Maximized="maximized",t.Readonly="readonly",t.Destroyed="destroyed",t))(ge||{}),De=(t=>(t.Close="close",t.Maximize="maximize",t.Minimize="minimize",t))(De||{}),dt=(t=>(t.North="n",t.South="s",t.West="w",t.East="e",t.NorthWest="nw",t.NorthEast="ne",t.SouthEast="se",t.SouthWest="sw",t))(dt||{});const Po="dh";function Be(t,e,i){return Math.min(Math.max(t,e),i)}function Qi(t){t.stopPropagation(),t.cancelable&&t.preventDefault()}let xv=1;function Mv(){return`New Box ${xv++}`}function Sv(t){return Boolean(t)}function Br(t){return!t}const ms=()=>typeof navigator!="undefined"&&typeof window!="undefined"&&/iPad|iPhone|iPod/.test(window.navigator.userAgent),vs=()=>typeof navigator!="undefined"&&/Android/.test(window.navigator.userAgent);function eu(t){return t.touches?t.touches[0]:t}function Iv(){return Date.now().toString().slice(6)+Math.random().toString().slice(2,8)}class Mh{constructor({readonly:e=!1,title:i,buttons:n,onEvent:r,onDragStart:s,namespace:o="telebox",state:a=D.Normal,appReadonly:c=!1}={}){this.$btns=[],this.sideEffect=new qn,this.lastTitleBarClick={timestamp:0,clientX:-100,clientY:-100},this.handleTitleBarClick=l=>{var u;if(this.readonly||l.button!==0||(u=l.target.dataset)!=null&&u.teleTitleBarNoDblClick)return;Qi(l);const d=Date.now();d-this.lastTitleBarClick.timestamp<=500?Math.abs(l.clientX-this.lastTitleBarClick.clientX)<=5&&Math.abs(l.clientY-this.lastTitleBarClick.clientY)<=5&&this.onEvent&&this.onEvent({type:De.Maximize}):this.onDragStart&&this.onDragStart(l),this.lastTitleBarClick.timestamp=d,this.lastTitleBarClick.clientX=l.clientX,this.lastTitleBarClick.clientY=l.clientY},this.lastTitleBarTouch={timestamp:0,clientX:-100,clientY:-100},this.handleTitleBarTouch=l=>{var u;if(this.readonly||(u=l.target.dataset)!=null&&u.teleTitleBarNoDblClick)return;Qi(l);const d=Date.now(),{clientX:f=this.lastTitleBarTouch.clientX+100,clientY:v=this.lastTitleBarTouch.clientY+100}=l.touches[0]||{};d-this.lastTitleBarTouch.timestamp<=500?Math.abs(f-this.lastTitleBarTouch.clientX)<=10&&Math.abs(v-this.lastTitleBarTouch.clientY)<=10&&this.onEvent&&this.onEvent({type:De.Maximize}):this.onDragStart&&this.onDragStart(l),this.lastTitleBarTouch.timestamp=d,this.lastTitleBarTouch.clientX=f,this.lastTitleBarTouch.clientY=v},this.readonly=e,this.onEvent=r,this.onDragStart=s,this.namespace=o,this.title=i,this.state=a,this.appReadonly=c,this.buttons=n||[{type:De.Minimize,iconClassName:this.wrapClassName("titlebar-icon-minimize")},{type:De.Maximize,iconClassName:this.wrapClassName("titlebar-icon-maximize"),isActive:l=>l===D.Maximized},{type:De.Close,iconClassName:this.wrapClassName("titlebar-icon-close")}],this.$dragArea=this.renderDragArea()}setTitle(e){this.title=e,this.$title&&(this.$title.textContent=e,this.$title.title=e)}setState(e){this.state!==e&&(this.state=e,this.buttons.forEach((i,n)=>{i.isActive&&this.$btns[n].classList.toggle("is-active",i.isActive(e))}))}setReadonly(e){var i;this.readonly!==e&&(this.readonly=e,(i=this.$buttonsContainer)==null||i.classList.toggle(this.wrapClassName("titlebar-btns-disable"),Boolean(vs()||ms()||this.readonly)))}render(){if(!this.$titleBar){this.$titleBar=document.createElement("div"),this.$titleBar.className=this.wrapClassName("titlebar");const e=document.createElement("div");e.className=this.wrapClassName("title-area"),e.dataset.teleBoxHandle=Po,this.$title=document.createElement("h1"),this.$title.className=this.wrapClassName("title"),this.$title.dataset.teleBoxHandle=Po,this.title&&(this.$title.textContent=this.title,this.$title.title=this.title),e.appendChild(this.$title),e.appendChild(this.$dragArea);const i=document.createElement("div");i.className=this.wrapClassName("titlebar-btns"),i.classList.toggle(this.wrapClassName("titlebar-btns-disable"),vs()||ms()||this.readonly),this.buttons.forEach(({iconClassName:n,isActive:r},s)=>{const o=String(s),a=document.createElement("button");a.className=`${this.wrapClassName("titlebar-btn")} ${n}`,a.dataset.teleTitleBarBtnIndex=o,a.dataset.teleTitleBarNoDblClick="true",r&&a.classList.toggle("is-active",r(this.state)),this.$btns.push(a),i.appendChild(a)}),this.sideEffect.addEventListener(i,"click",n=>{var r;if(this.readonly)return;const s=n.target,o=Number((r=s.dataset)==null?void 0:r.teleTitleBarBtnIndex);if(!Number.isNaN(o)&&o<this.buttons.length){Qi(n);const a=this.buttons[o];this.onEvent&&this.onEvent({type:a.type,value:a.value})}}),this.$buttonsContainer=i,this.$titleBar.appendChild(e),this.$titleBar.appendChild(i)}return this.$titleBar}renderDragArea(){const e=document.createElement("div");return e.className=this.wrapClassName("drag-area"),e.dataset.teleBoxHandle=Po,this.sideEffect.addEventListener(e,"mousedown",this.handleTitleBarClick),this.sideEffect.addEventListener(e,"touchstart",this.handleTitleBarTouch,{passive:!0}),e}dragHandle(){return this.$titleBar}wrapClassName(e){return`${this.namespace}-${e}`}destroy(){this.sideEffect.flushAll(),this.$titleBar&&(this.$titleBar=void 0,this.$title=void 0,this.$btns.length=0,this.onDragStart=void 0,this.onEvent=void 0)}}class Cv{constructor({id:e=Iv(),title:i=Mv(),prefersColorScheme:n=Sl.Light,darkMode:r,visible:s=!0,width:o=.5,height:a=.5,minWidth:c=0,minHeight:l=0,x:u=.1,y:d=.1,minimized:f=!1,maximized:v=!1,readonly:w=!1,resizable:x=!0,draggable:h=!0,fence:p=!0,fixRatio:g=!1,focus:m=!1,zIndex:y=100,namespace:M="telebox",titleBar:E,content:z,footer:P,styles:L,containerRect:S={x:0,y:0,width:window.innerWidth,height:window.innerHeight},collectorRect:N,fixed:I=!1,addObserver:U,appReadonly:Q,hasHeader:O=!0}={}){this.hasHeader=!0,this._renderSideEffect=new qn,this.handleTrackStart=k=>{var K;return(K=this._handleTrackStart)==null?void 0:K.call(this,k)},this.hasHeader=O,this._sideEffect=new qn,this._valSideEffectBinder=Ml(this._sideEffect);const{combine:q,createVal:W}=this._valSideEffectBinder;this.addObserver=U||Bo,this.appReadonly=Q,this.id=e,this.namespace=M,this.events=new gs,this._delegateEvents=new gs,this.scale=W(1),this.fixed=I;const we=W(n);we.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit PrefersColorScheme Event",{boxId:this.id,prefersColorScheme:k}),this.events.emit(ge.PrefersColorScheme,k))});const Ae=W(Boolean(r));r==null&&we.subscribe((k,K,H)=>{this._sideEffect.add(()=>{if(k==="auto"){const pe=window.matchMedia("(prefers-color-scheme: dark)");if(pe){Ae.setValue(pe.matches,H);const Nr=kr=>{Ae.setValue(kr.matches,H)};return pe.addListener(Nr),()=>pe.removeListener(Nr)}else return Bo}else return Ae.setValue(k==="dark",H),Bo},"prefers-color-scheme")}),Ae.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit DarkMode Event",{boxId:this.id,darkMode:k}),this.events.emit(ge.DarkMode,k))});const xt=W(S,ut),Mt=W(N,ut),ki=W(i);ki.reaction((k,K,H)=>{H||this.titleBar.setTitle(k)});const vn=W(s);vn.reaction((k,K,H)=>{!H&&!k&&(console.log("[TeleBox] Emit Close Event",{boxId:this.id}),this.events.emit(ge.Close))});const A=W(w);A.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit Readonly Event",{boxId:this.id,readonly:k}),this.events.emit(ge.Readonly,k))});const _=W(x),Y=W(h),oe=W(p),ce=W(g),ot=W(y);ot.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit ZIndex Event",{boxId:this.id,zIndex:k}),this.events.emit(ge.ZIndex,k))});const at=W(m);at.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit Focus/Blur Event",{boxId:this.id,focus:k,event:k?"Focus":"Blur"}),this.events.emit(k?ge.Focus:ge.Blur))});const Ge=W(f);Ge.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit Minimized Event",{boxId:this.id,minimized:k}),this.events.emit(ge.Minimized,k))});const Oe=W(v);Oe.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit Maximized Event",{boxId:this.id,maximized:k}),this.events.emit(ge.Maximized,k))});const jc=q([Ge,Oe],([k,K])=>(console.log("state reaction",k,K),k?D.Minimized:K?D.Maximized:D.Normal));jc.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit State Event",{boxId:this.id,state:k}),this.events.emit(ge.State,k))});const Tr=W({width:Be(c,0,1),height:Be(l,0,1)},ut),wn=W({width:Be(o,Tr.value.width,1),height:Be(a,Tr.value.height,1)},ut);Tr.reaction((k,K,H)=>{wn.setValue({width:Be(o,k.width,1),height:Be(a,k.height,1)},H)}),wn.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit IntrinsicResize Event",{boxId:this.id,size:k}),this.events.emit(ge.IntrinsicResize,k))});const yn=q([wn,Oe],([k,K])=>K?{width:1,height:1}:k,ut);yn.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit Resize Event",{boxId:this.id,size:k}),this.events.emit(ge.Resize,k))});const Rc=q([yn,Ge,xt,Mt],([k,K,H,pe])=>K&&pe?{width:pe.width/k.width/H.width,height:pe.height/k.height/H.height}:k,ut);Rc.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit VisualResize Event",{boxId:this.id,size:k}),this.events.emit(ge.VisualResize,k))});const Mo=W({x:Be(u,0,1),y:Be(d,0,1)},ut);Mo.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit IntrinsicMove Event",{boxId:this.id,coord:k}),this.events.emit(ge.IntrinsicMove,k))});const Er=q([Mo,wn,xt,Mt,Ge,Oe],([k,K,H,pe,Nr,kr])=>Nr&&pe?kr?{x:(pe.x+pe.width/2)/H.width-1/2,y:(pe.y+pe.height/2)/H.height-1/2}:{x:(pe.x+pe.width/2)/H.width-K.width/2,y:(pe.y+pe.height/2)/H.height-K.height/2}:kr?{x:0,y:0}:k,ut);Er.reaction((k,K,H)=>{H||(console.log("[TeleBox] Emit Move Event",{boxId:this.id,coord:k}),this.events.emit(ge.Move,k))}),this.titleBar=E||new Mh({readonly:A.value,appReadonly:this.appReadonly,title:ki.value,namespace:this.namespace,onDragStart:k=>{var K;return(K=this._handleTrackStart)==null?void 0:K.call(this,k)},onEvent:k=>{if(this._delegateEvents.listeners.length>0)console.log("[TeleBox] Emit Delegate Event",{boxId:this.id,eventType:k.type}),this._delegateEvents.emit(k.type);else switch(k.type){case De.Maximize:{console.log("[TeleBox] TeleBox TitleBar Maximize Event",{boxId:this.id,currentMaximized:Oe.value});break}case De.Minimize:{console.log("[TeleBox] TeleBox TitleBar Minimize Event",{boxId:this.id,currentMinimized:Ge.value});break}case De.Close:{console.log("[TeleBox] TeleBox TitleBar Close Event",{boxId:this.id,currentVisible:vn.value});break}default:{console.error("Unsupported titleBar event:",k);break}}}}),A.reaction(k=>{this.titleBar.setReadonly(k)});const Lg=W(z),jg=W(P),Rg=W(L);xh(this,{prefersColorScheme:we,darkMode:Ae,containerRect:xt,collectorRect:Mt,title:ki,visible:vn,readonly:A,resizable:_,draggable:Y,fence:oe,fixRatio:ce,focus:at,zIndex:ot,minimized:Ge,maximized:Oe,$userContent:Lg,$userFooter:jg,$userStyles:Rg}),this._state$=jc,this._minSize$=Tr,this._size$=yn,this._intrinsicSize$=wn,this._visualSize$=Rc,this._coord$=Er,this._intrinsicCoord$=Mo,this.fixRatio&&this.transform(Er.value.x,Er.value.y,yn.value.width,yn.value.height,!0),this.$box=this.render()}get darkMode(){return this._darkMode$.value}get state(){return this._state$.value}setState(e,i=!1){return console.log("setstate",e,i),this}get minWidth(){return this._minSize$.value.width}get minHeight(){return this._minSize$.value.height}setMinWidth(e,i=!1){return this._minSize$.setValue({width:e,height:this.minHeight},i),this}setMinHeight(e,i=!1){return this._minSize$.setValue({width:this.minWidth,height:e},i),this}get intrinsicWidth(){return this._intrinsicSize$.value.width}get intrinsicHeight(){return this._intrinsicSize$.value.height}resize(e,i,n=!1){return this._intrinsicSize$.setValue({width:e,height:i},n),this}get width(){return this._size$.value.width}get height(){return this._size$.value.height}get absoluteWidth(){return this.width*this.containerRect.width}get absoluteHeight(){return this.height*this.containerRect.height}get visualWidth(){return this._visualSize$.value.width}get visualHeight(){return this._visualSize$.value.height}get intrinsicX(){return this._intrinsicCoord$.value.x}get intrinsicY(){return this._intrinsicCoord$.value.y}move(e,i,n=!1){return this.fixed?this:(this._intrinsicCoord$.setValue({x:e,y:i},n),this)}get x(){return this._coord$.value.x}get y(){return this._coord$.value.y}transform(e,i,n,r,s=!1){if(this.fixRatio){const o=this.intrinsicHeight/this.intrinsicWidth*n;i!==this.intrinsicY&&(i-=o-r),r=o}return i<0&&(i=0,r>this.intrinsicHeight&&(r=this.intrinsicHeight)),this.fixed||this._intrinsicCoord$.setValue({x:n>=this.minWidth?e:this.intrinsicX,y:r>=this.minHeight?i:this.intrinsicY},s),this._intrinsicSize$.setValue({width:Be(n,this.minWidth,1),height:Be(r,this.minHeight,1)},s),this}mount(e){return e.appendChild(this.render()),this}unmount(){return this.$box&&this.$box.remove(),this}mountContent(e){return this.set$userContent(e),this}unmountContent(){return this.set$userContent(void 0),this}mountFooter(e){return this.set$userFooter(e),this}unmountFooter(){return this.set$userFooter(void 0),this}getUserStyles(){return this.$userStyles}mountStyles(e){let i;return typeof e=="string"?(i=document.createElement("style"),i.textContent=e):i=e,this.set$userStyles(i),this}unmountStyles(){return this.set$userStyles(void 0),this}setFixed(e){this.fixed=e}render(e){var i;if(e){if(e===this.$box)return this.$box;this.$box=e}else{if(this.$box)return this.$box;this.$box=document.createElement("div")}this._renderSideEffect.flushAll(),this.$box.classList.add(this.wrapClassName("box"));const n=(f,v,w,x=Sv)=>this._renderSideEffect.add(()=>{const h=this.wrapClassName(w);return v.subscribe(p=>{f.classList.toggle(h,x(p))})});n(this.$box,this._readonly$,"readonly"),n(this.$box,this._draggable$,"no-drag",Br),n(this.$box,this._resizable$,"no-resize",Br),n(this.$box,this._focus$,"blur",Br),n(this.$box,this._darkMode$,"color-scheme-dark"),n(this.$box,this._darkMode$,"color-scheme-light",Br),this._renderSideEffect.add(()=>{const f=this.wrapClassName("minimized"),v=this.wrapClassName("maximized"),w="box-maximized-timer";return this._state$.subscribe(x=>{console.log(x===D.Minimized,x),this.$box.classList.toggle(f,x===D.Minimized),x===D.Maximized?(this._renderSideEffect.flush(w),this.$box.classList.toggle(v,!0)):this.$box.classList.toggle(v,!1)})}),this._renderSideEffect.add(()=>this._visible$.subscribe(f=>{f?this.$box.style.removeProperty("display"):this.$box.style.display="none"})),this._renderSideEffect.add(()=>this._zIndex$.subscribe(f=>{this.$box.style.zIndex=String(f)}));const r=gv(this.$box);this.$box.dataset.teleBoxID=this.id,this.$box.style.width=this.absoluteWidth+"px",this.$box.style.height=this.absoluteHeight+"px";const s=this.x*this.containerRect.width+this.containerRect.x,o=this.y*this.containerRect.height+this.containerRect.y;this.$box.style.transform=`translate(${s-10}px,${o-10}px)`,this._valSideEffectBinder.combine([this._coord$,this._size$,this._minimized$,this._containerRect$,this._collectorRect$],([f,v,w,x,h])=>{const p=v.width*x.width,g=v.height*x.height;return{width:p+(w&&h?1:0),height:g+(w&&h?1:0),x:f.x*x.width,y:f.y*x.height,scaleX:1,scaleY:1}},ut).subscribe(f=>{r.set(f)}),r.set({x:s,y:o});const a=document.createElement("div");a.className=this.wrapClassName("box-main"),this.$box.appendChild(a);const c=document.createElement("div");c.className=this.wrapClassName("titlebar-wrap"),c.appendChild(this.titleBar.render()),this.$titleBar=c;const l=document.createElement("div");l.className=this.wrapClassName("content-wrap")+" tele-fancy-scrollbar",l.classList.toggle("hide-scroll",Boolean(ms()||vs()||this.appReadonly));const u=document.createElement("div");u.className=this.wrapClassName("content")+" tele-fancy-scrollbar",this.$content=u,(i=this.id)!=null&&i.includes("Plyr")&&(l.style.background="none",a.style.background="none",u.style.background="none"),this.hasHeader==!1&&(l.style.background="none",c.style.display="none",a.style.background="none",u.style.background="none"),this._renderSideEffect.add(()=>{let f;return this._$userStyles$.subscribe(v=>{f&&f.remove(),f=v,v&&l.appendChild(v)})}),this._renderSideEffect.add(()=>{let f;return this._$userContent$.subscribe(v=>{f&&f.remove(),f=v,v&&u.appendChild(v)})}),l.appendChild(u);const d=document.createElement("div");return d.className=this.wrapClassName("footer-wrap"),this.$footer=d,this._renderSideEffect.add(()=>{let f;return this._$userFooter$.subscribe(v=>{f&&f.remove(),f=v,v&&d.appendChild(v)})}),this._state$.reaction(f=>{d.classList.toggle(this.wrapClassName("footer-hide"),f==D.Maximized)}),a.appendChild(c),a.appendChild(l),a.appendChild(d),this.$contentWrap=l,this.addObserver(l,f=>{const v=f.find(w=>w.target==l);(v==null?void 0:v.target)==l&&(u.style.width=v.contentRect.width*this.scale.value+"px",u.style.height=v.contentRect.height*this.scale.value+"px")}),this.scale.reaction(f=>{u.style.width=l.getBoundingClientRect().width*f+"px",u.style.height=l.getBoundingClientRect().height*f+"px"}),this._renderResizeHandlers(),this.$box}_renderResizeHandlers(){const e=document.createElement("div");e.className=this.wrapClassName("resize-handles"),Object.values(dt).forEach(x=>{const h=document.createElement("div");h.className=this.wrapClassName(x)+" "+this.wrapClassName("resize-handle"),h.dataset.teleBoxHandle=x,e.appendChild(h)}),this.$box.appendChild(e);const i="handle-tracking-listener",n=this.wrapClassName("transforming");let r,s=0,o=0,a=0,c=0,l=0,u=0,d;const f=x=>{if(this.state!==D.Normal)return;Qi(x);let{pageX:h,pageY:p}=eu(x);p<0&&(p=0);const g=(h-l)/this.containerRect.width,m=(p-u)/this.containerRect.height;switch(d){case dt.North:{this.transform(this.x,o+m,this.width,c-m);break}case dt.South:{this.transform(this.x,this.y,this.width,c+m);break}case dt.West:{this.transform(s+g,this.y,a-g,this.height);break}case dt.East:{this.transform(this.x,this.y,a+g,this.height);break}case dt.NorthWest:{this.transform(s+g,o+m,a-g,c-m);break}case dt.NorthEast:{this.transform(this.x,o+m,a+g,c-m);break}case dt.SouthEast:{this.transform(this.x,this.y,a+g,c+m);break}case dt.SouthWest:{this.transform(s+g,this.y,a-g,c+m);break}default:{if(this.fence)this.move(Be(s+g,0,1-this.width),Be(o+m,0,1-this.height));else{const y=50/this.containerRect.width,M=40/this.containerRect.height;this.move(Be(s+g,y-this.width,1-y),Be(o+m,0,1-M))}break}}},v=x=>{d=void 0,r&&(Qi(x),this.$box.classList.toggle(n,!1),this._sideEffect.flush(i),r.remove())},w=x=>{var h;if(this.readonly||x.button!=null&&x.button!==0||!this.draggable||d||this.state!==D.Normal)return;const p=x.target;if((h=p.dataset)!=null&&h.teleBoxHandle){Qi(x),s=this.x,o=this.y,a=this.width,c=this.height,{pageX:l,pageY:u}=eu(x),d=p.dataset.teleBoxHandle,r||(r=document.createElement("div"));const g=d?this.wrapClassName(`cursor-${d}`):"";r.className=this.wrapClassName(`track-mask${g?` ${g}`:""}`),this.$box.appendChild(r),this.$box.classList.add(n),this._sideEffect.add(()=>(window.addEventListener("mousemove",f),window.addEventListener("touchmove",f,{passive:!1}),window.addEventListener("mouseup",v),window.addEventListener("touchend",v,{passive:!1}),window.addEventListener("touchcancel",v,{passive:!1}),()=>{window.removeEventListener("mousemove",f),window.removeEventListener("touchmove",f),window.removeEventListener("mouseup",v),window.removeEventListener("touchend",v),window.removeEventListener("touchcancel",v)}),i)}};this._handleTrackStart=w,this._sideEffect.addEventListener(e,"mousedown",w,{},"box-resizeHandles-mousedown"),this._sideEffect.addEventListener(e,"touchstart",w,{passive:!1},"box-resizeHandles-touchstart")}setScaleContent(e){this.scale.setValue(e)}destroy(){this.$box.remove(),console.log("[TeleBox] Emit Destroyed Event",{boxId:this.id}),this.events.emit(ge.Destroyed),this._sideEffect.flushAll(),this._renderSideEffect.flushAll(),this.events.removeAllListeners(),this._delegateEvents.removeAllListeners()}wrapClassName(e){return`${this.namespace}-${e}`}}function Bo(){}var bv="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzFfNDQyNDQpIj4KPGcgZmlsdGVyPSJ1cmwoI2ZpbHRlcjBfZF8xXzQ0MjQ0KSI+CjxwYXRoIGQ9Ik0xNC4wMDAyIDE2LjE5NTNDMTMuODI0NyAxNi4xOTUzIDEzLjY1MjIgMTYuMTQ5MSAxMy41MDAyIDE2LjA2MTVMNC41MDAxNyAxMC44NjQzQzQuMDIxNzggMTAuNTg3OSAzLjg1Nzk2IDkuOTc2MTIgNC4xMzQyOCA5LjQ5NzczQzQuMjIyMDQgOS4zNDU3OSA0LjM0ODIzIDkuMjE5NiA0LjUwMDE3IDkuMTMxODRMMTMuNTAwMiAzLjkzODQ4QzEzLjgwOTggMy43NjA3NCAxNC4xOTA1IDMuNzYwNzQgMTQuNTAwMiAzLjkzODQ4TDIzLjUwMDIgOS4xMzE4NEMyMy45Nzg2IDkuNDA4MTYgMjQuMTQyNCAxMC4wMiAyMy44NjYxIDEwLjQ5ODRDMjMuNzc4MyAxMC42NTAzIDIzLjY1MjEgMTAuNzc2NSAyMy41MDAyIDEwLjg2NDNMMTQuNTAwMiAxNi4wNjE1QzE0LjM0ODEgMTYuMTQ5MSAxNC4xNzU3IDE2LjE5NTMgMTQuMDAwMiAxNi4xOTUzWiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8ZyBmaWx0ZXI9InVybCgjZmlsdGVyMV9kXzFfNDQyNDQpIj4KPHBhdGggZD0iTTIzLjUwMDIgMTMuMTMxOUwyMS41MzYxIDExLjk5ODVMMTQuNTAwMiAxNi4wNjE2QzE0LjE5MDcgMTYuMjQgMTMuODA5NiAxNi4yNCAxMy41MDAyIDE2LjA2MTZMNi40NjQyOCAxMS45OTg1TDQuNTAwMTcgMTMuMTMxOUM0LjAyMTc4IDEzLjQwODIgMy44NTc5NiAxNC4wMiA0LjEzNDI4IDE0LjQ5ODRDNC4yMjIwNCAxNC42NTA0IDQuMzQ4MjMgMTQuNzc2NiA0LjUwMDE3IDE0Ljg2NDNMMTMuNTAwMiAyMC4wNjE2QzEzLjgwOTYgMjAuMjQgMTQuMTkwNyAyMC4yNCAxNC41MDAyIDIwLjA2MTZMMjMuNTAwMiAxNC44NjQzQzIzLjk3ODYgMTQuNTg4IDI0LjE0MjQgMTMuOTc2MiAyMy44NjYxIDEzLjQ5NzhDMjMuNzc4MyAxMy4zNDU5IDIzLjY1MjEgMTMuMjE5NyAyMy41MDAyIDEzLjEzMTlaIiBmaWxsPSJ3aGl0ZSIgZmlsbC1vcGFjaXR5PSIwLjgiIHNoYXBlLXJlbmRlcmluZz0iY3Jpc3BFZGdlcyIvPgo8L2c+CjxnIGZpbHRlcj0idXJsKCNmaWx0ZXIyX2RfMV80NDI0NCkiPgo8cGF0aCBkPSJNMjMuNTAwMiAxNy4xMzE5TDIxLjUzNjEgMTUuOTk4NUwxNC41MDAyIDIwLjA2MTZDMTQuMTkwNyAyMC4yNCAxMy44MDk2IDIwLjI0IDEzLjUwMDIgMjAuMDYxNkw2LjQ2NDI4IDE1Ljk5ODVMNC41MDAxNyAxNy4xMzE5QzQuMDIxNzggMTcuNDA4MiAzLjg1Nzk2IDE4LjAyIDQuMTM0MjggMTguNDk4NEM0LjIyMjA0IDE4LjY1MDQgNC4zNDgyMyAxOC43NzY2IDQuNTAwMTcgMTguODY0M0wxMy41MDAyIDI0LjA2MTZDMTMuODA5NiAyNC4yNCAxNC4xOTA3IDI0LjI0IDE0LjUwMDIgMjQuMDYxNkwyMy41MDAyIDE4Ljg2NDNDMjMuOTc4NiAxOC41ODggMjQuMTQyNCAxNy45NzYyIDIzLjg2NjEgMTcuNDk3OEMyMy43NzgzIDE3LjM0NTkgMjMuNjUyMSAxNy4yMTk3IDIzLjUwMDIgMTcuMTMxOVoiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuNiIgc2hhcGUtcmVuZGVyaW5nPSJjcmlzcEVkZ2VzIi8+CjwvZz4KPC9nPgo8ZGVmcz4KPGZpbHRlciBpZD0iZmlsdGVyMF9kXzFfNDQyNDQiIHg9IjMiIHk9IjMuODA1MTgiIHdpZHRoPSIyMiIgaGVpZ2h0PSIxNC4zOTAxIiBmaWx0ZXJVbml0cz0idXNlclNwYWNlT25Vc2UiIGNvbG9yLWludGVycG9sYXRpb24tZmlsdGVycz0ic1JHQiI+CjxmZUZsb29kIGZsb29kLW9wYWNpdHk9IjAiIHJlc3VsdD0iQmFja2dyb3VuZEltYWdlRml4Ii8+CjxmZUNvbG9yTWF0cml4IGluPSJTb3VyY2VBbHBoYSIgdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDEyNyAwIiByZXN1bHQ9ImhhcmRBbHBoYSIvPgo8ZmVPZmZzZXQgZHk9IjEiLz4KPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMC41Ii8+CjxmZUNvbXBvc2l0ZSBpbjI9ImhhcmRBbHBoYSIgb3BlcmF0b3I9Im91dCIvPgo8ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwLjU1Mjk0MSAwIDAgMCAwIDAuNTYwNzg0IDAgMCAwIDAgMC42NTA5OCAwIDAgMCAwLjE1IDAiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbjI9IkJhY2tncm91bmRJbWFnZUZpeCIgcmVzdWx0PSJlZmZlY3QxX2Ryb3BTaGFkb3dfMV80NDI0NCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9ImVmZmVjdDFfZHJvcFNoYWRvd18xXzQ0MjQ0IiByZXN1bHQ9InNoYXBlIi8+CjwvZmlsdGVyPgo8ZmlsdGVyIGlkPSJmaWx0ZXIxX2RfMV80NDI0NCIgeD0iMyIgeT0iMTEuOTk4NSIgd2lkdGg9IjIyIiBoZWlnaHQ9IjEwLjE5NjgiIGZpbHRlclVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzPSJzUkdCIj4KPGZlRmxvb2QgZmxvb2Qtb3BhY2l0eT0iMCIgcmVzdWx0PSJCYWNrZ3JvdW5kSW1hZ2VGaXgiLz4KPGZlQ29sb3JNYXRyaXggaW49IlNvdXJjZUFscGhhIiB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMTI3IDAiIHJlc3VsdD0iaGFyZEFscGhhIi8+CjxmZU9mZnNldCBkeT0iMSIvPgo8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIwLjUiLz4KPGZlQ29tcG9zaXRlIGluMj0iaGFyZEFscGhhIiBvcGVyYXRvcj0ib3V0Ii8+CjxmZUNvbG9yTWF0cml4IHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAuNTUyOTQxIDAgMCAwIDAgMC41NjA3ODQgMCAwIDAgMCAwLjY1MDk4IDAgMCAwIDAuMTUgMCIvPgo8ZmVCbGVuZCBtb2RlPSJub3JtYWwiIGluMj0iQmFja2dyb3VuZEltYWdlRml4IiByZXN1bHQ9ImVmZmVjdDFfZHJvcFNoYWRvd18xXzQ0MjQ0Ii8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW49IlNvdXJjZUdyYXBoaWMiIGluMj0iZWZmZWN0MV9kcm9wU2hhZG93XzFfNDQyNDQiIHJlc3VsdD0ic2hhcGUiLz4KPC9maWx0ZXI+CjxmaWx0ZXIgaWQ9ImZpbHRlcjJfZF8xXzQ0MjQ0IiB4PSIzIiB5PSIxNS45OTg1IiB3aWR0aD0iMjIiIGhlaWdodD0iMTAuMTk2OCIgZmlsdGVyVW5pdHM9InVzZXJTcGFjZU9uVXNlIiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiPgo8ZmVGbG9vZCBmbG9vZC1vcGFjaXR5PSIwIiByZXN1bHQ9IkJhY2tncm91bmRJbWFnZUZpeCIvPgo8ZmVDb2xvck1hdHJpeCBpbj0iU291cmNlQWxwaGEiIHR5cGU9Im1hdHJpeCIgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxMjcgMCIgcmVzdWx0PSJoYXJkQWxwaGEiLz4KPGZlT2Zmc2V0IGR5PSIxIi8+CjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjAuNSIvPgo8ZmVDb21wb3NpdGUgaW4yPSJoYXJkQWxwaGEiIG9wZXJhdG9yPSJvdXQiLz4KPGZlQ29sb3JNYXRyaXggdHlwZT0ibWF0cml4IiB2YWx1ZXM9IjAgMCAwIDAgMC41NTI5NDEgMCAwIDAgMCAwLjU2MDc4NCAwIDAgMCAwIDAuNjUwOTggMCAwIDAgMC4xNSAwIi8+CjxmZUJsZW5kIG1vZGU9Im5vcm1hbCIgaW4yPSJCYWNrZ3JvdW5kSW1hZ2VGaXgiIHJlc3VsdD0iZWZmZWN0MV9kcm9wU2hhZG93XzFfNDQyNDQiLz4KPGZlQmxlbmQgbW9kZT0ibm9ybWFsIiBpbj0iU291cmNlR3JhcGhpYyIgaW4yPSJlZmZlY3QxX2Ryb3BTaGFkb3dfMV80NDI0NCIgcmVzdWx0PSJzaGFwZSIvPgo8L2ZpbHRlcj4KPGNsaXBQYXRoIGlkPSJjbGlwMF8xXzQ0MjQ0Ij4KPHJlY3Qgd2lkdGg9IjI4IiBoZWlnaHQ9IjI4IiBmaWxsPSJ3aGl0ZSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo=";let xn,Mn;function Av(t,e=!1){xn?e?Mn==null||Mn.push(t):xn.push(t):(xn=e?[]:[t],Mn=e?[t]:[],Promise.resolve().then(()=>{const i=xn,n=Mn;xn=void 0,Mn=void 0,n==null||n.forEach(r=>r()),i==null||i.forEach(r=>r())}))}function Tv(t){const e=t.cloneNode(!0);e.style.position="absolute",e.style.top="-99999px",e.style.float="none",e.style.visibility="hidden",e.style.display="block",document.body.appendChild(e);const i=e.getBoundingClientRect();return document.body.removeChild(e),{height:i.height,width:i.width}}class Sh{constructor({visible:e=!0,readonly:i=!1,darkMode:n=!1,namespace:r="telebox",styles:s={},onClick:o,allBoxStatusInfo:a={},boxes:c=[],externalEvents:l,appReadonly:u}={}){this.allBoxStatusInfo={},this.handleCollectorClick=()=>{!this._readonly&&this.onClick&&this.popupVisible$.setValue(!this.popupVisible$.value)},this.externalEvents=l,this._sideEffect=new qn;const{createVal:d}=Ml(this._sideEffect);this._visible=e,this._readonly=i,this._darkMode=n,this.namespace=r,this.styles=s,this.allBoxStatusInfo={...a},this.boxes=c,this.onClick=o,this.appReadonly=u,this.popupVisible$=d(!1),this.popupVisible$.reaction(v=>{var w;(w=this.$titles)==null||w.classList.toggle(this.wrapClassName("collector-hide"),!v),requestAnimationFrame(()=>{requestAnimationFrame(()=>{var x;(x=this.$titles)==null||x.classList.toggle(this.wrapClassName("collector-titles-visible"),v)})})});const f=v=>{var w,x;!this.popupVisible$||(x=(w=v.target.className)==null?void 0:w.includes)!=null&&x.call(w,"collector")||this.popupVisible$.setValue(!1)};this._sideEffect.addEventListener(window,"pointerdown",f,!0)}get visible(){return this._visible}get readonly(){return this._readonly}get darkMode(){return this._darkMode}mount(e){return this.render(e),this.root=e,this}unmount(){return this.$collector&&this.$collector.remove(),this}setVisible(e){var i;return this._visible!==e&&(this._visible=e,this.$collector&&((i=this.wrp$)==null||i.classList.toggle(this.wrapClassName("collector-visible"),e),e?this.renderTitles():this.popupVisible$.setValue(!1))),this}setReadonly(e){return this._readonly!==e&&(this._readonly=e,this.$collector&&this.$collector.classList.toggle(this.wrapClassName("collector-readonly"),e)),this}setDarkMode(e){return this._darkMode!==e&&(this._darkMode=e,this.$collector&&(this.$collector.classList.toggle(this.wrapClassName("color-scheme-dark"),e),this.$collector.classList.toggle(this.wrapClassName("color-scheme-light"),!e))),this}setStyles(e){if(Object.assign(this.styles,e),this.wrp$){const i=this.wrp$;Object.keys(e).forEach(n=>{const r=e[n];r!=null&&(i.style[n]=r)})}return this}setAllBoxStatusInfo(e){console.log("[TeleBox] TeleBoxCollector - setAllBoxStatusInfo",e),this.allBoxStatusInfo={...e},this.updateMinimizedCount(),this.renderTitles()}updateMinimizedCount(){if(this.count$){const e=Object.values(this.allBoxStatusInfo).filter(i=>i===D.Minimized).length;this.count$.textContent=String(e)}}setBoxes(e){this.boxes=e,this.renderTitles()}render(e){if(vs()||ms()){const i=document.createElement("div");return i.className=this.wrapClassName("collector-hide"),i}return this.$collector||(this.$collector=document.createElement("button"),this.$collector.className=this.wrapClassName("collector"),this.$collector.style.backgroundImage=`url('${bv}')`,this.wrp$=document.createElement("div"),this.count$=document.createElement("div"),this.wrp$.className=this.wrapClassName("collector-wrp"),this.count$.className=this.wrapClassName("collector-count"),this.wrp$.appendChild(this.count$),this.wrp$.appendChild(this.$collector),this.wrp$.addEventListener("click",this.handleCollectorClick),this._visible&&(this.wrp$.classList.toggle(this.wrapClassName("collector-visible")),this.renderTitles()),this._readonly&&this.$collector.classList.add(this.wrapClassName("collector-readonly")),this.$collector.classList.add(this.wrapClassName(this._darkMode?"color-scheme-dark":"color-scheme-light")),this.setStyles(this.styles),e.appendChild(this.wrp$)),this.$collector}renderTitles(){var e,i,n,r;this.$titles||(this.$titles=document.createElement("div"),this.$titles.className=this.wrapClassName("collector-titles"),this.$titles.classList.toggle(this.wrapClassName("collector-hide"),!this.popupVisible$.value)),this._sideEffect.addEventListener(this.$titles,"wheel",l=>{l.deltaX||l.currentTarget.scrollBy({left:l.deltaY>0?250:-250,behavior:"smooth"})},{passive:!1},"min-popup-render-wheel-titles");const s=this.$titles.querySelector(`.${this.wrapClassName("collector-titles-content")}`),o=s!=null?s:document.createElement("div");o.className=this.wrapClassName("collector-titles-content"),s||(this.$titles.appendChild(o),this._sideEffect.addEventListener(o,"click",l=>{var u,d,f,v;const w=l.target;(d=(u=w.dataset)==null?void 0:u.teleBoxID)!=null&&d.length&&((v=this.onClick)==null||v.call(this,(f=w.dataset)==null?void 0:f.teleBoxID))},{},"telebox-collector-titles-content-click")),o.innerHTML="";const a=(e=this.boxes)==null?void 0:e.filter(l=>this.allBoxStatusInfo[l.id]===D.Minimized).map(l=>{const u=document.createElement("button");return u.className=this.wrapClassName("collector-titles-tab"),u.textContent=l.title,u.dataset.teleBoxID=l.id,u.dataset.teleTitleBarNoDblClick="true",o.appendChild(u),l._title$.reaction(d=>u.textContent=d)});this._sideEffect.addDisposer(()=>a==null?void 0:a.forEach(l=>l()),"min-popup-render-tab-titles");const c=(i=this.wrp$)==null?void 0:i.querySelector(`.${this.wrapClassName("collector-titles")}`);return c?(r=this.wrp$)==null||r.replaceChild(this.$titles,c):(n=this.wrp$)==null||n.appendChild(this.$titles),Av(()=>{var l,u;if(!this.$titles||!this.wrp$||!this.root)return;const d=(l=this.wrp$)==null?void 0:l.getBoundingClientRect(),f=(u=this.root)==null?void 0:u.getBoundingClientRect(),v=Tv(this.$titles);d.top-f.top>v.height;const w=-v.height-10;this.$titles.style.top=`${w}px`,this.$titles.style.left="0px"}),this.$titles}destroy(){this.$collector&&(this.$collector.removeEventListener("click",this.handleCollectorClick),this.$collector.remove(),this.$collector=void 0),this.onClick=void 0}wrapClassName(e){return`${this.namespace}-${e}`}}var ee=(t=>(t.Focused="focused",t.Blurred="blurred",t.Created="created",t.Removed="removed",t.State="state",t.AllBoxStatusInfo="all_box_status_info",t.LastLastNotMinimizedBoxsStatus="last_last_not_minimized_boxs_status",t.Move="move",t.Resize="resize",t.IntrinsicMove="intrinsic_move",t.IntrinsicResize="intrinsic_resize",t.VisualResize="visual_resize",t.ZIndex="z_index",t.PrefersColorScheme="prefers_color_scheme",t.DarkMode="dark_mode",t.BoxToMinimized="boxToMinimized",t.BoxToMaximized="boxToMaximized",t.BoxToNormal="boxToNormal",t))(ee||{});class Ev extends Mh{constructor(e){super(e),this.boxes=e.boxes,this.focusedBox=e.focusedBox,this.containerRect=e.containerRect,this.darkMode=e.darkMode,this.allBoxStatusInfo=e.allBoxStatusInfo}focusBox(e){var i,n;if(!(this.focusedBox&&this.focusedBox===e||!(e!=null&&e.hasHeader))){if(console.log("[TeleBox] TitleBar FocusBox Called",e==null?void 0:e.id,(i=this.focusedBox)==null?void 0:i.id,this.state),this.$titles&&(this.state===D.Maximized||this.hasMaximizedBox())){const{children:r}=this.$titles.firstElementChild;for(let s=r.length-1;s>=0;s-=1){const o=r[s],a=(n=o.dataset)==null?void 0:n.teleBoxID;a&&(e&&a===e.id?o.classList.toggle(this.wrapClassName("titles-tab-focus"),!0):this.focusedBox&&a===this.focusedBox.id&&o.classList.toggle(this.wrapClassName("titles-tab-focus"),!1))}}this.focusedBox=e}}hasMaximizedBox(){return Object.entries(this.allBoxStatusInfo||{}).some(([e,i])=>i===D.Maximized)}setContainerRect(e){if(this.containerRect=e,this.$titleBar){const{x:i,y:n,width:r}=e;this.$titleBar.style.transform=`translate(${i}px, ${n}px)`,this.$titleBar.style.width=r+"px"}}setBoxes(e){this.boxes=e,this.$titleBar&&this.$titleBar.classList.toggle(this.wrapClassName("max-titlebar-maximized"),this.state===D.Maximized&&e.length>0),this.updateTitles()}setAllBoxStatusInfo(e){console.log("[TeleBox] MaxTitleBar - setAllBoxStatusInfo",e),this.allBoxStatusInfo=e,this.$titleBar&&this.$titleBar.classList.toggle(this.wrapClassName("max-titlebar-maximized"),this.state===D.Maximized&&this.boxes.length>0),this.updateTitles()}setState(e){super.setState(e),this.$titleBar&&this.$titleBar.classList.toggle(this.wrapClassName("max-titlebar-maximized"),e===D.Maximized&&this.boxes.length>0),this.updateTitles()}setReadonly(e){super.setReadonly(e),this.$titleBar&&this.$titleBar.classList.toggle(this.wrapClassName("readonly"),this.readonly)}setDarkMode(e){e!==this.darkMode&&(this.darkMode=e,this.$titleBar&&(this.$titleBar.classList.toggle(this.wrapClassName("color-scheme-dark"),e),this.$titleBar.classList.toggle(this.wrapClassName("color-scheme-light"),!e)))}setIndexZ(e){this.$titleBar&&(this.$titleBar.style.zIndex=String(e))}render(){const e=super.render(),{x:i,y:n,width:r}=this.containerRect;e.style.transform=`translate(${i}px, ${n}px)`,e.style.width=r+"px",e.classList.add(this.wrapClassName("max-titlebar")),e.classList.toggle(this.wrapClassName("max-titlebar-maximized"),this.state===D.Maximized&&this.boxes.length>0),e.classList.toggle(this.wrapClassName("readonly"),this.readonly),e.classList.add(this.wrapClassName(this.darkMode?"color-scheme-dark":"color-scheme-light"));const s=document.createElement("div");return s.classList.add(this.wrapClassName("titles-area")),e.insertBefore(s,e.firstElementChild),this.updateTitles(),e}destroy(){super.destroy(),this.$titles=void 0,this.boxes.length=0,this.focusedBox=void 0}updateTitles(){var e;const i=Object.entries(this.allBoxStatusInfo).filter(([n,r])=>r===D.Maximized).map(([n,r])=>n);Object.entries(this.allBoxStatusInfo).filter(([n,r])=>r===D.Minimized).map(([n,r])=>n),(e=this.$titleBar)==null||e.classList.toggle(this.wrapClassName("max-titlebar-active"),i.length>0&&this.boxes.length>0),this.$titleBar&&i.length>0&&this.boxes.length>0&&(this.$titleBar.classList.toggle(this.wrapClassName("max-titlebar-single-title"),this.boxes.length===1),this.boxes.length===1?(this.setTitle(this.boxes[0].title),this.boxes[0].hasHeader===!1?this.$titleBar.style.display="none":this.$titleBar.style.display=""):this.$titleBar.replaceChild(this.renderTitles(),this.$titleBar.firstElementChild))}renderTitles(){this.$titles=document.createElement("div"),this.$titles.className=this.wrapClassName("titles"),this.$titles.addEventListener("wheel",o=>{o.currentTarget.scrollBy({left:o.deltaY>0?250:-250,behavior:"smooth"})},{passive:!1});const e=document.createElement("div");e.className=this.wrapClassName("titles-content"),this.$titles.appendChild(e);const i=Object.entries(this.allBoxStatusInfo).filter(([o,a])=>a===D.Maximized).map(([o,a])=>o),n=Object.entries(this.allBoxStatusInfo).filter(([o,a])=>a===D.Minimized).map(([o,a])=>o),r=this.boxes.filter(o=>i.includes(o.id)).filter(o=>!n.includes(o.id)).filter(o=>o.hasHeader),s=this.boxes.filter(o=>i.includes(o.id)).filter(o=>!n.includes(o.id)).filter(o=>!o.hasHeader);return this.$titleBar&&(r.length==0&&s.length>0?this.$titleBar.style.display="none":this.$titleBar.style.display=""),r.forEach(o=>{const a=document.createElement("button");a.className=this.wrapClassName("titles-tab"),a.textContent=o.title,a.dataset.teleBoxID=o.id,a.dataset.teleTitleBarNoDblClick="true",this.focusedBox&&o.id===this.focusedBox.id&&a.classList.add(this.wrapClassName("titles-tab-focus")),e.appendChild(a)}),this.$titles}}function Nv(){let t=new Set;function e(o){return t.add(o),()=>{i(o)}}function i(o){t.delete(o)}function n(...o){t.forEach(a=>{a(...o)})}function r(){return Boolean(t.size)}function s(){t=new Set}return{runCallbacks:n,addCallback:e,removeCallback:i,hasCallbacks:r,removeAll:s}}class kv{constructor({root:e=document.body,prefersColorScheme:i=Sl.Light,fence:n=!0,containerRect:r={x:0,y:0,width:window.innerWidth,height:window.innerHeight},collector:s,namespace:o="telebox",readonly:a=!1,allBoxStatusInfo:c={},lastLastNotMinimizedBoxsStatus:l={},appReadonly:u=!1}={}){this.externalEvents=new gs,this.events=new gs,this.appReadonly=!1,console.log("[TeleBox] Manager Constructor Start",{allBoxStatusInfo:c,readonly:a,appReadonly:u}),this._sideEffect=new qn;const{combine:d,createVal:f}=Ml(this._sideEffect);this.callbackManager=Nv(),this.sizeObserver=new ResizeObserver(this.callbackManager.runCallbacks),this.elementObserverMap=new Map,this.root=e,this.namespace=o,this.appReadonly=u,this.boxes$=f([]),this.lastLastNotMinimizedBoxsStatus$=f(l),this.topBox$=this.boxes$.derive(S=>{if(S.length>0)return S.reduce((I,U)=>I.zIndex>U.zIndex?I:U)});const v=window.matchMedia("(prefers-color-scheme: dark)"),w=f(!1);v&&(w.setValue(v.matches),this._sideEffect.add(()=>{const S=N=>{w.setValue(N.matches)};return v.addListener(S),()=>v.removeListener(S)}));const x=f(i);x.reaction((S,N,I)=>{this.boxes$.value.forEach(U=>U.setPrefersColorScheme(S,I)),I||(console.log("[TeleBox] Emit PrefersColorScheme Event",{prefersColorScheme:S}),this.events.emit(ee.PrefersColorScheme,S))}),this._darkMode$=d([w,x],([S,N])=>N==="auto"?S:N==="dark"),this._darkMode$.reaction((S,N,I)=>{this.boxes$.value.forEach(U=>U.setDarkMode(S,I)),I||(console.log("[TeleBox] Emit DarkMode Event",{darkMode:S}),this.events.emit(ee.DarkMode,S))});const h=f(a);h.reaction((S,N,I)=>{this.boxes$.value.forEach(U=>U.setReadonly(S,I))}),Object.entries(c||{}).filter(([S,N])=>N===D.Minimized).map(([S,N])=>S),Object.entries(c||{}).filter(([S,N])=>N===D.Maximized).map(([S,N])=>S),this.allBoxStatusInfo$=f(c),console.log("[TeleBox] Manager Constructor AllBoxStatusInfo Created",{allBoxStatusInfo:c}),this.allBoxStatusInfo$.reaction((S,N,I)=>{var U,Q,O;console.log("[TeleBox] AllBoxStatusInfo Reaction Triggered",{allBoxStatusInfo:S,skipUpdate:I});const q=this.getMaximizedBoxes(S),W=this.getMinimizedBoxes(S);this.boxes$.value.forEach(Ae=>{const xt=q.includes(Ae.id),Mt=W.includes(Ae.id);Ae.setMaximized(xt,!0),Ae.setMinimized(Mt,!0)}),this.maxTitleBar.setState(q.length>0?D.Maximized:D.Normal),this.maxTitleBar.setAllBoxStatusInfo({...S||{}});const we=W.length>0;console.log("[TeleBox] Collector Visibility Update",{minimized:we,minimizedBoxes:W}),(U=y.value)==null||U.setVisible(we),(Q=this.collector)==null||Q.setAllBoxStatusInfo({...S||{}}),we&&(O=y.value)!=null&&O.$collector&&E.setValue(M()),this.makeBoxTopFromNotMinimized(),I||(console.log("[TeleBox] Emit AllBoxStatusInfo Event",{allBoxStatusInfo:S}),this.events.emit(ee.AllBoxStatusInfo,S))}),this.lastLastNotMinimizedBoxsStatus$.reaction((S,N,I)=>{I||(console.log("[TeleBox] Emit LastLastNotMinimizedBoxsStatus Event",{lastLastNotMinimizedBoxsStatus:S}),this.events.emit(ee.LastLastNotMinimizedBoxsStatus,S))});const p=d([this.allBoxStatusInfo$],([S])=>{const N=this.getMinimizedBoxes(S),I=this.getMaximizedBoxes(S);return N.length?D.Minimized:I.length?D.Maximized:D.Normal});p.reaction((S,N,I)=>{this.maxTitleBar.setState(S),I||(console.log("[TeleBox] Emit State Event",{state:S}),this.events.emit(ee.State,S))});const g=f(n);g.subscribe((S,N,I)=>{this.boxes$.value.forEach(U=>U.setFence(S,I))});const m=f(r,ut);m.reaction((S,N,I)=>{this.boxes$.value.forEach(U=>U.setContainerRect(S,I)),this.maxTitleBar.setContainerRect(S)});const y=f(s===null?null:s||new Sh({visible:this.getMinimizedBoxes().length>0&&!this.readonly,readonly:h.value,namespace:o,allBoxStatusInfo:this.allBoxStatusInfo$.value,boxes:this.boxes$.value,externalEvents:this.externalEvents,appReadonly:this.appReadonly}).mount(e));y.subscribe(S=>{S&&(S.setVisible(this.getMinimizedBoxes().length>0&&!h.value),S.setReadonly(h.value),S.setDarkMode(this._darkMode$.value),this._sideEffect.add(()=>(S.onClick=N=>{if(console.log("[TeleBox] Collector Click Event",{boxId:N,readonly:h.value}),!h.value){const U=(this.lastLastNotMinimizedBoxsStatus$.value||{})[N],Q={...this.allBoxStatusInfo$.value||{}};U&&(Q[N]=U,this.setAllBoxStatusInfo(Q,!1)),this.makeBoxTopFromNotMinimized(this.boxes.find(O=>O.id===N),!1),U===D.Minimized?(console.log("[TeleBox] Emit BoxToMinimized Event",{boxId:N,allBoxStatusInfo:Q}),this.events.emit(ee.BoxToMinimized,{boxId:N,allBoxStatusInfo:Q})):U===D.Maximized?(console.log("[TeleBox] Emit BoxToMaximized Event",{boxId:N,allBoxStatusInfo:Q}),this.events.emit(ee.BoxToMaximized,{boxId:N,allBoxStatusInfo:Q})):U===D.Normal&&(console.log("[TeleBox] Emit BoxToNormal Event",{boxId:N,allBoxStatusInfo:Q}),this.events.emit(ee.BoxToNormal,{boxId:N,allBoxStatusInfo:Q}))}},()=>S.destroy()),"collect-onClick"))}),h.subscribe(S=>{var N,I;(N=y.value)==null||N.setReadonly(S),(I=y.value)==null||I.setVisible(this.getMinimizedBoxes().length>0&&!h.value)}),this._darkMode$.subscribe(S=>{var N;(N=y.value)==null||N.setDarkMode(S)});const M=()=>{var S;if((S=y.value)!=null&&S.$collector){const{x:N,y:I,width:U,height:Q}=y.value.$collector.getBoundingClientRect(),O=this.root.getBoundingClientRect();return{x:N-O.x,y:I-O.y,width:U,height:Q}}},E=f(this.getMinimizedBoxes().length>0?M():void 0);E.subscribe((S,N,I)=>{this.boxes$.value.forEach(U=>{U.setCollectorRect(S,I)})});const z=this.wrapClassName("titlebar-icon-close"),P=S=>{var N;if(h.value)return;const I=S.target;if(!!I.tagName)for(let U=I;U;U=U.parentElement){if(U.classList&&U.classList.contains(z))return;const Q=(N=U.dataset)==null?void 0:N.teleBoxID;if(Q){const O=this.getBox(Q);if(O){this.focusBox(O),this.makeBoxTop(O);return}}}};this._sideEffect.addEventListener(window,"mousedown",P,!0),this._sideEffect.addEventListener(window,"touchstart",P,!0),this.maxTitleBar=new Ev({darkMode:this.darkMode,readonly:h.value,namespace:this.namespace,state:p.value,boxes:this.boxes$.value,containerRect:m.value,allBoxStatusInfo:this.allBoxStatusInfo$.value,onEvent:S=>{var N,I,U,Q;if(!((N=this.topBox)!=null&&N.id))return;const O={...S,boxId:((I=this.maxTitleBar.focusedBox)==null?void 0:I.id)||((U=this.topBox)==null?void 0:U.id),hasFocus:this.focusBox!==void 0&&this.focusBox!==null};switch(S.type){case De.Maximize:{console.log("[TeleBox] TitleBar Options Click To Maximize",O);const q={...this.allBoxStatusInfo$.value||{}};if(O.hasFocus?(q[O.boxId]=D.Maximized===q[O.boxId]?D.Normal:D.Maximized,this.setAllBoxStatusInfo(q,!1)):(Object.keys(q).forEach(W=>{q[W]===D.Maximized&&(q[W]=D.Normal)}),this.setAllBoxStatusInfo(q,!1)),D.Normal===q[O.boxId]){const W=this.boxes.find(we=>we.id===O.boxId);W&&W._zIndex$.setValue(((Q=this.topBox)==null?void 0:Q.zIndex)+1,!1)}console.log("[TeleBox] Emit BoxToMaximized Event",{boxId:O.boxId,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}}),this.events.emit(ee.BoxToMaximized,{boxId:O.boxId,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}});break}case De.Minimize:{if(console.log("[TeleBox] TitleBar Options Click To Minimize",O),O.hasFocus)this.changeBoxToMinimized(O.boxId);else{const q={...this.allBoxStatusInfo$.value||{}};Object.keys(q).forEach(W=>{q[W]===D.Maximized&&(q[W]=D.Normal)}),this.setAllBoxStatusInfo(q,!1)}console.log("[TeleBox] Emit BoxToMinimized Event",{boxId:O.boxId,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}}),this.events.emit(ee.BoxToMinimized,{boxId:O.boxId,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}});break}case ge.Close:{console.log("[TeleBox] TitleBar Options Click To Close",O),this.changeBoxToClose(O.boxId);const q=this.getBox(O.boxId);q&&(console.log("[TeleBox] Emit Removed Event",{boxId:O.boxId,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}}),this.events.emit(ee.Removed,[q]));break}}},appReadonly:this.appReadonly}),h.subscribe(S=>this.maxTitleBar.setReadonly(S)),this._darkMode$.subscribe(S=>{this.maxTitleBar.setDarkMode(S)}),this.boxes$.reaction(S=>{var N;this.maxTitleBar.setBoxes(S),(N=this.collector)==null||N.setBoxes(S)});const L={prefersColorScheme:x,containerRect:m,collector:y,collectorRect:E,readonly:h,fence:g,allBoxStatusInfo:this.allBoxStatusInfo$,lastLastNotMinimizedBoxsStatus:this.lastLastNotMinimizedBoxsStatus$};xh(this,L),this._state$=p,this.root.appendChild(this.maxTitleBar.render())}get boxes(){return this.boxes$.value}get topBox(){return this.topBox$.value}get darkMode(){return this._darkMode$.value}get state(){return this._state$.value}get minimizedCount(){return this.getMinimizedBoxes().length}get maximizedCount(){return this.getMaximizedBoxes().length}setMinimized(e,i=!1){console.log("[TeleBox] SetMinimized Called",{data:e,skipUpdate:i})}setMaximized(e,i=!1){console.log("[TeleBox] SetMaximized Called",{data:e,skipUpdate:i})}cleanAllBoxStatusInfo(e){if(!e||Object.keys(e).length===0)return{};const i=this.boxes$.value.map(r=>r.id),n={...e||{}};return Object.keys(n).forEach(r=>{i.includes(r)||delete n[r]}),n}setAllBoxStatusInfo(e,i=!1){e=e||{},console.log("[TeleBox] SetAllBoxStatusInfo",{oldAllBoxStatusInfo:this.allBoxStatusInfo$.value,newAllBoxStatusInfo:e,skipUpdate:i});const r={...this.cleanAllBoxStatusInfo(e||{})};this.allBoxStatusInfo$.setValue(r)}setLastLastNotMinimizedBoxsStatus(e,i=!1){e=e||{},console.log("[TeleBox] SetLastLastNotMinimizedBoxsStatus",{oldLastLastNotMinimizedBoxsStatus:this.lastLastNotMinimizedBoxsStatus$.value,newLastLastNotMinimizedBoxsStatus:e,skipUpdate:i});const r={...this.cleanAllBoxStatusInfo(e||{})};this.lastLastNotMinimizedBoxsStatus$.setValue(r,i)}getMaximizedBoxes(e=this.allBoxStatusInfo$.value){return e=e||{},!e||Object.keys(e).length===0?[]:Object.entries(e).filter(([i,n])=>n===D.Maximized).map(([i,n])=>i)}getNomalBoxes(e=this.allBoxStatusInfo$.value){return e=e||{},!e||Object.keys(e).length===0?[]:Object.entries(e).filter(([i,n])=>n===D.Normal).map(([i,n])=>i)}getMinimizedBoxes(e=this.allBoxStatusInfo$.value){return e=e||{},!e||Object.keys(e).length===0?[]:Object.entries(e).filter(([i,n])=>n===D.Minimized).map(([i,n])=>i)}setState(e,i=!1){switch(console.log(i),e){case D.Maximized:break;case D.Minimized:break}return this}create(e={},i=!0){var n;const r=e.id||ji(),s=this.getMaximizedBoxes(),o=this.getMinimizedBoxes(),a=s.includes(r),c=o.includes(r);console.log("[TeleBox] Create Box Current State",r,a,c);const l=new Cv({zIndex:this.topBox?this.topBox.zIndex+1:100,...i?this.smartPosition(e):e,darkMode:this.darkMode,prefersColorScheme:this.prefersColorScheme,maximized:a,minimized:c,fence:this.fence,namespace:this.namespace,containerRect:this.containerRect,readonly:this.readonly,collectorRect:this.collectorRect,id:r,appReadonly:this.appReadonly,addObserver:(u,d)=>{const f=this.elementObserverMap.get(r);f?f.push({el:u,cb:d}):this.elementObserverMap.set(r,[{el:u,cb:d}]),this.callbackManager.addCallback(d),this.sizeObserver.observe(u)}});return l.mount(this.root),l.focus&&(this.focusBox(l),i&&this.makeBoxTop(l)),this.boxes$.setValue([...this.boxes,l]),(n=this.allBoxStatusInfo$.value)!=null&&n[l.id]||(console.log("[TeleBox] Create - Setting AllBoxStatusInfo for new box",l),this.setAllBoxStatusInfo({...this.allBoxStatusInfo$.value,[l.id]:D.Normal},this.appReadonly)),l._delegateEvents.on(De.Maximize,()=>{console.log("[TeleBox] TitleBar Maximize From Box Event",{boxId:l.id});const u=this.cleanAllBoxStatusInfo(this.allBoxStatusInfo$.value);Object.entries(u).forEach(([d,f])=>{f!==D.Minimized&&(u[d]=D.Maximized)}),this.setAllBoxStatusInfo(u,!1),console.log("[TeleBox] Emit BoxToNormal Event",{boxId:l.id,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}}),this.events.emit(ee.BoxToNormal,{boxId:l.id,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}})}),l._delegateEvents.on(De.Minimize,()=>{console.log("[TeleBox] TitleBar Minimize From Box Event",{boxId:l.id}),this.changeBoxToMinimized(l.id),console.log("[TeleBox] Emit BoxToMinimized Event",{boxId:l.id,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}}),this.events.emit(ee.BoxToMinimized,{boxId:l.id,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}})}),l._delegateEvents.on(De.Close,()=>{console.log("[TeleBox] TitleBar Close From Box Event",{boxId:l.id}),this.changeBoxToClose(l.id),this.events.emit(ee.Removed,[l]),console.log("[TeleBox] Emit BoxToNormal Event",{boxId:l.id,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}}),this.events.emit(ee.BoxToNormal,{boxId:l.id,allBoxStatusInfo:this.allBoxStatusInfo$.value||{}})}),l._coord$.reaction((u,d,f)=>{f||(console.log("[TeleBox] Emit Move Event",{boxId:l.id}),this.events.emit(ee.Move,l))}),l._size$.reaction((u,d,f)=>{f||(console.log("[TeleBox] Emit Resize Event",{boxId:l.id}),this.events.emit(ee.Resize,l))}),l._intrinsicCoord$.reaction((u,d,f)=>{f||(console.log("[TeleBox] Emit IntrinsicMove Event",{boxId:l.id}),this.events.emit(ee.IntrinsicMove,l))}),l._intrinsicSize$.reaction((u,d,f)=>{f||(console.log("[TeleBox] Emit IntrinsicResize Event",{boxId:l.id}),this.events.emit(ee.IntrinsicResize,l))}),l._visualSize$.reaction((u,d,f)=>{f||(console.log("[TeleBox] Emit VisualResize Event",{boxId:l.id}),this.events.emit(ee.VisualResize,l))}),l._zIndex$.reaction((u,d,f)=>{if(console.log("[TeleBox] Current Box ZIndex ",l.id,l.zIndex," Original ZIndex ",l.zIndex),this.boxes.length>0){const w=this.boxes.reduce((x,h)=>x.zIndex>h.zIndex?x:h);this.topBox$.setValue(w)}f||(console.log("[TeleBox] Emit ZIndex Event",{boxId:l.id,zIndex:l.zIndex}),this.events.emit(ee.ZIndex,l));const v=this.boxes$.value.filter(w=>this.getMaximizedBoxes().includes(w.id)).sort((w,x)=>x.zIndex-w.zIndex);v&&v.length>0&&this.maxTitleBar.setIndexZ(v[0].zIndex+1)}),console.log("[TeleBox] Emit Created Event",{boxId:l.id}),this.events.emit(ee.Created,l),l}changeBoxToMinimized(e){const i={...this.allBoxStatusInfo$.value||{}},n={...this.lastLastNotMinimizedBoxsStatus$.value};n[e]=i[e],i[e]=D.Minimized,this.setAllBoxStatusInfo(i,!1),this.lastLastNotMinimizedBoxsStatus$.setValue(n,!1)}changeBoxToClose(e){var i;(i=this.getBox(e))==null||i._zIndex$.setValue(0,!1),this.remove(e,!1);const n={...this.lastLastNotMinimizedBoxsStatus$.value};delete n[e],this.lastLastNotMinimizedBoxsStatus$.setValue(n,!1)}query(e){return e?this.boxes.filter(this.teleBoxMatcher(e)):[...this.boxes]}queryOne(e){return e?this.boxes.find(this.teleBoxMatcher(e)):this.boxes[0]}update(e,i,n=!1){const r=this.boxes.find(s=>s.id===e);if(r)return this.updateBox(r,i,n)}updateAll(e,i=!1){this.boxes$.value.forEach(n=>{this.updateBox(n,e,i)})}remove(e,i=!1){console.log("[TeleBox] Remove Method Called",{boxOrID:e,skipUpdate:i});const n=this.getBoxIndex(e);if(n>=0){const r=typeof e=="string"?e:e.id,s=this.boxes.slice(),o=s.splice(n,1);if(this.boxes$.setValue(s),o.forEach(a=>a.destroy()),r){const a={...this.allBoxStatusInfo$.value||{}};delete a[r],this.setAllBoxStatusInfo(a,i);const c=this.elementObserverMap.get(r);c&&c.forEach(({el:l,cb:u})=>{this.callbackManager.removeCallback(u),this.sizeObserver.unobserve(l),this.elementObserverMap.delete(r)})}return i||(this.boxes.length<=0&&this.setAllBoxStatusInfo({},i),console.log("[TeleBox] Emit Removed Event",{deletedBoxes:o.map(a=>a.id)}),this.events.emit(ee.Removed,o)),o[0]}}removeTopBox(){if(this.topBox)return this.remove(this.topBox)}removeAll(e=!1){console.log("[TeleBox] RemoveAll Method Called",{skipUpdate:e,boxCount:this.boxes$.value.length});const i=this.boxes$.value;return this.boxes$.setValue([]),i.forEach(n=>n.destroy()),this.sizeObserver.disconnect(),this.elementObserverMap=new Map,this.callbackManager.removeAll(),e||(this.boxes.length<=0&&(console.log("[TeleBox] RemoveAll - No Boxes Left, Clearing Arrays"),this.setAllBoxStatusInfo({})),console.log("[TeleBox] RemoveAll - Emitting Removed Event",i),console.log("[TeleBox] Emit Removed Event",{deletedBoxes:i.map(n=>n.id)}),this.events.emit(ee.Removed,i)),i}destroy(e=!1){this.events.removeAllListeners(),this._sideEffect.flushAll(),this.removeAll(e),this.sizeObserver.disconnect(),this.callbackManager.removeAll(),Object.keys(this).forEach(i=>{const n=this[i];n instanceof pr&&n.destroy()})}wrapClassName(e){return`${this.namespace}-${e}`}focusBox(e,i=!1){console.log("[TeleBox] FocusBox Called",{boxOrID:e,skipUpdate:i});const n=this.getBox(e);n&&(this.boxes$.value.forEach(r=>{if(n===r){let s=!1;n.focus||(s=!0,n.setFocus(!0,i)),s&&!i&&(console.log("[TeleBox] Emit Focused Event",{boxId:n.id}),this.events.emit(ee.Focused,n))}else r.focus&&this.blurBox(r,i)}),this.getMaximizedBoxes().length>0?this.getMaximizedBoxes().includes(n.id)&&(console.log("[TeleBox] FocusBox - MaxTitleBar Focus (Maximized Box)",{targetBoxId:n.id}),this.maxTitleBar.focusBox(n)):(console.log("[TeleBox] FocusBox - MaxTitleBar Focus (No Maximized Boxes)",{targetBoxId:n.id}),this.maxTitleBar.focusBox(n)))}focusTopBox(){var e,i;if(console.log("[TeleBox] FocusTopBox Called",{topBox:(e=this.topBox)==null?void 0:e.id,topBoxFocus:(i=this.topBox)==null?void 0:i.focus}),this.topBox&&!this.topBox.focus)return console.log("[TeleBox] FocusTopBox - Focusing Top Box",{topBox:this.topBox.id}),this.focusBox(this.topBox)}blurBox(e,i=!1){const n=this.getBox(e);n&&(n.focus&&(n.setFocus(!1,i),i||(console.log("[TeleBox] Emit Blurred Event",{boxId:n.id}),this.events.emit(ee.Blurred,n))),this.maxTitleBar.focusedBox===n&&this.maxTitleBar.focusBox())}blurAll(e=!1){this.boxes$.value.forEach(i=>{i.focus&&(i.setFocus(!1,e),e||(console.log("[TeleBox] Emit Blurred Event",{boxId:i.id}),this.events.emit(ee.Blurred,i)))}),this.maxTitleBar.focusedBox&&this.maxTitleBar.focusBox()}setScaleContent(e,i){const n=this.boxes.find(r=>r.id==e);n&&n.setScaleContent(i)}teleBoxMatcher(e){const i=Object.keys(e);return n=>i.every(r=>e[r]===n[r])}updateBox(e,i,n=!1){var r;console.log("[TeleBox] UpdateBox Method Called",{boxId:e.id,config:i,skipUpdate:n}),(i.x!=null||i.y!=null)&&e.move(i.x==null?e.intrinsicX:i.x,i.y==null?e.intrinsicY:i.y,n),(i.width!=null||i.height!=null)&&e.resize(i.width==null?e.intrinsicWidth:i.width,i.height==null?e.intrinsicHeight:i.height,n),i.title!=null&&(e.setTitle(i.title),this.maxTitleBar.updateTitles()),i.visible!=null&&e.setVisible(i.visible,n),i.minHeight!=null&&e.setMinHeight(i.minHeight,n),i.minWidth!=null&&e.setMinWidth(i.minWidth,n),i.resizable!=null&&e.setResizable(i.resizable,n),i.draggable!=null&&e.setDraggable(i.draggable,n),i.fixRatio!=null&&e.setFixRatio(i.fixRatio,n),i.zIndex!=null&&e.setZIndex(i.zIndex,n),i.content!=null&&e.mountContent(i.content),i.footer!=null&&e.mountFooter(i.footer),(r=e.id)!=null&&r.includes("audio")?(console.log("[TeleBox] UpdateBox - Audio Box Special Handling",{boxId:e.id}),e.setMaximized(!0,n),e.setMinimized(!1,n)):(console.log("[TeleBox] UpdateBox - Regular Box Config",i),i.maximized!=null&&(console.log("[TeleBox] UpdateBox - Setting Maximized",{boxId:e.id,maximized:i.maximized,skipUpdate:n}),e.setMaximized(i.maximized,n)),i.minimized!=null&&(console.log("[TeleBox] UpdateBox - Setting Minimized",{boxId:e.id,minimized:i.minimized,skipUpdate:n}),e.setMinimized(i.minimized,n)))}smartPosition(e={}){let{x:i,y:n}=e;const{width:r=.5,height:s=.5}=e;if(i==null){let o=20;this.topBox?(o=this.topBox.intrinsicX*this.containerRect.width+20,o>this.containerRect.width-r*this.containerRect.width&&(o=20)):o=this.containerRect.width*(.5-r/2),i=o/this.containerRect.width}if(n==null){let o=20;this.topBox?(o=this.topBox.intrinsicY*this.containerRect.height+20,o>this.containerRect.height-s*this.containerRect.height&&(o=20)):o=this.containerRect.height*(.5-s/2),n=o/this.containerRect.height}return{...e,x:i,y:n,width:r,height:s}}makeBoxTop(e,i=!1){var n,r;if(console.log("[TeleBox] TopBox Change To",e.id,e.zIndex," Original TopBox ",(n=this.topBox)==null?void 0:n.id,(r=this.topBox)==null?void 0:r.zIndex),this.topBox&&e!==this.topBox){const s=this.getMaximizedBoxes();let a=this.boxes.filter(l=>s.includes(l.id)).reduce((l,u)=>l.zIndex>u.zIndex?l:u).zIndex;const c=this.getNomalBoxes();if(s.includes(e.id)){const l=a;a=a+1,e._zIndex$.setValue(a,i),this.boxes.filter(u=>c.includes(u.id)).forEach(u=>{u._zIndex$.setValue(u.zIndex+(u.zIndex-l)+1,i)})}else a=this.boxes.filter(l=>c.includes(l.id)).reduce((l,u)=>l.zIndex>u.zIndex?l:u).zIndex,e._zIndex$.setValue(a+1,i)}}makeBoxTopFromNotMinimized(e=void 0,i=!1){if(console.log("[TeleBox] MakeBoxTopFromNotMinimized Called",{topFocusBox:e==null?void 0:e.id,skipUpdate:i}),!e){const s=this.allBoxStatusInfo$.value||{},o=Object.entries(s).filter(([c,l])=>l!==D.Minimized).map(([c,l])=>c),a=this.boxes.filter(c=>o.includes(c.id));a.length>0&&(e=a.reduce((c,l)=>c.zIndex>l.zIndex?c:l))}if(!e){console.log("[TeleBox] No topFocusBox found, returning early");return}this.makeBoxTop(e,i);const n=this.allBoxStatusInfo$.value||{};if(n[e.id]===D.Maximized)this.maxTitleBar.focusBox(e);else{const s=this.boxes.filter(o=>n[o.id]===D.Maximized);if(s.length>0){const o=s.reduce((a,c)=>a.zIndex>c.zIndex?a:c);this.maxTitleBar.focusBox(o)}}i||(console.log("[TeleBox] Emit ZIndex Event",{boxId:e.id,zIndex:e.zIndex}),this.events.emit(ee.ZIndex,e));const r=this.boxes$.value.filter(s=>this.getMaximizedBoxes().includes(s.id)).sort((s,o)=>o.zIndex-s.zIndex);r&&r.length>0&&this.maxTitleBar.setIndexZ(r[0].zIndex+1)}makeBoxTopFromMaximized(e){var i;console.log("[TeleBox] MakeBoxTopFromMaximized Called",{boxId:e,currentMaximized:this.getMaximizedBoxes(),currentMinimized:this.getMinimizedBoxes()});let n;if(e)this.getMaximizedBoxes().includes(e)&&!this.getMinimizedBoxes().includes(e)&&(n=this.boxes$.value.find(o=>o.id===e),console.log("[TeleBox] MakeBoxTopFromMaximized - Found Specific Box",{boxId:e,maxIndexBox:n==null?void 0:n.id}));else{const o=this.allBoxStatusInfo$.value||{},a=(i=this.boxes)==null?void 0:i.filter(c=>o[c.id]===D.Maximized);a&&a.length>0&&(n=a.reduce((c,l)=>c.zIndex>l.zIndex?c:l),n&&(console.log("[TeleBox] MakeBoxTopFromMaximized - Focusing Max Index Box",{maxIndexBox:n.id}),this.maxTitleBar.focusBox(n)))}const r=this.boxes$.value.filter(o=>this.getMaximizedBoxes().includes(o.id)).sort((o,a)=>a.zIndex-o.zIndex);r&&r.length>0&&this.maxTitleBar.setIndexZ(r[0].zIndex+1);const s=!!n;return console.log("[TeleBox] MakeBoxTopFromMaximized Result",{result:s,maxIndexBox:n==null?void 0:n.id}),s}getBoxIndex(e){return typeof e=="string"?this.boxes.findIndex(i=>i.id===e):this.boxes.findIndex(i=>i===e)}setMaxTitleFocus(e){this.getBox(e)&&this.maxTitleBar.focusBox(this.getBox(e))}getBox(e){return typeof e=="string"?this.boxes.find(i=>i.id===e):e}}var Wd;const On=(Wd=window.navigator)==null?void 0:Wd.userAgent;On==null||On.match(/(Edge?)\/(\d+)/);const Ks=()=>typeof navigator!="undefined"&&typeof window!="undefined"&&/iPad|iPhone|iPod/.test(On),qs=()=>typeof navigator!="undefined"&&/Android/.test(On),Pv=(t,e,i,n,r)=>new Bv({safeSetAttributes:s=>t.safeSetAttributes(s),getMainView:()=>t.mainView,updateAppState:(...s)=>{var o;return(o=t.appManager)==null?void 0:o.store.updateAppState(...s)},canOperate:()=>t.canOperate,notifyContainerRectUpdate:s=>{var o;return(o=t.appManager)==null?void 0:o.notifyContainerRectUpdate(s)},cleanFocus:()=>{var s;return(s=t.appManager)==null?void 0:s.store.cleanFocus()},setAppFocus:s=>{var o;return(o=t.appManager)==null?void 0:o.store.setAppFocus(s,!0)},callbacks:e,emitter:i,boxEmitter:n,manager:t},r);class Bv{constructor(e,i){this.context=e,this.createTeleBoxManagerConfig=i;const{emitter:n,callbacks:r,boxEmitter:s,manager:o}=e;this.manager=o,this.teleBoxManager=this.setupBoxManager(i),this.teleBoxManager._state$.reaction(a=>{r.emit("boxStateChange",a),n.emit("boxStateChange",a)}),this.teleBoxManager._darkMode$.reaction(a=>{r.emit("darkModeChange",a)}),this.teleBoxManager._prefersColorScheme$.reaction(a=>{r.emit("prefersColorSchemeChange",a)}),this.teleBoxManager.events.on("all_box_status_info",a=>{var u;console.log("[TeleBox] BoxManager - AllBoxStatusInfo Event Received",a);const c=a||{};(u=this.context.manager.appManager)==null||u.store.setAllBoxStatusInfo(c),Object.entries(c).filter(([d,f])=>f===D.Maximized).map(([d,f])=>d);const l=Object.entries(c).filter(([d,f])=>f===D.Minimized).map(([d,f])=>d);r.emit("onAllBoxStatusInfo",c),l.length>0&&setTimeout(()=>{const d=1e-4*(Math.random()>.5?1:-1);this.teleBoxManager.boxes.forEach(f=>{var v;(v=f.id)!=null&&v.toLocaleLowerCase().includes("slide")&&f.resize(f.intrinsicWidth+d,f.intrinsicHeight+d,!0)})},400)}),this.teleBoxManager.events.on("last_last_not_minimized_boxs_status",a=>{var l;console.log("[TeleBox] BoxManager - LastLastNotMinimizedBoxsStatus Event Received",a);const c=a||{};(l=this.context.manager.appManager)==null||l.store.setLastNotMinimizedBoxsStatus(c)}),this.teleBoxManager.events.on("removed",a=>{console.log("[TeleBox] BoxManager - Removed Event Received",a),a.forEach(c=>{s.emit("close",{appId:c.id})})}),this.teleBoxManager.events.on("intrinsic_move",b.debounce(a=>{s.emit("move",{appId:a.id,x:a.intrinsicX,y:a.intrinsicY})},50)),this.teleBoxManager.events.on("intrinsic_resize",b.debounce(a=>{s.emit("resize",{appId:a.id,width:a.intrinsicWidth,height:a.intrinsicHeight})},200)),this.teleBoxManager.events.on("focused",a=>{a&&(this.canOperate?s.emit("focus",{appId:a.id}):this.teleBoxManager.blurBox(a.id))}),this.teleBoxManager.events.on("z_index",a=>{this.context.updateAppState(a.id,ze.ZIndex,a.zIndex),r.emit("appZIndexChange",{appId:a.id,box:a})}),n.on("playgroundSizeChange",()=>this.updateManagerRect()),n.on("updateManagerRect",()=>this.updateManagerRect()),n.on("onScaleChange",({appId:a,scale:c})=>{this.changeScale(a,c)})}get mainView(){return this.context.getMainView()}get canOperate(){return this.context.canOperate()}get boxState(){return this.teleBoxManager.state}get maximized(){var i;const e=(i=this.context.manager.appManager)==null?void 0:i.store.getAllBoxStatusInfo();return e?Object.entries(e).filter(([n,r])=>r===D.Maximized).map(([n,r])=>n):[]}get minimized(){var i;const e=(i=this.context.manager.appManager)==null?void 0:i.store.getAllBoxStatusInfo();return e?Object.entries(e).filter(([n,r])=>r===D.Minimized).map(([n,r])=>n):[]}get darkMode(){return this.teleBoxManager.darkMode}get prefersColorScheme(){return this.teleBoxManager.prefersColorScheme}get boxSize(){return this.teleBoxManager.boxes.length}changeScale(e,i){this.teleBoxManager.setScaleContent(e,i)}createBox(e){var u,d,f,v,w,x,h;if(!this.teleBoxManager)return;let{minwidth:i=Hg,minheight:n=Fg}=(u=e.app.config)!=null?u:{};const{width:r,height:s}=(d=e.app.config)!=null?d:{},o=((f=e.options)==null?void 0:f.title)||e.appId,a=this.teleBoxManager.containerRect;i>1&&(i=i/a.width),n>1&&(n=n/a.height);const c={title:o,minWidth:i,minHeight:n,width:r,height:s,id:e.appId,hasHeader:(v=e.appId)!=null&&v.includes("audio")?!1:(x=(w=e.options)==null?void 0:w.hasHeader)!=null?x:!0},l=this.teleBoxManager.create(c,e.smartPosition);this.context.emitter.emit(`${e.appId}${ne.WindowCreated}`),(h=this.manager.scrollerManager)==null||h.add({appId:e.appId,manager:this.manager,scrollElement:l==null?void 0:l.$contentWrap})}setBoxInitState(e){const i=this.teleBoxManager.queryOne({id:e});i&&i.state===D.Maximized&&this.context.boxEmitter.emit("resize",{appId:e,x:i.x,y:i.y,width:i.intrinsicWidth,height:i.intrinsicHeight})}setupBoxManager(e){const i=X.wrapper?X.wrapper:document.body,n=i.getBoundingClientRect(),r={root:i,containerRect:{x:0,y:0,width:n.width,height:n.height},fence:!1,prefersColorScheme:e==null?void 0:e.prefersColorScheme,appReadonly:X.appReadonly},s=new kv(r);this.teleBoxManager&&this.teleBoxManager.destroy(),this.teleBoxManager=s;const o=(e==null?void 0:e.collectorContainer)||X.wrapper;return o&&this.setCollectorContainer(o),s}setCollectorContainer(e){var n;const i=new Sh({styles:(n=this.createTeleBoxManagerConfig)==null?void 0:n.collectorStyles,readonly:this.teleBoxManager.readonly}).mount(e);this.teleBoxManager.setCollector(i)}getBox(e){return this.teleBoxManager.queryOne({id:e})}closeBox(e,i=!1){var n;return(n=this.manager.scrollerManager)==null||n.remove(e),this.teleBoxManager.remove(e,i)}boxIsFocus(e){const i=this.getBox(e);return i==null?void 0:i.focus}getFocusBox(){return this.teleBoxManager.query({focus:!0})[0]}getTopBox(){return this.teleBoxManager.topBox}updateBoxState(e){if(console.log(e),!e)return;const i=this.getBox(e.id);i&&(this.teleBoxManager.update(i.id,{x:e.x,y:e.y,width:e.width||.5,height:e.height||.5,zIndex:e.zIndex,maximized:e.maximized,minimized:e.minimized},!0),setTimeout(()=>{e.focus&&this.teleBoxManager.focusBox(i.id,!0),e.maximized!=null&&this.teleBoxManager.setMaximized(Boolean(e.maximized),!0),e.minimized!=null&&this.teleBoxManager.setMinimized(Boolean(e.minimized),!0)},50),this.context.callbacks.emit("boxStateChange",this.teleBoxManager.state))}updateManagerRect(){var i;const e=(i=X.wrapper)==null?void 0:i.getBoundingClientRect();if(e&&e.width>0&&e.height>0){const n={x:0,y:0,width:e.width,height:e.height};this.teleBoxManager.setContainerRect(n),this.context.notifyContainerRectUpdate(this.teleBoxManager.containerRect)}}moveBox({appId:e,x:i,y:n}){this.teleBoxManager.update(e,{x:i,y:n},!0)}focusBox({appId:e},i=!0){this.teleBoxManager.focusBox(e,i)}resizeBox({appId:e,width:i,height:n,skipUpdate:r}){this.teleBoxManager.update(e,{width:i,height:n},r)}setBoxMinSize(e){this.teleBoxManager.update(e.appId,{minWidth:e.minWidth,minHeight:e.minHeight},!0)}setBoxTitle(e){this.teleBoxManager.update(e.appId,{title:e.title},!0)}blurAllBox(){this.teleBoxManager.blurAll()}updateAll(e){this.teleBoxManager.updateAll(e)}setMaximized(e,i=!0){e!==this.maximized&&this.teleBoxManager.setMaximized(e,i)}setMinimized(e,i=!0){this.teleBoxManager.setMinimized(e,i)}focusTopBox(){if(this.teleBoxManager.query().length>=1){const i=this.getTopBox();i&&this.focusBox({appId:i.id},!1)}}updateBox(e,i,n=!0){this.teleBoxManager.update(e,i,n)}setReadonly(e){this.teleBoxManager.setReadonly(e||Ks()||qs())}setPrefersColorScheme(e){this.teleBoxManager.setPrefersColorScheme(e)}setZIndex(e,i,n=!0){this.teleBoxManager.update(e,{zIndex:i},n)}destroy(){this.teleBoxManager.destroy()}}var V=(t=>(t.Apps="apps",t.Focus="focus",t.State="state",t.BoxState="boxState",t.MainViewCamera="mainViewCamera",t.MainViewSize="mainViewSize",t.Broadcaster="broadcaster",t.Cursors="cursors",t.Position="position",t.CursorState="cursorState",t.FullPath="fullPath",t.Registered="registered",t.IframeBridge="iframeBridge",t.LaserPointerActive="laserPointerActive",t.AllBoxStatusInfo="allBoxStatusInfo",t.LastNotMinimizedBoxsStatus="lastNotMinimizedBoxsStatus",t.ViewScrollChange="viewScrollChange",t.MainViewBackgroundInfo="mainViewBackgroundInfo",t.Scale="Scale",t.TeacherInfo="teacher",t))(V||{});class zv{constructor(e){this.context=e,this.setAppFocus=(i,n)=>{n?this.context.safeSetAttributes({focus:i}):this.context.safeSetAttributes({focus:void 0})}}setContext(e){this.context=e}get attributes(){return this.context.getAttributes()}apps(){return b.get(this.attributes,["apps"])}get focus(){return b.get(this.attributes,["focus"])}getAppAttributes(e){return b.get(this.apps(),[e])}getAppState(e){return b.get(this.apps(),[e,"state"])}getMaximized(){const e=this.getAllBoxStatusInfo();return e?Object.entries(e).filter(([i,n])=>n===D.Maximized).map(([i,n])=>i):[]}setTeacherInfo(e){this.context.safeSetAttributes({teacher:e})}getTeacherInfo(){return b.get(this.attributes,["teacher"])}getMinimized(){const e=this.getAllBoxStatusInfo();return e?Object.entries(e).filter(([i,n])=>n===D.Minimized).map(([i,n])=>i):[]}setAllBoxStatusInfo(e){console.log("[TeleBox] AttributesDelegate - setAllBoxStatusInfo",e),this.context.safeSetAttributes({allBoxStatusInfo:e})}getAllBoxStatusInfo(){return b.get(this.attributes,["allBoxStatusInfo"])}getLaserPointerActive(){return b.get(this.attributes,["laserPointerActive"])}setLaserPointerActive(e,i){this.context.safeSetAttributes({laserPointerActive:{active:e,uid:i}})}setBoxStatusInfo(e,i){this.context.safeUpdateAttributes(["allBoxStatusInfo",e],i)}getBoxStatusInfo(e){return b.get(this.attributes,["allBoxStatusInfo",e])}getLastNotMinimizedBoxsStatus(){return b.get(this.attributes,["lastNotMinimizedBoxsStatus"])}setLastNotMinimizedBoxsStatus(e){this.context.safeSetAttributes({lastNotMinimizedBoxsStatus:e})}setViewScrollChange(e){console.log(`${te} ViewScrollChange Set`,JSON.stringify(e)),this.context.safeSetAttributes({viewScrollChange:e})}getViewScrollChange(){return b.get(this.attributes,["viewScrollChange"])}getLastNotMinimizedBoxStatus(e){return b.get(this.attributes,["lastNotMinimizedBoxsStatus",e])}setLastNotMinimizedBoxStatus(e,i){this.context.safeUpdateAttributes(["lastNotMinimizedBoxsStatus",e],i)}setupAppAttributes(e,i,n){this.attributes.apps||this.context.safeSetAttributes({apps:{}});const s=["scenePath","title"];n||s.push("scenes");const o=b.pick(e.options,s),a={kind:e.kind,options:o,isDynamicPPT:n};typeof e.src=="string"&&(a.src=e.src),a.createdAt=Date.now(),this.context.safeUpdateAttributes(["apps",i],a),this.context.safeUpdateAttributes(["apps",i,"state"],{[ze.Size]:{},[ze.Position]:{},[ze.SceneIndex]:0})}updateAppState(e,i,n){b.get(this.attributes,["apps",e,"state"])&&this.context.safeUpdateAttributes(["apps",e,"state",i],n)}cleanAppAttributes(e){this.context.safeUpdateAttributes(["apps",e],void 0),this.context.safeSetAttributes({[e]:void 0}),this.attributes.focus===e&&this.cleanFocus()}cleanFocus(){this.context.safeSetAttributes({focus:void 0})}getAppSceneIndex(e){var i;return(i=this.getAppState(e))==null?void 0:i[ze.SceneIndex]}getAppScenePath(e){var i,n;return(n=(i=this.getAppAttributes(e))==null?void 0:i.options)==null?void 0:n.scenePath}getMainViewScenePath(){return this.attributes._mainScenePath}getMainViewSceneIndex(){return this.attributes._mainSceneIndex}getBoxState(){return this.attributes.boxState}setMainViewScenePath(e){this.context.safeSetAttributes({_mainScenePath:e})}setMainViewSceneIndex(e){this.context.safeSetAttributes({_mainSceneIndex:e})}getMainViewCamera(){return b.get(this.attributes,["mainViewCamera"])}getMainViewSize(){return b.get(this.attributes,["mainViewSize"])}setMainViewCamera(e){this.context.safeSetAttributes({mainViewCamera:{...e}})}setMainViewSize(e){e.width===0||e.height===0||this.context.safeSetAttributes({mainViewSize:{...e}})}setMainViewCameraAndSize(e,i){i.width===0||i.height===0||this.context.safeSetAttributes({mainViewCamera:{...e},mainViewSize:{...i}})}updateCursor(e,i){b.get(this.attributes,["cursors"])||this.context.safeUpdateAttributes(["cursors"],{}),b.get(this.attributes,["cursors",e])||this.context.safeUpdateAttributes(["cursors",e],{}),this.context.safeUpdateAttributes(["cursors",e,"position"],i)}updateCursorState(e,i){b.get(this.attributes,["cursors",e])||this.context.safeUpdateAttributes(["cursors",e],{}),this.context.safeUpdateAttributes(["cursors",e,"cursorState"],i)}getCursorState(e){return b.get(this.attributes,["cursors",e,"cursorState"])}cleanCursor(e){this.context.safeUpdateAttributes(["cursors",e],void 0)}setMainViewFocusPath(e){const i=this.getMainViewScenePath();i&&yi(e,i)}getIframeBridge(){return b.get(this.attributes,["iframeBridge"])}setIframeBridge(e){if(b.isObject(e)){const i=this.getIframeBridge();for(const n in e){const r=e[n];i[n]!==r&&this.context.safeUpdateAttributes(["iframeBridge",n],r)}}}}const Dv=new zv({getAttributes:()=>{throw new Error("getAttributes not implemented")},safeSetAttributes:()=>{throw new Error("safeSetAttributes not implemented")},safeUpdateAttributes:()=>{throw new Error("safeUpdateAttributes not implemented")}}),it=(...t)=>{X.debug&&console.log("[WindowManager]:",...t)},Il=(t,e)=>{let i=0;const n=e.length-1;return t===e.index?t===n?i=t-1:i=e.index+1:i=e.index,i},bt=new bi.default;class Cl{constructor(e,i,n,r){var s;this.params=e,this.manager=i,this.boxManager=this.manager.boxManager,this.appProxies=this.manager.appProxies,this.viewManager=this.manager.viewManager,this.store=this.manager.store,this.status="normal",this.getAppInitState=o=>{var h,p;const a=this.store.getAppState(o);if(!a)return;const c=a==null?void 0:a[ze.Position],l=this.store.focus,u=a==null?void 0:a[ze.Size],d=a==null?void 0:a[ze.SceneIndex],f=(h=this.store.getMaximized())==null?void 0:h.includes(o),v=(p=this.store.getMinimized())==null?void 0:p.includes(o),w=a==null?void 0:a.zIndex;let x={maximized:f,minimized:v,zIndex:w};return c&&(x={...x,id:o,x:c.x,y:c.y}),l===o&&(x={...x,focus:!0}),u&&(x={...x,width:u.width,height:u.height}),d&&(x={...x,sceneIndex:d}),x},this.appAttributesUpdateListener=o=>{this.manager.refresher.add(o,()=>T.autorun(()=>{const a=this.manager.attributes[o];a&&this.appEmitter.emit("attributesUpdate",a)})),this.manager.refresher.add(this.stateKey,()=>T.autorun(()=>{var c,l,u,d;const a=(c=this.appAttributes)==null?void 0:c.state;(a==null?void 0:a.zIndex)>0&&a.zIndex!==((l=this.box)==null?void 0:l.zIndex)&&((u=this.boxManager)==null||u.setZIndex(o,a.zIndex),(d=this.boxManager)==null||d.focusBox({appId:o}))})),this.manager.refresher.add(`${o}-fullPath`,()=>T.autorun(()=>{var c;const a=(c=this.appAttributes)==null?void 0:c.fullPath;this.setFocusScenePathHandler(a),this._prevFullPath!==a&&(this.notifyPageStateChange(),this._prevFullPath=a)}))},this.setFocusScenePathHandler=b.debounce(o=>{var a;this.view&&o&&o!==((a=this.view)==null?void 0:a.focusScenePath)&&(yi(this.view,o),J.emit("onAppScenePathChange",{appId:this.id,view:this.view}))},50),this.notifyPageStateChange=b.debounce(()=>{this.appEmitter.emit("pageStateChange",this.pageState)},50),this.kind=e.kind,this.id=n,this.stateKey=`${this.id}_state`,this.appProxies.set(this.id,this),this.appEmitter=new bi.default,this.appListener=this.makeAppEventListener(this.id),this.isAddApp=r,this.initScenes(),(s=this.params.options)!=null&&s.scenePath&&this.createView(),this._pageState=new Mm({displayer:this.manager.displayer,scenePath:this.scenePath,view:this.view,notifyPageStateChange:this.notifyPageStateChange})}initScenes(){var i;const e=this.params.options;e&&(this.scenePath=e.scenePath,((i=this.appAttributes)==null?void 0:i.isDynamicPPT)&&this.scenePath?this.scenes=nn(this.manager.displayer)[this.scenePath]:this.scenes=e.scenes)}get view(){return this.manager.viewManager.getView(this.id)}get viewIndex(){var e;return(e=this.view)==null?void 0:e.focusSceneIndex}get isWritable(){var e;return this.manager.canOperate&&!((e=this.box)!=null&&e.readonly)}get attributes(){return this.manager.attributes[this.id]}get appAttributes(){return this.store.getAppAttributes(this.id)}getFullScenePath(){if(this.scenePath)return b.get(this.appAttributes,[V.FullPath])||this.getFullScenePathFromScenes()}getFullScenePathFromScenes(){const e=b.get(this.appAttributes,["state","SceneIndex"],0),i=cm(this.manager.room,this.scenePath,e);return i&&this.setFullPath(i),i}setFullPath(e){this.manager.safeUpdateAttributes(["apps",this.id,V.FullPath],e)}async baseInsertApp(e=!1){var s;const i=this.params;if(!i.kind)throw new Error("[WindowManager]: kind require");const n=await((s=Ee.appClasses.get(i.kind))==null?void 0:s()),r=Ee.registered.get(i.kind);if(n)await this.setupApp(this.id,e,n,i.options,r==null?void 0:r.appOptions);else throw new Error(`[WindowManager]: app load failed ${i.kind} ${i.src}`);return R.emit("updateManagerRect"),{appId:this.id,app:n}}get box(){var e;return(e=this.boxManager)==null?void 0:e.getBox(this.id)}async setupApp(e,i,n,r,s){var a,c,l;if(it("setupApp",e,n,r),!this.boxManager)throw new qd;const o=new xm(this.manager,this.boxManager,e,this,s);this.appContext=o;try{R.once(`${e}${ne.WindowCreated}`).then(async()=>{var w,x,h,p,g,m,y,M,E,z;let f;if(!i){f=this.getAppInitState(e);const P=(h=(x=(w=this.boxManager)==null?void 0:w.teleBoxManager)==null?void 0:x.getMaximizedBoxes())==null?void 0:h.includes(e),L=(m=(g=(p=this.boxManager)==null?void 0:p.teleBoxManager)==null?void 0:g.getMinimizedBoxes())==null?void 0:m.includes(e);Object.assign(f||{},{maximized:P,minimized:L}),(y=this.boxManager)==null||y.updateBoxState(f);const S=(M=this.boxManager)==null?void 0:M.teleBoxManager.getMaximizedBoxes().filter(N=>{var I;return!((I=this==null?void 0:this.boxManager)!=null&&I.teleBoxManager.getMinimizedBoxes().includes(N))});S!=null&&S.length&&((z=(E=this.boxManager)==null?void 0:E.teleBoxManager)==null||z.makeBoxTopFromMaximized())}this.appEmitter.onAny(this.appListener),this.appAttributesUpdateListener(e),this.setViewFocusScenePath();let v;this.manager.isReplay&&(v=this.manager.mainView.scenePath),setTimeout(async()=>{console.log("setup app",n);const P=await n.setup(o);this.appResult=P,Ee.notifyApp(this.kind,"created",{appId:e,result:P}),this.afterSetupApp(f),this.fixMobileSize(),v&&this.manager.mainViewProxy.setFocusScenePath(v),J.emit("onAppSetup",e)},Zd)});const u=(r==null?void 0:r.hasHeader)===!1||((a=this.appAttributes.options)==null?void 0:a.hasHeader)===!1?!1:((c=this.appAttributes.state)==null?void 0:c.hasHeader)!==!1;(l=this.boxManager)==null||l.createBox({appId:e,app:n,options:{...r,hasHeader:u},canOperate:this.manager.canOperate,smartPosition:this.isAddApp}),this.isAddApp&&this.box&&(this.store.updateAppState(e,ze.ZIndex,this.box.zIndex),this.store.updateAppState(e,ze.Size,{width:this.box.intrinsicWidth,height:this.box.intrinsicHeight}),this.boxManager.focusBox({appId:e},!1));const d=this.store.attributes[V.MainViewBackgroundInfo];d&&d.img.length>0&&R.emit("onBackgroundImgChange",d.img)}catch(u){throw console.error(u),new Error(`[WindowManager]: app setup error: ${u.message}`)}}fixMobileSize(){var i,n;const e=(i=this.boxManager)==null?void 0:i.getBox(this.id);e&&((n=this.boxManager)==null||n.resizeBox({appId:this.id,width:e.intrinsicWidth+.001,height:e.intrinsicHeight+.001,skipUpdate:!0}))}afterSetupApp(e){var i;e&&(!(e!=null&&e.x)||!e.y)&&((i=this.boxManager)==null||i.setBoxInitState(this.id))}async onSeek(e){var n;this.appEmitter.emit("seek",e).catch(r=>{console.log(`[WindowManager]: emit seek error: ${r.message}`)});const i=this.getAppInitState(this.id);(n=this.boxManager)==null||n.updateBoxState(i)}async onReconnected(){var s;if(!Boolean(this.manager.attributes.apps[this.id])){await this.destroy(!0,!1,!0);return}this.appEmitter.emit("reconnected",void 0);const i=this.getAppInitState(this.id);await this.destroy(!0,!1,!0);const n=this.params;await new Cl(n,this.manager,this.id,this.isAddApp).baseInsertApp(!0),(s=this.boxManager)==null||s.updateBoxState(i)}async onRemoveScene(e){if(this.scenePath&&e.startsWith(this.scenePath+"/")){let i=this.pageState.index,n=this._pageState.getFullPath(i);n||(i=0,n=this._pageState.getFullPath(i)),n&&this.setFullPath(n),this.setViewFocusScenePath(),this.view&&(this.view.focusSceneIndex=i)}}emitAppSceneStateChange(e){this.appEmitter.emit("sceneStateChange",e)}emitAppIsWritableChange(){this.appEmitter.emit("writableChange",this.isWritable)}makeAppEventListener(e){return(i,n)=>{var r,s,o,a;if(!!this.manager.canOperate)switch(i){case"setBoxSize":{(r=this.boxManager)==null||r.resizeBox({appId:e,width:n.width,height:n.height,skipUpdate:!1});break}case"setBoxMinSize":{(s=this.boxManager)==null||s.setBoxMinSize({appId:e,minWidth:n.minwidth,minHeight:n.minheight});break}case"setBoxTitle":{(o=this.boxManager)==null||o.setBoxTitle({appId:e,title:n.title});break}case Hd.destroy:{if(this.status==="destroyed")return;this.destroy(!0,!1,!0,n==null?void 0:n.error),n!=null&&n.error&&console.error(n==null?void 0:n.error);break}case"focus":{(a=this.boxManager)==null||a.focusBox({appId:this.id}),bt.emit("focus",{appId:this.id});break}}}}setScenePath(){if(!this.manager.canOperate)return;const e=this.getFullScenePath();this.manager.room&&e&&this.view&&ia(this.manager.room,e)}setViewFocusScenePath(){const e=this.getFullScenePath();return e&&this.view&&yi(this.view,e),e}async createView(){const e=await this.viewManager.createView(this.id);return this.setViewFocusScenePath(),e}get pageState(){return this._pageState.toObject()}async removeSceneByIndex(e){const i=this._pageState.getFullPath(e);if(i){const n=Il(e,this.pageState);return this.setSceneIndexWithoutSync(n),this.manager.dispatchInternalEvent(ne.SetAppFocusIndex,{type:"app",appID:this.id,index:n}),setTimeout(()=>{na(this.manager.room,i,e)},100),!0}else return!1}setSceneIndexWithoutSync(e){this.view&&(this.view.focusSceneIndex=e)}setSceneIndex(e){if(this.view){this.view.focusSceneIndex=e;const i=this._pageState.getFullPath(e);i&&this.setFullPath(i)}}async destroy(e,i,n,r){var s;if(this.status!=="destroyed"){this.status="destroyed";try{await Ee.notifyApp(this.kind,"destroy",{appId:this.id}),await this.appEmitter.emit("destroy",{error:r})}catch(o){console.error("[WindowManager]: notifyApp error",o.message,o.stack)}this.appEmitter.clearListeners(),R.emit(`destroy-${this.id}`,{error:r}),e&&((s=this.boxManager)==null||s.closeBox(this.id,n)),i&&(this.store.cleanAppAttributes(this.id),this.scenePath&&na(this.manager.room,this.scenePath)),this.appProxies.delete(this.id),this._pageState.destroy(),this.viewManager.destroyView(this.id),this.manager.appStatus.delete(this.id),this.manager.refresher.remove(this.id),this.manager.refresher.remove(this.stateKey),this.manager.refresher.remove(`${this.id}-fullPath`),this._prevFullPath=void 0}}close(){return this.destroy(!0,!0,!1)}}class Lv{constructor(e){this.displayer=e,this.views=new Map}createView(e){const i=Ih(this.displayer);return this.views.set(e,i),i}getView(e){return this.views.get(e)}destroyView(e){const i=this.views.get(e);if(i){try{i.release()}catch{}this.views.delete(e)}}setViewScenePath(e,i){const n=this.views.get(e);n&&(n.focusScenePath=i)}destroy(){this.views.forEach(e=>{try{e.release()}catch{}}),this.views.clear()}}const Ih=t=>{const e=t.views.createView();return jv(e),e},jv=t=>{t.setCameraBound({maxContentMode:()=>10,minContentMode:()=>.1})};class Rv{constructor(e){this.manager=e,this.polling=!1,this.started=!1,this.mainViewIsAddListener=!1,this.store=this.manager.store,this.viewMode=this.manager.windowManger.viewMode,this.sideEffectManager=new hn,this.syncCamera=()=>{if(!this.polling||this.viewMode!==T.ViewMode.Broadcaster)return;const{mainViewCamera:n}=this;n&&n.id!==this.manager.uid&&this.moveCameraSizeByAttributes()},this.startListenWritableChange=()=>{this.sideEffectManager.add(()=>R.on("writableChange",n=>{n&&this.ensureCameraAndSize(),this.manager.room&&this.syncMainView(this.manager.room)}))},this.addCameraReaction=()=>{this.manager.refresher.add(V.MainViewCamera,this.cameraReaction)},this.cameraReaction=()=>T.reaction(()=>this.mainViewCamera,n=>{n&&n.id!==this.manager.uid&&(this.moveCameraToContian(this.mainViewSize),this.moveCamera(n))},{fireImmediately:!0}),this.sizeChangeHandler=b.debounce(n=>{n&&(this.moveCameraToContian(n),this.moveCamera(this.mainViewCamera)),this.ensureMainViewSize()},30),this.onUpdateContainerSizeRatio=()=>{const n=this.store.getMainViewSize();this.sizeChangeHandler(n)},this.onCameraUpdatedByDevice=n=>{this.viewMode!==T.ViewMode.Follower&&(this.store.setMainViewCamera({...n,id:this.manager.uid}),b.isEqual(this.mainViewSize,{...this.mainView.size,id:this.manager.uid})||this.setMainViewSize(this.view.size))},this.mainViewClickListener=()=>{this.mainViewClickHandler()},this.setMainViewSize=b.debounce(n=>{this.store.setMainViewSize({...n,id:this.manager.uid})},50),this._syncMainViewTimer=0,this.onCameraOrSizeUpdated=()=>{J.emit("cameraStateChange",this.cameraState),this.manager.room&&this.manager.room.syncMainView&&(clearTimeout(this._syncMainViewTimer),this._syncMainViewTimer=setTimeout(this.syncMainView,100,this.manager.room)),this.ensureMainViewSize()},this.syncMainView=n=>{n.isWritable&&n.syncMainView(this.mainView)},this.setViewMode=n=>{this.viewMode=n},this.mainView=this.createMainView(),this.moveCameraSizeByAttributes(),R.once("mainViewMounted").then(()=>{this.addMainViewListener(),this.start(),this.ensureCameraAndSize(),this.startListenWritableChange()});const i=()=>{this.sizeChangeHandler(this.mainViewSize)};this.sideEffectManager.add(()=>R.on("playgroundSizeChange",i)),this.sideEffectManager.add(()=>R.on("containerSizeRatioUpdate",this.onUpdateContainerSizeRatio)),this.sideEffectManager.add(()=>R.on("startReconnect",()=>{this.didRelease||this.mainView.release()})),this.sideEffectManager.setInterval(this.syncCamera,1500)}ensureCameraAndSize(){this.viewMode===T.ViewMode.Broadcaster&&(!this.mainViewCamera||!this.mainViewSize)&&(this.manager.dispatchInternalEvent(ne.InitMainViewCamera),this.setCameraAndSize())}get mainViewCamera(){return this.store.getMainViewCamera()}get mainViewSize(){return this.store.getMainViewSize()}get didRelease(){return b.get(this.view,["didRelease"])}moveCameraSizeByAttributes(){this.moveCameraToContian(this.mainViewSize),this.moveCamera(this.mainViewCamera)}start(){this.sizeChangeHandler(this.mainViewSize),!this.started&&(this.addCameraListener(),this.addCameraReaction(),this.manager.room&&this.syncMainView(this.manager.room),this.started=!0)}setCameraAndSize(){const e={...this.mainView.camera,id:this.manager.uid},i={...this.mainView.size,id:this.manager.uid};this.store.setMainViewCameraAndSize(e,i)}setMainViewCameraAndSize(e,i){this.store.setMainViewCameraAndSize(e,i)}get view(){return this.mainView}get cameraState(){return{...this.view.camera,...this.view.size}}createMainView(){const e=Ih(this.manager.displayer),i=this.store.getMainViewScenePath();return i&&yi(e,i),e}onReconnect(){if(this.didRelease)this.rebind();else{const e=this.store.getMainViewScenePath();this.setFocusScenePath(e)}}setFocusScenePath(e){if(e)return yi(this.view,e)}rebind(){const e=this.mainView.divElement,i=this.mainView.disableCameraTransform;this.stop(),this.didRelease||this.mainView.release(),this.removeMainViewListener(),this.mainView=this.createMainView(),this.mainView.disableCameraTransform=i,this.mainView.divElement=e,this.addMainViewListener(),this.start(),J.emit("onMainViewRebind",this.mainView)}addMainViewListener(){this.mainViewIsAddListener||this.view.divElement&&(this.view.divElement.addEventListener("click",this.mainViewClickListener),this.view.divElement.addEventListener("touchend",this.mainViewClickListener),this.mainViewIsAddListener=!0)}removeMainViewListener(){this.view.divElement&&(this.view.divElement.removeEventListener("click",this.mainViewClickListener),this.view.divElement.removeEventListener("touchend",this.mainViewClickListener)),this.mainViewIsAddListener=!1}async mainViewClickHandler(){var e;!this.manager.canOperate||(this.store.cleanFocus(),(e=this.manager.boxManager)==null||e.blurAllBox())}addCameraListener(){this.view.callbacks.on("onCameraUpdatedByDevice",this.onCameraUpdatedByDevice),this.view.callbacks.on("onCameraUpdated",this.onCameraOrSizeUpdated),this.view.callbacks.on("onSizeUpdated",this.onCameraOrSizeUpdated)}removeCameraListener(){this.view.callbacks.off("onCameraUpdatedByDevice",this.onCameraUpdatedByDevice),this.view.callbacks.off("onCameraUpdated",this.onCameraOrSizeUpdated),this.view.callbacks.off("onSizeUpdated",this.onCameraOrSizeUpdated)}ensureMainViewSize(){(!this.mainViewSize||this.mainViewSize.width===0||this.mainViewSize.height===0)&&this.mainView.size.width>0&&this.mainView.size.height>0&&this.setMainViewSize(this.mainView.size)}moveCameraToContian(e){b.isEmpty(e)||(this.view.moveCameraToContain({width:e.width,height:e.height,originX:-e.width/2,originY:-e.height/2,animationMode:T.AnimationMode.Immediately}),this.scale=this.view.camera.scale)}moveCamera(e){if(!b.isEmpty(e)){if(b.isEqual(e,this.view.camera))return;const{centerX:i,centerY:n,scale:r}=e,s=r*(this.scale||1);this.view.moveCamera({centerX:i,centerY:n,scale:s,animationMode:T.AnimationMode.Immediately})}}stop(){this.removeCameraListener(),this.manager.refresher.remove(V.MainViewCamera),this.manager.refresher.remove(V.MainViewSize),this.started=!1}destroy(){this.removeMainViewListener(),this.stop(),this.sideEffectManager.flushAll()}}class _v{constructor(e){this.context=e,this.addRedoUndoListeners=i=>{if(i===void 0)this.addViewCallbacks(this.context.mainView(),this.onCanRedoStepsUpdate,this.onCanUndoStepsUpdate);else{const n=this.context.getAppProxy(i);n&&n.view&&this.addViewCallbacks(n.view,this.onCanRedoStepsUpdate,this.onCanUndoStepsUpdate)}},this.addViewCallbacks=(i,n,r)=>{n(i.canRedoSteps),r(i.canUndoSteps),i.callbacks.on("onCanRedoStepsUpdate",n),i.callbacks.on("onCanUndoStepsUpdate",r)},this.disposeViewCallbacks=i=>{i.callbacks.off("onCanRedoStepsUpdate",this.onCanRedoStepsUpdate),i.callbacks.off("onCanUndoStepsUpdate",this.onCanUndoStepsUpdate)},this.onCanRedoStepsUpdate=i=>{J.emit("canRedoStepsChange",i)},this.onCanUndoStepsUpdate=i=>{J.emit("canUndoStepsChange",i)},this.disposePrevFocusViewRedoUndoListeners=i=>{let n;if(i===void 0)n=this.context.mainView();else{const r=this.context.getAppProxy(i);r&&r.view&&(n=r.view)}n&&this.disposeViewCallbacks(n)},R.on("focusedChange",i=>{this.disposePrevFocusViewRedoUndoListeners(i.prev),setTimeout(()=>{this.addRedoUndoListeners(i.focused)},0)}),R.on("rootDirRemoved",()=>{this.disposePrevFocusViewRedoUndoListeners(e.focus()),this.addRedoUndoListeners(e.focus())}),this.addRedoUndoListeners(e.focus())}destroy(){this.disposePrevFocusViewRedoUndoListeners(this.context.focus())}}class Vv{constructor(e){this.windowManger=e,this.appProxies=new Map,this.appStatus=new Map,this.store=Dv,this.isReplay=this.windowManger.isReplay,this.mainViewScenesLength=0,this.callbacksNode=null,this.appCreateQueue=new Qg,this.sideEffectManager=new hn,this.sceneState=null,this.rootDirRemoving=!1,this.onRemoveScenes=async i=>{var r,s;const{scenePath:n}=i;if(n===Ue){await this.onRootDirRemoved(),this.dispatchInternalEvent(ne.RootDirRemoved);return}if(fm(n)){let o=this.mainView.focusSceneIndex||0,a=(r=this.callbacksNode)==null?void 0:r.scenes[o];a||(o=0,a=(s=this.callbacksNode)==null?void 0:s.scenes[o]),a&&this.setMainViewScenePath(`${Ue}${a}`),await this.setMainViewSceneIndex(o)}else this.appProxies.forEach(o=>{o.onRemoveScene(n)})},this.onReadonlyChanged=()=>{this.appProxies.forEach(i=>{i.emitAppIsWritableChange()})},this.onPlayerSeekStart=async()=>{await this.closeAll()},this.onPlayerSeekDone=async i=>{await this.attributesUpdateCallback(this.attributes.apps),this.appProxies.forEach(n=>{n.onSeek(i)})},this.createRootDirScenesCallback=()=>{let i=!1;this.callbacksNode&&(this.callbacksNode.dispose(),i=!0),this.callbacksNode=this.displayer.createScenesCallback(Ue,{onAddScene:this.onSceneChange,onRemoveScene:async(n,r)=>{await this.onSceneChange(n),R.emit("rootDirSceneRemoved",r)}}),this.callbacksNode&&(this.updateSceneState(this.callbacksNode),this.mainViewScenesLength=this.callbacksNode.scenes.length,i&&this.emitMainViewScenesChange(this.callbacksNode.scenes.length))},this.removeSceneByIndex=async i=>{var s;const n=Il(i,this.windowManger.pageState);this.setSceneIndexWithoutSync(n),this.dispatchInternalEvent(ne.SetAppFocusIndex,{type:"main",index:n});const r=(s=this.callbacksNode)==null?void 0:s.scenes[i];return setTimeout(()=>{r&&na(this.room,`${Ue}${r}`,i)},100),new Promise((o,a)=>{R.once("rootDirSceneRemoved").then(c=>{c===r&&o(!0)}).catch(c=>{console.log(`[WindowManager]: removePage error: ${c}`),a(!1)})})},this.setSceneIndexWithoutSync=i=>{var r;const n=(r=this.callbacksNode)==null?void 0:r.scenes[i];n&&this.mainViewProxy.setFocusScenePath(`${Ue}${n}`)},this.onSceneChange=i=>(this.mainViewScenesLength=i.scenes.length,this.updateSceneState(i),this.emitMainViewScenesChange(this.mainViewScenesLength)),this.emitMainViewScenesChange=i=>Promise.all([J.emit("mainViewScenesLengthChange",i),R.emit("changePageState")]),this.updateSceneState=i=>{const n=this.store.getMainViewSceneIndex()||0;let r=i.scenes[n];r||(r=i.scenes[this.mainView.focusSceneIndex||0]),this.sceneState={scenePath:`${Ue}${r}`,contextPath:i.path,index:n,scenes:i.scenes.map(s=>({name:s})),sceneName:r},J.emit("sceneStateChange",this.sceneState)},this.onBoxMove=i=>{this.dispatchInternalEvent(ne.AppMove,i),this.store.updateAppState(i.appId,ze.Position,{x:i.x,y:i.y}),J.emit("onBoxMove",i)},this.onBoxResize=i=>{i.width&&i.height&&(this.dispatchInternalEvent(ne.AppResize,i),this.store.updateAppState(i.appId,ze.Size,{width:i.width,height:i.height}),J.emit("onBoxResize",i))},this.onBoxFocus=i=>{this.windowManger.safeSetAttributes({focus:i.appId}),J.emit("onBoxFocus",i)},this.onBoxClose=i=>{const n=this.appProxies.get(i.appId);n&&n.destroy(!1,!0,!0,i.error),J.emit("onBoxClose",i)},this.onBoxStateChange=i=>{this.dispatchInternalEvent(ne.AppBoxStateChange,i),J.emit("onBoxStateChange",i)},this.addAppsChangeListener=()=>{this.refresher.add("apps",()=>ra(()=>this.attributes.apps,()=>{this.attributesUpdateCallback(this.attributes.apps)}))},this.addAppCloseListener=()=>{this.refresher.add("appsClose",()=>ra(()=>this.attributes.apps,i=>{i.some(n=>n.kind===T.UpdateEventKind.Removed)&&this.onAppDelete(this.attributes.apps)}))},this.onMainViewIndexChange=i=>{i!==void 0&&this._prevSceneIndex!==i&&(J.emit("mainViewSceneIndexChange",i),R.emit("changePageState"),this.callbacksNode&&this.updateSceneState(this.callbacksNode),this._prevSceneIndex=i)},this.onFocusChange=i=>{var n;this._prevFocused!==i&&(J.emit("focusedChange",i),R.emit("focusedChange",{focused:i,prev:this._prevFocused}),this._prevFocused=i,i!==void 0&&((n=this.boxManager)==null||n.focusBox({appId:i}),setTimeout(()=>{const r=this.appProxies.get(i);r&&Ee.notifyApp(r.kind,"focus",{appId:i})},0)))},this.attributesUpdateCallback=b.debounce(i=>this._attributesUpdateCallback(i),100),this._appIds=[],this.onRegisteredChange=i=>{!i||Object.entries(i).forEach(([n,r])=>{Ee.appClasses.has(n)||Ee.register({kind:n,src:r.src,name:r.name})})},this.onMinimized=i=>{var n,r;((n=this.boxManager)==null?void 0:n.minimized)!==i&&(i===!0&&((r=this.boxManager)==null||r.blurAllBox()),setTimeout(()=>{var s;(s=this.boxManager)==null||s.setMinimized(Boolean(i))},0))},this.onAppDelete=async i=>{const n=Object.keys(i);for(const[r,s]of this.appProxies.entries())n.includes(r)||await s.destroy(!0,!1,!0)},this.closeAll=async()=>{for(const[i,n]of this.appProxies.entries())await n.destroy(!0,!1,!0)},this.displayerStateListener=i=>{this.appProxies.forEach(n=>{n.appEmitter.emit("roomStateChange",i)}),R.emit("observerIdChange",this.displayer.observerId)},this.displayerWritableListener=i=>{var s,o;const n=!i,r=this.windowManger.readonly===void 0||this.windowManger.readonly===!1;this.windowManger.readonly===void 0?(s=this.boxManager)==null||s.setReadonly(i):(o=this.boxManager)==null||o.setReadonly(!(n&&r)),this.appProxies.forEach(a=>{a.emitAppIsWritableChange()}),R.emit("writableChange",n)},this.updateSceneIndex=()=>{const i=this.store.getMainViewScenePath(),n=Io(i),r=nn(this.displayer)[n];if(r.length){const s=i.replace(n,"").replace("/",""),o=r.findIndex(a=>a.name===s);b.isInteger(o)&&o>=0&&this.safeSetAttributes({_mainSceneIndex:o})}},this.updateRootDirRemoving=i=>{this.rootDirRemoving=i},this.displayer=e.displayer,this.store.setContext({getAttributes:()=>this.attributes,safeSetAttributes:i=>this.safeSetAttributes(i),safeUpdateAttributes:(i,n)=>this.safeUpdateAttributes(i,n)}),this.mainViewProxy=new Rv(this),this.viewManager=new Lv(this.displayer),this.appListeners=new gm(this),this.displayer.callbacks.on(this.eventName,this.displayerStateListener),this.appListeners.addListeners(),this.refresher=Dg,this.refresher.setRoom(this.room),this.refresher.setContext({emitter:R}),this.sideEffectManager.addDisposer(()=>{var i,n;this.appCreateQueue.destroy(),this.mainViewProxy.destroy(),this.refresher.destroy(),this.viewManager.destroy(),(i=this.boxManager)==null||i.destroy(),(n=this.callbacksNode)==null||n.dispose()}),R.once("onCreated").then(()=>this.onCreated()),R.on("onReconnected",()=>this.onReconnected()),T.isPlayer(this.displayer)&&(R.on("seekStart",this.onPlayerSeekStart),R.on("seek",this.onPlayerSeekDone)),R.on("removeScenes",this.onRemoveScenes),R.on("setReadonly",this.onReadonlyChanged),this.createRootDirScenesCallback(),Ee.setSyncRegisterApp(i=>{this.safeUpdateAttributes([V.Registered,i.kind],i)})}getMemberState(){var e;return((e=this.room)==null?void 0:e.state.memberState)||{strokeColor:[0,0,0]}}async onRootDirRemoved(e=!0){this.setMainViewScenePath(Fd),this.createRootDirScenesCallback();for(const[i,n]of this.appProxies.entries())n.view&&await this.closeApp(i,e);this.mainViewProxy.rebind(),R.emit("rootDirRemoved"),this.updateRootDirRemoving(!1)}get eventName(){return T.isRoom(this.displayer)?"onRoomStateChanged":"onPlayerStateChanged"}get attributes(){return this.windowManger.attributes}get canOperate(){return this.windowManger.canOperate}get appReadonly(){return this.windowManger.appReadonly}get room(){return T.isRoom(this.displayer)?this.displayer:void 0}get isLaserPointerActive(){return this.windowManger.isLaserPointerActive}get mainView(){return this.mainViewProxy.view}get polling(){return this.mainViewProxy.polling}set polling(e){this.mainViewProxy.polling=e}get focusApp(){if(this.store.focus)return this.appProxies.get(this.store.focus)}get extendWrapper(){return this.windowManger.extendWrapper}get uid(){var e;return((e=this.room)==null?void 0:e.uid)||""}getMainViewSceneDir(){const e=this.store.getMainViewScenePath();if(e)return Io(e);throw new Error("[WindowManager]: mainViewSceneDir not found")}async onCreated(){var e;if(Object.keys(this.attributes.apps).length&&this.store.focus&&await new Promise(i=>{this._focusAppCreatedResolve=i}).then(()=>{this.focusByAttributes(this.attributes.apps)}),await this.attributesUpdateCallback(this.attributes.apps),this.focusByAttributes(this.attributes.apps),R.emit("updateManagerRect"),bt.on("move",this.onBoxMove),bt.on("resize",this.onBoxResize),bt.on("focus",this.onBoxFocus),bt.on("close",this.onBoxClose),bt.on("boxStateChange",this.onBoxStateChange),this.addAppsChangeListener(),this.addAppCloseListener(),this.refresher.add("mainViewIndex",()=>T.autorun(()=>{const i=b.get(this.attributes,"_mainSceneIndex");this.onMainViewIndexChange(i)})),this.refresher.add("focusedChange",()=>T.autorun(()=>{const i=b.get(this.attributes,"focus");this.onFocusChange(i)})),this.refresher.add("registeredChange",()=>T.autorun(()=>{const i=b.get(this.attributes,V.Registered);this.onRegisteredChange(i)})),!this.attributes.apps||Object.keys(this.attributes.apps).length===0){const i=this.store.getMainViewScenePath();if(!i)return;this.resetScenePath(i)}this.displayerWritableListener(!((e=this.room)!=null&&e.isWritable)),this.displayer.callbacks.on("onEnableWriteNowChanged",this.displayerWritableListener),this._prevFocused=this.attributes.focus,this.sideEffectManager.add(()=>{const i=new _v({mainView:()=>this.mainViewProxy.view,focus:()=>this.attributes.focus,getAppProxy:n=>this.appProxies.get(n)});return()=>i.destroy()})}notifyAppsChange(e){(this._appIds.length!==e.length||!this._appIds.every(i=>e.includes(i)))&&(this._appIds=e,J.emit("appsChange",e))}async _attributesUpdateCallback(e){if(e&&X.container){const i=Object.keys(e);i.length===0&&this.appCreateQueue.emitReady();const r=b.orderBy(i.map(s=>({id:s,createdAt:e[s].createdAt})),"createdAt","asc").map(({id:s})=>s);this.notifyAppsChange(r);for(const s of r)if(!this.appProxies.has(s)&&!this.appStatus.has(s)){const o=e[s];try{if(!this.attributes[s])throw new Error("appAttributes is undefined");this.appCreateQueue.push(()=>(this.appStatus.set(s,ea.StartCreate),this.baseInsertApp({kind:o.kind,options:o.options,isDynamicPPT:o.isDynamicPPT},s,!1))),this.focusByAttributes(e)}catch(a){console.warn("[WindowManager]: Insert App Error",a)}}}}refresh(){this.attributesUpdateCallback(this.attributes.apps)}setBoxManager(e){this.boxManager=e}resetMaximized(){var i,n;const e=this.store.getAllBoxStatusInfo();e&&((n=(i=this.boxManager)==null?void 0:i.teleBoxManager)==null||n.setAllBoxStatusInfo({...e}))}resetMinimized(){var i,n;const e=this.store.getAllBoxStatusInfo();e&&((n=(i=this.boxManager)==null?void 0:i.teleBoxManager)==null||n.setAllBoxStatusInfo({...e}))}bindMainView(e,i){const n=this.mainViewProxy.view;n.disableCameraTransform=i,n.divElement=e,n.focusScenePath||this.setMainViewFocusPath(),R.emit("mainViewMounted"),J.emit("onMainViewMounted",n)}setMainViewFocusPath(e){var n;const i=e||this.store.getMainViewScenePath();if(i)return yi(this.mainView,i),((n=this.mainView)==null?void 0:n.focusScenePath)===i}resetScenePath(e){this.displayer.state.sceneState.scenePath!==e&&ia(this.room,e)}async addApp(e,i){it("addApp",e);const{appId:n,needFocus:r}=await this.beforeAddApp(e,i),s=await this.baseInsertApp(e,n,!0,r);return this.afterAddApp(s),s==null?void 0:s.id}async beforeAddApp(e,i){var o,a;const n=await lm(e.kind);this.appStatus.set(n,ea.StartCreate);const r=(o=e.attributes)!=null?o:{};this.safeUpdateAttributes([n],r),this.store.setupAppAttributes(e,n,i);const s=!((a=this.boxManager)!=null&&a.minimized);return s&&this.store.setAppFocus(n,!0),{appId:n,needFocus:s}}afterAddApp(e){var i,n;if(e&&e.box){const r=e.box;bt.emit("move",{appId:e.id,x:r==null?void 0:r.intrinsicX,y:r==null?void 0:r.intrinsicY}),this.store.updateAppState(e.id,ze.ZIndex,r.zIndex)}(i=this.boxManager)!=null&&i.minimized&&((n=this.boxManager)==null||n.setMinimized(!1,!1))}async closeApp(e,i=!0){const n=this.appProxies.get(e);n&&n.destroy(!0,i,!1)}async baseInsertApp(e,i,n,r){if(this.appProxies.has(i)){console.warn("[WindowManager]: app duplicate exists and cannot be created again");return}const s=new Cl(e,this,i,n);if(s)return await s.baseInsertApp(r),this.appStatus.delete(i),s;throw this.appStatus.delete(i),new Error("[WindowManger]: initialize AppProxy failed")}safeSetAttributes(e){this.windowManger.safeSetAttributes(e)}safeUpdateAttributes(e,i){this.windowManger.safeUpdateAttributes(e,i)}async setMainViewScenePath(e){if(this.room){const i=this.displayer.scenePathType(e);if(Io(e)!==Ue)throw new Error('[WindowManager]: main view scenePath must in root dir "/"');if(i===T.ScenePathType.None)throw new Error(`[WindowManager]: ${e} not valid scene`);if(i===T.ScenePathType.Page)await this._setMainViewScenePath(e);else if(i===T.ScenePathType.Dir){const r=dm(this.displayer,e);r&&await this._setMainViewScenePath(r)}}}async _setMainViewScenePath(e){this.setMainViewFocusPath(e)&&(this.safeSetAttributes({_mainScenePath:e}),this.store.setMainViewFocusPath(this.mainView),this.updateSceneIndex(),this.dispatchSetMainViewScenePath(e))}async setMainViewSceneIndex(e){var i;if(this.room){if(this.store.getMainViewSceneIndex()===e)return;const n=(i=this.callbacksNode)==null?void 0:i.scenes[e],r=`${Ue}${n}`;if(n)this.setMainViewFocusPath(r)&&(this.store.setMainViewScenePath(r),this.store.setMainViewSceneIndex(e),this.dispatchSetMainViewScenePath(r));else throw new Error(`[WindowManager]: ${e} not valid index`)}}dispatchSetMainViewScenePath(e){this.dispatchInternalEvent(ne.SetMainViewScenePath,{nextScenePath:e}),J.emit("mainViewScenePathChange",e),ia(this.room,e)}getAppInitPath(e){var n;const i=this.store.getAppAttributes(e);if(i)return(n=i==null?void 0:i.options)==null?void 0:n.scenePath}safeDispatchMagixEvent(e,i){this.canOperate&&this.displayer.dispatchMagixEvent(e,i)}focusByAttributes(e){var i;if(e&&Object.keys(e).length===((i=this.boxManager)==null?void 0:i.boxSize)){const n=this.store.focus;n&&this.boxManager.focusBox({appId:n})}}async onReconnected(){this.attributesUpdateCallback(this.attributes.apps);const i=Array.from(this.appProxies.values()).map(n=>n.onReconnected());this.mainViewProxy.onReconnect(),await Promise.all(i),this.callbacksNode&&this.onSceneChange(this.callbacksNode)}notifyContainerRectUpdate(e){this.appProxies.forEach(i=>{i.appEmitter.emit("containerRectUpdate",e)})}dispatchInternalEvent(e,i){this.safeDispatchMagixEvent(qo,{eventName:e,payload:i})}destroy(){this.displayer.callbacks.off(this.eventName,this.displayerStateListener),this.displayer.callbacks.off("onEnableWriteNowChanged",this.displayerWritableListener),this.appListeners.removeListeners(),bt.clearListeners(),R.clearListeners(),this.appProxies.size&&this.appProxies.forEach(e=>{e.destroy(!0,!1,!0)}),J.clearListeners(),this.sideEffectManager.flushAll(),this._prevFocused=void 0,this._prevSceneIndex=void 0,this._focusAppCreatedResolve=void 0}}const Ov=t=>{const e=document.createElement("div");e.className="netless-window-manager-playground";const i=document.createElement("div");i.className="netless-window-manager-sizer";const n=document.createElement("div");n.className="netless-window-manager-wrapper";const r=document.createElement("div");r.className="netless-window-manager-wrapper netless-window-manager-fancy-scrollbar",r.classList.toggle("netless-window-manager-fancy-scrollbar-readonly",Boolean(qs()||Ks()));const s=document.createElement("div");s.className="netless-window-manager-main-view-wrapper netless-window-manager-main-view-wrp";const o=document.createElement("div");o.className="netless-window-manager-main-view";const a=document.createElement("div");return a.style.display="none",e.appendChild(i),e.appendChild(a),i.appendChild(n),s.appendChild(o),r.appendChild(s),n.appendChild(r),t.appendChild(e),X.wrapper=n,{playground:e,wrapper:n,sizer:i,mainViewElement:o,mainViewWrapper:s,extendWrapper:a,mainViewScrollWrapper:r}},$v=()=>{if(Uc(T.WhiteVersion)<Uc(Oc))throw new Yd(Oc)},ws=(t,e)=>{var s;const i=(t==null?void 0:t.state.roomMembers)||[];let n=-1,r;for(const o of i)((s=o.payload)==null?void 0:s.uid)===e&&n<o.memberId&&(n=o.memberId,r=o);return r},Wv=async t=>{let e=t.getInvisiblePlugin(X.kind);if(e)return e;let i;const n=new Promise(l=>{X._resolve=i=l});let r=!1;const s=Uv(t);!t.isWritable&&s&&(r=!0,await Ud.default(async l=>{it(`switching to writable (x${l})`),await t.setWritable(!0)},{retries:10,maxTimeout:5e3})),t.isWritable?(it("creating InvisiblePlugin..."),t.createInvisiblePlugin(X,{}).catch(console.warn)):(s&&console.warn("[WindowManager]: failed to switch to writable"),console.warn("[WindowManager]: waiting for others to create the plugin..."));const o=setTimeout(()=>{console.warn("[WindowManager]: no one called createInvisiblePlugin() after 20 seconds")},2e4),a=setTimeout(()=>{throw new Error("[WindowManager]: no one called createInvisiblePlugin() after 60 seconds")},6e4),c=setInterval(()=>{e=t.getInvisiblePlugin(X.kind),e&&(clearTimeout(a),clearTimeout(o),clearInterval(c),i(e),r&&t.isWritable&&setTimeout(()=>t.setWritable(!1).catch(console.warn),500))},200);return n},Uv=t=>{try{const e=atob(t.roomToken.slice(12)),i=e.indexOf("&role=");return+e[i+6]<2}catch(e){return console.error(e),!1}},Hv=window.ResizeObserver||$g.ResizeObserver;class bl{constructor(e){this.emitter=e}static create(e,i,n,r){const s=new bl(r);return s.observePlaygroundSize(e,i,n),s}observePlaygroundSize(e,i,n){this.updateSizer(e.getBoundingClientRect(),i,n),this.containerResizeObserver=new Hv(r=>{var o;const s=(o=r[0])==null?void 0:o.contentRect;s&&(this.updateSizer(s,i,n),this.emitter.emit("playgroundSizeChange",s))}),this.disposer=this.emitter.on("containerSizeRatioUpdate",()=>{const r=e.getBoundingClientRect();this.updateSizer(r,i,n),this.emitter.emit("playgroundSizeChange",r)}),this.containerResizeObserver.observe(e)}updateSizer({width:e,height:i},n,r){e&&i&&(i/e>X.containerSizeRatio?(i=e*X.containerSizeRatio,n.classList.toggle("netless-window-manager-sizer-horizontal",!0)):(e=i/X.containerSizeRatio,n.classList.toggle("netless-window-manager-sizer-horizontal",!1)),r.style.width=`${e}px`,r.style.height=`${i}px`)}disconnect(){var e;(e=this.containerResizeObserver)==null||e.disconnect(),b.isFunction(this.disposer)&&(this.disposer(),this.disposer=void 0)}}function er(){}function Ch(t){return t()}function tu(){return Object.create(null)}function eo(t){t.forEach(Ch)}function bh(t){return typeof t=="function"}function Fv(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let zr;function ys(t,e){return zr||(zr=document.createElement("a")),zr.href=e,t===zr.href}function Zv(t){return Object.keys(t).length===0}function Et(t,e){t.appendChild(e)}function to(t,e,i){t.insertBefore(e,i||null)}function fr(t){t.parentNode&&t.parentNode.removeChild(t)}function Wt(t){return document.createElement(t)}function Al(t){return document.createTextNode(t)}function ua(){return Al(" ")}function ue(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function Qv(t){return Array.from(t.childNodes)}function Ah(t,e){e=""+e,t.data!==e&&(t.data=e)}function Se(t,e,i,n){i==null?t.style.removeProperty(e):t.style.setProperty(e,i,n?"important":"")}let Tl;function $n(t){Tl=t}const Ri=[],iu=[];let Gi=[];const nu=[],Gv=Promise.resolve();let da=!1;function Yv(){da||(da=!0,Gv.then(Th))}function ha(t){Gi.push(t)}const zo=new Set;let Pi=0;function Th(){if(Pi!==0)return;const t=Tl;do{try{for(;Pi<Ri.length;){const e=Ri[Pi];Pi++,$n(e),Xv(e.$$)}}catch(e){throw Ri.length=0,Pi=0,e}for($n(null),Ri.length=0,Pi=0;iu.length;)iu.pop()();for(let e=0;e<Gi.length;e+=1){const i=Gi[e];zo.has(i)||(zo.add(i),i())}Gi.length=0}while(Ri.length);for(;nu.length;)nu.pop()();da=!1,zo.clear(),$n(t)}function Xv(t){if(t.fragment!==null){t.update(),eo(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ha)}}function Jv(t){const e=[],i=[];Gi.forEach(n=>t.indexOf(n)===-1?e.push(n):i.push(n)),i.forEach(n=>n()),Gi=e}const Kv=new Set;function qv(t,e){t&&t.i&&(Kv.delete(t),t.i(e))}function ew(t,e,i,n){const{fragment:r,after_update:s}=t.$$;r&&r.m(e,i),n||ha(()=>{const o=t.$$.on_mount.map(Ch).filter(bh);t.$$.on_destroy?t.$$.on_destroy.push(...o):eo(o),t.$$.on_mount=[]}),s.forEach(ha)}function tw(t,e){const i=t.$$;i.fragment!==null&&(Jv(i.after_update),eo(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function iw(t,e){t.$$.dirty[0]===-1&&(Ri.push(t),Yv(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function nw(t,e,i,n,r,s,o,a=[-1]){const c=Tl;$n(t);const l=t.$$={fragment:null,ctx:[],props:s,update:er,not_equal:r,bound:tu(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:tu(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};o&&o(l.root);let u=!1;if(l.ctx=i?i(t,e.props||{},(d,f,...v)=>{const w=v.length?v[0]:f;return l.ctx&&r(l.ctx[d],l.ctx[d]=w)&&(!l.skip_bound&&l.bound[d]&&l.bound[d](w),u&&iw(t,d)),f}):[],l.update(),u=!0,eo(l.before_update),l.fragment=n?n(l.ctx):!1,e.target){if(e.hydrate){const d=Qv(e.target);l.fragment&&l.fragment.l(d),d.forEach(fr)}else l.fragment&&l.fragment.c();e.intro&&qv(t.$$.fragment),ew(t,e.target,e.anchor,e.customElement),Th()}$n(c)}class rw{$destroy(){tw(this,1),this.$destroy=er}$on(e,i){if(!bh(i))return er;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(i),()=>{const r=n.indexOf(i);r!==-1&&n.splice(r,1)}}$set(e){this.$$set&&!Zv(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ru(t){let e,i,n,r,s,o,a,c=t[18]&&su(t),l=t[19]&&ou(t);return{c(){e=Wt("div"),i=Wt("div"),c&&c.c(),n=ua(),r=Wt("span"),s=Al(t[1]),o=ua(),l&&l.c(),Se(r,"overflow","hidden"),Se(r,"white-space","nowrap"),Se(r,"text-overflow","ellipsis"),Se(r,"max-width","80px"),ue(i,"class",t[9]),Se(i,"background-color",t[3]),Se(i,"color",t[10]),Se(i,"opacity",t[12]),ue(e,"class",a="netless-window-manager-cursor-name "+t[16]+" "+t[15])},m(u,d){to(u,e,d),Et(e,i),c&&c.m(i,null),Et(i,n),Et(i,r),Et(r,s),Et(i,o),l&&l.m(i,null)},p(u,d){u[18]?c?c.p(u,d):(c=su(u),c.c(),c.m(i,n)):c&&(c.d(1),c=null),d&2&&Ah(s,u[1]),u[19]?l?l.p(u,d):(l=ou(u),l.c(),l.m(i,null)):l&&(l.d(1),l=null),d&512&&ue(i,"class",u[9]),d&8&&Se(i,"background-color",u[3]),d&1024&&Se(i,"color",u[10]),d&4096&&Se(i,"opacity",u[12]),d&98304&&a!==(a="netless-window-manager-cursor-name "+u[16]+" "+u[15])&&ue(e,"class",a)},d(u){u&&fr(e),c&&c.d(),l&&l.d()}}}function su(t){let e,i;return{c(){e=Wt("img"),ue(e,"class","netless-window-manager-cursor-selector-avatar"),ue(e,"style",t[20]()),ys(e.src,i=t[8])||ue(e,"src",i),ue(e,"alt","avatar")},m(n,r){to(n,e,r)},p(n,r){r&256&&!ys(e.src,i=n[8])&&ue(e,"src",i)},d(n){n&&fr(e)}}}function ou(t){let e,i;return{c(){e=Wt("span"),i=Al(t[2]),ue(e,"class","netless-window-manager-cursor-tag-name"),Se(e,"background-color",t[11])},m(n,r){to(n,e,r),Et(e,i)},p(n,r){r&4&&Ah(i,n[2]),r&2048&&Se(e,"background-color",n[11])},d(n){n&&fr(e)}}}function sw(t){let e,i,n,r,s,o,a,c=!t[14]&&ru(t);return{c(){e=Wt("div"),c&&c.c(),i=ua(),n=Wt("div"),r=Wt("img"),ue(r,"class",s="netless-window-manager-cursor-"+t[4]+"-image "+t[15]),ys(r.src,o=t[7])||ue(r,"src",o),ue(r,"alt",t[4]),ue(n,"class","cursor-image-wrapper"),ue(e,"class",a="netless-window-manager-cursor-mid"+(t[13]?" netless-window-manager-cursor-custom":"")),Se(e,"transform","translateX("+t[5]+"px) translateY("+t[6]+"px)"),Se(e,"display",t[17]),ue(e,"data-cursor-uid",t[0])},m(l,u){to(l,e,u),c&&c.m(e,null),Et(e,i),Et(e,n),Et(n,r)},p(l,[u]){l[14]?c&&(c.d(1),c=null):c?c.p(l,u):(c=ru(l),c.c(),c.m(e,i)),u&32784&&s!==(s="netless-window-manager-cursor-"+l[4]+"-image "+l[15])&&ue(r,"class",s),u&128&&!ys(r.src,o=l[7])&&ue(r,"src",o),u&16&&ue(r,"alt",l[4]),u&8192&&a!==(a="netless-window-manager-cursor-mid"+(l[13]?" netless-window-manager-cursor-custom":""))&&ue(e,"class",a),u&96&&Se(e,"transform","translateX("+l[5]+"px) translateY("+l[6]+"px)"),u&131072&&Se(e,"display",l[17]),u&1&&ue(e,"data-cursor-uid",l[0])},i:er,o:er,d(l){l&&fr(e),c&&c.d()}}}function ow(t,e,i){let n,r,s,o,a,c,l,u,{uid:d}=e,{cursorName:f}=e,{tagName:v}=e,{backgroundColor:w}=e,{appliance:x}=e,{x:h}=e,{y:p}=e,{src:g}=e,{visible:m}=e,{avatar:y}=e,{theme:M}=e,{color:E}=e,{cursorTagBackgroundColor:z}=e,{opacity:P}=e,{pencilEraserSize:L}=e,{custom:S}=e;const N=()=>Object.entries({width:(n?19:28)+"px",height:(n?19:28)+"px",position:n?"initial":"absolute","border-color":n?"white":w,"margin-right":(n?4:0)+"px"}).map(([I,U])=>`${I}: ${U}`).join(";");return t.$$set=I=>{"uid"in I&&i(0,d=I.uid),"cursorName"in I&&i(1,f=I.cursorName),"tagName"in I&&i(2,v=I.tagName),"backgroundColor"in I&&i(3,w=I.backgroundColor),"appliance"in I&&i(4,x=I.appliance),"x"in I&&i(5,h=I.x),"y"in I&&i(6,p=I.y),"src"in I&&i(7,g=I.src),"visible"in I&&i(21,m=I.visible),"avatar"in I&&i(8,y=I.avatar),"theme"in I&&i(9,M=I.theme),"color"in I&&i(10,E=I.color),"cursorTagBackgroundColor"in I&&i(11,z=I.cursorTagBackgroundColor),"opacity"in I&&i(12,P=I.opacity),"pencilEraserSize"in I&&i(22,L=I.pencilEraserSize),"custom"in I&&i(13,S=I.custom)},t.$$.update=()=>{t.$$.dirty&2&&(n=!b.isEmpty(f)),t.$$.dirty&4&&i(19,r=!b.isEmpty(v)),t.$$.dirty&256&&i(18,s=!b.isEmpty(y)),t.$$.dirty&2097152&&i(17,o=m?"":"none"),t.$$.dirty&16&&i(14,a=x===T.ApplianceNames.laserPointer),t.$$.dirty&16400&&i(23,c=a||x===T.ApplianceNames.pencilEraser),t.$$.dirty&8388608&&i(16,l=c?"netless-window-manager-laserPointer-pencilEraser-offset":""),t.$$.dirty&4194304&&i(15,u=L===3?"netless-window-manager-pencilEraser-3-offset":"")},[d,f,v,w,x,h,p,g,y,M,E,z,P,S,a,u,l,o,s,r,N,m,L,c]}class aw extends rw{constructor(e){super(),nw(this,e,ow,sw,Fv,{uid:0,cursorName:1,tagName:2,backgroundColor:3,appliance:4,x:5,y:6,src:7,visible:21,avatar:8,theme:9,color:10,cursorTagBackgroundColor:11,opacity:12,pencilEraserSize:22,custom:13})}}const Eh="data:image/svg+xml,%3Csvg width='24' height='24' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Ccircle cx='12' cy='12' r='2.5' stroke='%23000' stroke-linejoin='square'/%3E%3Ccircle cx='12' cy='12' r='3.5' stroke='%23FFF'/%3E%3C/g%3E%3C/svg%3E";function Nh(t){return`data:image/svg+xml,%3Csvg width='24' height='24' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Ccircle cx='12' cy='12' r='2.5' stroke='%23${t}' stroke-linejoin='square'/%3E%3Ccircle cx='12' cy='12' r='3.5' stroke='%23${t}'/%3E%3C/g%3E%3C/svg%3E`}function _i(t){return`data:image/svg+xml,%3Csvg width='24' height='24' xmlns='http://www.w3.org/2000/svg' fill='none'%3E%3Cpath d='M5 12H19' stroke='%23${t}' stroke-linejoin='round'/%3E%3Cpath d='M12 5V19' stroke='%23${t}' stroke-linejoin='round'/%3E%3C/svg%3E`}function ri(t){return`url("${t}") 12 12, auto`}function lw(t){let e="";for(const i in t)e+=`.netless-whiteboard.${i} {cursor: ${t[i]}}
`;return e}const Dr=document.createElement("style");function cw(t){const[e,i,n]=t.strokeColor,r=((1<<24)+(e<<16)+(i<<8)+n).toString(16).slice(1);return Dr.textContent=lw({"cursor-pencil":ri(Nh(r)),"cursor-eraser":ri(Eh),"cursor-rectangle":ri(_i(r)),"cursor-ellipse":ri(_i(r)),"cursor-straight":ri(_i(r)),"cursor-arrow":ri(_i(r)),"cursor-shape":ri(_i(r))}),document.head.appendChild(Dr),()=>{Dr.parentNode!=null&&document.head.removeChild(Dr)}}const uw=new Set([T.ApplianceNames.rectangle,T.ApplianceNames.ellipse,T.ApplianceNames.straight,T.ApplianceNames.arrow,T.ApplianceNames.shape]);function au(t,e){if(t===T.ApplianceNames.pencil)return Nh(e);if(t===T.ApplianceNames.eraser)return Eh;if(uw.has(t))return _i(e)}class dw{constructor(e,i,n,r){this.manager=e,this.memberId=i,this.cursorManager=n,this.wrapper=r,this.style="default",this.move=s=>{var o;if(s.type==="main"){const a=this.cursorManager.wrapperRect;this.component&&a&&(this.autoHidden(),this.moveCursor(s,a,this.manager.mainView))}else{const a=this.cursorManager.focusView,c=(o=a==null?void 0:a.divElement)==null?void 0:o.getBoundingClientRect(),l=a==null?void 0:a.camera;a&&c&&l&&this.component&&(this.autoHidden(),this.moveCursor(s,c,a))}},this.setStyle=s=>{this.style=s,this.component&&this.component.$set({src:this.getIcon(),custom:this.isCustomIcon()})},this.leave=()=>{this.hide()},this.updateMember(),this.createCursor(),this.autoHidden(),this.setStyle(n.style)}moveCursor(e,i,n){var c,l;const{x:r,y:s,type:o}=e,a=n==null?void 0:n.screen.convertPointToScreen(r,s);if(a){let u=a.x-2,d=a.y-18;if(this.isCustomIcon()&&(u-=11,d+=4),o==="app"){const f=this.cursorManager.wrapperRect;f&&(u=u+i.x-f.x,d=d+i.y-f.y)}a.x<0||a.x>i.width||a.y<0||a.y>i.height?(c=this.component)==null||c.$set({visible:!1,x:u,y:d}):(l=this.component)==null||l.$set({visible:!0,x:u,y:d})}}get memberApplianceName(){var e,i;return(i=(e=this.member)==null?void 0:e.memberState)==null?void 0:i.currentApplianceName}get memberColor(){var i,n;return`rgb(${(n=(i=this.member)==null?void 0:i.memberState)==null?void 0:n.strokeColor.join(",")})`}get memberColorHex(){var r,s;const[e,i,n]=((s=(r=this.member)==null?void 0:r.memberState)==null?void 0:s.strokeColor)||[236,52,85];return((1<<24)+(e<<16)+(i<<8)+n).toString(16).slice(1)}get payload(){var e;return(e=this.member)==null?void 0:e.payload}get memberCursorName(){var e,i;return((e=this.payload)==null?void 0:e.nickName)||((i=this.payload)==null?void 0:i.cursorName)||this.memberId}get memberTheme(){var e;return(e=this.payload)!=null&&e.theme?"netless-window-manager-cursor-inner-mellow":"netless-window-manager-cursor-inner"}get memberCursorTextColor(){var e;return((e=this.payload)==null?void 0:e.cursorTextColor)||"#FFFFFF"}get memberCursorTagBackgroundColor(){var e;return((e=this.payload)==null?void 0:e.cursorTagBackgroundColor)||this.memberColor}get memberAvatar(){var e;return(e=this.payload)==null?void 0:e.avatar}get memberOpacity(){return!this.memberCursorName&&!this.memberAvatar?0:1}get memberTagName(){var e;return(e=this.payload)==null?void 0:e.cursorTagName}autoHidden(){this.timer&&clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.hide()},1e3*10)}async createCursor(){this.member&&this.wrapper&&(this.component=new aw({target:this.wrapper,props:this.initProps()}))}initProps(){var e;return{uid:this.memberId,x:0,y:0,appliance:this.memberApplianceName,avatar:this.memberAvatar,src:this.getIcon(),custom:this.isCustomIcon(),visible:!1,backgroundColor:this.memberColor,cursorName:this.memberCursorName,theme:this.memberTheme,color:this.memberCursorTextColor,cursorTagBackgroundColor:this.memberCursorTagBackgroundColor,opacity:this.memberOpacity,tagName:this.memberTagName,pencilEraserSize:(e=this.member)==null?void 0:e.memberState.pencilEraserSize}}getIcon(){var c;if(!this.member)return;const{memberApplianceName:e,memberColorHex:i}=this,{userApplianceIcons:n,applianceIcons:r}=this.cursorManager;let s=this.memberApplianceName;s===T.ApplianceNames.pencilEraser&&(s=`${s}${((c=this.member)==null?void 0:c.memberState.pencilEraserSize)||1}`);const o=s&&n[s];if(o)return o;if(this.style==="custom"&&e){const l=au(e,i);if(l)return l}return r[s||T.ApplianceNames.shape]||r[T.ApplianceNames.shape]}isCustomIcon(){var o;if(!this.member)return!1;const{memberApplianceName:e,memberColorHex:i}=this,{userApplianceIcons:n}=this.cursorManager;let r=this.memberApplianceName;return r===T.ApplianceNames.pencilEraser&&(r=`${r}${((o=this.member)==null?void 0:o.memberState.pencilEraserSize)||1}`),r&&n[r]?!1:!!(this.style==="custom"&&e&&au(e,i))}updateMember(){return this.member=ws(this.manager.room,this.memberId),this.updateComponent(),this.member}updateComponent(){var e;(e=this.component)==null||e.$set(b.omit(this.initProps(),["x","y"]))}destroy(){this.component&&this.component.$destroy(),this.cursorManager.cursorInstances.delete(this.memberId),this.timer&&clearTimeout(this.timer)}hide(){this.component&&(this.component.$set({visible:!1}),this.destroy())}}var hw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQYSURBVHgB7ZhLbBNHHMa/WSdOE1riNBCpiG3TSH2dsFSqNqYqOfSCRFT30qoKVZxTr0GqgKN9KhyqGIRAgYMjJN4SDwkQUi4ICSkHUMxDoEg8AgEHQogdB7N2dr3DzC42sbNebxI/VsKftJqZ/39n5/ftzOyuFqippg9bBFUW3bWrC5T+xqouVj6GIAyR3bvHrfavqgG6Y8cAK/rR0gLtePhQTxASJHv2bLdyjaoZoDt3htDQ4ENvL9DRoQejUWBwUC8JGWIm+opdR0AV9OK/fSG2XHzYuFGHHx4GjhzRk93desnymskiqvgM/D9CQ05Z8v1xdRBts5PAunVAJKIn+TKSJCCZfN8hlRoie/cWnImKGuDwFPDxeoMsIWvCTKoKTE4OkaNHDU1UbAldu3EwC8+Vqm/EqV/+wVTzZ+YdBYbocPhoT8+AYRoVEL21IeSpO+DrrD+YE7dsghC+J/rptm1d+amyG+DwoKqP1z3OQ+hsOZ2TL2oinQZkWa+rqjc/XVYDC+EhOIC2DnjazqOz9UzOeaYm4vGFreb8dNkMGMHD2ag1PWvOWJsJDp9ILDxtNn8cB8ogM3hN7Mkivr7ISgVP1R+y4bSjHmPiBrS/GMOql5H8u8/7/RW4cyeGchqwAo+pB8C8BFG4rj3I803caPkKX96/jtXJHAMBcvz4ufzxSmpgKfAZiZ+wdmMznkrfae14QsKMpGD08+/x7fN7GRMBcuyY32jMkhlYDjxWsTdvqwix6Z7WvDvdjvhrPa+wmeAmvnj1KNB6eL+/0LglMbAS+Ixc0ycx9/IZJvBzNqYQR6Bn+1a/2dgrNlAK+Lknt9hxGyK5pn3baCZUNRD8fa2/2PgrMlBK+Iy4CUoR+Nfr9cOClv0xVw54rRvbsGI3/LCoZRmwCzzXkg3YCZ5rSQbsBs9l2YAd4bksGbArPFdRA3aG15BgCr9pwM7wGpZZUqG9/fyHmV3huQouofnRs24iyKNADHVrr7IvRgq7wXMVngGH7NYrLijRX9l0NL2jsA88l1A4IWzONhi8MrWJQTfYCl7nLCBKqTsnwE08/0k3kVGV4blMNnGeAU1sOeFvrbQDPJehAXn0dFfhLu9MNH+TjVQLnsvQAHveuM27ufQ9wZZVNeG5DA2MTdHNBXtQFVROQJ2TkBpbj8TERE66kvBcdUbB4bty+6zkwI/tjFeR2JEETafYBn7D+OWcc1d/1Id4MgSVxioOz7XoReb19rs+bVsTnZmZg9dN8GdnY9GLpGk0FksGA+u3IogKa9EMJBW4I5FprX5iRI8tNMH2R4wQEqYqvUkIDWMeVz7eEhxHlbTIAPuT7aY0W4+dGEmGxVbhpudrpwbbtMU/DhvJaA+Ms8XcJzgRvnQuGOaByxdQU0012VRvAXMqptxy2zoQAAAAAElFTkSuQmCC",pw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAxCAYAAABznEEcAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAZoSURBVHgB7VlLSCRXFL3ljNEhEXTGhMQJmOjCz8ZNVLKICz9xIYhCNi7UgINkGEk2En8hW5cBUQNxo05GAoKikuCAmvGzGMdPcCUGjDPxD/4Vv/3JvWW97luvq7ur+hMZ8MKlqrteNfe8e965970GuLVbC5kpJr53+hjHx9yY3TUxJgLMAQG4ITARfp5T4Mri4uL9q6urnxwOxz/oY5eXl1/Pzs7e195X2FX4jZsIhAK7gx5ps9m6nGj9/f3OtbU1pzAE0318fPwVjYHrrN7R3AjU/wpOBwA9Cmf/9ejoqDMtLU31iooKGdA+ATo4OMiXAEWAHhBAGEApXj4rPAik0vPt7e0vCgoKPH4gMzMTSktLIS8vD2JiYgABvcHMTZyennbHxsaOg3udOJmLzwqEYB0ZgRCZENm4u7e39yQuLq65srISZmZmvP5Ybm4u5OfnQ0lJyXWUCAgzNLS+vt6SnJz8WgvYwV5xSlcRgyVg3ha2Dkxzc3MvfZmVlQW+bGxsDBobGyE7O1u94uJPjIqKqklKSvrbbrfPnp+ff7e8vJwMnlSTKWfJjDKhywJo6wLp0YcZ+dyIUr7s4cOHLsrRlQwBTSBFuzc2NiZYhjjVAIyzZBqEwgCQv0OOM/gNzuiP/ijlDxBRjgClpqa6AF1cXDydmpoaLCws3JcAGYHyC4JMzoKaibKysvienp6FtrY2IA/WCFB5ebkqCHSvARo8Ozt7igIxwIJ2gJ+seFMnDoIyEUV+dHT0G3qWVUr5M043DdAB0m2IKZwAYpgZX+qkywR6NFbuR0iDxmAoZRUQKRxSLTMnJ8eIaqqSeVMnIYUOdu+sq6vrp4f+VCoYo8khZaNs01VRlERUu2/BrWAA7sl2Anink1Ao18JGjyY/PDx8hq1GZqgp5c2mp6chMjLy2b179x7hRzvoqeUUwXIzqq4O5nZsNUaEbIbLqPLTou/s7FTvT05OpsA9sXJG1AVsZDwjutqBIN6gUlWjxod8XRBNKXgsrqpqYZfwEqX9h8TExD7wbFm8LmzxHQ0QHSlXKZVSqFC/hkqlaKapTaGgCQTK7PHW1lb/wsLC86KiokkccoV+qV1tcE0pO7AWxmhTxBszDzqRr66ujqanp2cRpQLNBgUsCh8BwQ54bn5+/s+mpqa+4eHhfS1gb52vwuP0trPjhSZCBtLQ0NA3MDDQQIFYAUHBYhuvzjpVbJr1lZWVP3p7e19UVVXNgHumXYrI4uBx6Yqevz02b0FcRQ8CoBQF3dXVpQLZ3d39C7n+ora29vfJyclDYFnWgFyxK3cxhss/+KoT/N6DVkQpKypFGUCp3Ozo6HgSHx//GLW/BwHsg57zl5pzADajwLn52mPL1ZHPloMoRYPMFL6EhAR18e7s7MxVV1fPsAAp4Avteq7dC/c1+wKI4g+EfGzDM+EYHBw8RDrNiA2QL6upqVGvKJ2/gHu2L1nA5wwEB2YDfSYMO1x/px0cgEc2zBY+eo67u6H29vZ/wU2VC8l58JxKNjDOgojNEp08aFVfX++3l6JMEdDx8fEB0FNIBsDXBc8ArwuW1EkeI1RKdLWmCx+1DhkZGRvR0dFfSsHKxYtnW0iqvJAN9xNm6MR/QO5sfapUSkqKmqW5ubmfwVgyZdpw/vPZl2kUEAinBMSUStG+gwra0NDQSynQKyloIxnlewafjDFLJzLRBJqiFMnqyMgIbG5uDuD996Dnv8iAPOMAPmbcm5lVJwA/vZRMKZGZlpaWVtAvUL4GZMqE1fjRJrUd76LHoX+InlhcXPwZnWW2tra6jjrpiBM3UK/weQr6J+gfodMh9HtwncG7YLA3CMSsLmxx5WuDCt8B7vZeicInTjCWlpb6wc15mfey7oc9E8LElpVmMgb9AXoC+qcTExOPKRu4NlTHs6Q10GfhgfYOvRsJQZ76BWMKuDtaolQs+gfoH6Mn436gDg+e+5BKXUQx/C5Je/a+NpbeiQJPKgUdlNXx/BCBKxVdxW5Q0I3XBqFKRhU4KLtjYawi3csuTKdc4FnIXNvKUJkVEGRG20QZAAUpA5DbaYAQLmQzfzxyk/ffdnCD4NWVnGdE7kQBQvQHC5lVEDxgMaM29lkxGCNLKrDnIbFAMkFmBIaDkHstU41coGZ1TZD5UjReCGUAYbNgdNqoXZB/T67yYbFAMiGML3BhYeH8rb0t9h/zgcTBcTNGiQAAAABJRU5ErkJggg==",fw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0CAYAAADFeBvrAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAgrSURBVHgB7ZprTBRXFIDP7gIt8lQppTwE5V0KaAn6o1pqNGkDDTEmTUhsgKRp+gNJw68CFkLbVC2QkDS+gD8KJdWmARvbFBNNWpuIRGPFWBXQRMPDqIki+KLATs+ZnTvcvXtnX8w2beJJToaduTP3fHPOPffcOwC8kP+2WCDwIvahGFxTuN8KmNSZmULPNjLeqF9F8rdPkIEGEn+r+vjx46LQ0NA8/Dsader58+e/h4WFDWntFO7ot6fMFAt3JLWi2lCDpqamCux2+2+KROj82NhYGrXT2lu5Z/DP/deFByElA4Pv3LlTiHY/nJ6eVnbv3q1s2bJFyc7OVrZu3arU1dUp4+PjxPUQoT+g9tp9PkMFgpo9kxljHRoaWp2Xl3duYmIiurKyEvDoclNCQgIcPnxYPc7MzHwcGRnZhaft4Ag7O9fUbRhaITCie4lgcnNzT7qDIaHz27dvh+vXr0NEREQneqoCHKFnAR+8ZCaQGGq2CxcurCGYycnJZHcwTNAzUFFRoUJFRUV1IFQ5OKBsXB9uxSwgl0TQ3d29Yt26dccwoyVXV1d7hGEiQmGi2AzOUHx/hob4K2yuYS9G987s7OwPISEh7xPM6dOnwVfBsIMjR45AZmbmo5s3b76Xnp7+J55egMVxBSAZT0v1ED+76yn66dOnLQSzd+9ev2BIyFP0MjBco1JTU/sxfFeDazp3cYgZHmKqdoaGNISHh9fv378fSJcqlPV6e3sBJ+I/goOD34VFL0k95Y+HxPHCYGxmw5DQ2NuzZw8EBQVtunXr1jvgwUP+hhz/QDXMMCNVE8zx48dNg2FCz6QQjI2N/RA8VBFmANnu3btXihnpG8pM9fX1EAi5du0aeWkVOAMBCF7yN+R0z4yOjq6NiYlpp9CgdBtIwXpPH6vgDKWLt0CygtM6MDCwBuUYZSKaOCksAiVY9wFOBePgDOOytPAGSKzNVCCC2bBhw69YdK7ypgpYimzbtk2dl7CM+hFcveOUHDylbTFO1YdhFbByx44dA1QFUP0VSJj4+Hjo6+sDq9U6iEmHKvFZTedQ50GYbN15SITVlwNlZWUnLRZL8s6dOwMOQ9UCTtKTra2ttdppt9V2kMF5cbmsjxuM43bMNrmUzc6fP6+GQiDGDoOJi4ubwb4qm5ubafyIE6nLxGqTPEsGo1cBOGNX0TyDYafC0CyOaxcVziyh53Z2dkJycvLMvn37PmpoaBgFR4jxYSbWdVIgI89Iq4CjR48CZjlYv369+tssqI6ODsjPz4f+/v668vLycxrEHHfkYdwC8SB6mGEV8Cl64cuuri5oa2tTG+EyGjZu3AiXLl1qefDgwV8lJSUFZkDV1tZCcXExXLx4sbWoqKgPFj0zx8GI9ZwO5W4M6ekZYeqpaqbqmaSqqkpNpcPDw4dwzfM9nrLduHEjEs+X0XV/Sx96LnqE1kLtBQUF3eDwCO8dGQyzV5rl+JyuegfXI29jRotiRlKnpFghHMzKyjqotVXS0tLacKPjF3bdHxjSq1evduAkepAD+ZsDYlC8V5w8ZBVg+PPq2MGMlkInqE4joTf45MmT4YyMjAPcA+ltLSQlJX2BafxnX6HI29QeK44TOTk57mCYZ0QoJ8OBM4yB6dkNkwGlSygsLFQvYtYB3BTMxFL+M+0eFgZqp4mJiU2+QKGX1fGIk/QIrn0aYXGsyDxjmAyMhO2jhaCGoUbX1NSkLSwsPMJqV8Fspu6lIZS6OYhjiOLwdU7fQM1HfRPD7wS1obZ0j0xpb4726Z49ezaJf2/S7s9ATUGNR41BjdJseRnke3WGwhrRTS9pD1mOGoeG15BxOOfoxuCkp0Ih6NeaEaSZGlieJyiCoc1FgsGldokGk8nBvAKOrWIGQ5uPsm0tt0BWDiicAaGuGhkZ+YqMw9StGzU4OKhCnT179hNsswY1FTXdE5QEJhc1S3tGogazXLOBwQSBl3tzIhQPtAL1VQJCTcNx8y1vHIUghSKFZE9PT7H2dlM1b+Wgrr1y5Uq77J75+fnplpaWMg2ch4nlYEI5z7hdensDpI4hrYNErcMMXJ32koG4ztf3pultz83NjWG99Ra2WQ0OL2VjZjwgeufUqVOqV8+cOdPIwdBLSNJeHg8TAh5WqJ6EfSmgt7IMNRJ1JThiOlnrOAMHshprmMKdoGSCpb9s3B3SYLIFGIqICJB7xisYi+RvfiypXw40DWGdlJaWRmMd141hk8V2OWm7ieYTXhBc3+BgaZyqAISjOYxSMVvXsBTNlzdiNQDgRao2AtK3pjggpmrqbGpqSsLPIN/dv38/gaBwUjTshMHcvn27JyUlpRmc5xpPMD599LIYnLNyUKKndKjGxsakXbt2deMCLIE8IVvs0YRM1fjdu3d/wrXN5+BcnzEgvor2uN3rjzAYMp5lPEoQlE5fA0fWo8GfhlCbKVFQ1pKNIfzcOHH58mWqaimVUwJI0+6n59D4pIlzmdZPMPiZzXjDjX47Le5g0Uu8x2zgPqWyKpjVe7x3+AUbq9NYjQbgp2dsBud5o8TP7d5kHAWcQchQfoEmLgn8HjOiBIF7o5hI1x6CEbLNP3bdqYAF44JzyWLzcN1i8DcT/o3awbm8Fz3DAy2A62INwPV/E3wWdx5inmBHuwChCBD6R2JwHge80TIQRQLjt7e8DTkGZgfX8cUMZTDAteFDkveaIlzjX9ySQs8X18r2t2VHUURPKoICmDR+eCO9aSdmOIub3/w9RgpgUpiJhvraXpa6jZKHGEqyusw0GLFzX+5RhN/8kYnMSNMMfyH/V/kHST6OYVElTPAAAAAASUVORK5CYII=",gw="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDBweCIgaGVpZ2h0PSI0MHB4IiB2aWV3Qm94PSIwIDAgNDAgNDAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYwLjEgKDg4MTMzKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5zaGFwZS1jdXJzb3I8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBkPSJNMjAsMjEuNSBDMjAuMjQ1NDU5OSwyMS41IDIwLjQ0OTYwODQsMjEuNjc2ODc1MiAyMC40OTE5NDQzLDIxLjkxMDEyNDQgTDIwLjUsMjIgTDIwLjUsMjcgQzIwLjUsMjcuMjc2MTQyNCAyMC4yNzYxNDI0LDI3LjUgMjAsMjcuNSBDMTkuNzU0NTQwMSwyNy41IDE5LjU1MDM5MTYsMjcuMzIzMTI0OCAxOS41MDgwNTU3LDI3LjA4OTg3NTYgTDE5LjUsMjcgTDE5LjUsMjIgQzE5LjUsMjEuNzIzODU3NiAxOS43MjM4NTc2LDIxLjUgMjAsMjEuNSBaIE0yNywxOS41IEMyNy4yNzYxNDI0LDE5LjUgMjcuNSwxOS43MjM4NTc2IDI3LjUsMjAgQzI3LjUsMjAuMjQ1NDU5OSAyNy4zMjMxMjQ4LDIwLjQ0OTYwODQgMjcuMDg5ODc1NiwyMC40OTE5NDQzIEwyNywyMC41IEwyMiwyMC41IEMyMS43MjM4NTc2LDIwLjUgMjEuNSwyMC4yNzYxNDI0IDIxLjUsMjAgQzIxLjUsMTkuNzU0NTQwMSAyMS42NzY4NzUyLDE5LjU1MDM5MTYgMjEuOTEwMTI0NCwxOS41MDgwNTU3IEwyMiwxOS41IEwyNywxOS41IFogTTE4LDE5LjUgQzE4LjI3NjE0MjQsMTkuNSAxOC41LDE5LjcyMzg1NzYgMTguNSwyMCBDMTguNSwyMC4yNDU0NTk5IDE4LjMyMzEyNDgsMjAuNDQ5NjA4NCAxOC4wODk4NzU2LDIwLjQ5MTk0NDMgTDE4LDIwLjUgTDEzLDIwLjUgQzEyLjcyMzg1NzYsMjAuNSAxMi41LDIwLjI3NjE0MjQgMTIuNSwyMCBDMTIuNSwxOS43NTQ1NDAxIDEyLjY3Njg3NTIsMTkuNTUwMzkxNiAxMi45MTAxMjQ0LDE5LjUwODA1NTcgTDEzLDE5LjUgTDE4LDE5LjUgWiBNMjAsMTIuNSBDMjAuMjQ1NDU5OSwxMi41IDIwLjQ0OTYwODQsMTIuNjc2ODc1MiAyMC40OTE5NDQzLDEyLjkxMDEyNDQgTDIwLjUsMTMgTDIwLjUsMTggQzIwLjUsMTguMjc2MTQyNCAyMC4yNzYxNDI0LDE4LjUgMjAsMTguNSBDMTkuNzU0NTQwMSwxOC41IDE5LjU1MDM5MTYsMTguMzIzMTI0OCAxOS41MDgwNTU3LDE4LjA4OTg3NTYgTDE5LjUsMTggTDE5LjUsMTMgQzE5LjUsMTIuNzIzODU3NiAxOS43MjM4NTc2LDEyLjUgMjAsMTIuNSBaIiBpZD0icGF0aC0xIj48L3BhdGg+CiAgICAgICAgPGZpbHRlciB4PSItNjQuNiUiIHk9Ii01OS41JSIgd2lkdGg9IjIyOS4zJSIgaGVpZ2h0PSIyNDYuMSUiIGZpbHRlclVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgaWQ9ImZpbHRlci0yIj4KICAgICAgICAgICAgPGZlTW9ycGhvbG9neSByYWRpdXM9IjEiIG9wZXJhdG9yPSJkaWxhdGUiIGluPSJTb3VyY2VBbHBoYSIgcmVzdWx0PSJzaGFkb3dTcHJlYWRPdXRlcjEiPjwvZmVNb3JwaG9sb2d5PgogICAgICAgICAgICA8ZmVPZmZzZXQgZHg9IjAiIGR5PSIyIiBpbj0ic2hhZG93U3ByZWFkT3V0ZXIxIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMSI+PC9mZU9mZnNldD4KICAgICAgICAgICAgPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMyIgaW49InNoYWRvd09mZnNldE91dGVyMSIgcmVzdWx0PSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlR2F1c3NpYW5CbHVyPgogICAgICAgICAgICA8ZmVDb21wb3NpdGUgaW49InNoYWRvd0JsdXJPdXRlcjEiIGluMj0iU291cmNlQWxwaGEiIG9wZXJhdG9yPSJvdXQiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUNvbXBvc2l0ZT4KICAgICAgICAgICAgPGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAgICAwIDAgMCAwIDAgICAwIDAgMCAwIDAgIDAgMCAwIDAuMTYgMCIgdHlwZT0ibWF0cml4IiBpbj0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUNvbG9yTWF0cml4PgogICAgICAgIDwvZmlsdGVyPgogICAgPC9kZWZzPgogICAgPGcgaWQ9Iumhtemdoi00IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iV2hpdGVib2FyZC1HdWlkZWxpbmVzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzQ0LjAwMDAwMCwgLTc1MS4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9InNoYXBlLWN1cnNvciIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQ0LjAwMDAwMCwgNzUxLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9ouWkh+S7vS00NCIgZmlsbD0iI0ZGRkZGRiIgb3BhY2l0eT0iMC4wMSIgeD0iMCIgeT0iMCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiByeD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPGcgaWQ9IuW9oueKtue7k+WQiCIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgICAgICA8dXNlIGZpbGw9ImJsYWNrIiBmaWxsLW9wYWNpdHk9IjEiIGZpbHRlcj0idXJsKCNmaWx0ZXItMikiIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIHN0cm9rZT0iI0ZGRkZGRiIgc3Ryb2tlLXdpZHRoPSIxIiBkPSJNMjAsMjEgQzIwLjQ4NTQxMDMsMjEgMjAuODk4MDg1LDIxLjM0Nzk5OTMgMjAuOTg5OTQ3OSwyMS44NjU0ODc3IEwyMSwyMiBMMjEsMjcgQzIxLDI3LjU1MjI4NDcgMjAuNTUyMjg0NywyOCAyMCwyOCBDMTkuNTE0NTg5NywyOCAxOS4xMDE5MTUsMjcuNjUyMDAwNyAxOS4wMTAwNTIxLDI3LjEzNDUxMjMgTDE5LDI3IEwxOSwyMiBDMTksMjEuNDQ3NzE1MyAxOS40NDc3MTUzLDIxIDIwLDIxIFogTTI3LDE5IEMyNy41NTIyODQ3LDE5IDI4LDE5LjQ0NzcxNTMgMjgsMjAgQzI4LDIwLjQ4NTQxMDMgMjcuNjUyMDAwNywyMC44OTgwODUgMjcuMTM0NTEyMywyMC45ODk5NDc5IEwyNywyMSBMMjIsMjEgQzIxLjQ0NzcxNTMsMjEgMjEsMjAuNTUyMjg0NyAyMSwyMCBDMjEsMTkuNTE0NTg5NyAyMS4zNDc5OTkzLDE5LjEwMTkxNSAyMS44NjU0ODc3LDE5LjAxMDA1MjEgTDIyLDE5IEwyNywxOSBaIE0xOCwxOSBDMTguNTUyMjg0NywxOSAxOSwxOS40NDc3MTUzIDE5LDIwIEMxOSwyMC40ODU0MTAzIDE4LjY1MjAwMDcsMjAuODk4MDg1IDE4LjEzNDUxMjMsMjAuOTg5OTQ3OSBMMTgsMjEgTDEzLDIxIEMxMi40NDc3MTUzLDIxIDEyLDIwLjU1MjI4NDcgMTIsMjAgQzEyLDE5LjUxNDU4OTcgMTIuMzQ3OTk5MywxOS4xMDE5MTUgMTIuODY1NDg3NywxOS4wMTAwNTIxIEwxMywxOSBMMTgsMTkgWiBNMjAsMTIgQzIwLjQ4NTQxMDMsMTIgMjAuODk4MDg1LDEyLjM0Nzk5OTMgMjAuOTg5OTQ3OSwxMi44NjU0ODc3IEwyMSwxMyBMMjEsMTggQzIxLDE4LjU1MjI4NDcgMjAuNTUyMjg0NywxOSAyMCwxOSBDMTkuNTE0NTg5NywxOSAxOS4xMDE5MTUsMTguNjUyMDAwNyAxOS4wMTAwNTIxLDE4LjEzNDUxMjMgTDE5LDE4IEwxOSwxMyBDMTksMTIuNDQ3NzE1MyAxOS40NDc3MTUzLDEyIDIwLDEyIFoiIGZpbGw9IiMyMTIzMjQiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMTguNSIgeT0iMTciIHdpZHRoPSIzIiBoZWlnaHQ9IjYiPjwvcmVjdD4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjE3IiB5PSIxOC41IiB3aWR0aD0iNiIgaGVpZ2h0PSIzIj48L3JlY3Q+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMjAsMjEuNSBDMjAuMjQ1NDU5OSwyMS41IDIwLjQ0OTYwODQsMjEuNjc2ODc1MiAyMC40OTE5NDQzLDIxLjkxMDEyNDQgTDIwLjUsMjIgTDIwLjUsMjcgQzIwLjUsMjcuMjc2MTQyNCAyMC4yNzYxNDI0LDI3LjUgMjAsMjcuNSBDMTkuNzU0NTQwMSwyNy41IDE5LjU1MDM5MTYsMjcuMzIzMTI0OCAxOS41MDgwNTU3LDI3LjA4OTg3NTYgTDE5LjUsMjcgTDE5LjUsMjIgQzE5LjUsMjEuNzIzODU3NiAxOS43MjM4NTc2LDIxLjUgMjAsMjEuNSBaIE0yNywxOS41IEMyNy4yNzYxNDI0LDE5LjUgMjcuNSwxOS43MjM4NTc2IDI3LjUsMjAgQzI3LjUsMjAuMjQ1NDU5OSAyNy4zMjMxMjQ4LDIwLjQ0OTYwODQgMjcuMDg5ODc1NiwyMC40OTE5NDQzIEwyNywyMC41IEwyMiwyMC41IEMyMS43MjM4NTc2LDIwLjUgMjEuNSwyMC4yNzYxNDI0IDIxLjUsMjAgQzIxLjUsMTkuNzU0NTQwMSAyMS42NzY4NzUyLDE5LjU1MDM5MTYgMjEuOTEwMTI0NCwxOS41MDgwNTU3IEwyMiwxOS41IEwyNywxOS41IFogTTE4LDE5LjUgQzE4LjI3NjE0MjQsMTkuNSAxOC41LDE5LjcyMzg1NzYgMTguNSwyMCBDMTguNSwyMC4yNDU0NTk5IDE4LjMyMzEyNDgsMjAuNDQ5NjA4NCAxOC4wODk4NzU2LDIwLjQ5MTk0NDMgTDE4LDIwLjUgTDEzLDIwLjUgQzEyLjcyMzg1NzYsMjAuNSAxMi41LDIwLjI3NjE0MjQgMTIuNSwyMCBDMTIuNSwxOS43NTQ1NDAxIDEyLjY3Njg3NTIsMTkuNTUwMzkxNiAxMi45MTAxMjQ0LDE5LjUwODA1NTcgTDEzLDE5LjUgTDE4LDE5LjUgWiBNMjAsMTIuNSBDMjAuMjQ1NDU5OSwxMi41IDIwLjQ0OTYwODQsMTIuNjc2ODc1MiAyMC40OTE5NDQzLDEyLjkxMDEyNDQgTDIwLjUsMTMgTDIwLjUsMTggQzIwLjUsMTguMjc2MTQyNCAyMC4yNzYxNDI0LDE4LjUgMjAsMTguNSBDMTkuNzU0NTQwMSwxOC41IDE5LjU1MDM5MTYsMTguMzIzMTI0OCAxOS41MDgwNTU3LDE4LjA4OTg3NTYgTDE5LjUsMTggTDE5LjUsMTMgQzE5LjUsMTIuNzIzODU3NiAxOS43MjM4NTc2LDEyLjUgMjAsMTIuNSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjMjEyMzI0IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",mw="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDdweCIgaGVpZ2h0PSI0MHB4IiB2aWV3Qm94PSIwIDAgNDcgNDAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYwLjEgKDg4MTMzKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT50ZXh0LWN1cnNvcjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGQ9Ik0xNiwyNi41IEMxNS43MjM4NTc2LDI2LjUgMTUuNSwyNi4yNzYxNDI0IDE1LjUsMjYgQzE1LjUsMjUuNzU0NTQwMSAxNS42NzY4NzUyLDI1LjU1MDM5MTYgMTUuOTEwMTI0NCwyNS41MDgwNTU3IEwxNiwyNS41IEwxOS41LDI1LjUgTDE5LjUsMTQuNSBMMTYsMTQuNSBDMTUuNzIzODU3NiwxNC41IDE1LjUsMTQuMjc2MTQyNCAxNS41LDE0IEMxNS41LDEzLjc1NDU0MDEgMTUuNjc2ODc1MiwxMy41NTAzOTE2IDE1LjkxMDEyNDQsMTMuNTA4MDU1NyBMMTYsMTMuNSBMMjQsMTMuNSBDMjQuMjc2MTQyNCwxMy41IDI0LjUsMTMuNzIzODU3NiAyNC41LDE0IEMyNC41LDE0LjI0NTQ1OTkgMjQuMzIzMTI0OCwxNC40NDk2MDg0IDI0LjA4OTg3NTYsMTQuNDkxOTQ0MyBMMjQsMTQuNSBMMjAuNSwxNC41IEwyMC41LDI1LjUgTDI0LDI1LjUgQzI0LjI3NjE0MjQsMjUuNSAyNC41LDI1LjcyMzg1NzYgMjQuNSwyNiBDMjQuNSwyNi4yNDU0NTk5IDI0LjMyMzEyNDgsMjYuNDQ5NjA4NCAyNC4wODk4NzU2LDI2LjQ5MTk0NDMgTDI0LDI2LjUgTDE2LDI2LjUgWiIgaWQ9InBhdGgtMSI+PC9wYXRoPgogICAgICAgIDxmaWx0ZXIgeD0iLTI4NC4wJSIgeT0iLTgxLjUlIiB3aWR0aD0iNjY4LjElIiBoZWlnaHQ9IjI5My45JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0iZmlsdGVyLTIiPgogICAgICAgICAgICA8ZmVNb3JwaG9sb2d5IHJhZGl1cz0iMSIgb3BlcmF0b3I9ImRpbGF0ZSIgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd1NwcmVhZE91dGVyMSI+PC9mZU1vcnBob2xvZ3k+CiAgICAgICAgICAgIDxmZU9mZnNldCBkeD0iMCIgZHk9IjIiIGluPSJzaGFkb3dTcHJlYWRPdXRlcjEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PgogICAgICAgICAgICA8ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzIiBpbj0ic2hhZG93T2Zmc2V0T3V0ZXIxIiByZXN1bHQ9InNoYWRvd0JsdXJPdXRlcjEiPjwvZmVHYXVzc2lhbkJsdXI+CiAgICAgICAgICAgIDxmZUNvbXBvc2l0ZSBpbj0ic2hhZG93Qmx1ck91dGVyMSIgaW4yPSJTb3VyY2VBbHBoYSIgb3BlcmF0b3I9Im91dCIgcmVzdWx0PSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlQ29tcG9zaXRlPgogICAgICAgICAgICA8ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAgIDAgMCAwIDAgMCAgIDAgMCAwIDAgMCAgMCAwIDAgMC4xNiAwIiB0eXBlPSJtYXRyaXgiIGluPSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlQ29sb3JNYXRyaXg+CiAgICAgICAgPC9maWx0ZXI+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0i6aG16Z2iLTQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJXaGl0ZWJvYXJkLUd1aWRlbGluZXMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zODguMDAwMDAwLCAtNjcyLjAwMDAwMCkiPgogICAgICAgICAgICA8ZyBpZD0idGV4dC1jdXJzb3IiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM5Mi4wMDAwMDAsIDY3Mi4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaLlpIfku70tNDAiIGZpbGw9IiNGRkZGRkYiIG9wYWNpdHk9IjAuMDEiIHg9IjAiIHk9IjAiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcng9IjIiPjwvcmVjdD4KICAgICAgICAgICAgICAgIDxnIGlkPSLlvaLnirbnu5PlkIgiIGZpbGwtcnVsZT0ibm9uemVybyI+CiAgICAgICAgICAgICAgICAgICAgPHVzZSBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIxIiBmaWx0ZXI9InVybCgjZmlsdGVyLTIpIiB4bGluazpocmVmPSIjcGF0aC0xIj48L3VzZT4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMSIgZD0iTTE5LDI1IEwxOSwxNSBMMTYsMTUgQzE1LjQ0NzcxNTMsMTUgMTUsMTQuNTUyMjg0NyAxNSwxNCBDMTUsMTMuNTE0NTg5NyAxNS4zNDc5OTkzLDEzLjEwMTkxNSAxNS44NjU0ODc3LDEzLjAxMDA1MjEgTDE2LDEzIEwyNCwxMyBDMjQuNTUyMjg0NywxMyAyNSwxMy40NDc3MTUzIDI1LDE0IEMyNSwxNC40ODU0MTAzIDI0LjY1MjAwMDcsMTQuODk4MDg1IDI0LjEzNDUxMjMsMTQuOTg5OTQ3OSBMMjQsMTUgTDIxLDE1IEwyMSwyNSBMMjQsMjUgQzI0LjU1MjI4NDcsMjUgMjUsMjUuNDQ3NzE1MyAyNSwyNiBDMjUsMjYuNDg1NDEwMyAyNC42NTIwMDA3LDI2Ljg5ODA4NSAyNC4xMzQ1MTIzLDI2Ljk4OTk0NzkgTDI0LDI3IEwxNiwyNyBDMTUuNDQ3NzE1MywyNyAxNSwyNi41NTIyODQ3IDE1LDI2IEMxNSwyNS41MTQ1ODk3IDE1LjM0Nzk5OTMsMjUuMTAxOTE1IDE1Ljg2NTQ4NzcsMjUuMDEwMDUyMSBMMTYsMjUgTDE5LDI1IFoiIGZpbGw9IiMyMTIzMjQiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",vw="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjhweCIgaGVpZ2h0PSIyOHB4IiB2aWV3Qm94PSIwIDAgMjggMjgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1LjEgKDc4MTM2KSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT7nvJbnu4QgMjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPgogICAgICAgIDxmaWx0ZXIgeD0iLTEyMC4wJSIgeT0iLTEyMC4wJSIgd2lkdGg9IjM0MC4wJSIgaGVpZ2h0PSIzNDAuMCUiIGZpbHRlclVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgaWQ9ImZpbHRlci0xIj4KICAgICAgICAgICAgPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iNCIgaW49IlNvdXJjZUdyYXBoaWMiPjwvZmVHYXVzc2lhbkJsdXI+CiAgICAgICAgPC9maWx0ZXI+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0i6aG16Z2iMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hC0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5LjAwMDAwMCwgOS4wMDAwMDApIiBmaWxsPSIjRkYwMTAwIj4KICAgICAgICAgICAgPGNpcmNsZSBpZD0i5qSt5ZyG5b2iIiBmaWx0ZXI9InVybCgjZmlsdGVyLTEpIiBjeD0iNSIgY3k9IjUiIHI9IjUiPjwvY2lyY2xlPgogICAgICAgICAgICA8cGF0aCBkPSJNNSw4IEM2LjY1Njg1NDI1LDggOCw2LjY1Njg1NDI1IDgsNSBDOCwzLjM0MzE0NTc1IDYuNjU2ODU0MjUsMiA1LDIgQzMuMzQzMTQ1NzUsMiAyLDMuMzQzMTQ1NzUgMiw1IEMyLDYuNjU2ODU0MjUgMy4zNDMxNDU3NSw4IDUsOCBaIE01LDYuMjg1NzE0MjkgQzQuMjg5OTE5NjEsNi4yODU3MTQyOSAzLjcxNDI4NTcxLDUuNzEwMDgwMzkgMy43MTQyODU3MSw1IEMzLjcxNDI4NTcxLDQuMjg5OTE5NjEgNC4yODk5MTk2MSwzLjcxNDI4NTcxIDUsMy43MTQyODU3MSBDNS43MTAwODAzOSwzLjcxNDI4NTcxIDYuMjg1NzE0MjksNC4yODk5MTk2MSA2LjI4NTcxNDI5LDUgQzYuMjg1NzE0MjksNS43MTAwODAzOSA1LjcxMDA4MDM5LDYuMjg1NzE0MjkgNSw2LjI4NTcxNDI5IFoiIGlkPSLmpK3lnIblvaIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",ww="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCAxOCAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIxNyIgaGVpZ2h0PSIyNSIgcng9IjMuNSIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC4zNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8L3N2Zz4K",yw="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjYiIGhlaWdodD0iMzQiIHZpZXdCb3g9IjAgMCAyNiAzNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIyNSIgaGVpZ2h0PSIzMyIgcng9IjMuNSIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC4zNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8L3N2Zz4K",xw="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzQiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCAzNCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3QgeD0iMC41IiB5PSIwLjUiIHdpZHRoPSIzMyIgaGVpZ2h0PSI0OSIgcng9IjMuNSIgZmlsbD0iYmxhY2siIGZpbGwtb3BhY2l0eT0iMC4zNSIgc3Ryb2tlPSJ3aGl0ZSIvPgo8L3N2Zz4K";const Mw={[T.ApplianceNames.pencil]:hw,[T.ApplianceNames.selector]:pw,[T.ApplianceNames.eraser]:fw,[T.ApplianceNames.shape]:gw,[T.ApplianceNames.text]:mw,[T.ApplianceNames.laserPointer]:vw,pencilEraser1:ww,pencilEraser2:yw,pencilEraser3:xw},lu="local-cursor";class Sw{constructor(e,i,n,r){var a;this.manager=e,this.enableCursor=i,this.cursorInstances=new Map,this.userApplianceIcons={},this.sideEffectManager=new hn,this.store=this.manager.store,this.leaveFlag=!0,this._style="default",this.onCursorMove=c=>{const l=this.initCursorInstance(c.uid);if(c.state===ta.Leave)l.leave();else{const u=l.updateMember();this.canMoveCursor(u)&&l.move(c.position)}},this.initCursorInstance=c=>{let l=this.cursorInstances.get(c);return l||(l=new dw(this.manager,c,this,X.wrapper),this.cursorInstances.set(c,l)),l},this.mouseMoveListener_=(c,l)=>{const u=this.getType(c);this.updateCursor(u,c.clientX,c.clientY),l&&this.showPencilEraserIfNeeded(u,c.clientX,c.clientY)},this.mouseMoveTimer=0,this.mouseMoveListener=c=>{const l=c.pointerType==="touch";if(l&&!c.isPrimary)return;const u=Date.now();if(u-this.mouseMoveTimer>48){if(this.mouseMoveTimer=u,X.supportAppliancePlugin&&T.isRoom(X.displayer)&&X.displayer.disableDeviceInputs){this.leaveFlag&&(this.manager.dispatchInternalEvent(ne.CursorMove,{uid:this.manager.uid,state:ta.Leave}),this.leaveFlag=!1);return}this.mouseMoveListener_(c,l),this.leaveFlag=!0}},this.mouseLeaveListener=()=>{this.hideCursor(this.manager.uid)},this.getPoint=(c,l,u)=>{var f;const d=(f=c==null?void 0:c.divElement)==null?void 0:f.getBoundingClientRect();if(d)return c==null?void 0:c.convertToPointInWorld({x:l-d.x,y:u-d.y})},this.getType=c=>{var d;const l=c.target,u=this.manager.focusApp;switch(l.parentElement){case this.mainViewElement:return{type:"main"};case((d=u==null?void 0:u.view)==null?void 0:d.divElement):return{type:"app"};default:return{type:"main"}}},this.roomMembers=(a=this.manager.room)==null?void 0:a.state.roomMembers;const s=X.wrapper;s&&this.setupWrapper(s),this.sideEffectManager.add(()=>R.on("cursorMove",this.onCursorMove)),this.sideEffectManager.add(()=>R.on("playgroundSizeChange",()=>this.updateContainerRect()));const o=this.manager.room;o&&this.sideEffectManager.add(()=>{const c=l=>{this.style==="custom"&&l.memberState&&this.enableCustomCursor()};return o.callbacks.on("onRoomStateChanged",c),()=>o.callbacks.off("onRoomStateChanged",c)}),r&&(this.userApplianceIcons=r),this.style=(n==null?void 0:n.style)||"default"}get applianceIcons(){return{...Mw,...this.userApplianceIcons}}get style(){return this._style}set style(e){this._style!==e&&(this._style=e,this.cursorInstances.forEach(i=>{i.setStyle(e)}),e==="custom"?this.enableCustomCursor():this.sideEffectManager.flush(lu))}enableCustomCursor(){this.sideEffectManager.add(()=>cw(this.manager.getMemberState()),lu)}canMoveCursor(e){const i=(e==null?void 0:e.memberState.currentApplianceName)===T.ApplianceNames.laserPointer;return this.enableCursor||i}setupWrapper(e){this.sideEffectManager.add(()=>(e.addEventListener("pointerenter",this.mouseMoveListener),e.addEventListener("pointermove",this.mouseMoveListener),e.addEventListener("pointerleave",this.mouseLeaveListener),()=>{e.removeEventListener("pointerenter",this.mouseMoveListener),e.removeEventListener("pointermove",this.mouseMoveListener),e.removeEventListener("pointerleave",this.mouseLeaveListener)})),this.wrapperRect=e.getBoundingClientRect()}setMainViewDivElement(e){this.mainViewElement=e}get boxState(){return this.store.getBoxState()}get focusView(){var e;return(e=this.manager.focusApp)==null?void 0:e.view}showPencilEraserIfNeeded(e,i,n){const r=ws(this.manager.room,this.manager.uid),s=(r==null?void 0:r.memberState.currentApplianceName)===T.ApplianceNames.pencilEraser;if(this.wrapperRect&&this.manager.canOperate&&this.canMoveCursor(r)&&s){const o=e.type==="main"?this.manager.mainView:this.focusView,a=this.getPoint(o,i,n);a&&this.onCursorMove({uid:this.manager.uid,position:{x:a.x,y:a.y,type:e.type}})}}updateCursor(e,i,n){const r=ws(this.manager.room,this.manager.uid);if(this.wrapperRect&&this.manager.canOperate&&this.canMoveCursor(r)){const s=e.type==="main"?this.manager.mainView:this.focusView,o=this.getPoint(s,i,n);o&&this.manager.dispatchInternalEvent(ne.CursorMove,{uid:this.manager.uid,position:{x:o.x,y:o.y,type:e.type}})}}updateContainerRect(){var e,i;this.containerRect=(e=X.container)==null?void 0:e.getBoundingClientRect(),this.wrapperRect=(i=X.wrapper)==null?void 0:i.getBoundingClientRect()}deleteCursor(e){this.store.cleanCursor(e);const i=this.cursorInstances.get(e);i&&i.destroy()}hideCursor(e){const i=this.cursorInstances.get(e);i&&i.hide()}destroy(){this.sideEffectManager.flushAll(),this.cursorInstances.size&&(this.cursorInstances.forEach(e=>{e.destroy()}),this.cursorInstances.clear())}}class Iw{constructor(e){this.manager=e,R.on("changePageState",()=>{J.emit("pageStateChange",this.toObject())})}get index(){return this.manager.store.getMainViewSceneIndex()||0}get length(){return this.manager.mainViewScenesLength||0}toObject(){return{index:this.index>=this.length?this.length-1:this.index,length:this.length}}}class Cw{constructor(e){this.ctx=e,this.reactors=new Map,this.disposers=new Map,this.onPhaseChanged=async i=>{var n,r;i===T.RoomPhase.Reconnecting&&this.ctx.emitter.emit("startReconnect"),i===T.RoomPhase.Connected&&this.phase===T.RoomPhase.Reconnecting&&((n=this.room)!=null&&n.isWritable?(r=this.room)==null||r.dispatchMagixEvent(So,{}):(await Qd(500),this.onReconnected())),this.phase=i},this.onReconnected=b.debounce(()=>{this._onReconnected()},1e3),this._onReconnected=()=>{it("onReconnected refresh reactors"),this.releaseDisposers(),this.reactors.forEach((i,n)=>{b.isFunction(i)&&this.disposers.set(n,i())}),this.ctx.emitter.emit("onReconnected")}}setRoom(e){this.room=e,this.phase=e==null?void 0:e.phase,e&&(e.callbacks.off("onPhaseChanged",this.onPhaseChanged),e.callbacks.on("onPhaseChanged",this.onPhaseChanged),e.addMagixEventListener(So,i=>{i.authorId===e.observerId&&this.onReconnected()},{fireSelfEventAfterCommit:!0}))}setContext(e){this.ctx=e}releaseDisposers(){this.disposers.forEach(e=>{b.isFunction(e)&&e()}),this.disposers.clear()}refresh(){this._onReconnected()}add(e,i){const n=this.disposers.get(e);n&&b.isFunction(n)&&n(),b.isFunction(i)&&(this.reactors.set(e,i),this.disposers.set(e,i()))}remove(e){this.reactors.has(e)&&this.reactors.delete(e);const i=this.disposers.get(e);i&&(b.isFunction(i)&&i(),this.disposers.delete(e))}hasReactor(e){return this.reactors.has(e)}destroy(){var e,i;(e=this.room)==null||e.callbacks.off("onPhaseChanged",this.onPhaseChanged),(i=this.room)==null||i.removeMagixEventListener(So,this.onReconnected),this.releaseDisposers()}}const bw=(t,e)=>{if(T.isPlayer(t))Tw(t);else{if(t=t,Object.getOwnPropertyDescriptor(t,"disableCameraTransform"))return;Object.defineProperty(t,"disableCameraTransform",{get(){return e.mainView.disableCameraTransform},set(n){e.mainView.disableCameraTransform=n}}),Object.defineProperty(t,"canUndoSteps",{get(){return e.canUndoSteps}}),Object.defineProperty(t,"canRedoSteps",{get(){return e.canRedoSteps}}),t.moveCamera=n=>e.moveCamera(n),t.moveCameraToContain=(...n)=>e.moveCameraToContain(...n),t.convertToPointInWorld=(...n)=>e.mainView.convertToPointInWorld(...n),t.setCameraBound=(...n)=>e.mainView.setCameraBound(...n),t.scenePreview=(...n)=>e.mainView.scenePreview(...n),t.fillSceneSnapshot=(...n)=>e.mainView.fillSceneSnapshot(...n),t.generateScreenshot=(...n)=>e.mainView.generateScreenshot(...n),t.setMemberState=(...n)=>e.mainView.setMemberState(...n),t.redo=()=>e.redo(),t.undo=()=>e.undo(),t.cleanCurrentScene=()=>e.cleanCurrentScene(),t.delete=()=>e.delete(),t.copy=()=>e.copy(),t.paste=()=>e.paste(),t.duplicate=()=>e.duplicate(),t.insertImage=(...n)=>e.insertImage(...n),t.completeImageUpload=(...n)=>e.completeImageUpload(...n),t.insertText=(...n)=>e.insertText(...n),t.lockImage=(...n)=>e.lockImage(...n),t.lockImages=(...n)=>e.lockImages(...n),Aw(t,e)}},Aw=(t,e)=>{const i=t.removeScenes;t.removeScenes=(n,r)=>{var o;n===Ue&&((o=e.appManager)==null||o.updateRootDirRemoving(!0));const s=i.call(t,n);return R.emit("removeScenes",{scenePath:n,index:r}),s}},Tw=t=>{const e=t.seekToProgressTime;async function i(n){await R.emit("seekStart");const r=await e.call(t,n);return R.emit("seek",n),r}t.seekToProgressTime=i};var cu,Ew=`.netless-app-docs-viewer-content{position:relative;height:100%;overflow:hidden}.netless-app-docs-viewer-preview-mask{display:block;position:absolute;z-index:200;top:0;left:0;width:100%;height:100%}.netless-app-docs-viewer-preview{display:flex;flex-direction:column;align-items:center;z-index:300;top:0;right:0;width:23%;padding:12px;box-shadow:-4.8px -3.2px 20px #20233826;transition:transform .4s;background:#f5f5fc;border-radius:4px;-webkit-box-shadow:-4.8px -3.2px 20px rgba(32,35,56,.15);height:100%;position:absolute}.netless-app-docs-viewer-preview-active .netless-app-docs-viewer-preview-mask{display:block}.netless-app-docs-viewer-preview-active .netless-app-docs-viewer-preview{transform:translate(0);opacity:1}.netless-app-docs-viewer-preview-head{display:flex;align-items:center;justify-content:space-between;width:100%;margin-bottom:10px}.netless-app-docs-viewer-preview-head>h3{color:#484c70;font-weight:400;font-size:14px;width:calc(100% - 20px);overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.netless-app-docs-viewer-preview-head .netless-app-docs-viewer-close{width:25px;height:25px;padding:0;outline:none;border:none;background:#fff;display:flex;justify-content:center;align-items:center;border-radius:100%;cursor:pointer}.netless-app-docs-viewer-preview-head .netless-app-docs-viewer-close button{width:22px;height:22px;padding:0;outline:none;border:none;background:center/cover no-repeat;background-image:url(./icons/close.svg)}.netless-app-docs-viewer-preview-page{position:relative;display:flex;width:100%;margin-bottom:10px;font-size:0;color:transparent;outline:none;border-radius:4px;transition:border-color .3s;user-select:none;align-items:flex-end}.netless-app-docs-viewer-preview-page>img{width:calc(90% - 10px);height:auto;box-sizing:border-box;border:2px solid rgba(0,0,0,.5);border-radius:2px;background-color:#fff}.netless-app-docs-viewer-preview-page>img.netless-app-docs-viewer-active{border-color:#ff5353}.netless-app-docs-viewer-preview-page-name{text-align:right;font-size:12px;color:#8d8fa6;user-select:none;margin-right:10px;width:5%}.netless-app-docs-viewer-footer{box-sizing:border-box;height:2.778vw;display:flex;align-items:center;padding:0 1.11vw;color:#191919;background:#ebecfa}.netless-app-docs-viewer-float-footer{width:100%;min-height:2.778vw;position:absolute;left:0;bottom:0;z-index:2000;transition:opacity .4s;color:#191919}.netless-app-docs-viewer-footer-btn{box-sizing:border-box;width:1.81vw;height:1.81vw;font-size:0;margin:0;padding:3px;border:none;border-radius:4px;outline:none;color:currentColor;background:transparent;transition:background .4s;cursor:pointer;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);color:#8d8fa6}.netless-app-docs-viewer-footer-btn.netless-app-docs-viewer-footer-btn-disable{color:#c6c7d2;cursor:not-allowed}.netless-app-docs-viewer-footer-btn.netless-app-docs-viewer-footer-btn-disable .arrow{fill:#c6c7d2}.netless-app-docs-viewer-footer-btn .arrow{fill:#8d8fa6}.netless-app-docs-viewer-footer-btn:hover{background-color:#1b1f4d0a}@media (hover: none){.netless-app-docs-viewer-footer-btn:hover{background:transparent!important}}.netless-app-docs-viewer-footer-btn>svg{width:100%;height:100%}.netless-app-docs-viewer-footer-btn>svg:nth-of-type(2){display:none}.netless-app-docs-viewer-footer-btn.netless-app-docs-viewer-footer-btn-playing>svg:nth-of-type(1){display:none}.netless-app-docs-viewer-footer-btn.netless-app-docs-viewer-footer-btn-playing>svg:nth-of-type(2){display:initial}.netless-app-docs-viewer-hide{display:none}.netless-app-docs-viewer-page-jumps{flex:1;display:flex;justify-content:center;align-items:center;gap:.556vw}.netless-app-docs-viewer-page-number{font-size:1vw;color:#8d8fa6;user-select:none;white-space:nowrap;word-break:keep-all}.netless-app-docs-viewer-page-number-input{border:none;outline:none;width:3em;margin:0;padding:0 2px;text-align:right;font-size:1vw;line-height:1;font-weight:400;font-family:inherit;border-radius:2px;color:currentColor;background:transparent;transition:background .4s;user-select:text;-webkit-tap-highlight-color:rgba(0,0,0,0)}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-footer-btn{cursor:not-allowed}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-footer-btn:hover{background:transparent}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-page-number-input{cursor:not-allowed}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-page-number-input:hover,.netless-app-docs-viewer-readonly .netless-app-docs-viewer-page-number-input:focus,.netless-app-docs-viewer-readonly .netless-app-docs-viewer-page-number-input:active{background:transparent;box-shadow:none}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-page-number-input:disabled{color:inherit}.netless-app-docs-viewer-readonly.netless-app-docs-viewer-float-footer{display:none}.telebox-color-scheme-dark .netless-app-docs-viewer-page-number-input{color:#a6a6a8}.telebox-color-scheme-dark .netless-app-docs-viewer-page-number-input:active,.telebox-color-scheme-dark .netless-app-docs-viewer-page-number-input:focus,.telebox-color-scheme-dark .netless-app-docs-viewer-page-number-input:hover{color:#222}.telebox-color-scheme-dark .netless-app-docs-viewer-footer{color:#a6a6a8;background:#2d2d33;border-top:none}.telebox-color-scheme-dark .netless-app-docs-viewer-footer-btn:hover{background:#212126}.telebox-color-scheme-dark .netless-app-docs-viewer-preview{background:rgba(50,50,50,.9)}.netless-app-docs-viewer-static-scrollbar{position:absolute;top:0;right:0;z-index:2147483647;width:8px;min-height:30px;margin:0;padding:0;border:none;outline:none;border-radius:4px;background:rgba(68,78,96,.4);box-shadow:1px 1px 8px #ffffffb3;opacity:0;transition:background .4s,opacity .4s 3s,transform .2s;user-select:none}.netless-app-docs-viewer-static-scrollbar.netless-app-docs-viewer-static-scrollbar-dragging{background:rgba(68,78,96,.6);opacity:1;transition:background .4s,opacity .4s 3s!important}.netless-app-docs-viewer-static-scrollbar:hover,.netless-app-docs-viewer-static-scrollbar:focus{background:rgba(68,78,96,.5)}.netless-app-docs-viewer-static-scrollbar:active{background:rgba(68,78,96,.6)}.netless-app-docs-viewer-content:hover .netless-app-docs-viewer-static-scrollbar{opacity:1;transition:background .4s,opacity .4s,transform .2s}.netless-app-docs-viewer-readonly .netless-app-docs-viewer-static-scrollbar{display:none}.netless-app-docs-viewer-static-pages:hover .netless-app-docs-viewer-static-scrollbar{opacity:1;transition:background .4s,opacity .4s,transform .2s}.page-renderer-pages-container{position:relative;overflow:hidden}.page-renderer-page{position:absolute;top:0;left:0;background-position:center;background-size:cover;background-repeat:no-repeat}.page-renderer-pages-container.is-hwa .page-renderer-page{will-change:transform}.page-renderer-page-img{display:block;width:100%;height:auto;user-select:none}.netless-app-docs-viewer-static-pages{overflow:hidden;position:relative;height:100%;user-select:none}.netless-app-docs-viewer-static-page{display:block;width:100%;height:auto;user-select:none}.netless-app-docs-viewer-static-wb-view,.netless-app-docs-viewer-dynamic-wb-view{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;overflow:auto}.netless-app-docs-viewer-dynamic-wb-view .cursor-clicker .ppt-event-source{cursor:pointer}
`;const Nw=(t,e,i,n)=>{if(i==="length"||i==="prototype"||i==="arguments"||i==="caller")return;const r=Object.getOwnPropertyDescriptor(t,i),s=Object.getOwnPropertyDescriptor(e,i);!kw(r,s)&&n||Object.defineProperty(t,i,s)},kw=function(t,e){return t===void 0||t.configurable||t.writable===e.writable&&t.enumerable===e.enumerable&&t.configurable===e.configurable&&(t.writable||t.value===e.value)},Pw=(t,e)=>{const i=Object.getPrototypeOf(e);i!==Object.getPrototypeOf(t)&&Object.setPrototypeOf(t,i)},Bw=(t,e)=>`/* Wrapped ${t}*/
${e}`,zw=Object.getOwnPropertyDescriptor(Function.prototype,"toString"),Dw=Object.getOwnPropertyDescriptor(Function.prototype.toString,"name"),Lw=(t,e,i)=>{const n=i===""?"":`with ${i.trim()}() `,r=Bw.bind(null,n,e.toString());Object.defineProperty(r,"name",Dw),Object.defineProperty(t,"toString",{...zw,value:r})};function jw(t,e,{ignoreNonConfigurable:i=!1}={}){const{name:n}=t;for(const r of Reflect.ownKeys(e))Nw(t,e,r,i);return Pw(t,e),Lw(t,e,n),t}const Rw=(t,e={})=>{if(typeof t!="function")throw new TypeError(`Expected the first argument to be a function, got \`${typeof t}\``);const{wait:i=0,maxWait:n=Number.POSITIVE_INFINITY,before:r=!1,after:s=!0}=e;if(!r&&!s)throw new Error("Both `before` and `after` are false, function wouldn't be called.");let o,a,c;const l=function(...u){const d=this,f=()=>{o=void 0,a&&(clearTimeout(a),a=void 0),s&&(c=t.apply(d,u))},v=()=>{a=void 0,o&&(clearTimeout(o),o=void 0),s&&(c=t.apply(d,u))},w=r&&!o;return clearTimeout(o),o=setTimeout(f,i),n>0&&n!==Number.POSITIVE_INFINITY&&!a&&(a=setTimeout(v,n)),w&&(c=t.apply(d,u)),c};return jw(l,t),l.cancel=()=>{o&&(clearTimeout(o),o=void 0),a&&(clearTimeout(a),a=void 0)},l};var _w="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Vw=87,Ow=20,uu=[],$w=()=>{for(let t=0;t<Ow;t++)uu[t]=_w.charAt(Math.random()*Vw);return uu.join("")};function kh(t){try{return t()}catch(e){console.error(e)}}var io=class{constructor(){this.push=this.addDisposer,this.disposers=new Map}addDisposer(t,e=this.genUID()){return this.flush(e),this.disposers.set(e,Array.isArray(t)?Ww(t):t),e}add(t,e=this.genUID()){const i=t();return i?this.addDisposer(i,e):e}addEventListener(t,e,i,n,r=this.genUID()){return t.addEventListener(e,i,n),this.addDisposer(()=>t.removeEventListener(e,i,n),r),r}setTimeout(t,e,i=this.genUID()){const n=window.setTimeout(()=>{this.remove(i),t()},e);return this.addDisposer(()=>window.clearTimeout(n),i)}setInterval(t,e,i=this.genUID()){const n=window.setInterval(t,e);return this.addDisposer(()=>window.clearInterval(n),i)}remove(t){const e=this.disposers.get(t);return this.disposers.delete(t),e}flush(t){const e=this.remove(t);e&&e()}flushAll(){this.disposers.forEach(kh),this.disposers.clear()}genUID(){let t;do t=$w();while(this.disposers.has(t));return t}};function Ww(t){return()=>t.forEach(kh)}var hi=[],Uw=function(){return hi.some(function(t){return t.activeTargets.length>0})},Hw=function(){return hi.some(function(t){return t.skippedTargets.length>0})},du="ResizeObserver loop completed with undelivered notifications.",Fw=function(){var t;typeof ErrorEvent=="function"?t=new ErrorEvent("error",{message:du}):(t=document.createEvent("Event"),t.initEvent("error",!1,!1),t.message=du),window.dispatchEvent(t)},tr;(function(t){t.BORDER_BOX="border-box",t.CONTENT_BOX="content-box",t.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(tr||(tr={}));var pi=function(t){return Object.freeze(t)},Zw=function(){function t(e,i){this.inlineSize=e,this.blockSize=i,pi(this)}return t}(),Ph=function(){function t(e,i,n,r){return this.x=e,this.y=i,this.width=n,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,pi(this)}return t.prototype.toJSON=function(){var e=this,i=e.x,n=e.y,r=e.top,s=e.right,o=e.bottom,a=e.left,c=e.width,l=e.height;return{x:i,y:n,top:r,right:s,bottom:o,left:a,width:c,height:l}},t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t}(),El=function(t){return t instanceof SVGElement&&"getBBox"in t},Bh=function(t){if(El(t)){var e=t.getBBox(),i=e.width,n=e.height;return!i&&!n}var r=t,s=r.offsetWidth,o=r.offsetHeight;return!(s||o||t.getClientRects().length)},hu=function(t){var e;if(t instanceof Element)return!0;var i=(e=t==null?void 0:t.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(i&&t instanceof i.Element)},Qw=function(t){switch(t.tagName){case"INPUT":if(t.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},Wn=typeof window!="undefined"?window:{},Lr=new WeakMap,pu=/auto|scroll/,Gw=/^tb|vertical/,Yw=/msie|trident/i.test(Wn.navigator&&Wn.navigator.userAgent),ct=function(t){return parseFloat(t||"0")},Yi=function(t,e,i){return t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=!1),new Zw((i?e:t)||0,(i?t:e)||0)},fu=pi({devicePixelContentBoxSize:Yi(),borderBoxSize:Yi(),contentBoxSize:Yi(),contentRect:new Ph(0,0,0,0)}),zh=function(t,e){if(e===void 0&&(e=!1),Lr.has(t)&&!e)return Lr.get(t);if(Bh(t))return Lr.set(t,fu),fu;var i=getComputedStyle(t),n=El(t)&&t.ownerSVGElement&&t.getBBox(),r=!Yw&&i.boxSizing==="border-box",s=Gw.test(i.writingMode||""),o=!n&&pu.test(i.overflowY||""),a=!n&&pu.test(i.overflowX||""),c=n?0:ct(i.paddingTop),l=n?0:ct(i.paddingRight),u=n?0:ct(i.paddingBottom),d=n?0:ct(i.paddingLeft),f=n?0:ct(i.borderTopWidth),v=n?0:ct(i.borderRightWidth),w=n?0:ct(i.borderBottomWidth),x=n?0:ct(i.borderLeftWidth),h=d+l,p=c+u,g=x+v,m=f+w,y=a?t.offsetHeight-m-t.clientHeight:0,M=o?t.offsetWidth-g-t.clientWidth:0,E=r?h+g:0,z=r?p+m:0,P=n?n.width:ct(i.width)-E-M,L=n?n.height:ct(i.height)-z-y,S=P+h+M+g,N=L+p+y+m,I=pi({devicePixelContentBoxSize:Yi(Math.round(P*devicePixelRatio),Math.round(L*devicePixelRatio),s),borderBoxSize:Yi(S,N,s),contentBoxSize:Yi(P,L,s),contentRect:new Ph(d,c,P,L)});return Lr.set(t,I),I},Dh=function(t,e,i){var n=zh(t,i),r=n.borderBoxSize,s=n.contentBoxSize,o=n.devicePixelContentBoxSize;switch(e){case tr.DEVICE_PIXEL_CONTENT_BOX:return o;case tr.BORDER_BOX:return r;default:return s}},Xw=function(){function t(e){var i=zh(e);this.target=e,this.contentRect=i.contentRect,this.borderBoxSize=pi([i.borderBoxSize]),this.contentBoxSize=pi([i.contentBoxSize]),this.devicePixelContentBoxSize=pi([i.devicePixelContentBoxSize])}return t}(),Lh=function(t){if(Bh(t))return 1/0;for(var e=0,i=t.parentNode;i;)e+=1,i=i.parentNode;return e},Jw=function(){var t=1/0,e=[];hi.forEach(function(o){if(o.activeTargets.length!==0){var a=[];o.activeTargets.forEach(function(l){var u=new Xw(l.target),d=Lh(l.target);a.push(u),l.lastReportedSize=Dh(l.target,l.observedBox),d<t&&(t=d)}),e.push(function(){o.callback.call(o.observer,a,o.observer)}),o.activeTargets.splice(0,o.activeTargets.length)}});for(var i=0,n=e;i<n.length;i++){var r=n[i];r()}return t},gu=function(t){hi.forEach(function(i){i.activeTargets.splice(0,i.activeTargets.length),i.skippedTargets.splice(0,i.skippedTargets.length),i.observationTargets.forEach(function(r){r.isActive()&&(Lh(r.target)>t?i.activeTargets.push(r):i.skippedTargets.push(r))})})},Kw=function(){var t=0;for(gu(t);Uw();)t=Jw(),gu(t);return Hw()&&Fw(),t>0},Do,jh=[],qw=function(){return jh.splice(0).forEach(function(t){return t()})},ey=function(t){if(!Do){var e=0,i=document.createTextNode(""),n={characterData:!0};new MutationObserver(function(){return qw()}).observe(i,n),Do=function(){i.textContent="".concat(e?e--:e++)}}jh.push(t),Do()},ty=function(t){ey(function(){requestAnimationFrame(t)})},es=0,iy=function(){return!!es},ny=250,ry={attributes:!0,characterData:!0,childList:!0,subtree:!0},mu=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],vu=function(t){return t===void 0&&(t=0),Date.now()+t},Lo=!1,sy=function(){function t(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return t.prototype.run=function(e){var i=this;if(e===void 0&&(e=ny),!Lo){Lo=!0;var n=vu(e);ty(function(){var r=!1;try{r=Kw()}finally{if(Lo=!1,e=n-vu(),!iy())return;r?i.run(1e3):e>0?i.run(e):i.start()}})}},t.prototype.schedule=function(){this.stop(),this.run()},t.prototype.observe=function(){var e=this,i=function(){return e.observer&&e.observer.observe(document.body,ry)};document.body?i():Wn.addEventListener("DOMContentLoaded",i)},t.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),mu.forEach(function(i){return Wn.addEventListener(i,e.listener,!0)}))},t.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),mu.forEach(function(i){return Wn.removeEventListener(i,e.listener,!0)}),this.stopped=!0)},t}(),pa=new sy,wu=function(t){!es&&t>0&&pa.start(),es+=t,!es&&pa.stop()},oy=function(t){return!El(t)&&!Qw(t)&&getComputedStyle(t).display==="inline"},ay=function(){function t(e,i){this.target=e,this.observedBox=i||tr.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return t.prototype.isActive=function(){var e=Dh(this.target,this.observedBox,!0);return oy(this.target)&&(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},t}(),ly=function(){function t(e,i){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=i}return t}(),jr=new WeakMap,yu=function(t,e){for(var i=0;i<t.length;i+=1)if(t[i].target===e)return i;return-1},Rr=function(){function t(){}return t.connect=function(e,i){var n=new ly(e,i);jr.set(e,n)},t.observe=function(e,i,n){var r=jr.get(e),s=r.observationTargets.length===0;yu(r.observationTargets,i)<0&&(s&&hi.push(r),r.observationTargets.push(new ay(i,n&&n.box)),wu(1),pa.schedule())},t.unobserve=function(e,i){var n=jr.get(e),r=yu(n.observationTargets,i),s=n.observationTargets.length===1;r>=0&&(s&&hi.splice(hi.indexOf(n),1),n.observationTargets.splice(r,1),wu(-1))},t.disconnect=function(e){var i=this,n=jr.get(e);n.observationTargets.slice().forEach(function(r){return i.unobserve(e,r.target)}),n.activeTargets.splice(0,n.activeTargets.length)},t}(),cy=function(){function t(e){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof e!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Rr.connect(this,e)}return t.prototype.observe=function(e,i){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!hu(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Rr.observe(this,e,i)},t.prototype.unobserve=function(e){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!hu(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Rr.unobserve(this,e)},t.prototype.disconnect=function(){Rr.disconnect(this)},t.toString=function(){return"function ResizeObserver () { [polyfill code] }"},t}();function uy(t){const e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"svg");return i.setAttribute("class",`${t}-footer-icon-arrow-left`),i.setAttribute("viewBox","0 0 20 20"),i.innerHTML=`<g clip-path="url(#clip0_11800_99864)">
<path fill-rule="evenodd" clip-rule="evenodd" d="M11.5283 4.86182L12.4711 5.80463L8.22849 10.0473L12.4711 14.2899L11.5283 15.2327L6.34287 10.0473L11.5283 4.86182Z" class="arrow" />
</g>
<defs>
<clipPath id="clip0_11800_99864">
<rect width="16" height="16" fill="white" transform="translate(2 2)"/>
</clipPath>
</defs>`,i}function dy(t){const e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"svg");return i.setAttribute("class",`${t}-footer-icon-arrow-right`),i.setAttribute("viewBox","0 0 20 20"),i.innerHTML=`<g clip-path="url(#clip0_11800_99870)">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8.1377 4.86182L7.19489 5.80463L11.4375 10.0473L7.19489 14.2899L8.1377 15.2327L13.3231 10.0473L8.1377 4.86182Z" class="arrow" />
</g>
<defs>
<clipPath id="clip0_11800_99870">
<rect width="16" height="16" fill="white" transform="translate(2 2)"/>
</clipPath>
</defs>`,i}function hy(t){const e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"svg");i.setAttribute("class",`${t}-footer-icon-play`),i.setAttribute("viewBox","0 0 500 500");const n=document.createElementNS(e,"path");return n.setAttribute("fill","currentColor"),n.setAttribute("d","M418.158 257.419L174.663 413.33c-6.017 3.919-15.708 3.772-21.291-.29-2.791-2.018-4.295-4.483-4.295-7.084V94.109c0-5.65 6.883-10.289 15.271-10.289 4.298 0 8.391 1.307 11.181 3.332l242.629 155.484c6.016 3.917 6.451 10.292.649 14.491-.216.154-.432.154-.649.292zM170.621 391.288l223.116-141.301L170.71 107.753l-.089 283.535z"),i.appendChild(n),i}function py(t){const e="http://www.w3.org/2000/svg",i=document.createElementNS(e,"svg");i.setAttribute("class",`${t}-footer-icon-pause`),i.setAttribute("viewBox","0 0 500 500");const n=document.createElementNS(e,"path");return n.setAttribute("fill","currentColor"),n.setAttribute("d","M312.491 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261zM165.257 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261z"),i.appendChild(n),i}const ei=typeof window!="undefined",Rh=ei&&!("onscroll"in window)||typeof navigator!="undefined"&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),_h=ei&&"IntersectionObserver"in window,Vh=ei&&"classList"in document.createElement("p"),Oh=ei&&window.devicePixelRatio>1,fy={elements_selector:".lazy",container:Rh||ei?document:null,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",data_bg_hidpi:"bg-hidpi",data_bg_multi:"bg-multi",data_bg_multi_hidpi:"bg-multi-hidpi",data_bg_set:"bg-set",data_poster:"poster",class_applied:"applied",class_loading:"loading",class_loaded:"loaded",class_error:"error",class_entered:"entered",class_exited:"exited",unobserve_completed:!0,unobserve_entered:!1,cancel_on_exit:!0,callback_enter:null,callback_exit:null,callback_applied:null,callback_loading:null,callback_loaded:null,callback_error:null,callback_finish:null,callback_cancel:null,use_native:!1,restore_on_error:!1},$h=t=>Object.assign({},fy,t),xu=function(t,e){let i;const n="LazyLoad::Initialized",r=new t(e);try{i=new CustomEvent(n,{detail:{instance:r}})}catch{i=document.createEvent("CustomEvent"),i.initCustomEvent(n,!1,!1,{instance:r})}window.dispatchEvent(i)},gy=(t,e)=>{if(!!e)if(!e.length)xu(t,e);else for(let i=0,n;n=e[i];i+=1)xu(t,n)},zt="src",Nl="srcset",kl="sizes",Wh="poster",gr="llOriginalAttrs",Uh="data",Pl="loading",Hh="loaded",Fh="applied",my="entered",Bl="error",Zh="native",Qh="data-",Gh="ll-status",Le=(t,e)=>t.getAttribute(Qh+e),vy=(t,e,i)=>{const n=Qh+e;if(i===null){t.removeAttribute(n);return}t.setAttribute(n,i)},mr=t=>Le(t,Gh),Ai=(t,e)=>vy(t,Gh,e),no=t=>Ai(t,null),zl=t=>mr(t)===null,wy=t=>mr(t)===Pl,yy=t=>mr(t)===Bl,Dl=t=>mr(t)===Zh,xy=[Pl,Hh,Fh,Bl],My=t=>xy.indexOf(mr(t))>=0,ti=(t,e,i,n)=>{if(!(!t||typeof t!="function")){if(n!==void 0){t(e,i,n);return}if(i!==void 0){t(e,i);return}t(e)}},pn=(t,e)=>{if(e!==""){if(Vh){t.classList.add(e);return}t.className+=(t.className?" ":"")+e}},ht=(t,e)=>{if(e!==""){if(Vh){t.classList.remove(e);return}t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")}},Sy=t=>{t.llTempImage=document.createElement("IMG")},Iy=t=>{delete t.llTempImage},Yh=t=>t.llTempImage,ro=(t,e)=>{if(!e)return;const i=e._observer;!i||i.unobserve(t)},Cy=t=>{t.disconnect()},by=(t,e,i)=>{e.unobserve_entered&&ro(t,i)},Ll=(t,e)=>{!t||(t.loadingCount+=e)},Ay=t=>{!t||(t.toLoadCount-=1)},Xh=(t,e)=>{!t||(t.toLoadCount=e)},Ty=t=>t.loadingCount>0,Ey=t=>t.toLoadCount>0,Jh=t=>{let e=[];for(let i=0,n;n=t.children[i];i+=1)n.tagName==="SOURCE"&&e.push(n);return e},jl=(t,e)=>{const i=t.parentNode;if(!i||i.tagName!=="PICTURE")return;Jh(i).forEach(e)},Kh=(t,e)=>{Jh(t).forEach(e)},so=[zt],qh=[zt,Wh],ir=[zt,Nl,kl],ep=[Uh],oo=t=>!!t[gr],tp=t=>t[gr],ip=t=>delete t[gr],rn=(t,e)=>{if(oo(t))return;const i={};e.forEach(n=>{i[n]=t.getAttribute(n)}),t[gr]=i},Ny=t=>{oo(t)||(t[gr]={backgroundImage:t.style.backgroundImage})},ky=(t,e,i)=>{if(!i){t.removeAttribute(e);return}t.setAttribute(e,i)},xi=(t,e)=>{if(!oo(t))return;const i=tp(t);e.forEach(n=>{ky(t,n,i[n])})},Py=t=>{if(!oo(t))return;const e=tp(t);t.style.backgroundImage=e.backgroundImage},np=(t,e,i)=>{pn(t,e.class_applied),Ai(t,Fh),i&&(e.unobserve_completed&&ro(t,e),ti(e.callback_applied,t,i))},rp=(t,e,i)=>{pn(t,e.class_loading),Ai(t,Pl),i&&(Ll(i,1),ti(e.callback_loading,t,i))},Ut=(t,e,i)=>{!i||t.setAttribute(e,i)},Mu=(t,e)=>{Ut(t,kl,Le(t,e.data_sizes)),Ut(t,Nl,Le(t,e.data_srcset)),Ut(t,zt,Le(t,e.data_src))},By=(t,e)=>{jl(t,i=>{rn(i,ir),Mu(i,e)}),rn(t,ir),Mu(t,e)},zy=(t,e)=>{rn(t,so),Ut(t,zt,Le(t,e.data_src))},Dy=(t,e)=>{Kh(t,i=>{rn(i,so),Ut(i,zt,Le(i,e.data_src))}),rn(t,qh),Ut(t,Wh,Le(t,e.data_poster)),Ut(t,zt,Le(t,e.data_src)),t.load()},Ly=(t,e)=>{rn(t,ep),Ut(t,Uh,Le(t,e.data_src))},jy=(t,e,i)=>{const n=Le(t,e.data_bg),r=Le(t,e.data_bg_hidpi),s=Oh&&r?r:n;!s||(t.style.backgroundImage=`url("${s}")`,Yh(t).setAttribute(zt,s),rp(t,e,i))},Ry=(t,e,i)=>{const n=Le(t,e.data_bg_multi),r=Le(t,e.data_bg_multi_hidpi),s=Oh&&r?r:n;!s||(t.style.backgroundImage=s,np(t,e,i))},_y=(t,e,i)=>{const n=Le(t,e.data_bg_set);if(!n)return;const r=n.split("|");let s=r.map(o=>`image-set(${o})`);t.style.backgroundImage=s.join(),t.style.backgroundImage===""&&(s=r.map(o=>`-webkit-image-set(${o})`),t.style.backgroundImage=s.join()),np(t,e,i)},sp={IMG:By,IFRAME:zy,VIDEO:Dy,OBJECT:Ly},Vy=(t,e)=>{const i=sp[t.tagName];!i||i(t,e)},Oy=(t,e,i)=>{const n=sp[t.tagName];!n||(n(t,e),rp(t,e,i))},$y=["IMG","IFRAME","VIDEO","OBJECT"],Wy=t=>$y.indexOf(t.tagName)>-1,op=(t,e)=>{e&&!Ty(e)&&!Ey(e)&&ti(t.callback_finish,e)},Su=(t,e,i)=>{t.addEventListener(e,i),t.llEvLisnrs[e]=i},Uy=(t,e,i)=>{t.removeEventListener(e,i)},Rl=t=>!!t.llEvLisnrs,Hy=(t,e,i)=>{Rl(t)||(t.llEvLisnrs={});const n=t.tagName==="VIDEO"?"loadeddata":"load";Su(t,n,e),Su(t,"error",i)},fa=t=>{if(!Rl(t))return;const e=t.llEvLisnrs;for(let i in e){const n=e[i];Uy(t,i,n)}delete t.llEvLisnrs},ap=(t,e,i)=>{Iy(t),Ll(i,-1),Ay(i),ht(t,e.class_loading),e.unobserve_completed&&ro(t,i)},Fy=(t,e,i,n)=>{const r=Dl(e);ap(e,i,n),pn(e,i.class_loaded),Ai(e,Hh),ti(i.callback_loaded,e,n),r||op(i,n)},Zy=(t,e,i,n)=>{const r=Dl(e);ap(e,i,n),pn(e,i.class_error),Ai(e,Bl),ti(i.callback_error,e,n),i.restore_on_error&&xi(e,ir),r||op(i,n)},_l=(t,e,i)=>{const n=Yh(t)||t;if(Rl(n))return;Hy(n,o=>{Fy(o,t,e,i),fa(n)},o=>{Zy(o,t,e,i),fa(n)})},Qy=(t,e,i)=>{Sy(t),_l(t,e,i),Ny(t),jy(t,e,i),Ry(t,e,i),_y(t,e,i)},Gy=(t,e,i)=>{_l(t,e,i),Oy(t,e,i)},Vl=(t,e,i)=>{Wy(t)?Gy(t,e,i):Qy(t,e,i)},Yy=(t,e,i)=>{t.setAttribute("loading","lazy"),_l(t,e,i),Vy(t,e),Ai(t,Zh)},Iu=t=>{t.removeAttribute(zt),t.removeAttribute(Nl),t.removeAttribute(kl)},Xy=t=>{jl(t,e=>{Iu(e)}),Iu(t)},lp=t=>{jl(t,e=>{xi(e,ir)}),xi(t,ir)},Jy=t=>{Kh(t,e=>{xi(e,so)}),xi(t,qh),t.load()},Ky=t=>{xi(t,so)},qy=t=>{xi(t,ep)},ex={IMG:lp,IFRAME:Ky,VIDEO:Jy,OBJECT:qy},tx=t=>{const e=ex[t.tagName];if(!e){Py(t);return}e(t)},ix=(t,e)=>{zl(t)||Dl(t)||(ht(t,e.class_entered),ht(t,e.class_exited),ht(t,e.class_applied),ht(t,e.class_loading),ht(t,e.class_loaded),ht(t,e.class_error))},nx=(t,e)=>{tx(t),ix(t,e),no(t),ip(t)},rx=(t,e,i,n)=>{!i.cancel_on_exit||!wy(t)||t.tagName==="IMG"&&(fa(t),Xy(t),lp(t),ht(t,i.class_loading),Ll(n,-1),no(t),ti(i.callback_cancel,t,e,n))},sx=(t,e,i,n)=>{const r=My(t);Ai(t,my),pn(t,i.class_entered),ht(t,i.class_exited),by(t,i,n),ti(i.callback_enter,t,e,n),!r&&Vl(t,i,n)},ox=(t,e,i,n)=>{zl(t)||(pn(t,i.class_exited),rx(t,e,i,n),ti(i.callback_exit,t,e,n))},ax=["IMG","IFRAME","VIDEO"],cp=t=>t.use_native&&"loading"in HTMLImageElement.prototype,lx=(t,e,i)=>{t.forEach(n=>{ax.indexOf(n.tagName)!==-1&&Yy(n,e,i)}),Xh(i,0)},cx=t=>t.isIntersecting||t.intersectionRatio>0,ux=t=>({root:t.container===document?null:t.container,rootMargin:t.thresholds||t.threshold+"px"}),dx=(t,e,i)=>{t.forEach(n=>cx(n)?sx(n.target,n,e,i):ox(n.target,n,e,i))},hx=(t,e)=>{e.forEach(i=>{t.observe(i)})},px=(t,e)=>{Cy(t),hx(t,e)},fx=(t,e)=>{!_h||cp(t)||(e._observer=new IntersectionObserver(i=>{dx(i,t,e)},ux(t)))},up=t=>Array.prototype.slice.call(t),xs=t=>t.container.querySelectorAll(t.elements_selector),gx=t=>up(t).filter(zl),mx=t=>yy(t),vx=t=>up(t).filter(mx),Cu=(t,e)=>gx(t||xs(e)),wx=(t,e)=>{vx(xs(t)).forEach(n=>{ht(n,t.class_error),no(n)}),e.update()},yx=(t,e)=>{!ei||(e._onlineHandler=()=>{wx(t,e)},window.addEventListener("online",e._onlineHandler))},xx=t=>{!ei||window.removeEventListener("online",t._onlineHandler)},vr=function(t,e){const i=$h(t);this._settings=i,this.loadingCount=0,fx(i,this),yx(i,this),this.update(e)};vr.prototype={update:function(t){const e=this._settings,i=Cu(t,e);if(Xh(this,i.length),Rh||!_h){this.loadAll(i);return}if(cp(e)){lx(i,e,this);return}px(this._observer,i)},destroy:function(){this._observer&&this._observer.disconnect(),xx(this),xs(this._settings).forEach(t=>{ip(t)}),delete this._observer,delete this._settings,delete this._onlineHandler,delete this.loadingCount,delete this.toLoadCount},loadAll:function(t){const e=this._settings;Cu(t,e).forEach(n=>{ro(n,this),Vl(n,e,this)})},restoreAll:function(){const t=this._settings;xs(t).forEach(e=>{nx(e,t)})}};vr.load=(t,e)=>{const i=$h(e);Vl(t,i)};vr.resetStatus=t=>{no(t)};ei&&gy(vr,window.lazyLoadOptions);const Ms=(cu=window.navigator)==null?void 0:cu.userAgent;Ms==null||Ms.match(/(Edge?)\/(\d+)/);const bu=()=>typeof navigator!="undefined"&&typeof window!="undefined"&&/iPad|iPhone|iPod/.test(Ms),Au=()=>typeof navigator!="undefined"&&/Android/.test(Ms);class dp{constructor({context:e,readonly:i,box:n,pages:r,onNewPageIndex:s,onPlay:o}){if(this.pageIndex=0,this.namespace="netless-app-docs-viewer",this.isShowPreview=!1,this.isSmallBox=!1,this.sideEffect=new io,r.length<=0)throw new Error("[DocsViewer] Empty pages.");this.context=e,this.readonly=i,this.box=n,this.pages=r,this.onNewPageIndex=s,this.onPlay=o,this.onPageIndexChanged=()=>{},this.render()}mount(){this.box.mountContent(this.$content),this.box.mountFooter(this.$footer),this.box.events.on("maximized",e=>{this.$footer.classList.toggle(this.wrapClassName("hide"),e)}),this.$footer.classList.toggle(this.wrapClassName("hide"),this.box.maximized)}unmount(){this.$content.remove(),this.$footer.remove()}setReadonly(e){this.readonly!==e&&(this.readonly=e,this.$content.classList.toggle(this.wrapClassName("readonly"),e),this.$footer.classList.toggle(this.wrapClassName("readonly"),e))}destroy(){this.sideEffect.flushAll(),this.unmount()}setPageIndex(e){Number.isNaN(e)||(this.scrollPreview(e),this.pageIndex=e,this.$pageNumberInput.textContent=String(e+1),this.onPageIndexChanged(e),this.$btnPageBack.classList.toggle(this.wrapClassName("footer-btn-disable"),e==0),this.$btnPageNext.classList.toggle(this.wrapClassName("footer-btn-disable"),e==this.pages.length-1))}scrollPreview(e){var i;const n=(i=this.$preview)==null?void 0:i.querySelectorAll("."+this.wrapClassName("preview-page"));if(n==null||n.forEach((c,l)=>{var u;(u=c.querySelector("img"))==null||u.classList.toggle(this.wrapClassName("active"),Number(e)==l)}),!n)return;const r=Array.prototype.slice.call(n).find(c=>c.querySelector("img").className.includes(this.wrapClassName("active")));if(!r)return;const s=this.$preview.getBoundingClientRect(),o=r==null?void 0:r.getBoundingClientRect();o.top>=s.top&&o.bottom<=s.bottom||this.$preview.scrollTo({top:r.offsetTop-16,behavior:this.isShowPreview?"smooth":"auto"})}setSmallBox(e){this.isSmallBox!==e&&(this.isSmallBox=e,this.$footer.classList.toggle(this.wrapClassName("float-footer"),e))}render(){return this.renderContent(),this.renderFooter(),this.$content}renderContent(){if(!this.$content){const e=document.createElement("div");e.className=this.wrapClassName("content"),this.$content=e,this.readonly&&e.classList.add(this.wrapClassName("readonly"))}return this.$content}renderPreview(){if(!this.$preview){const e=document.createElement("div");e.className=this.wrapClassName("preview")+" tele-fancy-scrollbar",this.$preview=e;const i=document.createElement("div");i.className=this.wrapClassName("preview-head");const n=document.createElement("h3");n.textContent=this.box.title,i.appendChild(n),this.$preview.appendChild(i);const r=this.wrapClassName("preview-page"),s=this.wrapClassName("preview-page-name");this.pages.forEach((o,a)=>{var c;const l=(c=o.thumbnail)!=null?c:o.src.startsWith("ppt")?void 0:o.src;if(!l)return;const u=String(a),d=document.createElement("a");d.className=r+" "+this.wrapClassName(`preview-page-${a}`),d.setAttribute("href","#"),d.dataset.pageIndex=u;const f=document.createElement("span");f.className=s,f.textContent=String(a+1),f.dataset.pageIndex=u;const v=document.createElement("img");v.width=o.width,v.height=o.height,v.dataset.src=l,v.dataset.pageIndex=u,d.appendChild(f),d.appendChild(v),e.appendChild(d),v.classList.toggle(this.wrapClassName("active"),this.pageIndex==a)}),this.sideEffect.addEventListener(e,"click",o=>{var a;if(this.readonly)return;const c=(a=o.target.dataset)==null?void 0:a.pageIndex;c&&(o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation(),this.onNewPageIndex(Number(c)))})}return this.$preview}renderPreviewMask(){return this.$previewMask||(this.$previewMask=document.createElement("div"),this.$previewMask.className=this.wrapClassName("preview-mask"),this.sideEffect.addEventListener(this.$previewMask,"click",e=>{this.readonly||e.target===this.$previewMask&&this.togglePreview(!1)})),this.$previewMask}renderFooter(){if(!this.$footer){const e=document.createElement("div");e.className=this.wrapClassName("footer"),this.$footer=e,this.readonly&&e.classList.add(this.wrapClassName("readonly")),this.isSmallBox&&e.classList.add(this.wrapClassName("float-footer"));const i=document.createElement("div");i.className=this.wrapClassName("page-jumps");const n=this.renderFooterBtn("btn-page-back",uy(this.namespace));if(this.sideEffect.addEventListener(n,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex-1)}),i.appendChild(n),this.$btnPageBack=n,this.onPlay){const c=this.renderFooterBtn("btn-page-play",hy(this.namespace),py(this.namespace)),l=()=>{this.sideEffect.setTimeout(()=>{c.classList.toggle(this.wrapClassName("footer-btn-playing"),!1)},500,"returnPlay")};this.sideEffect.addEventListener(c,"click",()=>{var u;this.readonly||(c.classList.toggle(this.wrapClassName("footer-btn-playing"),!0),(u=this.onPlay)==null||u.call(this),l())}),!this.context.getIsAppReadonly()&&!bu()&&!Au()&&this.$footer.appendChild(c)}const r=document.createElement("div");r.className=this.wrapClassName("page-number");const s=document.createElement("span");s.className=this.wrapClassName("page-number-input"),s.textContent=String(this.pageIndex+1),this.$pageNumberInput=s;const o=document.createElement("span");o.textContent=" / "+this.pages.length,r.appendChild(s),r.appendChild(o),i.appendChild(r);const a=this.renderFooterBtn("btn-page-next",dy(this.namespace));this.sideEffect.addEventListener(a,"click",()=>{this.readonly||this.onNewPageIndex(this.pageIndex+1)}),i.appendChild(a),this.$btnPageNext=a,!this.context.getIsAppReadonly()&&!bu()&&!Au()&&this.$footer.appendChild(i)}return this.$footer}renderFooterBtn(e,i,n){const r=document.createElement("button");return r.className=this.wrapClassName("footer-btn")+" "+this.wrapClassName(e),r.appendChild(i),n&&r.appendChild(n),r}togglePreview(e){var i,n,r,s,o,a,c;this.isShowPreview=e!=null?e:!this.isShowPreview,console.log((i=this.context)==null?void 0:i.extendWrapper),this.$content.classList.toggle(this.wrapClassName("preview-active"),this.isShowPreview),this.isShowPreview?((n=this.context)!=null&&n.extendWrapper&&((s=(r=this.context)==null?void 0:r.extendWrapper)==null||s.appendChild(this.renderPreviewMask()),(a=(o=this.context)==null?void 0:o.extendWrapper)==null||a.appendChild(this.renderPreview()),this.context.extendWrapper.style.display="block"),setTimeout(()=>{const l=this.$preview.querySelector("."+this.wrapClassName(`preview-page-${this.pageIndex}`));l&&(this.sideEffect.add(()=>{const u=new vr({container:this.$preview,elements_selector:`.${this.wrapClassName("preview-page>img")}`});return()=>u.destroy()},"preview-lazyload"),this.$preview.scrollTo({top:l.offsetTop-16})),l&&this.$preview.scrollTo({top:l.offsetTop-16})})):(c=this.context)!=null&&c.extendWrapper&&(this.context.extendWrapper.style.display="none",this.context.extendWrapper.innerHTML="")}wrapClassName(e){return`${this.namespace}-${e}`}}function sn(t,e,i){return Math.min(Math.max(t,e),i)}function Tu(t){return t.touches?t.touches[0]:t}function hp(t){t.stopPropagation(),t.cancelable&&t.preventDefault()}function pp(t){if(!t)return!1;const e=t.tagName;return e==="INPUT"||e==="TEXTAREA"||e==="SELECT"}class Mx{constructor(e){var i,n,r;this.velocity=0,this.paused=!0,this._animationFrameID=null,this._loopTimestamp=0,this.looper=s=>{if(this.paused)return;let o=Math.floor((s-this._loopTimestamp)/1e3*60)+1;for(this._loopTimestamp=s;o-- >0;)this.stepper();this.onStep(this.current,this),!this.paused&&this.current!==this.target&&window.requestAnimationFrame(this.looper)},this.current=(i=e.start)!=null?i:0,this.target=this.current,this.stiffness=(n=e.stiffness)!=null?n:170,this.damping=(r=e.damping)!=null?r:26,this.onStep=e.onStep}stepTo(e,i){this.paused&&i!=null&&(this.current=i),this.paused=!1,this.target=e,this.onStep(this.current,this),this._loopTimestamp=Date.now(),window.requestAnimationFrame(this.looper)}pause(){this.paused=!0}destroy(){this.pause()}stepper(){const e=-this.stiffness*(this.current-this.target),i=-this.damping*this.velocity,n=this.velocity+(e+i)/60,r=this.current+n/60;Math.abs(n-0)<.01&&Math.abs(r-this.target)<.01?(this.current=this.target,this.velocity=0):(this.current=r,this.velocity=n)}}class Sx{constructor(e,i,n,r){this.scale=1,this.lastVisit=Date.now(),this.pageOffsetY=0,this.pageOffsetX=0,this.visible=!0,this.index=e,this.page=i,this.scale=n,this.pageOffsetX=(r-i.width)/2;const s=document.createElement("div");s.className="page-renderer-page",s.dataset.index=`${e}`,s.style.width=`${i.width*n}px`,s.style.height=`${i.height*n}px`,i.thumbnail&&(s.style.backgroundImage=`url("${i.thumbnail}")`);const o=document.createElement("img");o.className="page-renderer-page-img",o.width=i.width,o.height=i.height,o.src=i.src,s.appendChild(o),this.$page=s}translateY(e){Math.abs(e-this.pageOffsetY)>=.001&&(this.pageOffsetY=e,this.$page.style.transform=`translate(${this.pageOffsetX*this.scale}px, ${this.pageOffsetY*this.scale}px)`)}setScale(e){Math.abs(e-this.scale)>=.001&&(this.scale=e,this.$page.style.width=`${this.page.width*this.scale}px`,this.$page.style.height=`${this.page.height*this.scale}px`,this.$page.style.transform=`translate(${this.pageOffsetX*this.scale}px, ${this.pageOffsetY*this.scale}px)`)}setVisible(e){e!==this.visible&&(this.visible=e,this.$page.style.opacity=e?"1":"0")}}const Ix=window.requestIdleCallback||(t=>window.setTimeout(t,5e3)),Cx=window.cancelIdleCallback||window.clearTimeout;class bx{constructor(e,i,n){this.pages=e,this.pagesIntrinsicWidth=i,this.scale=n,this.els=new Map,this.maxElCount=200,this.gcTimer=null,this.gc=()=>{if(this.gcTimer=null,this.els.size>this.maxElCount){const r=[...this.els.values()].sort((s,o)=>o.lastVisit-s.lastVisit);for(let s=Math.floor(this.maxElCount/4);s<r.length;s++)this.els.delete(r[s].index)}}}getEl(e){let i=this.els.get(e);return i||(i=new Sx(e,this.pages[e],this.scale,this.pagesIntrinsicWidth),this.els.set(e,i)),i.lastVisit=Date.now(),this.els.size>this.maxElCount&&this.gcTimer===null&&(this.gcTimer=Ix(this.gc)),i}setScale(e){e!==this.scale&&(this.scale=e,this.els.forEach(i=>i.setScale(e)))}destroy(){this.els.clear(),this.gcTimer!==null&&(Cx(this.gcTimer),this.gcTimer=null)}}class Ax{constructor(e){this._hwaTimeout=NaN,this._turnOffHWA=()=>{window.clearTimeout(this._hwaTimeout),this._hwaTimeout=NaN,this.$pages.classList.toggle("is-hwa",!1)},this.pagesScrollTop=e.pagesScrollTop||0,this.containerWidth=e.containerWidth||1,this.containerHeight=e.containerHeight||1,this.pages=e.pages.map(s=>{if(s.thumbnail)return s;try{const o=new URL(s.src);return o.searchParams.set("x-oss-process","image/resize,l_50"),{...s,thumbnail:o.toString()}}catch(o){return console.error(o),s}});const i=Array(this.pages.length);let n=1/0,r=0;this.pagesIntrinsicHeight=this.pages.reduce((s,o,a)=>(i[a]=s,o.width>r&&(r=o.width),o.height<=n&&(n=o.height),s+o.height),0),this.pagesIntrinsicWidth=r,this.pagesMinHeight=n,this.pagesIntrinsicYs=i,this.scale=this._calcScale(),this.threshold=this._calcThreshold(),this.onPageIndexChanged=e.onPageIndexChanged,this.pageScrollIndex=0,this.pagesScrollTop!==0&&(this.pageScrollIndex=this.findScrollPageIndex(),this.onPageIndexChanged&&this.pageScrollIndex>0&&this.onPageIndexChanged(this.pageScrollIndex)),this.pageElManager=new bx(this.pages,r,this.scale),this.$pages=this.renderPages()}setContainerSize(e,i){e>0&&i>0&&(e!==this.containerWidth||i!==this.containerHeight)&&(this.containerWidth=e,this.containerHeight=i,this.$pages.style.width=`${this.containerWidth}px`,this.$pages.style.height=`${this.containerHeight}px`,this.scale=this._calcScale(),this.threshold=this._calcThreshold(),this.pageElManager.setScale(this.scale),this.$pages.parentElement&&this.pagesScrollTo(this.pagesScrollTop,!0))}renderPages(){const e=document.createElement("div");return e.className="page-renderer-pages-container",e.style.width=`${this.containerWidth}px`,e.style.height=`${this.containerHeight}px`,e}pagesScrollTo(e,i){if(e=sn(e,0,this.pagesIntrinsicHeight-this.containerHeight/this.scale),i||Math.abs(e-this.pagesScrollTop)>=.001){this._turnOnHWA(),this.pagesScrollTop=e;const n=this.findScrollPageIndex(),r=Math.max(n-this.threshold,0),s=Math.min(n+this.threshold,this.pages.length-1);for(let o=0;o<this.$pages.children.length;o++){const a=this.$pages.children[o],c=Number(a.dataset.index);c>=r&&c<=s||(a.remove(),o--)}for(let o=r;o<=s;o++){const a=this.pageElManager.getEl(o);a.$page.parentElement!==this.$pages&&this.$pages.appendChild(a.$page),a.translateY(this.pagesIntrinsicYs[o]-this.pagesScrollTop)}n!==this.pageScrollIndex&&(this.pageScrollIndex=n,this.onPageIndexChanged&&this.onPageIndexChanged(n))}}findScrollPageIndex(){for(let e=0;e<this.pagesIntrinsicYs.length;e++)if(this.pagesIntrinsicYs[e]+this.pages[e].height-this.pagesScrollTop>=.001)return e;return this.pagesIntrinsicYs.length-1}mount(e){e.appendChild(this.$pages),this.pagesScrollTo(this.pagesScrollTop,!0)}unmount(){this.$pages.remove()}destroy(){this.unmount(),this.onPageIndexChanged=void 0,this.pageElManager.destroy(),this._hwaTimeout&&(window.clearTimeout(this._hwaTimeout),this._hwaTimeout=NaN)}_calcScale(){return this.containerWidth/this.pagesIntrinsicWidth||1}_calcThreshold(){return sn(Math.ceil(this.containerHeight/this.scale/this.pagesMinHeight/2),1,this.pages.length)}_turnOnHWA(){this._hwaTimeout?window.clearTimeout(this._hwaTimeout):this.$pages.classList.toggle("is-hwa",!0),this._hwaTimeout=window.setTimeout(this._turnOffHWA,1e3)}}const Tx=30;class Ex{constructor(e){this.sideEffect=new io,this.pagesScrollTop=e.pagesScrollTop||0,this.containerWidth=e.containerWidth||1,this.containerHeight=e.containerHeight||1,this.pagesWidth=e.pagesWidth||1,this.pagesHeight=e.pagesHeight||1,this.scale=this._calcScale(),this.scrollbarMinHeight=e.scrollbarMinHeight||Tx,this.scrollbarHeight=this._calcScrollbarHeight(),this.readonly=e.readonly,this.wrapClassName=e.wrapClassName,this.onDragScroll=e.onDragScroll,this.$scrollbar=this.renderScrollbar()}mount(e){e.appendChild(this.$scrollbar),this.pagesScrollTo(this.pagesScrollTop,!0)}unmount(){this.$scrollbar.remove()}setReadonly(e){this.readonly=e}setContainerSize(e,i){e>0&&i>0&&(e!==this.containerWidth||i!==this.containerHeight)&&(this.containerWidth=e,this.containerHeight=i,this.scale=this._calcScale(),this._updateScrollbarHeight(),this.$scrollbar.parentElement&&this.pagesScrollTo(this.pagesScrollTop,!0))}pagesScrollTo(e,i){if(e=sn(e,0,this.pagesHeight-this.containerHeight/this.scale),i||Math.abs(e-this.pagesScrollTop)>=.001){this.pagesScrollTop=e;const n=this.pagesScrollTop*this.scale,r=this.pagesHeight*this.scale,s=n/(r-this.containerHeight)*(this.containerHeight-this.scrollbarHeight);window.requestAnimationFrame?window.requestAnimationFrame(()=>{this.$scrollbar.style.transform=`translateY(${s}px)`}):this.$scrollbar.style.transform=`translateY(${s}px)`}}destroy(){this.unmount(),this.onDragScroll=void 0,this.sideEffect.flushAll()}renderScrollbar(){const e=document.createElement("button");e.className=this.wrapClassName("scrollbar"),e.style.minHeight=`${this.scrollbarMinHeight}px`,e.style.height=`${this.scrollbarHeight}px`;const i=n=>{if(this.readonly||n.button!=null&&n.button!==0)return;hp(n);const r=this.wrapClassName("scrollbar-dragging");e.classList.toggle(r,!0);const s=this.pagesScrollTop,{clientY:o}=Tu(n),a=l=>{if(this.readonly)return;const{clientY:u}=Tu(l),d=(u-o)/this.scale;Math.abs(d)>0&&this.onDragScroll&&this.onDragScroll(s+d*(this.pagesHeight*this.scale/this.containerHeight))},c=()=>{e.classList.toggle(r,!1),window.removeEventListener("mousemove",a,!0),window.removeEventListener("touchmove",a,!0),window.removeEventListener("mouseup",c,!0),window.removeEventListener("touchend",c,!0),window.removeEventListener("touchcancel",c,!0)};window.addEventListener("mousemove",a,!0),window.addEventListener("touchmove",a,!0),window.addEventListener("mouseup",c,!0),window.addEventListener("touchend",c,!0),window.addEventListener("touchcancel",c,!0)};return this.sideEffect.addEventListener(e,"mousedown",i),this.sideEffect.addEventListener(e,"touchstart",i),e}_calcScale(){return this.containerWidth/this.pagesWidth||1}_calcScrollbarHeight(){return sn(this.containerHeight/(this.pagesHeight*this.scale)*this.containerHeight,this.scrollbarMinHeight,this.containerHeight)}_updateScrollbarHeight(){const e=this._calcScrollbarHeight();Math.abs(e-this.scrollbarHeight)>.001&&(this.scrollbarHeight=e,this.$scrollbar.style.height=`${e}px`)}}const Nx=window.ResizeObserver||cy,kx=640;class Px{constructor({context:e,whiteboardView:i,readonly:n,box:r,pages:s,pageScrollTop:o=0,mountWhiteboard:a,onUserScroll:c,baseScenePath:l,appId:u}){this.sideEffect=new io,this.userScrolling=!1,this.onNewPageIndex=w=>{this.scrollToPage(w)},this.toPdf=async()=>{const w=document.createElement("canvas"),x=w.getContext("2d");if(!x||!this.baseScenePath){this.reportProgress(100,null);return}const h=this.whiteboardView.focusScenePath||`${this.baseScenePath}/1`,p=this.pages[0],{jsPDF:g}=await Promise.resolve().then(function(){return Ug(require("jspdf"))}),m=new g({format:[p.width,p.height],orientation:p.width>p.height?"l":"p",compress:!0});for(const[M,E]of this.pages.entries()){const{width:z,height:P,src:L}=E;w.width=z,w.height=P;const S=z>P?"l":"p";M>0&&m.addPage([z,P],S);const N=await this.getBase64FromUrl(L),I=document.createElement("img");I.src=N,await new Promise(we=>I.onload=we),x.drawImage(I,0,0);const U=w.toDataURL("image/jpeg",.6);x.clearRect(0,0,z,P);const Q={centerX:z/2,centerY:P/2+M*P,scale:1},O=this.context.manager.windowManger;O._appliancePlugin?await O._appliancePlugin.screenshotToCanvasAsync(x,h,z,P,Q):this.whiteboardView.screenshotToCanvas(x,h,z,P,Q);const q=w.toDataURL("image/png");m.addImage(U,"JPEG",0,0,z,P,"","FAST"),m.addImage(q,"PNG",0,0,z,P,"","FAST"),x.clearRect(0,0,z,P),Math.ceil((M+1)/this.pages.length*100)<100&&this.reportProgress(Math.ceil((M+1)/this.pages.length*100),null)}const y=m.output("arraybuffer");this.reportProgress(100,{pdf:y,title:this.box.title})},this.context=e,this.whiteboardView=i,this.readonly=n,this.box=r,this.pages=s,this.baseScenePath=l,this.appId=u,this.mountWhiteboard=a,this._onUserScroll=c;const d=this.debounce(()=>{this.userScrolling=!1,this._onUserScroll&&this._onUserScroll(this.pageRenderer.pagesScrollTop)},{wait:80},"debounce-updateUserScroll");this.updateUserScroll=()=>{this.userScrolling=!0,d()},this.viewer=new dp({context:e,readonly:n,box:r,pages:s,onNewPageIndex:this.onNewPageIndex});const{width:f,height:v}=this.whiteboardView.size;this.pageRenderer=new Ax({pagesScrollTop:o,pages:this.pages,containerWidth:f,containerHeight:v,onPageIndexChanged:this.viewer.setPageIndex.bind(this.viewer)}),this.scrollbar=new Ex({pagesScrollTop:this.pageRenderer.pagesScrollTop,containerWidth:f,containerHeight:v,pagesWidth:this.pageRenderer.pagesIntrinsicWidth,pagesHeight:this.pageRenderer.pagesIntrinsicHeight,readonly:this.readonly,wrapClassName:this.wrapClassName.bind(this),onDragScroll:w=>{this.pageScrollTo(w),this.updateUserScroll()}}),this.pageScrollStepper=new Mx({start:this.pageRenderer.pagesScrollTop,onStep:w=>{this.pageScrollTo(w)}}),this.render()}mount(){this.viewer.mount(),this.setupScrollListener();const e=this.debounce(this.renderRatioHeight.bind(this),{wait:80});return this.sideEffect.add(()=>{const i=new Nx(e);return i.observe(this.viewer.$content),()=>i.disconnect()}),this.sideEffect.setTimeout(()=>{this.userScrolling||this.pageScrollTo(this.pageRenderer.pagesScrollTop)},100),this.sideEffect.add(()=>{const i=n=>{n.data.type==="@netless/_request_save_pdf_"&&n.data.appId===this.appId&&this.toPdf().catch(()=>this.reportProgress(100,null))};return window.addEventListener("message",i),()=>{window.removeEventListener("message",i)}}),this}unmount(){return this.viewer.unmount(),this}setReadonly(e){this.readonly!==e&&(this.readonly=e,this.viewer.setReadonly(e),this.scrollbar.setReadonly(e))}destroy(){this.sideEffect.flushAll(),this.pageScrollStepper.destroy(),this._onUserScroll=void 0,this.unmount(),this.viewer.destroy(),this.pageRenderer.destroy(),this.scrollbar.destroy()}syncPageScrollTop(e){!this.userScrolling&&e>=0&&Math.abs(this.pageRenderer.pagesScrollTop-e)>.01&&this.pageScrollStepper.stepTo(e,this.pageRenderer.pagesScrollTop)}render(){this.pageRenderer.mount(this.viewer.$content),this.viewer.$content.appendChild(this.renderWhiteboardView()),this.scrollbar.mount(this.viewer.$content),this.renderRatioHeight()}renderRatioHeight(){const i=Math.round(this.box.absoluteHeight)<=kx;this.viewer.setSmallBox(i),this.box.$titleBar&&(this.box.$titleBar.style.height="2.778vw"),this.box.$footer&&(this.box.$footer.style.height="2.778vw")}renderWhiteboardView(){return this.$whiteboardView||(this.$whiteboardView=document.createElement("div"),this.$whiteboardView.className=this.wrapClassName("wb-view"),this.mountWhiteboard(this.$whiteboardView),this.sideEffect.addEventListener(this.$whiteboardView,"wheel",e=>{hp(e),this.readonly||(this.pageScrollTo(this.pageRenderer.pagesScrollTop+e.deltaY),this.updateUserScroll())},{passive:!1,capture:!0}),this.sideEffect.addEventListener(this.$whiteboardView,"touchmove",e=>{this.readonly||e.touches.length<=1||this.updateUserScroll()},{passive:!0,capture:!0})),this.$whiteboardView}scrollTopPageToEl(e){return e*this.pageRenderer.scale}scrollTopElToPage(e){return e/this.pageRenderer.scale}elScrollTo(e){this.pageScrollTo(this.scrollTopElToPage(e))}pageScrollTo(e){const i=this.scrollTopElToPage(this.whiteboardView.size.height/2);this.whiteboardView.moveCamera({centerY:sn(e+i,i,this.pageRenderer.pagesIntrinsicHeight-i),animationMode:"immediately"})}scrollToPage(e){if(!this.readonly&&!Number.isNaN(e)){const i=this.pageRenderer.pagesIntrinsicYs[e];i>=0&&(this.pageScrollTo(i+5/this.pageRenderer.scale),this.updateUserScroll())}}setupScrollListener(){this.sideEffect.add(()=>{const e=i=>{const{width:n,height:r}=this.whiteboardView.size;if(n<=0||r<=0)return;const s=i.centerY-this.pageRenderer.containerHeight/this.pageRenderer.scale/2;this.pageRenderer.pagesScrollTo(s),this.scrollbar.pagesScrollTo(s)};return this.whiteboardView.callbacks.on("onCameraUpdated",e),()=>this.whiteboardView.callbacks.off("onCameraUpdated",e)}),this.sideEffect.add(()=>{const{updateUserScroll:e}=this;return this.whiteboardView.callbacks.on("onCameraUpdatedByDevice",e),()=>this.whiteboardView.callbacks.off("onCameraUpdatedByDevice",e)}),this.sideEffect.add(()=>{const e=({width:i,height:n})=>{if(i<=0||n<=0)return;this.pageRenderer.setContainerSize(i,n),this.scrollbar.setContainerSize(i,n);const{pagesIntrinsicWidth:r,pagesIntrinsicHeight:s}=this.pageRenderer;this.whiteboardView.moveCameraToContain({originX:0,originY:this.pageRenderer.pagesScrollTop,width:r,height:n/this.pageRenderer.scale,animationMode:"immediately"}),this.whiteboardView.setCameraBound({damping:1,maxContentMode:()=>this.pageRenderer.scale,minContentMode:()=>this.pageRenderer.scale,centerX:r/2,centerY:s/2,width:r,height:s})};return this.whiteboardView.callbacks.on("onSizeUpdated",e),()=>{this.whiteboardView.callbacks.off("onSizeUpdated",e)}},"whiteboard-size-update"),this.sideEffect.addEventListener(window,"keyup",e=>{if(this.readonly||!this.box.focus||this.box.minimized||pp(e.target))return;let i=null;switch(e.key){case"PageDown":{i=this.pageRenderer.pagesScrollTop+this.pageRenderer.containerHeight/this.pageRenderer.scale;break}case"PageUp":{i=this.pageRenderer.pagesScrollTop-this.pageRenderer.containerHeight/this.pageRenderer.scale;break}case"ArrowDown":{i=this.pageRenderer.pagesScrollTop+this.pageRenderer.containerHeight/4/this.pageRenderer.scale;break}case"ArrowUp":{i=this.pageRenderer.pagesScrollTop-this.pageRenderer.containerHeight/4/this.pageRenderer.scale;break}}i!==null&&(this._onUserScroll?this._onUserScroll(i):(this.pageScrollTo(i),this.updateUserScroll()))},{capture:!0})}debounce(e,i,n){const r=Rw(e,i);return this.sideEffect.addDisposer(()=>r.cancel(),n),r}wrapClassName(e){return"netless-app-docs-viewer-static-"+e}async getBase64FromUrl(e){const n=await(await fetch(this._invalidate(e))).blob();return new Promise(r=>{const s=new FileReader;s.readAsDataURL(n),s.onloadend=()=>{const o=s.result;r(o)}})}_invalidate(e){try{const i=new URL(e);return i.searchParams.set("t",Date.now().toString()),i.toString()}catch{return e}}reportProgress(e,i){window.postMessage({type:"@netless/_result_save_pdf_",appId:this.appId,progress:e,result:i})}}class Bx{constructor({context:e,whiteboardView:i,box:n,pages:r}){this.sideEffect=new io,this.onPlayPPT=()=>{const s=this.context.getRoom();s&&s.pptNextStep()},this._scaleDocsToFitImpl=()=>{const s=this.pages[this.getPageIndex()];s&&(this.whiteboardView.moveCameraToContain({originX:-s.width/2,originY:-s.height/2,width:s.width,height:s.height,animationMode:"immediately"}),this.whiteboardView.setCameraBound({damping:1,maxContentMode:()=>this.whiteboardView.camera.scale,minContentMode:()=>this.whiteboardView.camera.scale,centerX:0,centerY:0,width:s.width,height:s.height}))},this._scaleDocsToFitDebounced=()=>{this.sideEffect.setTimeout(this._scaleDocsToFitImpl,1e3,"_scaleDocsToFitDebounced")},this.scaleDocsToFit=()=>{this._scaleDocsToFitImpl(),this._scaleDocsToFitDebounced()},this.onNewPageIndex=s=>{this.jumpToPage(s,!0)},this.context=e,this.whiteboardView=i,this.box=n,this.pages=r,this.displayer=e.getDisplayer(),this.viewer=new dp({context:e,readonly:!e.getIsWritable(),box:n,pages:r,onNewPageIndex:this.onNewPageIndex,onPlay:this.onPlayPPT}),this.render(),this.sideEffect.add(()=>{const s=o=>{this.viewer.setReadonly(!o)};return this.context.emitter.on("writableChange",s),()=>this.context.emitter.off("writableChange",s)}),this.sideEffect.add(()=>{const s=o=>{this.jumpToPage(o.index)};return this.context.emitter.on("sceneStateChange",s),()=>this.context.emitter.off("sceneStateChange",s)}),this.sideEffect.add(()=>{const s=o=>{this.jumpToPage(o.index)};return this.context.emitter.on("pageStateChange",s),()=>this.context.emitter.off("pageStateChange",s)}),this.sideEffect.add(()=>{const s=o=>{this.viewer.togglePreview(o)};return this.context.emitter.on("togglePreview",s),()=>this.context.emitter.off("togglePreview",s)})}mount(){this.viewer.mount();const e=this.getPageIndex();return e!==0&&this.jumpToPage(e),this.scaleDocsToFit(),this.sideEffect.add(()=>(this.whiteboardView.callbacks.on("onSizeUpdated",this.scaleDocsToFit),()=>{this.whiteboardView.callbacks.off("onSizeUpdated",this.scaleDocsToFit)})),this}unmount(){return this.viewer.unmount(),this}destroy(){this.sideEffect.flushAll(),this.unmount(),this.viewer.destroy()}getPageIndex(){return this.displayer.state.sceneState.index}jumpToPage(e,i){var n,r;if(e=sn(e,0,this.pages.length-1),e!==this.getPageIndex()&&this.context.getIsWritable()){const s=this.context.getInitScenePath(),o=(r=(n=this.context.getScenes())==null?void 0:n[e])==null?void 0:r.name;s&&o&&this.context.setScenePath(`${s}/${o}`),this.scaleDocsToFit()}if(e!==this.viewer.pageIndex&&this.viewer.setPageIndex(e),i){const s=this.context.getRoom();if(s){const o=s.state.globalState.__pptState;s.setGlobalState({__pptState:o&&{uuid:o.uuid,pageIndex:e,disableAutoPlay:o.disableAutoPlay}})}}}render(){this.viewer.$content.appendChild(this.renderMask()),this.viewer.$content.appendChild(this.renderWhiteboardView()),this.sideEffect.addEventListener(window,"keydown",e=>{var i;if(this.box.focus&&!pp(e.target))switch(e.key){case"ArrowUp":case"ArrowLeft":{this.jumpToPage(this.getPageIndex()-1,!0);break}case"ArrowRight":case"ArrowDown":{(i=this.context.getRoom())==null||i.pptNextStep();break}}})}renderMask(){if(!this.$mask){const e=document.createElement("div");e.className=this.wrapClassName("mask"),this.$mask=e;const i=document.createElement("button");i.className=this.wrapClassName("back");const n=document.createElement("button");n.className=this.wrapClassName("next")}return this.$mask}renderWhiteboardView(){return this.$whiteboardView||(this.$whiteboardView=document.createElement("div"),this.$whiteboardView.className=this.wrapClassName("wb-view"),this.sideEffect.addEventListener(this.$whiteboardView,"click",e=>{var i;const n=this.context.getRoom();if(n&&n.state.memberState.currentApplianceName==="clicker"){for(let r=e.target;r;r=r.parentElement)if((i=r.classList)!=null&&i.contains("ppt-event-source"))return;n.pptNextStep()}}),this.context.mountView(this.$whiteboardView)),this.$whiteboardView}wrapClassName(e){return"netless-app-docs-viewer-dynamic-"+e}}const zx="DocsViewer",Eu="0.2.23.wukongBeta.1",ga={kind:zx,setup(t){console.log("SDK \u7248\u672C\u4FE1\u606F-App App Docs Viewer ",Eu);const e=document.createElement("div");e.style.position="absolute",e.style.top="290px",e.style.left="0",e.style.color="red",e.style.fontSize="12px",e.style.zIndex="99999",e.innerHTML=`SDK \u7248\u672C\u4FE1\u606F-App App Docs Viewer ${Eu}`,document.body.appendChild(e);const i=t.getBox(),n=t.getScenes();if(!n)throw new Error("[Docs Viewer]: scenes not found.");const r=t.getView();if(!r)throw new Error("[Docs Viewer]: no whiteboard view.");const s=n.map(({ppt:o})=>o?{width:o.width,height:o.height,src:o.src,thumbnail:o.previewURL}:null).filter(o=>Boolean(o));if(s.length<=0)throw new Error("[Docs Viewer]: empty scenes.");return i.mountStyles(Ew),s[0].src.startsWith("ppt")?Lx(t,r,i,s):Dx(t,r,i,s)}};function Dx(t,e,i,n){var r,s,o,a;e.disableCameraTransform=!t.getIsWritable();const c=new Px({context:t,whiteboardView:e,readonly:!t.getIsWritable(),box:i,pages:n,pageScrollTop:(r=t.getAttributes())==null?void 0:r.pageScrollTop,mountWhiteboard:t.mountView.bind(t),onUserScroll:u=>{var d;((d=t.getAttributes())==null?void 0:d.pageScrollTop)!==u&&!i.readonly&&t.updateAttributes(["pageScrollTop"],u)},baseScenePath:t.getInitScenePath(),appId:t.appId}).mount();c.viewer.onPageIndexChanged=u=>{t.dispatchAppEvent("pageStateChange",{index:u,length:n.length})},t.dispatchAppEvent("pageStateChange",{index:c.viewer.pageIndex,length:n.length}),t.emitter.on("attributesUpdate",u=>{u&&u.pageScrollTop!=null&&c.syncPageScrollTop(u.pageScrollTop)}),t.emitter.on("writableChange",u=>{c.setReadonly(!u),e.disableCameraTransform=!u});const l={viewer:()=>c,position:()=>{const u=c==null?void 0:c.viewer;if(u)return[u.pageIndex,c.pages.length]}};return((a=(o=(s=t.getInitScenePath())==null?void 0:s.toLowerCase())==null?void 0:o.indexOf("pdf"))!=null?a:0)>0?{...l,togglePreview:u=>{c.viewer.togglePreview(u)}}:l}function Lx(t,e,i,n){e.disableCameraTransform=!0;const r=new Bx({context:t,whiteboardView:e,box:i,pages:n}).mount();return r.viewer.onPageIndexChanged=s=>{t.dispatchAppEvent("pageStateChange",{index:s,length:n.length})},t.dispatchAppEvent("pageStateChange",{index:r.getPageIndex(),length:n.length}),t.mountView(r.$whiteboardView),t.isAddApp&&e.callbacks.once("onSizeUpdated",({width:s,height:o})=>{if(n.length>0&&i.state!=="maximized"){const{width:a,height:c}=n[0],u=c/a*s-o;u!==0&&t.getIsWritable()&&t.emitter.emit("setBoxSize",{width:i.width,height:i.height+u/i.containerRect.height})}}),{viewer:()=>r,position:()=>{const s=r==null?void 0:r.viewer;if(s)return[s.pageIndex,r.pages.length]},nextStep:()=>r.onPlayPPT(),nextPage:()=>r.jumpToPage(r.getPageIndex()+1,!0),prevPage:()=>r.jumpToPage(r.getPageIndex()+1,!0),jumpToPage:s=>{typeof s=="number"&&r.jumpToPage(s,!0)},togglePreview:s=>{r.viewer.togglePreview(s)}}}var Ti={exports:{}},ie={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var Nu=Object.getOwnPropertySymbols,jx=Object.prototype.hasOwnProperty,Rx=Object.prototype.propertyIsEnumerable;function _x(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function Vx(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;var n=Object.getOwnPropertyNames(e).map(function(s){return e[s]});if(n.join("")!=="0123456789")return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(s){r[s]=s}),Object.keys(Object.assign({},r)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var fp=Vx()?Object.assign:function(t,e){for(var i,n=_x(t),r,s=1;s<arguments.length;s++){i=Object(arguments[s]);for(var o in i)jx.call(i,o)&&(n[o]=i[o]);if(Nu){r=Nu(i);for(var a=0;a<r.length;a++)Rx.call(i,r[a])&&(n[r[a]]=i[r[a]])}}return n};/** @license React v16.14.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ol=fp,st=typeof Symbol=="function"&&Symbol.for,wr=st?Symbol.for("react.element"):60103,Ox=st?Symbol.for("react.portal"):60106,$x=st?Symbol.for("react.fragment"):60107,Wx=st?Symbol.for("react.strict_mode"):60108,Ux=st?Symbol.for("react.profiler"):60114,Hx=st?Symbol.for("react.provider"):60109,Fx=st?Symbol.for("react.context"):60110,Zx=st?Symbol.for("react.forward_ref"):60112,Qx=st?Symbol.for("react.suspense"):60113,Gx=st?Symbol.for("react.memo"):60115,Yx=st?Symbol.for("react.lazy"):60116,ku=typeof Symbol=="function"&&Symbol.iterator;function yr(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mp={};function fn(t,e,i){this.props=t,this.context=e,this.refs=mp,this.updater=i||gp}fn.prototype.isReactComponent={};fn.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error(yr(85));this.updater.enqueueSetState(this,t,e,"setState")};fn.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function vp(){}vp.prototype=fn.prototype;function $l(t,e,i){this.props=t,this.context=e,this.refs=mp,this.updater=i||gp}var Wl=$l.prototype=new vp;Wl.constructor=$l;Ol(Wl,fn.prototype);Wl.isPureReactComponent=!0;var Ul={current:null},wp=Object.prototype.hasOwnProperty,yp={key:!0,ref:!0,__self:!0,__source:!0};function xp(t,e,i){var n,r={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)wp.call(e,n)&&!yp.hasOwnProperty(n)&&(r[n]=e[n]);var a=arguments.length-2;if(a===1)r.children=i;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];r.children=c}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)r[n]===void 0&&(r[n]=a[n]);return{$$typeof:wr,type:t,key:s,ref:o,props:r,_owner:Ul.current}}function Xx(t,e){return{$$typeof:wr,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Hl(t){return typeof t=="object"&&t!==null&&t.$$typeof===wr}function Jx(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(i){return e[i]})}var Mp=/\/+/g,Ss=[];function Sp(t,e,i,n){if(Ss.length){var r=Ss.pop();return r.result=t,r.keyPrefix=e,r.func=i,r.context=n,r.count=0,r}return{result:t,keyPrefix:e,func:i,context:n,count:0}}function Ip(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>Ss.length&&Ss.push(t)}function ma(t,e,i,n){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(r){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case wr:case Ox:s=!0}}if(s)return i(n,t,e===""?"."+jo(t,0):e),1;if(s=0,e=e===""?".":e+":",Array.isArray(t))for(var o=0;o<t.length;o++){r=t[o];var a=e+jo(r,o);s+=ma(r,a,i,n)}else if(t===null||typeof t!="object"?a=null:(a=ku&&t[ku]||t["@@iterator"],a=typeof a=="function"?a:null),typeof a=="function")for(t=a.call(t),o=0;!(r=t.next()).done;)r=r.value,a=e+jo(r,o++),s+=ma(r,a,i,n);else if(r==="object")throw i=""+t,Error(yr(31,i==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":i,""));return s}function va(t,e,i){return t==null?0:ma(t,"",e,i)}function jo(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Jx(t.key):e.toString(36)}function Kx(t,e){t.func.call(t.context,e,t.count++)}function qx(t,e,i){var n=t.result,r=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?wa(t,n,i,function(s){return s}):t!=null&&(Hl(t)&&(t=Xx(t,r+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(Mp,"$&/")+"/")+i)),n.push(t))}function wa(t,e,i,n,r){var s="";i!=null&&(s=(""+i).replace(Mp,"$&/")+"/"),e=Sp(e,s,n,r),va(t,qx,e),Ip(e)}var Cp={current:null};function Dt(){var t=Cp.current;if(t===null)throw Error(yr(321));return t}var e0={ReactCurrentDispatcher:Cp,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:Ul,IsSomeRendererActing:{current:!1},assign:Ol};ie.Children={map:function(t,e,i){if(t==null)return t;var n=[];return wa(t,n,null,e,i),n},forEach:function(t,e,i){if(t==null)return t;e=Sp(null,null,e,i),va(t,Kx,e),Ip(e)},count:function(t){return va(t,function(){return null},null)},toArray:function(t){var e=[];return wa(t,e,null,function(i){return i}),e},only:function(t){if(!Hl(t))throw Error(yr(143));return t}};ie.Component=fn;ie.Fragment=$x;ie.Profiler=Ux;ie.PureComponent=$l;ie.StrictMode=Wx;ie.Suspense=Qx;ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e0;ie.cloneElement=function(t,e,i){if(t==null)throw Error(yr(267,t));var n=Ol({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Ul.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)wp.call(e,c)&&!yp.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=i;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];n.children=a}return{$$typeof:wr,type:t.type,key:r,ref:s,props:n,_owner:o}};ie.createContext=function(t,e){return e===void 0&&(e=null),t={$$typeof:Fx,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider={$$typeof:Hx,_context:t},t.Consumer=t};ie.createElement=xp;ie.createFactory=function(t){var e=xp.bind(null,t);return e.type=t,e};ie.createRef=function(){return{current:null}};ie.forwardRef=function(t){return{$$typeof:Zx,render:t}};ie.isValidElement=Hl;ie.lazy=function(t){return{$$typeof:Yx,_ctor:t,_status:-1,_result:null}};ie.memo=function(t,e){return{$$typeof:Gx,type:t,compare:e===void 0?null:e}};ie.useCallback=function(t,e){return Dt().useCallback(t,e)};ie.useContext=function(t,e){return Dt().useContext(t,e)};ie.useDebugValue=function(){};ie.useEffect=function(t,e){return Dt().useEffect(t,e)};ie.useImperativeHandle=function(t,e,i){return Dt().useImperativeHandle(t,e,i)};ie.useLayoutEffect=function(t,e){return Dt().useLayoutEffect(t,e)};ie.useMemo=function(t,e){return Dt().useMemo(t,e)};ie.useReducer=function(t,e,i){return Dt().useReducer(t,e,i)};ie.useRef=function(t){return Dt().useRef(t)};ie.useState=function(t){return Dt().useState(t)};ie.version="16.14.0";Ti.exports=ie;var G=Ti.exports,bp={exports:{}},Ke={},Ap={exports:{}},Tp={};/** @license React v0.19.1
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){var e,i,n,r,s;if(typeof window=="undefined"||typeof MessageChannel!="function"){var o=null,a=null,c=function(){if(o!==null)try{var A=t.unstable_now();o(!0,A),o=null}catch(_){throw setTimeout(c,0),_}},l=Date.now();t.unstable_now=function(){return Date.now()-l},e=function(A){o!==null?setTimeout(e,0,A):(o=A,setTimeout(c,0))},i=function(A,_){a=setTimeout(A,_)},n=function(){clearTimeout(a)},r=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var u=window.performance,d=window.Date,f=window.setTimeout,v=window.clearTimeout;if(typeof console!="undefined"){var w=window.cancelAnimationFrame;typeof window.requestAnimationFrame!="function"&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),typeof w!="function"&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if(typeof u=="object"&&typeof u.now=="function")t.unstable_now=function(){return u.now()};else{var x=d.now();t.unstable_now=function(){return d.now()-x}}var h=!1,p=null,g=-1,m=5,y=0;r=function(){return t.unstable_now()>=y},s=function(){},t.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):m=0<A?Math.floor(1e3/A):5};var M=new MessageChannel,E=M.port2;M.port1.onmessage=function(){if(p!==null){var A=t.unstable_now();y=A+m;try{p(!0,A)?E.postMessage(null):(h=!1,p=null)}catch(_){throw E.postMessage(null),_}}else h=!1},e=function(A){p=A,h||(h=!0,E.postMessage(null))},i=function(A,_){g=f(function(){A(t.unstable_now())},_)},n=function(){v(g),g=-1}}function z(A,_){var Y=A.length;A.push(_);e:for(;;){var oe=Y-1>>>1,ce=A[oe];if(ce!==void 0&&0<S(ce,_))A[oe]=_,A[Y]=ce,Y=oe;else break e}}function P(A){return A=A[0],A===void 0?null:A}function L(A){var _=A[0];if(_!==void 0){var Y=A.pop();if(Y!==_){A[0]=Y;e:for(var oe=0,ce=A.length;oe<ce;){var ot=2*(oe+1)-1,at=A[ot],Ge=ot+1,Oe=A[Ge];if(at!==void 0&&0>S(at,Y))Oe!==void 0&&0>S(Oe,at)?(A[oe]=Oe,A[Ge]=Y,oe=Ge):(A[oe]=at,A[ot]=Y,oe=ot);else if(Oe!==void 0&&0>S(Oe,Y))A[oe]=Oe,A[Ge]=Y,oe=Ge;else break e}}return _}return null}function S(A,_){var Y=A.sortIndex-_.sortIndex;return Y!==0?Y:A.id-_.id}var N=[],I=[],U=1,Q=null,O=3,q=!1,W=!1,we=!1;function Ae(A){for(var _=P(I);_!==null;){if(_.callback===null)L(I);else if(_.startTime<=A)L(I),_.sortIndex=_.expirationTime,z(N,_);else break;_=P(I)}}function xt(A){if(we=!1,Ae(A),!W)if(P(N)!==null)W=!0,e(Mt);else{var _=P(I);_!==null&&i(xt,_.startTime-A)}}function Mt(A,_){W=!1,we&&(we=!1,n()),q=!0;var Y=O;try{for(Ae(_),Q=P(N);Q!==null&&(!(Q.expirationTime>_)||A&&!r());){var oe=Q.callback;if(oe!==null){Q.callback=null,O=Q.priorityLevel;var ce=oe(Q.expirationTime<=_);_=t.unstable_now(),typeof ce=="function"?Q.callback=ce:Q===P(N)&&L(N),Ae(_)}else L(N);Q=P(N)}if(Q!==null)var ot=!0;else{var at=P(I);at!==null&&i(xt,at.startTime-_),ot=!1}return ot}finally{Q=null,O=Y,q=!1}}function ki(A){switch(A){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var vn=s;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(A){A.callback=null},t.unstable_continueExecution=function(){W||q||(W=!0,e(Mt))},t.unstable_getCurrentPriorityLevel=function(){return O},t.unstable_getFirstCallbackNode=function(){return P(N)},t.unstable_next=function(A){switch(O){case 1:case 2:case 3:var _=3;break;default:_=O}var Y=O;O=_;try{return A()}finally{O=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=vn,t.unstable_runWithPriority=function(A,_){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var Y=O;O=A;try{return _()}finally{O=Y}},t.unstable_scheduleCallback=function(A,_,Y){var oe=t.unstable_now();if(typeof Y=="object"&&Y!==null){var ce=Y.delay;ce=typeof ce=="number"&&0<ce?oe+ce:oe,Y=typeof Y.timeout=="number"?Y.timeout:ki(A)}else Y=ki(A),ce=oe;return Y=ce+Y,A={id:U++,callback:_,priorityLevel:A,startTime:ce,expirationTime:Y,sortIndex:-1},ce>oe?(A.sortIndex=ce,z(I,A),P(N)===null&&A===P(I)&&(we?n():we=!0,i(xt,ce-oe))):(A.sortIndex=Y,z(N,A),W||q||(W=!0,e(Mt))),A},t.unstable_shouldYield=function(){var A=t.unstable_now();Ae(A);var _=P(N);return _!==Q&&Q!==null&&_!==null&&_.callback!==null&&_.startTime<=A&&_.expirationTime<Q.expirationTime||r()},t.unstable_wrapCallback=function(A){var _=O;return function(){var Y=O;O=_;try{return A.apply(this,arguments)}finally{O=Y}}}})(Tp);Ap.exports=Tp;/** @license React v16.14.0
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ao=Ti.exports,ke=fp,xe=Ap.exports;function C(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!ao)throw Error(C(227));function t0(t,e,i,n,r,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(i,l)}catch(u){this.onError(u)}}var Un=!1,Is=null,Cs=!1,ya=null,i0={onError:function(t){Un=!0,Is=t}};function n0(t,e,i,n,r,s,o,a,c){Un=!1,Is=null,t0.apply(i0,arguments)}function r0(t,e,i,n,r,s,o,a,c){if(n0.apply(this,arguments),Un){if(Un){var l=Is;Un=!1,Is=null}else throw Error(C(198));Cs||(Cs=!0,ya=l)}}var Fl=null,Ep=null,Np=null;function Pu(t,e,i){var n=t.type||"unknown-event";t.currentTarget=Np(i),r0(n,e,void 0,t),t.currentTarget=null}var bs=null,Oi={};function kp(){if(bs)for(var t in Oi){var e=Oi[t],i=bs.indexOf(t);if(!(-1<i))throw Error(C(96,t));if(!As[i]){if(!e.extractEvents)throw Error(C(97,t));As[i]=e,i=e.eventTypes;for(var n in i){var r=void 0,s=i[n],o=e,a=n;if(xa.hasOwnProperty(a))throw Error(C(99,a));xa[a]=s;var c=s.phasedRegistrationNames;if(c){for(r in c)c.hasOwnProperty(r)&&Bu(c[r],o,a);r=!0}else s.registrationName?(Bu(s.registrationName,o,a),r=!0):r=!1;if(!r)throw Error(C(98,n,t))}}}}function Bu(t,e,i){if(on[t])throw Error(C(100,t));on[t]=e,Zl[t]=e.eventTypes[i].dependencies}var As=[],xa={},on={},Zl={};function Pp(t){var e=!1,i;for(i in t)if(t.hasOwnProperty(i)){var n=t[i];if(!Oi.hasOwnProperty(i)||Oi[i]!==n){if(Oi[i])throw Error(C(102,i));Oi[i]=n,e=!0}}e&&kp()}var ii=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),Ma=null,Xi=null,Ji=null;function zu(t){if(t=Ep(t)){if(typeof Ma!="function")throw Error(C(280));var e=t.stateNode;e&&(e=Fl(e),Ma(t.stateNode,t.type,e))}}function Bp(t){Xi?Ji?Ji.push(t):Ji=[t]:Xi=t}function zp(){if(Xi){var t=Xi,e=Ji;if(Ji=Xi=null,zu(t),e)for(t=0;t<e.length;t++)zu(e[t])}}function Ql(t,e){return t(e)}function Dp(t,e,i,n,r){return t(e,i,n,r)}function Gl(){}var Lp=Ql,ai=!1,Ro=!1;function Yl(){(Xi!==null||Ji!==null)&&(Gl(),zp())}function jp(t,e,i){if(Ro)return t(e,i);Ro=!0;try{return Lp(t,e,i)}finally{Ro=!1,Yl()}}var s0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Du=Object.prototype.hasOwnProperty,Lu={},ju={};function o0(t){return Du.call(ju,t)?!0:Du.call(Lu,t)?!1:s0.test(t)?ju[t]=!0:(Lu[t]=!0,!1)}function a0(t,e,i,n){if(i!==null&&i.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:i!==null?!i.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function l0(t,e,i,n){if(e===null||typeof e=="undefined"||a0(t,e,i,n))return!0;if(n)return!1;if(i!==null)switch(i.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Pe(t,e,i,n,r,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=t,this.type=e,this.sanitizeURL=s}var Me={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Me[t]=new Pe(t,0,!1,t,null,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Me[e]=new Pe(e,1,!1,t[1],null,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Me[t]=new Pe(t,2,!1,t.toLowerCase(),null,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Me[t]=new Pe(t,2,!1,t,null,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Me[t]=new Pe(t,3,!1,t.toLowerCase(),null,!1)});["checked","multiple","muted","selected"].forEach(function(t){Me[t]=new Pe(t,3,!0,t,null,!1)});["capture","download"].forEach(function(t){Me[t]=new Pe(t,4,!1,t,null,!1)});["cols","rows","size","span"].forEach(function(t){Me[t]=new Pe(t,6,!1,t,null,!1)});["rowSpan","start"].forEach(function(t){Me[t]=new Pe(t,5,!1,t.toLowerCase(),null,!1)});var Xl=/[\-:]([a-z])/g;function Jl(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Xl,Jl);Me[e]=new Pe(e,1,!1,t,null,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Xl,Jl);Me[e]=new Pe(e,1,!1,t,"http://www.w3.org/1999/xlink",!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Xl,Jl);Me[e]=new Pe(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1)});["tabIndex","crossOrigin"].forEach(function(t){Me[t]=new Pe(t,1,!1,t.toLowerCase(),null,!1)});Me.xlinkHref=new Pe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0);["src","href","action","formAction"].forEach(function(t){Me[t]=new Pe(t,1,!1,t.toLowerCase(),null,!0)});var nt=ao.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;nt.hasOwnProperty("ReactCurrentDispatcher")||(nt.ReactCurrentDispatcher={current:null});nt.hasOwnProperty("ReactCurrentBatchConfig")||(nt.ReactCurrentBatchConfig={suspense:null});function Kl(t,e,i,n){var r=Me.hasOwnProperty(e)?Me[e]:null,s=r!==null?r.type===0:n?!1:!(!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N");s||(l0(e,i,r,n)&&(i=null),n||r===null?o0(e)&&(i===null?t.removeAttribute(e):t.setAttribute(e,""+i)):r.mustUseProperty?t[r.propertyName]=i===null?r.type===3?!1:"":i:(e=r.attributeName,n=r.attributeNamespace,i===null?t.removeAttribute(e):(r=r.type,i=r===3||r===4&&i===!0?"":""+i,n?t.setAttributeNS(n,e,i):t.setAttribute(e,i))))}var c0=/^(.*)[\\\/]/,Ve=typeof Symbol=="function"&&Symbol.for,_r=Ve?Symbol.for("react.element"):60103,$i=Ve?Symbol.for("react.portal"):60106,oi=Ve?Symbol.for("react.fragment"):60107,Rp=Ve?Symbol.for("react.strict_mode"):60108,ts=Ve?Symbol.for("react.profiler"):60114,_p=Ve?Symbol.for("react.provider"):60109,Vp=Ve?Symbol.for("react.context"):60110,u0=Ve?Symbol.for("react.concurrent_mode"):60111,ql=Ve?Symbol.for("react.forward_ref"):60112,is=Ve?Symbol.for("react.suspense"):60113,Sa=Ve?Symbol.for("react.suspense_list"):60120,ec=Ve?Symbol.for("react.memo"):60115,Op=Ve?Symbol.for("react.lazy"):60116,$p=Ve?Symbol.for("react.block"):60121,Ru=typeof Symbol=="function"&&Symbol.iterator;function Sn(t){return t===null||typeof t!="object"?null:(t=Ru&&t[Ru]||t["@@iterator"],typeof t=="function"?t:null)}function d0(t){if(t._status===-1){t._status=0;var e=t._ctor;e=e(),t._result=e,e.then(function(i){t._status===0&&(i=i.default,t._status=1,t._result=i)},function(i){t._status===0&&(t._status=2,t._result=i)})}}function Bt(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case oi:return"Fragment";case $i:return"Portal";case ts:return"Profiler";case Rp:return"StrictMode";case is:return"Suspense";case Sa:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Vp:return"Context.Consumer";case _p:return"Context.Provider";case ql:var e=t.render;return e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case ec:return Bt(t.type);case $p:return Bt(t.render);case Op:if(t=t._status===1?t._result:null)return Bt(t)}return null}function tc(t){var e="";do{e:switch(t.tag){case 3:case 4:case 6:case 7:case 10:case 9:var i="";break e;default:var n=t._debugOwner,r=t._debugSource,s=Bt(t.type);i=null,n&&(i=Bt(n.type)),n=s,s="",r?s=" (at "+r.fileName.replace(c0,"")+":"+r.lineNumber+")":i&&(s=" (created by "+i+")"),i=`
    in `+(n||"Unknown")+s}e+=i,t=t.return}while(t);return e}function Jt(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function Wp(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function h0(t){var e=Wp(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof i!="undefined"&&typeof i.get=="function"&&typeof i.set=="function"){var r=i.get,s=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Vr(t){t._valueTracker||(t._valueTracker=h0(t))}function Up(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),n="";return t&&(n=Wp(t)?t.checked?"true":"false":t.value),t=n,t!==i?(e.setValue(t),!0):!1}function Ia(t,e){var i=e.checked;return ke({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i!=null?i:t._wrapperState.initialChecked})}function _u(t,e){var i=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;i=Jt(e.value!=null?e.value:i),t._wrapperState={initialChecked:n,initialValue:i,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Hp(t,e){e=e.checked,e!=null&&Kl(t,"checked",e,!1)}function Ca(t,e){Hp(t,e);var i=Jt(e.value),n=e.type;if(i!=null)n==="number"?(i===0&&t.value===""||t.value!=i)&&(t.value=""+i):t.value!==""+i&&(t.value=""+i);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ba(t,e.type,i):e.hasOwnProperty("defaultValue")&&ba(t,e.type,Jt(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Vu(t,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,i||e===t.value||(t.value=e),t.defaultValue=e}i=t.name,i!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,i!==""&&(t.name=i)}function ba(t,e,i){(e!=="number"||t.ownerDocument.activeElement!==t)&&(i==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+i&&(t.defaultValue=""+i))}function p0(t){var e="";return ao.Children.forEach(t,function(i){i!=null&&(e+=i)}),e}function Aa(t,e){return t=ke({children:void 0},e),(e=p0(e.children))&&(t.children=e),t}function Ki(t,e,i,n){if(t=t.options,e){e={};for(var r=0;r<i.length;r++)e["$"+i[r]]=!0;for(i=0;i<t.length;i++)r=e.hasOwnProperty("$"+t[i].value),t[i].selected!==r&&(t[i].selected=r),r&&n&&(t[i].defaultSelected=!0)}else{for(i=""+Jt(i),e=null,r=0;r<t.length;r++){if(t[r].value===i){t[r].selected=!0,n&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Ta(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(C(91));return ke({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ou(t,e){var i=e.value;if(i==null){if(i=e.children,e=e.defaultValue,i!=null){if(e!=null)throw Error(C(92));if(Array.isArray(i)){if(!(1>=i.length))throw Error(C(93));i=i[0]}e=i}e==null&&(e=""),i=e}t._wrapperState={initialValue:Jt(i)}}function Fp(t,e){var i=Jt(e.value),n=Jt(e.defaultValue);i!=null&&(i=""+i,i!==t.value&&(t.value=i),e.defaultValue==null&&t.defaultValue!==i&&(t.defaultValue=i)),n!=null&&(t.defaultValue=""+n)}function $u(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}var Zp={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function Qp(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ea(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Qp(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Or,Gp=function(t){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(e,i,n,r){MSApp.execUnsafeLocalFunction(function(){return t(e,i,n,r)})}:t}(function(t,e){if(t.namespaceURI!==Zp.svg||"innerHTML"in t)t.innerHTML=e;else{for(Or=Or||document.createElement("div"),Or.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Or.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function nr(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&i.nodeType===3){i.nodeValue=e;return}}t.textContent=e}function $r(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var Wi={animationend:$r("Animation","AnimationEnd"),animationiteration:$r("Animation","AnimationIteration"),animationstart:$r("Animation","AnimationStart"),transitionend:$r("Transition","TransitionEnd")},_o={},Yp={};ii&&(Yp=document.createElement("div").style,"AnimationEvent"in window||(delete Wi.animationend.animation,delete Wi.animationiteration.animation,delete Wi.animationstart.animation),"TransitionEvent"in window||delete Wi.transitionend.transition);function lo(t){if(_o[t])return _o[t];if(!Wi[t])return t;var e=Wi[t],i;for(i in e)if(e.hasOwnProperty(i)&&i in Yp)return _o[t]=e[i];return t}var Xp=lo("animationend"),Jp=lo("animationiteration"),Kp=lo("animationstart"),qp=lo("transitionend"),Bn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wu=new(typeof WeakMap=="function"?WeakMap:Map);function ic(t){var e=Wu.get(t);return e===void 0&&(e=new Map,Wu.set(t,e)),e}function Ei(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,(e.effectTag&1026)!==0&&(i=e.return),t=e.return;while(t)}return e.tag===3?i:null}function ef(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Uu(t){if(Ei(t)!==t)throw Error(C(188))}function f0(t){var e=t.alternate;if(!e){if(e=Ei(t),e===null)throw Error(C(188));return e!==t?null:t}for(var i=t,n=e;;){var r=i.return;if(r===null)break;var s=r.alternate;if(s===null){if(n=r.return,n!==null){i=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===i)return Uu(r),t;if(s===n)return Uu(r),e;s=s.sibling}throw Error(C(188))}if(i.return!==n.return)i=r,n=s;else{for(var o=!1,a=r.child;a;){if(a===i){o=!0,i=r,n=s;break}if(a===n){o=!0,n=r,i=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===i){o=!0,i=s,n=r;break}if(a===n){o=!0,n=s,i=r;break}a=a.sibling}if(!o)throw Error(C(189))}}if(i.alternate!==n)throw Error(C(190))}if(i.tag!==3)throw Error(C(188));return i.stateNode.current===i?t:e}function tf(t){if(t=f0(t),!t)return null;for(var e=t;;){if(e.tag===5||e.tag===6)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function an(t,e){if(e==null)throw Error(C(30));return t==null?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function nc(t,e,i){Array.isArray(t)?t.forEach(e,i):t&&e.call(i,t)}var In=null;function g0(t){if(t){var e=t._dispatchListeners,i=t._dispatchInstances;if(Array.isArray(e))for(var n=0;n<e.length&&!t.isPropagationStopped();n++)Pu(t,e[n],i[n]);else e&&Pu(t,e,i);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function co(t){if(t!==null&&(In=an(In,t)),t=In,In=null,t){if(nc(t,g0),In)throw Error(C(95));if(Cs)throw t=ya,Cs=!1,ya=null,t}}function rc(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}function nf(t){if(!ii)return!1;t="on"+t;var e=t in document;return e||(e=document.createElement("div"),e.setAttribute(t,"return;"),e=typeof e[t]=="function"),e}var Ts=[];function rf(t){t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>Ts.length&&Ts.push(t)}function sf(t,e,i,n){if(Ts.length){var r=Ts.pop();return r.topLevelType=t,r.eventSystemFlags=n,r.nativeEvent=e,r.targetInst=i,r}return{topLevelType:t,eventSystemFlags:n,nativeEvent:e,targetInst:i,ancestors:[]}}function of(t){var e=t.targetInst,i=e;do{if(!i){t.ancestors.push(i);break}var n=i;if(n.tag===3)n=n.stateNode.containerInfo;else{for(;n.return;)n=n.return;n=n.tag!==3?null:n.stateNode.containerInfo}if(!n)break;e=i.tag,e!==5&&e!==6||t.ancestors.push(i),i=Mr(n)}while(i);for(i=0;i<t.ancestors.length;i++){e=t.ancestors[i];var r=rc(t.nativeEvent);n=t.topLevelType;var s=t.nativeEvent,o=t.eventSystemFlags;i===0&&(o|=64);for(var a=null,c=0;c<As.length;c++){var l=As[c];l&&(l=l.extractEvents(n,e,s,r,o))&&(a=an(a,l))}co(a)}}function Na(t,e,i){if(!i.has(t)){switch(t){case"scroll":zn(e,"scroll",!0);break;case"focus":case"blur":zn(e,"focus",!0),zn(e,"blur",!0),i.set("blur",null),i.set("focus",null);break;case"cancel":case"close":nf(t)&&zn(e,t,!0);break;case"invalid":case"submit":case"reset":break;default:Bn.indexOf(t)===-1&&ae(t,e)}i.set(t,null)}}var af,sc,lf,ka=!1,pt=[],Ht=null,Ft=null,Zt=null,rr=new Map,sr=new Map,Cn=[],Pa="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),m0="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function v0(t,e){var i=ic(e);Pa.forEach(function(n){Na(n,e,i)}),m0.forEach(function(n){Na(n,e,i)})}function Ba(t,e,i,n,r){return{blockedOn:t,topLevelType:e,eventSystemFlags:i|32,nativeEvent:r,container:n}}function Hu(t,e){switch(t){case"focus":case"blur":Ht=null;break;case"dragenter":case"dragleave":Ft=null;break;case"mouseover":case"mouseout":Zt=null;break;case"pointerover":case"pointerout":rr.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":sr.delete(e.pointerId)}}function bn(t,e,i,n,r,s){return t===null||t.nativeEvent!==s?(t=Ba(e,i,n,r,s),e!==null&&(e=Sr(e),e!==null&&sc(e)),t):(t.eventSystemFlags|=n,t)}function w0(t,e,i,n,r){switch(e){case"focus":return Ht=bn(Ht,t,e,i,n,r),!0;case"dragenter":return Ft=bn(Ft,t,e,i,n,r),!0;case"mouseover":return Zt=bn(Zt,t,e,i,n,r),!0;case"pointerover":var s=r.pointerId;return rr.set(s,bn(rr.get(s)||null,t,e,i,n,r)),!0;case"gotpointercapture":return s=r.pointerId,sr.set(s,bn(sr.get(s)||null,t,e,i,n,r)),!0}return!1}function y0(t){var e=Mr(t.target);if(e!==null){var i=Ei(e);if(i!==null){if(e=i.tag,e===13){if(e=ef(i),e!==null){t.blockedOn=e,xe.unstable_runWithPriority(t.priority,function(){lf(i)});return}}else if(e===3&&i.stateNode.hydrate){t.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ns(t){if(t.blockedOn!==null)return!1;var e=lc(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);if(e!==null){var i=Sr(e);return i!==null&&sc(i),t.blockedOn=e,!1}return!0}function Fu(t,e,i){ns(t)&&i.delete(e)}function x0(){for(ka=!1;0<pt.length;){var t=pt[0];if(t.blockedOn!==null){t=Sr(t.blockedOn),t!==null&&af(t);break}var e=lc(t.topLevelType,t.eventSystemFlags,t.container,t.nativeEvent);e!==null?t.blockedOn=e:pt.shift()}Ht!==null&&ns(Ht)&&(Ht=null),Ft!==null&&ns(Ft)&&(Ft=null),Zt!==null&&ns(Zt)&&(Zt=null),rr.forEach(Fu),sr.forEach(Fu)}function An(t,e){t.blockedOn===e&&(t.blockedOn=null,ka||(ka=!0,xe.unstable_scheduleCallback(xe.unstable_NormalPriority,x0)))}function cf(t){function e(r){return An(r,t)}if(0<pt.length){An(pt[0],t);for(var i=1;i<pt.length;i++){var n=pt[i];n.blockedOn===t&&(n.blockedOn=null)}}for(Ht!==null&&An(Ht,t),Ft!==null&&An(Ft,t),Zt!==null&&An(Zt,t),rr.forEach(e),sr.forEach(e),i=0;i<Cn.length;i++)n=Cn[i],n.blockedOn===t&&(n.blockedOn=null);for(;0<Cn.length&&(i=Cn[0],i.blockedOn===null);)y0(i),i.blockedOn===null&&Cn.shift()}var uf={},df=new Map,oc=new Map,M0=["abort","abort",Xp,"animationEnd",Jp,"animationIteration",Kp,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",qp,"transitionEnd","waiting","waiting"];function ac(t,e){for(var i=0;i<t.length;i+=2){var n=t[i],r=t[i+1],s="on"+(r[0].toUpperCase()+r.slice(1));s={phasedRegistrationNames:{bubbled:s,captured:s+"Capture"},dependencies:[n],eventPriority:e},oc.set(n,e),df.set(n,s),uf[r]=s}}ac("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0);ac("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);ac(M0,2);for(var Zu="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Vo=0;Vo<Zu.length;Vo++)oc.set(Zu[Vo],0);var S0=xe.unstable_UserBlockingPriority,I0=xe.unstable_runWithPriority,rs=!0;function ae(t,e){zn(e,t,!1)}function zn(t,e,i){var n=oc.get(e);switch(n===void 0?2:n){case 0:n=C0.bind(null,e,1,t);break;case 1:n=b0.bind(null,e,1,t);break;default:n=uo.bind(null,e,1,t)}i?t.addEventListener(e,n,!0):t.addEventListener(e,n,!1)}function C0(t,e,i,n){ai||Gl();var r=uo,s=ai;ai=!0;try{Dp(r,t,e,i,n)}finally{(ai=s)||Yl()}}function b0(t,e,i,n){I0(S0,uo.bind(null,t,e,i,n))}function uo(t,e,i,n){if(rs)if(0<pt.length&&-1<Pa.indexOf(t))t=Ba(null,t,e,i,n),pt.push(t);else{var r=lc(t,e,i,n);if(r===null)Hu(t,n);else if(-1<Pa.indexOf(t))t=Ba(r,t,e,i,n),pt.push(t);else if(!w0(r,t,e,i,n)){Hu(t,n),t=sf(t,n,null,e);try{jp(of,t)}finally{rf(t)}}}}function lc(t,e,i,n){if(i=rc(n),i=Mr(i),i!==null){var r=Ei(i);if(r===null)i=null;else{var s=r.tag;if(s===13){if(i=ef(r),i!==null)return i;i=null}else if(s===3){if(r.stateNode.hydrate)return r.tag===3?r.stateNode.containerInfo:null;i=null}else r!==i&&(i=null)}}t=sf(t,n,i,e);try{jp(of,t)}finally{rf(t)}return null}var Hn={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},A0=["Webkit","ms","Moz","O"];Object.keys(Hn).forEach(function(t){A0.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Hn[e]=Hn[t]})});function hf(t,e,i){return e==null||typeof e=="boolean"||e===""?"":i||typeof e!="number"||e===0||Hn.hasOwnProperty(t)&&Hn[t]?(""+e).trim():e+"px"}function pf(t,e){t=t.style;for(var i in e)if(e.hasOwnProperty(i)){var n=i.indexOf("--")===0,r=hf(i,e[i],n);i==="float"&&(i="cssFloat"),n?t.setProperty(i,r):t[i]=r}}var T0=ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function za(t,e){if(e){if(T0[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(C(137,t,""));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(C(60));if(!(typeof e.dangerouslySetInnerHTML=="object"&&"__html"in e.dangerouslySetInnerHTML))throw Error(C(61))}if(e.style!=null&&typeof e.style!="object")throw Error(C(62,""))}}function Da(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qu=Zp.html;function It(t,e){t=t.nodeType===9||t.nodeType===11?t:t.ownerDocument;var i=ic(t);e=Zl[e];for(var n=0;n<e.length;n++)Na(e[n],t,i)}function Es(){}function La(t){if(t=t||(typeof document!="undefined"?document:void 0),typeof t=="undefined")return null;try{return t.activeElement||t.body}catch{return t.body}}function Gu(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Yu(t,e){var i=Gu(t);t=0;for(var n;i;){if(i.nodeType===3){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Gu(i)}}function ff(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ff(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Xu(){for(var t=window,e=La();e instanceof t.HTMLIFrameElement;){try{var i=typeof e.contentWindow.location.href=="string"}catch{i=!1}if(i)t=e.contentWindow;else break;e=La(t.document)}return e}function ja(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var gf="$",mf="/$",cc="$?",uc="$!",Oo=null,$o=null;function vf(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function Ra(t,e){return t==="textarea"||t==="option"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Wo=typeof setTimeout=="function"?setTimeout:void 0,E0=typeof clearTimeout=="function"?clearTimeout:void 0;function qi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break}return t}function Ju(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var i=t.data;if(i===gf||i===uc||i===cc){if(e===0)return t;e--}else i===mf&&e++}t=t.previousSibling}return null}var dc=Math.random().toString(36).slice(2),Rt="__reactInternalInstance$"+dc,Ns="__reactEventHandlers$"+dc,xr="__reactContainere$"+dc;function Mr(t){var e=t[Rt];if(e)return e;for(var i=t.parentNode;i;){if(e=i[xr]||i[Rt]){if(i=e.alternate,e.child!==null||i!==null&&i.child!==null)for(t=Ju(t);t!==null;){if(i=t[Rt])return i;t=Ju(t)}return e}t=i,i=t.parentNode}return null}function Sr(t){return t=t[Rt]||t[xr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Mi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(C(33))}function hc(t){return t[Ns]||null}function Ct(t){do t=t.return;while(t&&t.tag!==5);return t||null}function wf(t,e){var i=t.stateNode;if(!i)return null;var n=Fl(i);if(!n)return null;i=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(i&&typeof i!="function")throw Error(C(231,e,typeof i));return i}function Ku(t,e,i){(e=wf(t,i.dispatchConfig.phasedRegistrationNames[e]))&&(i._dispatchListeners=an(i._dispatchListeners,e),i._dispatchInstances=an(i._dispatchInstances,t))}function N0(t){if(t&&t.dispatchConfig.phasedRegistrationNames){for(var e=t._targetInst,i=[];e;)i.push(e),e=Ct(e);for(e=i.length;0<e--;)Ku(i[e],"captured",t);for(e=0;e<i.length;e++)Ku(i[e],"bubbled",t)}}function _a(t,e,i){t&&i&&i.dispatchConfig.registrationName&&(e=wf(t,i.dispatchConfig.registrationName))&&(i._dispatchListeners=an(i._dispatchListeners,e),i._dispatchInstances=an(i._dispatchInstances,t))}function k0(t){t&&t.dispatchConfig.registrationName&&_a(t._targetInst,null,t)}function ln(t){nc(t,N0)}var _t=null,pc=null,ss=null;function yf(){if(ss)return ss;var t,e=pc,i=e.length,n,r="value"in _t?_t.value:_t.textContent,s=r.length;for(t=0;t<i&&e[t]===r[t];t++);var o=i-t;for(n=1;n<=o&&e[i-n]===r[s-n];n++);return ss=r.slice(t,1<n?1-n:void 0)}function os(){return!0}function ks(){return!1}function Qe(t,e,i,n){this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=i,t=this.constructor.Interface;for(var r in t)t.hasOwnProperty(r)&&((e=t[r])?this[r]=e(i):r==="target"?this.target=n:this[r]=i[r]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?os:ks,this.isPropagationStopped=ks,this}ke(Qe.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=os)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=os)},persist:function(){this.isPersistent=os},isPersistent:ks,destructor:function(){var t=this.constructor.Interface,e;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=ks,this._dispatchInstances=this._dispatchListeners=null}});Qe.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};Qe.extend=function(t){function e(){}function i(){return n.apply(this,arguments)}var n=this;e.prototype=n.prototype;var r=new e;return ke(r,i.prototype),i.prototype=r,i.prototype.constructor=i,i.Interface=ke({},n.Interface,t),i.extend=n.extend,xf(i),i};xf(Qe);function P0(t,e,i,n){if(this.eventPool.length){var r=this.eventPool.pop();return this.call(r,t,e,i,n),r}return new this(t,e,i,n)}function B0(t){if(!(t instanceof this))throw Error(C(279));t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function xf(t){t.eventPool=[],t.getPooled=P0,t.release=B0}var z0=Qe.extend({data:null}),D0=Qe.extend({data:null}),L0=[9,13,27,32],fc=ii&&"CompositionEvent"in window,Fn=null;ii&&"documentMode"in document&&(Fn=document.documentMode);var j0=ii&&"TextEvent"in window&&!Fn,Mf=ii&&(!fc||Fn&&8<Fn&&11>=Fn),qu=String.fromCharCode(32),St={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},ed=!1;function Sf(t,e){switch(t){case"keyup":return L0.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function If(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ui=!1;function R0(t,e){switch(t){case"compositionend":return If(e);case"keypress":return e.which!==32?null:(ed=!0,qu);case"textInput":return t=e.data,t===qu&&ed?null:t;default:return null}}function _0(t,e){if(Ui)return t==="compositionend"||!fc&&Sf(t,e)?(t=yf(),ss=pc=_t=null,Ui=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Mf&&e.locale!=="ko"?null:e.data;default:return null}}var V0={eventTypes:St,extractEvents:function(t,e,i,n){var r;if(fc)e:{switch(t){case"compositionstart":var s=St.compositionStart;break e;case"compositionend":s=St.compositionEnd;break e;case"compositionupdate":s=St.compositionUpdate;break e}s=void 0}else Ui?Sf(t,i)&&(s=St.compositionEnd):t==="keydown"&&i.keyCode===229&&(s=St.compositionStart);return s?(Mf&&i.locale!=="ko"&&(Ui||s!==St.compositionStart?s===St.compositionEnd&&Ui&&(r=yf()):(_t=n,pc="value"in _t?_t.value:_t.textContent,Ui=!0)),s=z0.getPooled(s,e,i,n),r?s.data=r:(r=If(i),r!==null&&(s.data=r)),ln(s),r=s):r=null,(t=j0?R0(t,i):_0(t,i))?(e=D0.getPooled(St.beforeInput,e,i,n),e.data=t,ln(e)):e=null,r===null?e:e===null?r:[r,e]}},O0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!O0[t.type]:e==="textarea"}var bf={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function Af(t,e,i){return t=Qe.getPooled(bf.change,t,e,i),t.type="change",Bp(i),ln(t),t}var Zn=null,or=null;function $0(t){co(t)}function ho(t){var e=Mi(t);if(Up(e))return t}function W0(t,e){if(t==="change")return e}var Va=!1;ii&&(Va=nf("input")&&(!document.documentMode||9<document.documentMode));function td(){Zn&&(Zn.detachEvent("onpropertychange",Tf),or=Zn=null)}function Tf(t){if(t.propertyName==="value"&&ho(or))if(t=Af(or,t,rc(t)),ai)co(t);else{ai=!0;try{Ql($0,t)}finally{ai=!1,Yl()}}}function U0(t,e,i){t==="focus"?(td(),Zn=e,or=i,Zn.attachEvent("onpropertychange",Tf)):t==="blur"&&td()}function H0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ho(or)}function F0(t,e){if(t==="click")return ho(e)}function Z0(t,e){if(t==="input"||t==="change")return ho(e)}var Q0={eventTypes:bf,_isInputEventSupported:Va,extractEvents:function(t,e,i,n){var r=e?Mi(e):window,s=r.nodeName&&r.nodeName.toLowerCase();if(s==="select"||s==="input"&&r.type==="file")var o=W0;else if(Cf(r))if(Va)o=Z0;else{o=H0;var a=U0}else(s=r.nodeName)&&s.toLowerCase()==="input"&&(r.type==="checkbox"||r.type==="radio")&&(o=F0);if(o&&(o=o(t,e)))return Af(o,i,n);a&&a(t,r,e),t==="blur"&&(t=r._wrapperState)&&t.controlled&&r.type==="number"&&ba(r,"number",r.value)}},Ir=Qe.extend({view:null,detail:null}),G0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Y0(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=G0[t])?!!e[t]:!1}function gc(){return Y0}var id=0,nd=0,rd=!1,sd=!1,Cr=Ir.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:gc,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},movementX:function(t){if("movementX"in t)return t.movementX;var e=id;return id=t.screenX,rd?t.type==="mousemove"?t.screenX-e:0:(rd=!0,0)},movementY:function(t){if("movementY"in t)return t.movementY;var e=nd;return nd=t.screenY,sd?t.type==="mousemove"?t.screenY-e:0:(sd=!0,0)}}),Ef=Cr.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Tn={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},X0={eventTypes:Tn,extractEvents:function(t,e,i,n,r){var s=t==="mouseover"||t==="pointerover",o=t==="mouseout"||t==="pointerout";if(s&&(r&32)===0&&(i.relatedTarget||i.fromElement)||!o&&!s)return null;if(s=n.window===n?n:(s=n.ownerDocument)?s.defaultView||s.parentWindow:window,o){if(o=e,e=(e=i.relatedTarget||i.toElement)?Mr(e):null,e!==null){var a=Ei(e);(e!==a||e.tag!==5&&e.tag!==6)&&(e=null)}}else o=null;if(o===e)return null;if(t==="mouseout"||t==="mouseover")var c=Cr,l=Tn.mouseLeave,u=Tn.mouseEnter,d="mouse";else(t==="pointerout"||t==="pointerover")&&(c=Ef,l=Tn.pointerLeave,u=Tn.pointerEnter,d="pointer");if(t=o==null?s:Mi(o),s=e==null?s:Mi(e),l=c.getPooled(l,o,i,n),l.type=d+"leave",l.target=t,l.relatedTarget=s,i=c.getPooled(u,e,i,n),i.type=d+"enter",i.target=s,i.relatedTarget=t,n=o,d=e,n&&d)e:{for(c=n,u=d,o=0,t=c;t;t=Ct(t))o++;for(t=0,e=u;e;e=Ct(e))t++;for(;0<o-t;)c=Ct(c),o--;for(;0<t-o;)u=Ct(u),t--;for(;o--;){if(c===u||c===u.alternate)break e;c=Ct(c),u=Ct(u)}c=null}else c=null;for(u=c,c=[];n&&n!==u&&(o=n.alternate,!(o!==null&&o===u));)c.push(n),n=Ct(n);for(n=[];d&&d!==u&&(o=d.alternate,!(o!==null&&o===u));)n.push(d),d=Ct(d);for(d=0;d<c.length;d++)_a(c[d],"bubbled",l);for(d=n.length;0<d--;)_a(n[d],"captured",i);return(r&64)===0?[l]:[l,i]}};function J0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Si=typeof Object.is=="function"?Object.is:J0,K0=Object.prototype.hasOwnProperty;function ar(t,e){if(Si(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++)if(!K0.call(e,i[n])||!Si(t[i[n]],e[i[n]]))return!1;return!0}var q0=ii&&"documentMode"in document&&11>=document.documentMode,Nf={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Hi=null,Oa=null,Qn=null,$a=!1;function od(t,e){var i=e.window===e?e.document:e.nodeType===9?e:e.ownerDocument;return $a||Hi==null||Hi!==La(i)?null:(i=Hi,"selectionStart"in i&&ja(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Qn&&ar(Qn,i)?null:(Qn=i,t=Qe.getPooled(Nf.select,Oa,t,e),t.type="select",t.target=Hi,ln(t),t))}var eM={eventTypes:Nf,extractEvents:function(t,e,i,n,r,s){if(r=s||(n.window===n?n.document:n.nodeType===9?n:n.ownerDocument),!(s=!r)){e:{r=ic(r),s=Zl.onSelect;for(var o=0;o<s.length;o++)if(!r.has(s[o])){r=!1;break e}r=!0}s=!r}if(s)return null;switch(r=e?Mi(e):window,t){case"focus":(Cf(r)||r.contentEditable==="true")&&(Hi=r,Oa=e,Qn=null);break;case"blur":Qn=Oa=Hi=null;break;case"mousedown":$a=!0;break;case"contextmenu":case"mouseup":case"dragend":return $a=!1,od(i,n);case"selectionchange":if(q0)break;case"keydown":case"keyup":return od(i,n)}return null}},tM=Qe.extend({animationName:null,elapsedTime:null,pseudoElement:null}),iM=Qe.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),nM=Ir.extend({relatedTarget:null});function as(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}var rM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oM=Ir.extend({key:function(t){if(t.key){var e=rM[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=as(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?sM[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:gc,charCode:function(t){return t.type==="keypress"?as(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?as(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),aM=Cr.extend({dataTransfer:null}),lM=Ir.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:gc}),cM=Qe.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),uM=Cr.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),dM={eventTypes:uf,extractEvents:function(t,e,i,n){var r=df.get(t);if(!r)return null;switch(t){case"keypress":if(as(i)===0)return null;case"keydown":case"keyup":t=oM;break;case"blur":case"focus":t=nM;break;case"click":if(i.button===2)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":t=Cr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":t=aM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":t=lM;break;case Xp:case Jp:case Kp:t=tM;break;case qp:t=cM;break;case"scroll":t=Ir;break;case"wheel":t=uM;break;case"copy":case"cut":case"paste":t=iM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":t=Ef;break;default:t=Qe}return e=t.getPooled(r,e,i,n),ln(e),e}};if(bs)throw Error(C(101));bs=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" "));kp();var hM=Sr;Fl=hc;Ep=hM;Np=Mi;Pp({SimpleEventPlugin:dM,EnterLeaveEventPlugin:X0,ChangeEventPlugin:Q0,SelectEventPlugin:eM,BeforeInputEventPlugin:V0});var Wa=[],Fi=-1;function se(t){0>Fi||(t.current=Wa[Fi],Wa[Fi]=null,Fi--)}function de(t,e){Fi++,Wa[Fi]=t.current,t.current=e}var Kt={},be={current:Kt},je={current:!1},Ii=Kt;function cn(t,e){var i=t.type.contextTypes;if(!i)return Kt;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in i)r[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Re(t){return t=t.childContextTypes,t!=null}function Ps(){se(je),se(be)}function ad(t,e,i){if(be.current!==Kt)throw Error(C(168));de(be,e),de(je,i)}function kf(t,e,i){var n=t.stateNode;if(t=e.childContextTypes,typeof n.getChildContext!="function")return i;n=n.getChildContext();for(var r in n)if(!(r in t))throw Error(C(108,Bt(e)||"Unknown",r));return ke({},i,{},n)}function ls(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Kt,Ii=be.current,de(be,t),de(je,je.current),!0}function ld(t,e,i){var n=t.stateNode;if(!n)throw Error(C(169));i?(t=kf(t,e,Ii),n.__reactInternalMemoizedMergedChildContext=t,se(je),se(be),de(be,t)):se(je),de(je,i)}var pM=xe.unstable_runWithPriority,mc=xe.unstable_scheduleCallback,Pf=xe.unstable_cancelCallback,cd=xe.unstable_requestPaint,Ua=xe.unstable_now,fM=xe.unstable_getCurrentPriorityLevel,po=xe.unstable_ImmediatePriority,Bf=xe.unstable_UserBlockingPriority,zf=xe.unstable_NormalPriority,Df=xe.unstable_LowPriority,Lf=xe.unstable_IdlePriority,jf={},gM=xe.unstable_shouldYield,mM=cd!==void 0?cd:function(){},Tt=null,cs=null,Uo=!1,ud=Ua(),Ye=1e4>ud?Ua:function(){return Ua()-ud};function fo(){switch(fM()){case po:return 99;case Bf:return 98;case zf:return 97;case Df:return 96;case Lf:return 95;default:throw Error(C(332))}}function Rf(t){switch(t){case 99:return po;case 98:return Bf;case 97:return zf;case 96:return Df;case 95:return Lf;default:throw Error(C(332))}}function qt(t,e){return t=Rf(t),pM(t,e)}function _f(t,e,i){return t=Rf(t),mc(t,e,i)}function dd(t){return Tt===null?(Tt=[t],cs=mc(po,Vf)):Tt.push(t),jf}function yt(){if(cs!==null){var t=cs;cs=null,Pf(t)}Vf()}function Vf(){if(!Uo&&Tt!==null){Uo=!0;var t=0;try{var e=Tt;qt(99,function(){for(;t<e.length;t++){var i=e[t];do i=i(!0);while(i!==null)}}),Tt=null}catch(i){throw Tt!==null&&(Tt=Tt.slice(t+1)),mc(po,yt),i}finally{Uo=!1}}}function us(t,e,i){return i/=10,1073741821-(((1073741821-t+e/10)/i|0)+1)*i}function tt(t,e){if(t&&t.defaultProps){e=ke({},e),t=t.defaultProps;for(var i in t)e[i]===void 0&&(e[i]=t[i])}return e}var Bs={current:null},zs=null,Zi=null,Ds=null;function vc(){Ds=Zi=zs=null}function wc(t){var e=Bs.current;se(Bs),t.type._context._currentValue=e}function Of(t,e){for(;t!==null;){var i=t.alternate;if(t.childExpirationTime<e)t.childExpirationTime=e,i!==null&&i.childExpirationTime<e&&(i.childExpirationTime=e);else if(i!==null&&i.childExpirationTime<e)i.childExpirationTime=e;else break;t=t.return}}function en(t,e){zs=t,Ds=Zi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.expirationTime>=e&&(ft=!0),t.firstContext=null)}function Je(t,e){if(Ds!==t&&e!==!1&&e!==0)if((typeof e!="number"||e===1073741823)&&(Ds=t,e=1073741823),e={context:t,observedBits:e,next:null},Zi===null){if(zs===null)throw Error(C(308));Zi=e,zs.dependencies={expirationTime:0,firstContext:e,responders:null}}else Zi=Zi.next=e;return t._currentValue}var jt=!1;function yc(t){t.updateQueue={baseState:t.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function xc(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,baseQueue:t.baseQueue,shared:t.shared,effects:t.effects})}function Qt(t,e){return t={expirationTime:t,suspenseConfig:e,tag:0,payload:null,callback:null,next:null},t.next=t}function Gt(t,e){if(t=t.updateQueue,t!==null){t=t.shared;var i=t.pending;i===null?e.next=e:(e.next=i.next,i.next=e),t.pending=e}}function hd(t,e){var i=t.alternate;i!==null&&xc(i,t),t=t.updateQueue,i=t.baseQueue,i===null?(t.baseQueue=e.next=e,e.next=e):(e.next=i.next,i.next=e)}function lr(t,e,i,n){var r=t.updateQueue;jt=!1;var s=r.baseQueue,o=r.shared.pending;if(o!==null){if(s!==null){var a=s.next;s.next=o.next,o.next=a}s=o,r.shared.pending=null,a=t.alternate,a!==null&&(a=a.updateQueue,a!==null&&(a.baseQueue=o))}if(s!==null){a=s.next;var c=r.baseState,l=0,u=null,d=null,f=null;if(a!==null){var v=a;do{if(o=v.expirationTime,o<n){var w={expirationTime:v.expirationTime,suspenseConfig:v.suspenseConfig,tag:v.tag,payload:v.payload,callback:v.callback,next:null};f===null?(d=f=w,u=c):f=f.next=w,o>l&&(l=o)}else{f!==null&&(f=f.next={expirationTime:1073741823,suspenseConfig:v.suspenseConfig,tag:v.tag,payload:v.payload,callback:v.callback,next:null}),mg(o,v.suspenseConfig);e:{var x=t,h=v;switch(o=e,w=i,h.tag){case 1:if(x=h.payload,typeof x=="function"){c=x.call(w,c,o);break e}c=x;break e;case 3:x.effectTag=x.effectTag&-4097|64;case 0:if(x=h.payload,o=typeof x=="function"?x.call(w,c,o):x,o==null)break e;c=ke({},c,o);break e;case 2:jt=!0}}v.callback!==null&&(t.effectTag|=32,o=r.effects,o===null?r.effects=[v]:o.push(v))}if(v=v.next,v===null||v===a){if(o=r.shared.pending,o===null)break;v=s.next=o.next,o.next=a,r.baseQueue=s=o,r.shared.pending=null}}while(1)}f===null?u=c:f.next=d,r.baseState=u,r.baseQueue=f,yo(l),t.expirationTime=l,t.memoizedState=c}}function pd(t,e,i){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],r=n.callback;if(r!==null){if(n.callback=null,n=r,r=i,typeof n!="function")throw Error(C(191,n));n.call(r)}}}var Gn=nt.ReactCurrentBatchConfig,$f=new ao.Component().refs;function Ls(t,e,i,n){e=t.memoizedState,i=i(n,e),i=i==null?e:ke({},e,i),t.memoizedState=i,t.expirationTime===0&&(t.updateQueue.baseState=i)}var go={isMounted:function(t){return(t=t._reactInternalFiber)?Ei(t)===t:!1},enqueueSetState:function(t,e,i){t=t._reactInternalFiber;var n=vt(),r=Gn.suspense;n=vi(n,t,r),r=Qt(n,r),r.payload=e,i!=null&&(r.callback=i),Gt(t,r),Xt(t,n)},enqueueReplaceState:function(t,e,i){t=t._reactInternalFiber;var n=vt(),r=Gn.suspense;n=vi(n,t,r),r=Qt(n,r),r.tag=1,r.payload=e,i!=null&&(r.callback=i),Gt(t,r),Xt(t,n)},enqueueForceUpdate:function(t,e){t=t._reactInternalFiber;var i=vt(),n=Gn.suspense;i=vi(i,t,n),n=Qt(i,n),n.tag=2,e!=null&&(n.callback=e),Gt(t,n),Xt(t,i)}};function fd(t,e,i,n,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!ar(i,n)||!ar(r,s):!0}function Wf(t,e,i){var n=!1,r=Kt,s=e.contextType;return typeof s=="object"&&s!==null?s=Je(s):(r=Re(e)?Ii:be.current,n=e.contextTypes,s=(n=n!=null)?cn(t,r):Kt),e=new e(i,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=go,t.stateNode=e,e._reactInternalFiber=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function gd(t,e,i,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(i,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(i,n),e.state!==t&&go.enqueueReplaceState(e,e.state,null)}function Ha(t,e,i,n){var r=t.stateNode;r.props=i,r.state=t.memoizedState,r.refs=$f,yc(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Je(s):(s=Re(e)?Ii:be.current,r.context=cn(t,s)),lr(t,i,r,n),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Ls(t,e,s,i),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&go.enqueueReplaceState(r,r.state,null),lr(t,i,r,n),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.effectTag|=4)}var Wr=Array.isArray;function En(t,e,i){if(t=i.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(C(309));var n=i.stateNode}if(!n)throw Error(C(147,t));var r=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(s){var o=n.refs;o===$f&&(o=n.refs={}),s===null?delete o[r]:o[r]=s},e._stringRef=r,e)}if(typeof t!="string")throw Error(C(284));if(!i._owner)throw Error(C(290,t))}return t}function Ur(t,e){if(t.type!=="textarea")throw Error(C(31,Object.prototype.toString.call(e)==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":e,""))}function Uf(t){function e(h,p){if(t){var g=h.lastEffect;g!==null?(g.nextEffect=p,h.lastEffect=p):h.firstEffect=h.lastEffect=p,p.nextEffect=null,p.effectTag=8}}function i(h,p){if(!t)return null;for(;p!==null;)e(h,p),p=p.sibling;return null}function n(h,p){for(h=new Map;p!==null;)p.key!==null?h.set(p.key,p):h.set(p.index,p),p=p.sibling;return h}function r(h,p){return h=Ci(h,p),h.index=0,h.sibling=null,h}function s(h,p,g){return h.index=g,t?(g=h.alternate,g!==null?(g=g.index,g<p?(h.effectTag=2,p):g):(h.effectTag=2,p)):p}function o(h){return t&&h.alternate===null&&(h.effectTag=2),h}function a(h,p,g,m){return p===null||p.tag!==6?(p=Yo(g,h.mode,m),p.return=h,p):(p=r(p,g),p.return=h,p)}function c(h,p,g,m){return p!==null&&p.elementType===g.type?(m=r(p,g.props),m.ref=En(h,p,g),m.return=h,m):(m=fs(g.type,g.key,g.props,null,h.mode,m),m.ref=En(h,p,g),m.return=h,m)}function l(h,p,g,m){return p===null||p.tag!==4||p.stateNode.containerInfo!==g.containerInfo||p.stateNode.implementation!==g.implementation?(p=Xo(g,h.mode,m),p.return=h,p):(p=r(p,g.children||[]),p.return=h,p)}function u(h,p,g,m,y){return p===null||p.tag!==7?(p=$t(g,h.mode,m,y),p.return=h,p):(p=r(p,g),p.return=h,p)}function d(h,p,g){if(typeof p=="string"||typeof p=="number")return p=Yo(""+p,h.mode,g),p.return=h,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case _r:return g=fs(p.type,p.key,p.props,null,h.mode,g),g.ref=En(h,null,p),g.return=h,g;case $i:return p=Xo(p,h.mode,g),p.return=h,p}if(Wr(p)||Sn(p))return p=$t(p,h.mode,g,null),p.return=h,p;Ur(h,p)}return null}function f(h,p,g,m){var y=p!==null?p.key:null;if(typeof g=="string"||typeof g=="number")return y!==null?null:a(h,p,""+g,m);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case _r:return g.key===y?g.type===oi?u(h,p,g.props.children,m,y):c(h,p,g,m):null;case $i:return g.key===y?l(h,p,g,m):null}if(Wr(g)||Sn(g))return y!==null?null:u(h,p,g,m,null);Ur(h,g)}return null}function v(h,p,g,m,y){if(typeof m=="string"||typeof m=="number")return h=h.get(g)||null,a(p,h,""+m,y);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case _r:return h=h.get(m.key===null?g:m.key)||null,m.type===oi?u(p,h,m.props.children,y,m.key):c(p,h,m,y);case $i:return h=h.get(m.key===null?g:m.key)||null,l(p,h,m,y)}if(Wr(m)||Sn(m))return h=h.get(g)||null,u(p,h,m,y,null);Ur(p,m)}return null}function w(h,p,g,m){for(var y=null,M=null,E=p,z=p=0,P=null;E!==null&&z<g.length;z++){E.index>z?(P=E,E=null):P=E.sibling;var L=f(h,E,g[z],m);if(L===null){E===null&&(E=P);break}t&&E&&L.alternate===null&&e(h,E),p=s(L,p,z),M===null?y=L:M.sibling=L,M=L,E=P}if(z===g.length)return i(h,E),y;if(E===null){for(;z<g.length;z++)E=d(h,g[z],m),E!==null&&(p=s(E,p,z),M===null?y=E:M.sibling=E,M=E);return y}for(E=n(h,E);z<g.length;z++)P=v(E,h,z,g[z],m),P!==null&&(t&&P.alternate!==null&&E.delete(P.key===null?z:P.key),p=s(P,p,z),M===null?y=P:M.sibling=P,M=P);return t&&E.forEach(function(S){return e(h,S)}),y}function x(h,p,g,m){var y=Sn(g);if(typeof y!="function")throw Error(C(150));if(g=y.call(g),g==null)throw Error(C(151));for(var M=y=null,E=p,z=p=0,P=null,L=g.next();E!==null&&!L.done;z++,L=g.next()){E.index>z?(P=E,E=null):P=E.sibling;var S=f(h,E,L.value,m);if(S===null){E===null&&(E=P);break}t&&E&&S.alternate===null&&e(h,E),p=s(S,p,z),M===null?y=S:M.sibling=S,M=S,E=P}if(L.done)return i(h,E),y;if(E===null){for(;!L.done;z++,L=g.next())L=d(h,L.value,m),L!==null&&(p=s(L,p,z),M===null?y=L:M.sibling=L,M=L);return y}for(E=n(h,E);!L.done;z++,L=g.next())L=v(E,h,z,L.value,m),L!==null&&(t&&L.alternate!==null&&E.delete(L.key===null?z:L.key),p=s(L,p,z),M===null?y=L:M.sibling=L,M=L);return t&&E.forEach(function(N){return e(h,N)}),y}return function(h,p,g,m){var y=typeof g=="object"&&g!==null&&g.type===oi&&g.key===null;y&&(g=g.props.children);var M=typeof g=="object"&&g!==null;if(M)switch(g.$$typeof){case _r:e:{for(M=g.key,y=p;y!==null;){if(y.key===M){switch(y.tag){case 7:if(g.type===oi){i(h,y.sibling),p=r(y,g.props.children),p.return=h,h=p;break e}break;default:if(y.elementType===g.type){i(h,y.sibling),p=r(y,g.props),p.ref=En(h,y,g),p.return=h,h=p;break e}}i(h,y);break}else e(h,y);y=y.sibling}g.type===oi?(p=$t(g.props.children,h.mode,m,g.key),p.return=h,h=p):(m=fs(g.type,g.key,g.props,null,h.mode,m),m.ref=En(h,p,g),m.return=h,h=m)}return o(h);case $i:e:{for(y=g.key;p!==null;){if(p.key===y)if(p.tag===4&&p.stateNode.containerInfo===g.containerInfo&&p.stateNode.implementation===g.implementation){i(h,p.sibling),p=r(p,g.children||[]),p.return=h,h=p;break e}else{i(h,p);break}else e(h,p);p=p.sibling}p=Xo(g,h.mode,m),p.return=h,h=p}return o(h)}if(typeof g=="string"||typeof g=="number")return g=""+g,p!==null&&p.tag===6?(i(h,p.sibling),p=r(p,g),p.return=h,h=p):(i(h,p),p=Yo(g,h.mode,m),p.return=h,h=p),o(h);if(Wr(g))return w(h,p,g,m);if(Sn(g))return x(h,p,g,m);if(M&&Ur(h,g),typeof g=="undefined"&&!y)switch(h.tag){case 1:case 0:throw h=h.type,Error(C(152,h.displayName||h.name||"Component"))}return i(h,p)}}var un=Uf(!0),Mc=Uf(!1),br={},mt={current:br},cr={current:br},ur={current:br};function li(t){if(t===br)throw Error(C(174));return t}function Fa(t,e){switch(de(ur,e),de(cr,t),de(mt,br),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ea(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Ea(e,t)}se(mt),de(mt,e)}function dn(){se(mt),se(cr),se(ur)}function md(t){li(ur.current);var e=li(mt.current),i=Ea(e,t.type);e!==i&&(de(cr,t),de(mt,i))}function Sc(t){cr.current===t&&(se(mt),se(cr))}var le={current:0};function js(t){for(var e=t;e!==null;){if(e.tag===13){var i=e.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data===cc||i.data===uc))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.effectTag&64)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function Ic(t,e){return{responder:t,props:e}}var ds=nt.ReactCurrentDispatcher,Xe=nt.ReactCurrentBatchConfig,Vt=0,he=null,Ie=null,Ce=null,Rs=!1;function $e(){throw Error(C(321))}function Cc(t,e){if(e===null)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!Si(t[i],e[i]))return!1;return!0}function bc(t,e,i,n,r,s){if(Vt=s,he=e,e.memoizedState=null,e.updateQueue=null,e.expirationTime=0,ds.current=t===null||t.memoizedState===null?vM:wM,t=i(n,r),e.expirationTime===Vt){s=0;do{if(e.expirationTime=0,!(25>s))throw Error(C(301));s+=1,Ce=Ie=null,e.updateQueue=null,ds.current=yM,t=i(n,r)}while(e.expirationTime===Vt)}if(ds.current=Os,e=Ie!==null&&Ie.next!==null,Vt=0,Ce=Ie=he=null,Rs=!1,e)throw Error(C(300));return t}function tn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ce===null?he.memoizedState=Ce=t:Ce=Ce.next=t,Ce}function gn(){if(Ie===null){var t=he.alternate;t=t!==null?t.memoizedState:null}else t=Ie.next;var e=Ce===null?he.memoizedState:Ce.next;if(e!==null)Ce=e,Ie=t;else{if(t===null)throw Error(C(310));Ie=t,t={memoizedState:Ie.memoizedState,baseState:Ie.baseState,baseQueue:Ie.baseQueue,queue:Ie.queue,next:null},Ce===null?he.memoizedState=Ce=t:Ce=Ce.next=t}return Ce}function fi(t,e){return typeof e=="function"?e(t):e}function Hr(t){var e=gn(),i=e.queue;if(i===null)throw Error(C(311));i.lastRenderedReducer=t;var n=Ie,r=n.baseQueue,s=i.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}n.baseQueue=r=s,i.pending=null}if(r!==null){r=r.next,n=n.baseState;var a=o=s=null,c=r;do{var l=c.expirationTime;if(l<Vt){var u={expirationTime:c.expirationTime,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};a===null?(o=a=u,s=n):a=a.next=u,l>he.expirationTime&&(he.expirationTime=l,yo(l))}else a!==null&&(a=a.next={expirationTime:1073741823,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),mg(l,c.suspenseConfig),n=c.eagerReducer===t?c.eagerState:t(n,c.action);c=c.next}while(c!==null&&c!==r);a===null?s=n:a.next=o,Si(n,e.memoizedState)||(ft=!0),e.memoizedState=n,e.baseState=s,e.baseQueue=a,i.lastRenderedState=n}return[e.memoizedState,i.dispatch]}function Fr(t){var e=gn(),i=e.queue;if(i===null)throw Error(C(311));i.lastRenderedReducer=t;var n=i.dispatch,r=i.pending,s=e.memoizedState;if(r!==null){i.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);Si(s,e.memoizedState)||(ft=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),i.lastRenderedState=s}return[s,n]}function Ho(t){var e=tn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t=e.queue={pending:null,dispatch:null,lastRenderedReducer:fi,lastRenderedState:t},t=t.dispatch=Yf.bind(null,he,t),[e.memoizedState,t]}function Za(t,e,i,n){return t={tag:t,create:e,destroy:i,deps:n,next:null},e=he.updateQueue,e===null?(e={lastEffect:null},he.updateQueue=e,e.lastEffect=t.next=t):(i=e.lastEffect,i===null?e.lastEffect=t.next=t:(n=i.next,i.next=t,t.next=n,e.lastEffect=t)),t}function Hf(){return gn().memoizedState}function Qa(t,e,i,n){var r=tn();he.effectTag|=t,r.memoizedState=Za(1|e,i,void 0,n===void 0?null:n)}function Ac(t,e,i,n){var r=gn();n=n===void 0?null:n;var s=void 0;if(Ie!==null){var o=Ie.memoizedState;if(s=o.destroy,n!==null&&Cc(n,o.deps)){Za(e,i,s,n);return}}he.effectTag|=t,r.memoizedState=Za(1|e,i,s,n)}function vd(t,e){return Qa(516,4,t,e)}function _s(t,e){return Ac(516,4,t,e)}function Ff(t,e){return Ac(4,2,t,e)}function Zf(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Qf(t,e,i){return i=i!=null?i.concat([t]):null,Ac(4,2,Zf.bind(null,e,t),i)}function Tc(){}function wd(t,e){return tn().memoizedState=[t,e===void 0?null:e],t}function Vs(t,e){var i=gn();e=e===void 0?null:e;var n=i.memoizedState;return n!==null&&e!==null&&Cc(e,n[1])?n[0]:(i.memoizedState=[t,e],t)}function Gf(t,e){var i=gn();e=e===void 0?null:e;var n=i.memoizedState;return n!==null&&e!==null&&Cc(e,n[1])?n[0]:(t=t(),i.memoizedState=[t,e],t)}function Ec(t,e,i){var n=fo();qt(98>n?98:n,function(){t(!0)}),qt(97<n?97:n,function(){var r=Xe.suspense;Xe.suspense=e===void 0?null:e;try{t(!1),i()}finally{Xe.suspense=r}})}function Yf(t,e,i){var n=vt(),r=Gn.suspense;n=vi(n,t,r),r={expirationTime:n,suspenseConfig:r,action:i,eagerReducer:null,eagerState:null,next:null};var s=e.pending;if(s===null?r.next=r:(r.next=s.next,s.next=r),e.pending=r,s=t.alternate,t===he||s!==null&&s===he)Rs=!0,r.expirationTime=Vt,he.expirationTime=Vt;else{if(t.expirationTime===0&&(s===null||s.expirationTime===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,i);if(r.eagerReducer=s,r.eagerState=a,Si(a,o))return}catch{}finally{}Xt(t,n)}}var Os={readContext:Je,useCallback:$e,useContext:$e,useEffect:$e,useImperativeHandle:$e,useLayoutEffect:$e,useMemo:$e,useReducer:$e,useRef:$e,useState:$e,useDebugValue:$e,useResponder:$e,useDeferredValue:$e,useTransition:$e},vM={readContext:Je,useCallback:wd,useContext:Je,useEffect:vd,useImperativeHandle:function(t,e,i){return i=i!=null?i.concat([t]):null,Qa(4,2,Zf.bind(null,e,t),i)},useLayoutEffect:function(t,e){return Qa(4,2,t,e)},useMemo:function(t,e){var i=tn();return e=e===void 0?null:e,t=t(),i.memoizedState=[t,e],t},useReducer:function(t,e,i){var n=tn();return e=i!==void 0?i(e):e,n.memoizedState=n.baseState=e,t=n.queue={pending:null,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},t=t.dispatch=Yf.bind(null,he,t),[n.memoizedState,t]},useRef:function(t){var e=tn();return t={current:t},e.memoizedState=t},useState:Ho,useDebugValue:Tc,useResponder:Ic,useDeferredValue:function(t,e){var i=Ho(t),n=i[0],r=i[1];return vd(function(){var s=Xe.suspense;Xe.suspense=e===void 0?null:e;try{r(t)}finally{Xe.suspense=s}},[t,e]),n},useTransition:function(t){var e=Ho(!1),i=e[0];return e=e[1],[wd(Ec.bind(null,e,t),[e,t]),i]}},wM={readContext:Je,useCallback:Vs,useContext:Je,useEffect:_s,useImperativeHandle:Qf,useLayoutEffect:Ff,useMemo:Gf,useReducer:Hr,useRef:Hf,useState:function(){return Hr(fi)},useDebugValue:Tc,useResponder:Ic,useDeferredValue:function(t,e){var i=Hr(fi),n=i[0],r=i[1];return _s(function(){var s=Xe.suspense;Xe.suspense=e===void 0?null:e;try{r(t)}finally{Xe.suspense=s}},[t,e]),n},useTransition:function(t){var e=Hr(fi),i=e[0];return e=e[1],[Vs(Ec.bind(null,e,t),[e,t]),i]}},yM={readContext:Je,useCallback:Vs,useContext:Je,useEffect:_s,useImperativeHandle:Qf,useLayoutEffect:Ff,useMemo:Gf,useReducer:Fr,useRef:Hf,useState:function(){return Fr(fi)},useDebugValue:Tc,useResponder:Ic,useDeferredValue:function(t,e){var i=Fr(fi),n=i[0],r=i[1];return _s(function(){var s=Xe.suspense;Xe.suspense=e===void 0?null:e;try{r(t)}finally{Xe.suspense=s}},[t,e]),n},useTransition:function(t){var e=Fr(fi),i=e[0];return e=e[1],[Vs(Ec.bind(null,e,t),[e,t]),i]}},kt=null,Ot=null,gi=!1;function Xf(t,e){var i=gt(5,null,null,0);i.elementType="DELETED",i.type="DELETED",i.stateNode=e,i.return=t,i.effectTag=8,t.lastEffect!==null?(t.lastEffect.nextEffect=i,t.lastEffect=i):t.firstEffect=t.lastEffect=i}function yd(t,e){switch(t.tag){case 5:var i=t.type;return e=e.nodeType!==1||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,!0):!1;case 13:return!1;default:return!1}}function Ga(t){if(gi){var e=Ot;if(e){var i=e;if(!yd(t,e)){if(e=qi(i.nextSibling),!e||!yd(t,e)){t.effectTag=t.effectTag&-1025|2,gi=!1,kt=t;return}Xf(kt,i)}kt=t,Ot=qi(e.firstChild)}else t.effectTag=t.effectTag&-1025|2,gi=!1,kt=t}}function xd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;kt=t}function Zr(t){if(t!==kt)return!1;if(!gi)return xd(t),gi=!0,!1;var e=t.type;if(t.tag!==5||e!=="head"&&e!=="body"&&!Ra(e,t.memoizedProps))for(e=Ot;e;)Xf(t,e),e=qi(e.nextSibling);if(xd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(C(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var i=t.data;if(i===mf){if(e===0){Ot=qi(t.nextSibling);break e}e--}else i!==gf&&i!==uc&&i!==cc||e++}t=t.nextSibling}Ot=null}}else Ot=kt?qi(t.stateNode.nextSibling):null;return!0}function Fo(){Ot=kt=null,gi=!1}var xM=nt.ReactCurrentOwner,ft=!1;function We(t,e,i,n){e.child=t===null?Mc(e,null,i,n):un(e,t.child,i,n)}function Md(t,e,i,n,r){i=i.render;var s=e.ref;return en(e,r),n=bc(t,e,i,n,s,r),t!==null&&!ft?(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=r&&(t.expirationTime=0),Pt(t,e,r)):(e.effectTag|=1,We(t,e,n,r),e.child)}function Sd(t,e,i,n,r,s){if(t===null){var o=i.type;return typeof o=="function"&&!zc(o)&&o.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(e.tag=15,e.type=o,Jf(t,e,o,n,r,s)):(t=fs(i.type,null,n,null,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}return o=t.child,r<s&&(r=o.memoizedProps,i=i.compare,i=i!==null?i:ar,i(r,n)&&t.ref===e.ref)?Pt(t,e,s):(e.effectTag|=1,t=Ci(o,n),t.ref=e.ref,t.return=e,e.child=t)}function Jf(t,e,i,n,r,s){return t!==null&&ar(t.memoizedProps,n)&&t.ref===e.ref&&(ft=!1,r<s)?(e.expirationTime=t.expirationTime,Pt(t,e,s)):Ya(t,e,i,n,s)}function Kf(t,e){var i=e.ref;(t===null&&i!==null||t!==null&&t.ref!==i)&&(e.effectTag|=128)}function Ya(t,e,i,n,r){var s=Re(i)?Ii:be.current;return s=cn(e,s),en(e,r),i=bc(t,e,i,n,s,r),t!==null&&!ft?(e.updateQueue=t.updateQueue,e.effectTag&=-517,t.expirationTime<=r&&(t.expirationTime=0),Pt(t,e,r)):(e.effectTag|=1,We(t,e,i,r),e.child)}function Id(t,e,i,n,r){if(Re(i)){var s=!0;ls(e)}else s=!1;if(en(e,r),e.stateNode===null)t!==null&&(t.alternate=null,e.alternate=null,e.effectTag|=2),Wf(e,i,n),Ha(e,i,n,r),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,l=i.contextType;typeof l=="object"&&l!==null?l=Je(l):(l=Re(i)?Ii:be.current,l=cn(e,l));var u=i.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||c!==l)&&gd(e,o,n,l),jt=!1;var f=e.memoizedState;o.state=f,lr(e,n,o,r),c=e.memoizedState,a!==n||f!==c||je.current||jt?(typeof u=="function"&&(Ls(e,i,u,n),c=e.memoizedState),(a=jt||fd(e,i,a,n,f,c,l))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.effectTag|=4)):(typeof o.componentDidMount=="function"&&(e.effectTag|=4),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=l,n=a):(typeof o.componentDidMount=="function"&&(e.effectTag|=4),n=!1)}else o=e.stateNode,xc(t,e),a=e.memoizedProps,o.props=e.type===e.elementType?a:tt(e.type,a),c=o.context,l=i.contextType,typeof l=="object"&&l!==null?l=Je(l):(l=Re(i)?Ii:be.current,l=cn(e,l)),u=i.getDerivedStateFromProps,(d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||c!==l)&&gd(e,o,n,l),jt=!1,c=e.memoizedState,o.state=c,lr(e,n,o,r),f=e.memoizedState,a!==n||c!==f||je.current||jt?(typeof u=="function"&&(Ls(e,i,u,n),f=e.memoizedState),(u=jt||fd(e,i,a,n,c,f,l))?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,f,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,f,l)),typeof o.componentDidUpdate=="function"&&(e.effectTag|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.effectTag|=256)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&c===t.memoizedState||(e.effectTag|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&c===t.memoizedState||(e.effectTag|=256),e.memoizedProps=n,e.memoizedState=f),o.props=n,o.state=f,o.context=l,n=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&c===t.memoizedState||(e.effectTag|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&c===t.memoizedState||(e.effectTag|=256),n=!1);return Xa(t,e,i,n,s,r)}function Xa(t,e,i,n,r,s){Kf(t,e);var o=(e.effectTag&64)!==0;if(!n&&!o)return r&&ld(e,i,!1),Pt(t,e,s);n=e.stateNode,xM.current=e;var a=o&&typeof i.getDerivedStateFromError!="function"?null:n.render();return e.effectTag|=1,t!==null&&o?(e.child=un(e,t.child,null,s),e.child=un(e,null,a,s)):We(t,e,a,s),e.memoizedState=n.state,r&&ld(e,i,!0),e.child}function Cd(t){var e=t.stateNode;e.pendingContext?ad(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ad(t,e.context,!1),Fa(t,e.containerInfo)}var Zo={dehydrated:null,retryTime:0};function bd(t,e,i){var n=e.mode,r=e.pendingProps,s=le.current,o=!1,a;if((a=(e.effectTag&64)!==0)||(a=(s&2)!==0&&(t===null||t.memoizedState!==null)),a?(o=!0,e.effectTag&=-65):t!==null&&t.memoizedState===null||r.fallback===void 0||r.unstable_avoidThisFallback===!0||(s|=1),de(le,s&1),t===null){if(r.fallback!==void 0&&Ga(e),o){if(o=r.fallback,r=$t(null,n,0,null),r.return=e,(e.mode&2)===0)for(t=e.memoizedState!==null?e.child.child:e.child,r.child=t;t!==null;)t.return=r,t=t.sibling;return i=$t(o,n,i,null),i.return=e,r.sibling=i,e.memoizedState=Zo,e.child=r,i}return n=r.children,e.memoizedState=null,e.child=Mc(e,null,n,i)}if(t.memoizedState!==null){if(t=t.child,n=t.sibling,o){if(r=r.fallback,i=Ci(t,t.pendingProps),i.return=e,(e.mode&2)===0&&(o=e.memoizedState!==null?e.child.child:e.child,o!==t.child))for(i.child=o;o!==null;)o.return=i,o=o.sibling;return n=Ci(n,r),n.return=e,i.sibling=n,i.childExpirationTime=0,e.memoizedState=Zo,e.child=i,n}return i=un(e,t.child,r.children,i),e.memoizedState=null,e.child=i}if(t=t.child,o){if(o=r.fallback,r=$t(null,n,0,null),r.return=e,r.child=t,t!==null&&(t.return=r),(e.mode&2)===0)for(t=e.memoizedState!==null?e.child.child:e.child,r.child=t;t!==null;)t.return=r,t=t.sibling;return i=$t(o,n,i,null),i.return=e,r.sibling=i,i.effectTag|=2,r.childExpirationTime=0,e.memoizedState=Zo,e.child=r,i}return e.memoizedState=null,e.child=un(e,t,r.children,i)}function Ad(t,e){t.expirationTime<e&&(t.expirationTime=e);var i=t.alternate;i!==null&&i.expirationTime<e&&(i.expirationTime=e),Of(t.return,e)}function Qo(t,e,i,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:i,tailExpiration:0,tailMode:r,lastEffect:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=i,o.tailExpiration=0,o.tailMode=r,o.lastEffect=s)}function Td(t,e,i){var n=e.pendingProps,r=n.revealOrder,s=n.tail;if(We(t,e,n.children,i),n=le.current,(n&2)!==0)n=n&1|2,e.effectTag|=64;else{if(t!==null&&(t.effectTag&64)!==0)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ad(t,i);else if(t.tag===19)Ad(t,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(de(le,n),(e.mode&2)===0)e.memoizedState=null;else switch(r){case"forwards":for(i=e.child,r=null;i!==null;)t=i.alternate,t!==null&&js(t)===null&&(r=i),i=i.sibling;i=r,i===null?(r=e.child,e.child=null):(r=i.sibling,i.sibling=null),Qo(e,!1,r,i,s,e.lastEffect);break;case"backwards":for(i=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&js(t)===null){e.child=r;break}t=r.sibling,r.sibling=i,i=r,r=t}Qo(e,!0,i,null,s,e.lastEffect);break;case"together":Qo(e,!1,null,null,void 0,e.lastEffect);break;default:e.memoizedState=null}return e.child}function Pt(t,e,i){t!==null&&(e.dependencies=t.dependencies);var n=e.expirationTime;if(n!==0&&yo(n),e.childExpirationTime<i)return null;if(t!==null&&e.child!==t.child)throw Error(C(153));if(e.child!==null){for(t=e.child,i=Ci(t,t.pendingProps),e.child=i,i.return=e;t.sibling!==null;)t=t.sibling,i=i.sibling=Ci(t,t.pendingProps),i.return=e;i.sibling=null}return e.child}var qf,Ja,eg,tg;qf=function(t,e){for(var i=e.child;i!==null;){if(i.tag===5||i.tag===6)t.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Ja=function(){};eg=function(t,e,i,n,r){var s=t.memoizedProps;if(s!==n){var o=e.stateNode;switch(li(mt.current),t=null,i){case"input":s=Ia(o,s),n=Ia(o,n),t=[];break;case"option":s=Aa(o,s),n=Aa(o,n),t=[];break;case"select":s=ke({},s,{value:void 0}),n=ke({},n,{value:void 0}),t=[];break;case"textarea":s=Ta(o,s),n=Ta(o,n),t=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(o.onclick=Es)}za(i,n);var a,c;i=null;for(a in s)if(!n.hasOwnProperty(a)&&s.hasOwnProperty(a)&&s[a]!=null)if(a==="style")for(c in o=s[a],o)o.hasOwnProperty(c)&&(i||(i={}),i[c]="");else a!=="dangerouslySetInnerHTML"&&a!=="children"&&a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(on.hasOwnProperty(a)?t||(t=[]):(t=t||[]).push(a,null));for(a in n){var l=n[a];if(o=s!=null?s[a]:void 0,n.hasOwnProperty(a)&&l!==o&&(l!=null||o!=null))if(a==="style")if(o){for(c in o)!o.hasOwnProperty(c)||l&&l.hasOwnProperty(c)||(i||(i={}),i[c]="");for(c in l)l.hasOwnProperty(c)&&o[c]!==l[c]&&(i||(i={}),i[c]=l[c])}else i||(t||(t=[]),t.push(a,i)),i=l;else a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(t=t||[]).push(a,l)):a==="children"?o===l||typeof l!="string"&&typeof l!="number"||(t=t||[]).push(a,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&(on.hasOwnProperty(a)?(l!=null&&It(r,a),t||o===l||(t=[])):(t=t||[]).push(a,l))}i&&(t=t||[]).push("style",i),r=t,(e.updateQueue=r)&&(e.effectTag|=4)}};tg=function(t,e,i,n){i!==n&&(e.effectTag|=4)};function Qr(t,e){switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var n=null;i!==null;)i.alternate!==null&&(n=i),i=i.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function MM(t,e,i){var n=e.pendingProps;switch(e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return Re(e.type)&&Ps(),null;case 3:return dn(),se(je),se(be),i=e.stateNode,i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),t!==null&&t.child!==null||!Zr(e)||(e.effectTag|=4),Ja(e),null;case 5:Sc(e),i=li(ur.current);var r=e.type;if(t!==null&&e.stateNode!=null)eg(t,e,r,n,i),t.ref!==e.ref&&(e.effectTag|=128);else{if(!n){if(e.stateNode===null)throw Error(C(166));return null}if(t=li(mt.current),Zr(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[Rt]=e,n[Ns]=s,r){case"iframe":case"object":case"embed":ae("load",n);break;case"video":case"audio":for(t=0;t<Bn.length;t++)ae(Bn[t],n);break;case"source":ae("error",n);break;case"img":case"image":case"link":ae("error",n),ae("load",n);break;case"form":ae("reset",n),ae("submit",n);break;case"details":ae("toggle",n);break;case"input":_u(n,s),ae("invalid",n),It(i,"onChange");break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ae("invalid",n),It(i,"onChange");break;case"textarea":Ou(n,s),ae("invalid",n),It(i,"onChange")}za(r,s),t=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(t=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(t=["children",""+a]):on.hasOwnProperty(o)&&a!=null&&It(i,o)}switch(r){case"input":Vr(n),Vu(n,s,!0);break;case"textarea":Vr(n),$u(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Es)}i=t,e.updateQueue=i,i!==null&&(e.effectTag|=4)}else{switch(o=i.nodeType===9?i:i.ownerDocument,t===Qu&&(t=Qp(r)),t===Qu?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[Rt]=e,t[Ns]=n,qf(t,e,!1,!1),e.stateNode=t,o=Da(r,n),r){case"iframe":case"object":case"embed":ae("load",t),a=n;break;case"video":case"audio":for(a=0;a<Bn.length;a++)ae(Bn[a],t);a=n;break;case"source":ae("error",t),a=n;break;case"img":case"image":case"link":ae("error",t),ae("load",t),a=n;break;case"form":ae("reset",t),ae("submit",t),a=n;break;case"details":ae("toggle",t),a=n;break;case"input":_u(t,n),a=Ia(t,n),ae("invalid",t),It(i,"onChange");break;case"option":a=Aa(t,n);break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=ke({},n,{value:void 0}),ae("invalid",t),It(i,"onChange");break;case"textarea":Ou(t,n),a=Ta(t,n),ae("invalid",t),It(i,"onChange");break;default:a=n}za(r,a);var c=a;for(s in c)if(c.hasOwnProperty(s)){var l=c[s];s==="style"?pf(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Gp(t,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&nr(t,l):typeof l=="number"&&nr(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(on.hasOwnProperty(s)?l!=null&&It(i,s):l!=null&&Kl(t,s,l,o))}switch(r){case"input":Vr(t),Vu(t,n,!1);break;case"textarea":Vr(t),$u(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Jt(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?Ki(t,!!n.multiple,i,!1):n.defaultValue!=null&&Ki(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Es)}vf(r,n)&&(e.effectTag|=4)}e.ref!==null&&(e.effectTag|=128)}return null;case 6:if(t&&e.stateNode!=null)tg(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(C(166));i=li(ur.current),li(mt.current),Zr(e)?(i=e.stateNode,n=e.memoizedProps,i[Rt]=e,i.nodeValue!==n&&(e.effectTag|=4)):(i=(i.nodeType===9?i:i.ownerDocument).createTextNode(n),i[Rt]=e,e.stateNode=i)}return null;case 13:return se(le),n=e.memoizedState,(e.effectTag&64)!==0?(e.expirationTime=i,e):(i=n!==null,n=!1,t===null?e.memoizedProps.fallback!==void 0&&Zr(e):(r=t.memoizedState,n=r!==null,i||r===null||(r=t.child.sibling,r!==null&&(s=e.firstEffect,s!==null?(e.firstEffect=r,r.nextEffect=s):(e.firstEffect=e.lastEffect=r,r.nextEffect=null),r.effectTag=8))),i&&!n&&(e.mode&2)!==0&&(t===null&&e.memoizedProps.unstable_avoidThisFallback!==!0||(le.current&1)!==0?me===mi&&(me=Us):((me===mi||me===Us)&&(me=mo),hr!==0&&Fe!==null&&(di(Fe,_e),Mg(Fe,hr)))),(i||n)&&(e.effectTag|=4),null);case 4:return dn(),Ja(e),null;case 10:return wc(e),null;case 17:return Re(e.type)&&Ps(),null;case 19:if(se(le),n=e.memoizedState,n===null)return null;if(r=(e.effectTag&64)!==0,s=n.rendering,s===null){if(r)Qr(n,!1);else if(me!==mi||t!==null&&(t.effectTag&64)!==0)for(s=e.child;s!==null;){if(t=js(s),t!==null){for(e.effectTag|=64,Qr(n,!1),r=t.updateQueue,r!==null&&(e.updateQueue=r,e.effectTag|=4),n.lastEffect===null&&(e.firstEffect=null),e.lastEffect=n.lastEffect,n=e.child;n!==null;)r=n,s=i,r.effectTag&=2,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null,t=r.alternate,t===null?(r.childExpirationTime=0,r.expirationTime=s,r.child=null,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null):(r.childExpirationTime=t.childExpirationTime,r.expirationTime=t.expirationTime,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,s=t.dependencies,r.dependencies=s===null?null:{expirationTime:s.expirationTime,firstContext:s.firstContext,responders:s.responders}),n=n.sibling;return de(le,le.current&1|2),e.child}s=s.sibling}}else{if(!r)if(t=js(s),t!==null){if(e.effectTag|=64,r=!0,i=t.updateQueue,i!==null&&(e.updateQueue=i,e.effectTag|=4),Qr(n,!0),n.tail===null&&n.tailMode==="hidden"&&!s.alternate)return e=e.lastEffect=n.lastEffect,e!==null&&(e.nextEffect=null),null}else 2*Ye()-n.renderingStartTime>n.tailExpiration&&1<i&&(e.effectTag|=64,r=!0,Qr(n,!1),e.expirationTime=e.childExpirationTime=i-1);n.isBackwards?(s.sibling=e.child,e.child=s):(i=n.last,i!==null?i.sibling=s:e.child=s,n.last=s)}return n.tail!==null?(n.tailExpiration===0&&(n.tailExpiration=Ye()+500),i=n.tail,n.rendering=i,n.tail=i.sibling,n.lastEffect=e.lastEffect,n.renderingStartTime=Ye(),i.sibling=null,e=le.current,de(le,r?e&1|2:e&1),i):null}throw Error(C(156,e.tag))}function SM(t){switch(t.tag){case 1:Re(t.type)&&Ps();var e=t.effectTag;return e&4096?(t.effectTag=e&-4097|64,t):null;case 3:if(dn(),se(je),se(be),e=t.effectTag,(e&64)!==0)throw Error(C(285));return t.effectTag=e&-4097|64,t;case 5:return Sc(t),null;case 13:return se(le),e=t.effectTag,e&4096?(t.effectTag=e&-4097|64,t):null;case 19:return se(le),null;case 4:return dn(),null;case 10:return wc(t),null;default:return null}}function Nc(t,e){return{value:t,source:e,stack:tc(e)}}var IM=typeof WeakSet=="function"?WeakSet:Set;function Ka(t,e){var i=e.source,n=e.stack;n===null&&i!==null&&(n=tc(i)),i!==null&&Bt(i.type),e=e.value,t!==null&&t.tag===1&&Bt(t.type);try{console.error(e)}catch(r){setTimeout(function(){throw r})}}function CM(t,e){try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(i){wi(t,i)}}function Ed(t){var e=t.ref;if(e!==null)if(typeof e=="function")try{e(null)}catch(i){wi(t,i)}else e.current=null}function bM(t,e){switch(e.tag){case 0:case 11:case 15:case 22:return;case 1:if(e.effectTag&256&&t!==null){var i=t.memoizedProps,n=t.memoizedState;t=e.stateNode,e=t.getSnapshotBeforeUpdate(e.elementType===e.type?i:tt(e.type,i),n),t.__reactInternalSnapshotBeforeUpdate=e}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(C(163))}function ig(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&t)===t){var n=i.destroy;i.destroy=void 0,n!==void 0&&n()}i=i.next}while(i!==e)}}function ng(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&t)===t){var n=i.create;i.destroy=n()}i=i.next}while(i!==e)}}function AM(t,e,i){switch(i.tag){case 0:case 11:case 15:case 22:ng(3,i);return;case 1:if(t=i.stateNode,i.effectTag&4)if(e===null)t.componentDidMount();else{var n=i.elementType===i.type?e.memoizedProps:tt(i.type,e.memoizedProps);t.componentDidUpdate(n,e.memoizedState,t.__reactInternalSnapshotBeforeUpdate)}e=i.updateQueue,e!==null&&pd(i,e,t);return;case 3:if(e=i.updateQueue,e!==null){if(t=null,i.child!==null)switch(i.child.tag){case 5:t=i.child.stateNode;break;case 1:t=i.child.stateNode}pd(i,e,t)}return;case 5:t=i.stateNode,e===null&&i.effectTag&4&&vf(i.type,i.memoizedProps)&&t.focus();return;case 6:return;case 4:return;case 12:return;case 13:i.memoizedState===null&&(i=i.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&cf(i))));return;case 19:case 17:case 20:case 21:return}throw Error(C(163))}function Nd(t,e,i){switch(typeof ol=="function"&&ol(e),e.tag){case 0:case 11:case 14:case 15:case 22:if(t=e.updateQueue,t!==null&&(t=t.lastEffect,t!==null)){var n=t.next;qt(97<i?97:i,function(){var r=n;do{var s=r.destroy;if(s!==void 0){var o=e;try{s()}catch(a){wi(o,a)}}r=r.next}while(r!==n)})}break;case 1:Ed(e),i=e.stateNode,typeof i.componentWillUnmount=="function"&&CM(e,i);break;case 5:Ed(e);break;case 4:sg(t,e,i)}}function rg(t){var e=t.alternate;t.return=null,t.child=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.alternate=null,t.firstEffect=null,t.lastEffect=null,t.pendingProps=null,t.memoizedProps=null,t.stateNode=null,e!==null&&rg(e)}function kd(t){return t.tag===5||t.tag===3||t.tag===4}function Pd(t){e:{for(var e=t.return;e!==null;){if(kd(e)){var i=e;break e}e=e.return}throw Error(C(160))}switch(e=i.stateNode,i.tag){case 5:var n=!1;break;case 3:e=e.containerInfo,n=!0;break;case 4:e=e.containerInfo,n=!0;break;default:throw Error(C(161))}i.effectTag&16&&(nr(e,""),i.effectTag&=-17);e:t:for(i=t;;){for(;i.sibling===null;){if(i.return===null||kd(i.return)){i=null;break e}i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.effectTag&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.effectTag&2)){i=i.stateNode;break e}}n?qa(t,i,e):el(t,i,e)}function qa(t,e,i){var n=t.tag,r=n===5||n===6;if(r)t=r?t.stateNode:t.stateNode.instance,e?i.nodeType===8?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(i.nodeType===8?(e=i.parentNode,e.insertBefore(t,i)):(e=i,e.appendChild(t)),i=i._reactRootContainer,i!=null||e.onclick!==null||(e.onclick=Es));else if(n!==4&&(t=t.child,t!==null))for(qa(t,e,i),t=t.sibling;t!==null;)qa(t,e,i),t=t.sibling}function el(t,e,i){var n=t.tag,r=n===5||n===6;if(r)t=r?t.stateNode:t.stateNode.instance,e?i.insertBefore(t,e):i.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(el(t,e,i),t=t.sibling;t!==null;)el(t,e,i),t=t.sibling}function sg(t,e,i){for(var n=e,r=!1,s,o;;){if(!r){r=n.return;e:for(;;){if(r===null)throw Error(C(160));switch(s=r.stateNode,r.tag){case 5:o=!1;break e;case 3:s=s.containerInfo,o=!0;break e;case 4:s=s.containerInfo,o=!0;break e}r=r.return}r=!0}if(n.tag===5||n.tag===6){e:for(var a=t,c=n,l=i,u=c;;)if(Nd(a,u,l),u.child!==null&&u.tag!==4)u.child.return=u,u=u.child;else{if(u===c)break e;for(;u.sibling===null;){if(u.return===null||u.return===c)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}o?(a=s,c=n.stateNode,a.nodeType===8?a.parentNode.removeChild(c):a.removeChild(c)):s.removeChild(n.stateNode)}else if(n.tag===4){if(n.child!==null){s=n.stateNode.containerInfo,o=!0,n.child.return=n,n=n.child;continue}}else if(Nd(t,n,i),n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return,n.tag===4&&(r=!1)}n.sibling.return=n.return,n=n.sibling}}function Go(t,e){switch(e.tag){case 0:case 11:case 14:case 15:case 22:ig(3,e);return;case 1:return;case 5:var i=e.stateNode;if(i!=null){var n=e.memoizedProps,r=t!==null?t.memoizedProps:n;t=e.type;var s=e.updateQueue;if(e.updateQueue=null,s!==null){for(i[Ns]=n,t==="input"&&n.type==="radio"&&n.name!=null&&Hp(i,n),Da(t,r),e=Da(t,n),r=0;r<s.length;r+=2){var o=s[r],a=s[r+1];o==="style"?pf(i,a):o==="dangerouslySetInnerHTML"?Gp(i,a):o==="children"?nr(i,a):Kl(i,o,a,e)}switch(t){case"input":Ca(i,n);break;case"textarea":Fp(i,n);break;case"select":e=i._wrapperState.wasMultiple,i._wrapperState.wasMultiple=!!n.multiple,t=n.value,t!=null?Ki(i,!!n.multiple,t,!1):e!==!!n.multiple&&(n.defaultValue!=null?Ki(i,!!n.multiple,n.defaultValue,!0):Ki(i,!!n.multiple,n.multiple?[]:"",!1))}}}return;case 6:if(e.stateNode===null)throw Error(C(162));e.stateNode.nodeValue=e.memoizedProps;return;case 3:e=e.stateNode,e.hydrate&&(e.hydrate=!1,cf(e.containerInfo));return;case 12:return;case 13:if(i=e,e.memoizedState===null?n=!1:(n=!0,i=e.child,Bc=Ye()),i!==null)e:for(t=i;;){if(t.tag===5)s=t.stateNode,n?(s=s.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(s=t.stateNode,r=t.memoizedProps.style,r=r!=null&&r.hasOwnProperty("display")?r.display:null,s.style.display=hf("display",r));else if(t.tag===6)t.stateNode.nodeValue=n?"":t.memoizedProps;else if(t.tag===13&&t.memoizedState!==null&&t.memoizedState.dehydrated===null){s=t.child.sibling,s.return=t,t=s;continue}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}Bd(e);return;case 19:Bd(e);return;case 17:return}throw Error(C(163))}function Bd(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var i=t.stateNode;i===null&&(i=t.stateNode=new IM),e.forEach(function(n){var r=jM.bind(null,t,n);i.has(n)||(i.add(n),n.then(r,r))})}}var TM=typeof WeakMap=="function"?WeakMap:Map;function og(t,e,i){i=Qt(i,null),i.tag=3,i.payload={element:null};var n=e.value;return i.callback=function(){Zs||(Zs=!0,tl=n),Ka(t,e)},i}function ag(t,e,i){i=Qt(i,null),i.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var r=e.value;i.payload=function(){return Ka(t,e),n(r)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(i.callback=function(){typeof n!="function"&&(Yt===null?Yt=new Set([this]):Yt.add(this),Ka(t,e));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),i}var EM=Math.ceil,$s=nt.ReactCurrentDispatcher,lg=nt.ReactCurrentOwner,ve=0,kc=8,rt=16,wt=32,mi=0,Ws=1,cg=2,Us=3,mo=4,Pc=5,$=ve,Fe=null,Z=null,_e=0,me=mi,vo=null,Nt=1073741823,dr=1073741823,Hs=null,hr=0,Fs=!1,Bc=0,ug=500,j=null,Zs=!1,tl=null,Yt=null,Qs=!1,Yn=null,Dn=90,ci=null,Xn=0,il=null,hs=0;function vt(){return($&(rt|wt))!==ve?1073741821-(Ye()/10|0):hs!==0?hs:hs=1073741821-(Ye()/10|0)}function vi(t,e,i){if(e=e.mode,(e&2)===0)return 1073741823;var n=fo();if((e&4)===0)return n===99?1073741823:1073741822;if(($&rt)!==ve)return _e;if(i!==null)t=us(t,i.timeoutMs|0||5e3,250);else switch(n){case 99:t=1073741823;break;case 98:t=us(t,150,100);break;case 97:case 96:t=us(t,5e3,250);break;case 95:t=2;break;default:throw Error(C(326))}return Fe!==null&&t===_e&&--t,t}function Xt(t,e){if(50<Xn)throw Xn=0,il=null,Error(C(185));if(t=wo(t,e),t!==null){var i=fo();e===1073741823?($&kc)!==ve&&($&(rt|wt))===ve?nl(t):(Ze(t),$===ve&&yt()):Ze(t),($&4)===ve||i!==98&&i!==99||(ci===null?ci=new Map([[t,e]]):(i=ci.get(t),(i===void 0||i>e)&&ci.set(t,e)))}}function wo(t,e){t.expirationTime<e&&(t.expirationTime=e);var i=t.alternate;i!==null&&i.expirationTime<e&&(i.expirationTime=e);var n=t.return,r=null;if(n===null&&t.tag===3)r=t.stateNode;else for(;n!==null;){if(i=n.alternate,n.childExpirationTime<e&&(n.childExpirationTime=e),i!==null&&i.childExpirationTime<e&&(i.childExpirationTime=e),n.return===null&&n.tag===3){r=n.stateNode;break}n=n.return}return r!==null&&(Fe===r&&(yo(e),me===mo&&di(r,_e)),Mg(r,e)),r}function ps(t){var e=t.lastExpiredTime;if(e!==0||(e=t.firstPendingTime,!xg(t,e)))return e;var i=t.lastPingedTime;return t=t.nextKnownPendingLevel,t=i>t?i:t,2>=t&&e!==t?0:t}function Ze(t){if(t.lastExpiredTime!==0)t.callbackExpirationTime=1073741823,t.callbackPriority=99,t.callbackNode=dd(nl.bind(null,t));else{var e=ps(t),i=t.callbackNode;if(e===0)i!==null&&(t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90);else{var n=vt();if(e===1073741823?n=99:e===1||e===2?n=95:(n=10*(1073741821-e)-10*(1073741821-n),n=0>=n?99:250>=n?98:5250>=n?97:95),i!==null){var r=t.callbackPriority;if(t.callbackExpirationTime===e&&r>=n)return;i!==jf&&Pf(i)}t.callbackExpirationTime=e,t.callbackPriority=n,e=e===1073741823?dd(nl.bind(null,t)):_f(n,dg.bind(null,t),{timeout:10*(1073741821-e)-Ye()}),t.callbackNode=e}}}function dg(t,e){if(hs=0,e)return e=vt(),al(t,e),Ze(t),null;var i=ps(t);if(i!==0){if(e=t.callbackNode,($&(rt|wt))!==ve)throw Error(C(327));if(mn(),t===Fe&&i===_e||ui(t,i),Z!==null){var n=$;$|=rt;var r=gg();do try{PM();break}catch(a){fg(t,a)}while(1);if(vc(),$=n,$s.current=r,me===Ws)throw e=vo,ui(t,i),di(t,i),Ze(t),e;if(Z===null)switch(r=t.finishedWork=t.current.alternate,t.finishedExpirationTime=i,n=me,Fe=null,n){case mi:case Ws:throw Error(C(345));case cg:al(t,2<i?2:i);break;case Us:if(di(t,i),n=t.lastSuspendedTime,i===n&&(t.nextKnownPendingLevel=rl(r)),Nt===1073741823&&(r=Bc+ug-Ye(),10<r)){if(Fs){var s=t.lastPingedTime;if(s===0||s>=i){t.lastPingedTime=i,ui(t,i);break}}if(s=ps(t),s!==0&&s!==i)break;if(n!==0&&n!==i){t.lastPingedTime=n;break}t.timeoutHandle=Wo(si.bind(null,t),r);break}si(t);break;case mo:if(di(t,i),n=t.lastSuspendedTime,i===n&&(t.nextKnownPendingLevel=rl(r)),Fs&&(r=t.lastPingedTime,r===0||r>=i)){t.lastPingedTime=i,ui(t,i);break}if(r=ps(t),r!==0&&r!==i)break;if(n!==0&&n!==i){t.lastPingedTime=n;break}if(dr!==1073741823?n=10*(1073741821-dr)-Ye():Nt===1073741823?n=0:(n=10*(1073741821-Nt)-5e3,r=Ye(),i=10*(1073741821-i)-r,n=r-n,0>n&&(n=0),n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*EM(n/1960))-n,i<n&&(n=i)),10<n){t.timeoutHandle=Wo(si.bind(null,t),n);break}si(t);break;case Pc:if(Nt!==1073741823&&Hs!==null){s=Nt;var o=Hs;if(n=o.busyMinDurationMs|0,0>=n?n=0:(r=o.busyDelayMs|0,s=Ye()-(10*(1073741821-s)-(o.timeoutMs|0||5e3)),n=s<=r?0:r+n-s),10<n){di(t,i),t.timeoutHandle=Wo(si.bind(null,t),n);break}}si(t);break;default:throw Error(C(329))}if(Ze(t),t.callbackNode===e)return dg.bind(null,t)}}return null}function nl(t){var e=t.lastExpiredTime;if(e=e!==0?e:1073741823,($&(rt|wt))!==ve)throw Error(C(327));if(mn(),t===Fe&&e===_e||ui(t,e),Z!==null){var i=$;$|=rt;var n=gg();do try{kM();break}catch(r){fg(t,r)}while(1);if(vc(),$=i,$s.current=n,me===Ws)throw i=vo,ui(t,e),di(t,e),Ze(t),i;if(Z!==null)throw Error(C(261));t.finishedWork=t.current.alternate,t.finishedExpirationTime=e,Fe=null,si(t),Ze(t)}return null}function NM(){if(ci!==null){var t=ci;ci=null,t.forEach(function(e,i){al(i,e),Ze(i)}),yt()}}function hg(t,e){var i=$;$|=1;try{return t(e)}finally{$=i,$===ve&&yt()}}function pg(t,e){var i=$;$&=-2,$|=kc;try{return t(e)}finally{$=i,$===ve&&yt()}}function ui(t,e){t.finishedWork=null,t.finishedExpirationTime=0;var i=t.timeoutHandle;if(i!==-1&&(t.timeoutHandle=-1,E0(i)),Z!==null)for(i=Z.return;i!==null;){var n=i;switch(n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ps();break;case 3:dn(),se(je),se(be);break;case 5:Sc(n);break;case 4:dn();break;case 13:se(le);break;case 19:se(le);break;case 10:wc(n)}i=i.return}Fe=t,Z=Ci(t.current,null),_e=e,me=mi,vo=null,dr=Nt=1073741823,Hs=null,hr=0,Fs=!1}function fg(t,e){do{try{if(vc(),ds.current=Os,Rs)for(var i=he.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}if(Vt=0,Ce=Ie=he=null,Rs=!1,Z===null||Z.return===null)return me=Ws,vo=e,Z=null;e:{var r=t,s=Z.return,o=Z,a=e;if(e=_e,o.effectTag|=2048,o.firstEffect=o.lastEffect=null,a!==null&&typeof a=="object"&&typeof a.then=="function"){var c=a;if((o.mode&2)===0){var l=o.alternate;l?(o.updateQueue=l.updateQueue,o.memoizedState=l.memoizedState,o.expirationTime=l.expirationTime):(o.updateQueue=null,o.memoizedState=null)}var u=(le.current&1)!==0,d=s;do{var f;if(f=d.tag===13){var v=d.memoizedState;if(v!==null)f=v.dehydrated!==null;else{var w=d.memoizedProps;f=w.fallback===void 0?!1:w.unstable_avoidThisFallback!==!0?!0:!u}}if(f){var x=d.updateQueue;if(x===null){var h=new Set;h.add(c),d.updateQueue=h}else x.add(c);if((d.mode&2)===0){if(d.effectTag|=64,o.effectTag&=-2981,o.tag===1)if(o.alternate===null)o.tag=17;else{var p=Qt(1073741823,null);p.tag=2,Gt(o,p)}o.expirationTime=1073741823;break e}a=void 0,o=e;var g=r.pingCache;if(g===null?(g=r.pingCache=new TM,a=new Set,g.set(c,a)):(a=g.get(c),a===void 0&&(a=new Set,g.set(c,a))),!a.has(o)){a.add(o);var m=LM.bind(null,r,c,o);c.then(m,m)}d.effectTag|=4096,d.expirationTime=e;break e}d=d.return}while(d!==null);a=Error((Bt(o.type)||"A React component")+` suspended while rendering, but no fallback UI was specified.

Add a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.`+tc(o))}me!==Pc&&(me=cg),a=Nc(a,o),d=s;do{switch(d.tag){case 3:c=a,d.effectTag|=4096,d.expirationTime=e;var y=og(d,c,e);hd(d,y);break e;case 1:c=a;var M=d.type,E=d.stateNode;if((d.effectTag&64)===0&&(typeof M.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Yt===null||!Yt.has(E)))){d.effectTag|=4096,d.expirationTime=e;var z=ag(d,c,e);hd(d,z);break e}}d=d.return}while(d!==null)}Z=wg(Z)}catch(P){e=P;continue}break}while(1)}function gg(){var t=$s.current;return $s.current=Os,t===null?Os:t}function mg(t,e){t<Nt&&2<t&&(Nt=t),e!==null&&t<dr&&2<t&&(dr=t,Hs=e)}function yo(t){t>hr&&(hr=t)}function kM(){for(;Z!==null;)Z=vg(Z)}function PM(){for(;Z!==null&&!gM();)Z=vg(Z)}function vg(t){var e=yg(t.alternate,t,_e);return t.memoizedProps=t.pendingProps,e===null&&(e=wg(t)),lg.current=null,e}function wg(t){Z=t;do{var e=Z.alternate;if(t=Z.return,(Z.effectTag&2048)===0){if(e=MM(e,Z,_e),_e===1||Z.childExpirationTime!==1){for(var i=0,n=Z.child;n!==null;){var r=n.expirationTime,s=n.childExpirationTime;r>i&&(i=r),s>i&&(i=s),n=n.sibling}Z.childExpirationTime=i}if(e!==null)return e;t!==null&&(t.effectTag&2048)===0&&(t.firstEffect===null&&(t.firstEffect=Z.firstEffect),Z.lastEffect!==null&&(t.lastEffect!==null&&(t.lastEffect.nextEffect=Z.firstEffect),t.lastEffect=Z.lastEffect),1<Z.effectTag&&(t.lastEffect!==null?t.lastEffect.nextEffect=Z:t.firstEffect=Z,t.lastEffect=Z))}else{if(e=SM(Z),e!==null)return e.effectTag&=2047,e;t!==null&&(t.firstEffect=t.lastEffect=null,t.effectTag|=2048)}if(e=Z.sibling,e!==null)return e;Z=t}while(Z!==null);return me===mi&&(me=Pc),null}function rl(t){var e=t.expirationTime;return t=t.childExpirationTime,e>t?e:t}function si(t){var e=fo();return qt(99,BM.bind(null,t,e)),null}function BM(t,e){do mn();while(Yn!==null);if(($&(rt|wt))!==ve)throw Error(C(327));var i=t.finishedWork,n=t.finishedExpirationTime;if(i===null)return null;if(t.finishedWork=null,t.finishedExpirationTime=0,i===t.current)throw Error(C(177));t.callbackNode=null,t.callbackExpirationTime=0,t.callbackPriority=90,t.nextKnownPendingLevel=0;var r=rl(i);if(t.firstPendingTime=r,n<=t.lastSuspendedTime?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:n<=t.firstSuspendedTime&&(t.firstSuspendedTime=n-1),n<=t.lastPingedTime&&(t.lastPingedTime=0),n<=t.lastExpiredTime&&(t.lastExpiredTime=0),t===Fe&&(Z=Fe=null,_e=0),1<i.effectTag?i.lastEffect!==null?(i.lastEffect.nextEffect=i,r=i.firstEffect):r=i:r=i.firstEffect,r!==null){var s=$;$|=wt,lg.current=null,Oo=rs;var o=Xu();if(ja(o)){if("selectionStart"in o)var a={start:o.selectionStart,end:o.selectionEnd};else e:{a=(a=o.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var l=c.anchorOffset,u=c.focusNode;c=c.focusOffset;try{a.nodeType,u.nodeType}catch{a=null;break e}var d=0,f=-1,v=-1,w=0,x=0,h=o,p=null;t:for(;;){for(var g;h!==a||l!==0&&h.nodeType!==3||(f=d+l),h!==u||c!==0&&h.nodeType!==3||(v=d+c),h.nodeType===3&&(d+=h.nodeValue.length),(g=h.firstChild)!==null;)p=h,h=g;for(;;){if(h===o)break t;if(p===a&&++w===l&&(f=d),p===u&&++x===c&&(v=d),(g=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=g}a=f===-1||v===-1?null:{start:f,end:v}}else a=null}a=a||{start:0,end:0}}else a=null;$o={activeElementDetached:null,focusedElem:o,selectionRange:a},rs=!1,j=r;do try{zM()}catch(L){if(j===null)throw Error(C(330));wi(j,L),j=j.nextEffect}while(j!==null);j=r;do try{for(o=t,a=e;j!==null;){var m=j.effectTag;if(m&16&&nr(j.stateNode,""),m&128){var y=j.alternate;if(y!==null){var M=y.ref;M!==null&&(typeof M=="function"?M(null):M.current=null)}}switch(m&1038){case 2:Pd(j),j.effectTag&=-3;break;case 6:Pd(j),j.effectTag&=-3,Go(j.alternate,j);break;case 1024:j.effectTag&=-1025;break;case 1028:j.effectTag&=-1025,Go(j.alternate,j);break;case 4:Go(j.alternate,j);break;case 8:l=j,sg(o,l,a),rg(l)}j=j.nextEffect}}catch(L){if(j===null)throw Error(C(330));wi(j,L),j=j.nextEffect}while(j!==null);if(M=$o,y=Xu(),m=M.focusedElem,a=M.selectionRange,y!==m&&m&&m.ownerDocument&&ff(m.ownerDocument.documentElement,m)){for(a!==null&&ja(m)&&(y=a.start,M=a.end,M===void 0&&(M=y),"selectionStart"in m?(m.selectionStart=y,m.selectionEnd=Math.min(M,m.value.length)):(M=(y=m.ownerDocument||document)&&y.defaultView||window,M.getSelection&&(M=M.getSelection(),l=m.textContent.length,o=Math.min(a.start,l),a=a.end===void 0?o:Math.min(a.end,l),!M.extend&&o>a&&(l=a,a=o,o=l),l=Yu(m,o),u=Yu(m,a),l&&u&&(M.rangeCount!==1||M.anchorNode!==l.node||M.anchorOffset!==l.offset||M.focusNode!==u.node||M.focusOffset!==u.offset)&&(y=y.createRange(),y.setStart(l.node,l.offset),M.removeAllRanges(),o>a?(M.addRange(y),M.extend(u.node,u.offset)):(y.setEnd(u.node,u.offset),M.addRange(y)))))),y=[],M=m;M=M.parentNode;)M.nodeType===1&&y.push({element:M,left:M.scrollLeft,top:M.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<y.length;m++)M=y[m],M.element.scrollLeft=M.left,M.element.scrollTop=M.top}rs=!!Oo,$o=Oo=null,t.current=i,j=r;do try{for(m=t;j!==null;){var E=j.effectTag;if(E&36&&AM(m,j.alternate,j),E&128){y=void 0;var z=j.ref;if(z!==null){var P=j.stateNode;switch(j.tag){case 5:y=P;break;default:y=P}typeof z=="function"?z(y):z.current=y}}j=j.nextEffect}}catch(L){if(j===null)throw Error(C(330));wi(j,L),j=j.nextEffect}while(j!==null);j=null,mM(),$=s}else t.current=i;if(Qs)Qs=!1,Yn=t,Dn=e;else for(j=r;j!==null;)e=j.nextEffect,j.nextEffect=null,j=e;if(e=t.firstPendingTime,e===0&&(Yt=null),e===1073741823?t===il?Xn++:(Xn=0,il=t):Xn=0,typeof sl=="function"&&sl(i.stateNode,n),Ze(t),Zs)throw Zs=!1,t=tl,tl=null,t;return($&kc)!==ve||yt(),null}function zM(){for(;j!==null;){var t=j.effectTag;(t&256)!==0&&bM(j.alternate,j),(t&512)===0||Qs||(Qs=!0,_f(97,function(){return mn(),null})),j=j.nextEffect}}function mn(){if(Dn!==90){var t=97<Dn?97:Dn;return Dn=90,qt(t,DM)}}function DM(){if(Yn===null)return!1;var t=Yn;if(Yn=null,($&(rt|wt))!==ve)throw Error(C(331));var e=$;for($|=wt,t=t.current.firstEffect;t!==null;){try{var i=t;if((i.effectTag&512)!==0)switch(i.tag){case 0:case 11:case 15:case 22:ig(5,i),ng(5,i)}}catch(n){if(t===null)throw Error(C(330));wi(t,n)}i=t.nextEffect,t.nextEffect=null,t=i}return $=e,yt(),!0}function zd(t,e,i){e=Nc(i,e),e=og(t,e,1073741823),Gt(t,e),t=wo(t,1073741823),t!==null&&Ze(t)}function wi(t,e){if(t.tag===3)zd(t,t,e);else for(var i=t.return;i!==null;){if(i.tag===3){zd(i,t,e);break}else if(i.tag===1){var n=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Yt===null||!Yt.has(n))){t=Nc(e,t),t=ag(i,t,1073741823),Gt(i,t),i=wo(i,1073741823),i!==null&&Ze(i);break}}i=i.return}}function LM(t,e,i){var n=t.pingCache;n!==null&&n.delete(e),Fe===t&&_e===i?me===mo||me===Us&&Nt===1073741823&&Ye()-Bc<ug?ui(t,_e):Fs=!0:xg(t,i)&&(e=t.lastPingedTime,e!==0&&e<i||(t.lastPingedTime=i,Ze(t)))}function jM(t,e){var i=t.stateNode;i!==null&&i.delete(e),e=0,e===0&&(e=vt(),e=vi(e,t,null)),t=wo(t,e),t!==null&&Ze(t)}var yg;yg=function(t,e,i){var n=e.expirationTime;if(t!==null){var r=e.pendingProps;if(t.memoizedProps!==r||je.current)ft=!0;else{if(n<i){switch(ft=!1,e.tag){case 3:Cd(e),Fo();break;case 5:if(md(e),e.mode&4&&i!==1&&r.hidden)return e.expirationTime=e.childExpirationTime=1,null;break;case 1:Re(e.type)&&ls(e);break;case 4:Fa(e,e.stateNode.containerInfo);break;case 10:n=e.memoizedProps.value,r=e.type._context,de(Bs,r._currentValue),r._currentValue=n;break;case 13:if(e.memoizedState!==null)return n=e.child.childExpirationTime,n!==0&&n>=i?bd(t,e,i):(de(le,le.current&1),e=Pt(t,e,i),e!==null?e.sibling:null);de(le,le.current&1);break;case 19:if(n=e.childExpirationTime>=i,(t.effectTag&64)!==0){if(n)return Td(t,e,i);e.effectTag|=64}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null),de(le,le.current),!n)return null}return Pt(t,e,i)}ft=!1}}else ft=!1;switch(e.expirationTime=0,e.tag){case 2:if(n=e.type,t!==null&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,r=cn(e,be.current),en(e,i),r=bc(null,e,n,t,r,i),e.effectTag|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0){if(e.tag=1,e.memoizedState=null,e.updateQueue=null,Re(n)){var s=!0;ls(e)}else s=!1;e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,yc(e);var o=n.getDerivedStateFromProps;typeof o=="function"&&Ls(e,n,o,t),r.updater=go,e.stateNode=r,r._reactInternalFiber=e,Ha(e,n,t,i),e=Xa(null,e,n,!0,s,i)}else e.tag=0,We(null,e,r,i),e=e.child;return e;case 16:e:{if(r=e.elementType,t!==null&&(t.alternate=null,e.alternate=null,e.effectTag|=2),t=e.pendingProps,d0(r),r._status!==1)throw r._result;switch(r=r._result,e.type=r,s=e.tag=VM(r),t=tt(r,t),s){case 0:e=Ya(null,e,r,t,i);break e;case 1:e=Id(null,e,r,t,i);break e;case 11:e=Md(null,e,r,t,i);break e;case 14:e=Sd(null,e,r,tt(r.type,t),n,i);break e}throw Error(C(306,r,""))}return e;case 0:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:tt(n,r),Ya(t,e,n,r,i);case 1:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:tt(n,r),Id(t,e,n,r,i);case 3:if(Cd(e),n=e.updateQueue,t===null||n===null)throw Error(C(282));if(n=e.pendingProps,r=e.memoizedState,r=r!==null?r.element:null,xc(t,e),lr(e,n,null,i),n=e.memoizedState.element,n===r)Fo(),e=Pt(t,e,i);else{if((r=e.stateNode.hydrate)&&(Ot=qi(e.stateNode.containerInfo.firstChild),kt=e,r=gi=!0),r)for(i=Mc(e,null,n,i),e.child=i;i;)i.effectTag=i.effectTag&-3|1024,i=i.sibling;else We(t,e,n,i),Fo();e=e.child}return e;case 5:return md(e),t===null&&Ga(e),n=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,Ra(n,r)?o=null:s!==null&&Ra(n,s)&&(e.effectTag|=16),Kf(t,e),e.mode&4&&i!==1&&r.hidden?(e.expirationTime=e.childExpirationTime=1,e=null):(We(t,e,o,i),e=e.child),e;case 6:return t===null&&Ga(e),null;case 13:return bd(t,e,i);case 4:return Fa(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=un(e,null,n,i):We(t,e,n,i),e.child;case 11:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:tt(n,r),Md(t,e,n,r,i);case 7:return We(t,e,e.pendingProps,i),e.child;case 8:return We(t,e,e.pendingProps.children,i),e.child;case 12:return We(t,e,e.pendingProps.children,i),e.child;case 10:e:{n=e.type._context,r=e.pendingProps,o=e.memoizedProps,s=r.value;var a=e.type._context;if(de(Bs,a._currentValue),a._currentValue=s,o!==null)if(a=o.value,s=Si(a,s)?0:(typeof n._calculateChangedBits=="function"?n._calculateChangedBits(a,s):1073741823)|0,s===0){if(o.children===r.children&&!je.current){e=Pt(t,e,i);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var c=a.dependencies;if(c!==null){o=a.child;for(var l=c.firstContext;l!==null;){if(l.context===n&&(l.observedBits&s)!==0){a.tag===1&&(l=Qt(i,null),l.tag=2,Gt(a,l)),a.expirationTime<i&&(a.expirationTime=i),l=a.alternate,l!==null&&l.expirationTime<i&&(l.expirationTime=i),Of(a.return,i),c.expirationTime<i&&(c.expirationTime=i);break}l=l.next}}else o=a.tag===10&&a.type===e.type?null:a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}We(t,e,r.children,i),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps,n=s.children,en(e,i),r=Je(r,s.unstable_observedBits),n=n(r),e.effectTag|=1,We(t,e,n,i),e.child;case 14:return r=e.type,s=tt(r,e.pendingProps),s=tt(r.type,s),Sd(t,e,r,s,n,i);case 15:return Jf(t,e,e.type,e.pendingProps,n,i);case 17:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:tt(n,r),t!==null&&(t.alternate=null,e.alternate=null,e.effectTag|=2),e.tag=1,Re(n)?(t=!0,ls(e)):t=!1,en(e,i),Wf(e,n,r),Ha(e,n,r,i),Xa(null,e,n,!0,t,i);case 19:return Td(t,e,i)}throw Error(C(156,e.tag))};var sl=null,ol=null;function RM(t){if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined")return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var i=e.inject(t);sl=function(n){try{e.onCommitFiberRoot(i,n,void 0,(n.current.effectTag&64)===64)}catch{}},ol=function(n){try{e.onCommitFiberUnmount(i,n)}catch{}}}catch{}return!0}function _M(t,e,i,n){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function gt(t,e,i,n){return new _M(t,e,i,n)}function zc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function VM(t){if(typeof t=="function")return zc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ql)return 11;if(t===ec)return 14}return 2}function Ci(t,e){var i=t.alternate;return i===null?(i=gt(t.tag,e,t.key,t.mode),i.elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.effectTag=0,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null),i.childExpirationTime=t.childExpirationTime,i.expirationTime=t.expirationTime,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=e===null?null:{expirationTime:e.expirationTime,firstContext:e.firstContext,responders:e.responders},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function fs(t,e,i,n,r,s){var o=2;if(n=t,typeof t=="function")zc(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case oi:return $t(i.children,r,s,e);case u0:o=8,r|=7;break;case Rp:o=8,r|=1;break;case ts:return t=gt(12,i,e,r|8),t.elementType=ts,t.type=ts,t.expirationTime=s,t;case is:return t=gt(13,i,e,r),t.type=is,t.elementType=is,t.expirationTime=s,t;case Sa:return t=gt(19,i,e,r),t.elementType=Sa,t.expirationTime=s,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _p:o=10;break e;case Vp:o=9;break e;case ql:o=11;break e;case ec:o=14;break e;case Op:o=16,n=null;break e;case $p:o=22;break e}throw Error(C(130,t==null?t:typeof t,""))}return e=gt(o,i,e,r),e.elementType=t,e.type=n,e.expirationTime=s,e}function $t(t,e,i,n){return t=gt(7,t,n,e),t.expirationTime=i,t}function Yo(t,e,i){return t=gt(6,t,null,e),t.expirationTime=i,t}function Xo(t,e,i){return e=gt(4,t.children!==null?t.children:[],t.key,e),e.expirationTime=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function OM(t,e,i){this.tag=e,this.current=null,this.containerInfo=t,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=i,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function xg(t,e){var i=t.firstSuspendedTime;return t=t.lastSuspendedTime,i!==0&&i>=e&&t<=e}function di(t,e){var i=t.firstSuspendedTime,n=t.lastSuspendedTime;i<e&&(t.firstSuspendedTime=e),(n>e||i===0)&&(t.lastSuspendedTime=e),e<=t.lastPingedTime&&(t.lastPingedTime=0),e<=t.lastExpiredTime&&(t.lastExpiredTime=0)}function Mg(t,e){e>t.firstPendingTime&&(t.firstPendingTime=e);var i=t.firstSuspendedTime;i!==0&&(e>=i?t.firstSuspendedTime=t.lastSuspendedTime=t.nextKnownPendingLevel=0:e>=t.lastSuspendedTime&&(t.lastSuspendedTime=e+1),e>t.nextKnownPendingLevel&&(t.nextKnownPendingLevel=e))}function al(t,e){var i=t.lastExpiredTime;(i===0||i>e)&&(t.lastExpiredTime=e)}function Gs(t,e,i,n){var r=e.current,s=vt(),o=Gn.suspense;s=vi(s,r,o);e:if(i){i=i._reactInternalFiber;t:{if(Ei(i)!==i||i.tag!==1)throw Error(C(170));var a=i;do{switch(a.tag){case 3:a=a.stateNode.context;break t;case 1:if(Re(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break t}}a=a.return}while(a!==null);throw Error(C(171))}if(i.tag===1){var c=i.type;if(Re(c)){i=kf(i,c,a);break e}}i=a}else i=Kt;return e.context===null?e.context=i:e.pendingContext=i,e=Qt(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),Gt(r,e),Xt(r,s),s}function Jo(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Dd(t,e){t=t.memoizedState,t!==null&&t.dehydrated!==null&&t.retryTime<e&&(t.retryTime=e)}function Dc(t,e){Dd(t,e),(t=t.alternate)&&Dd(t,e)}function Lc(t,e,i){i=i!=null&&i.hydrate===!0;var n=new OM(t,e,i),r=gt(3,null,null,e===2?7:e===1?3:0);n.current=r,r.stateNode=n,yc(r),t[xr]=n.current,i&&e!==0&&v0(t,t.nodeType===9?t:t.ownerDocument),this._internalRoot=n}Lc.prototype.render=function(t){Gs(t,this._internalRoot,null,null)};Lc.prototype.unmount=function(){var t=this._internalRoot,e=t.containerInfo;Gs(null,t,null,function(){e[xr]=null})};function Ar(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function $M(t,e){if(e||(e=t?t.nodeType===9?t.documentElement:t.firstChild:null,e=!(!e||e.nodeType!==1||!e.hasAttribute("data-reactroot"))),!e)for(var i;i=t.lastChild;)t.removeChild(i);return new Lc(t,0,e?{hydrate:!0}:void 0)}function xo(t,e,i,n,r){var s=i._reactRootContainer;if(s){var o=s._internalRoot;if(typeof r=="function"){var a=r;r=function(){var l=Jo(o);a.call(l)}}Gs(e,o,t,r)}else{if(s=i._reactRootContainer=$M(i,n),o=s._internalRoot,typeof r=="function"){var c=r;r=function(){var l=Jo(o);c.call(l)}}pg(function(){Gs(e,o,t,r)})}return Jo(o)}function WM(t,e,i){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$i,key:n==null?null:""+n,children:t,containerInfo:e,implementation:i}}af=function(t){if(t.tag===13){var e=us(vt(),150,100);Xt(t,e),Dc(t,e)}};sc=function(t){t.tag===13&&(Xt(t,3),Dc(t,3))};lf=function(t){if(t.tag===13){var e=vt();e=vi(e,t,null),Xt(t,e),Dc(t,e)}};Ma=function(t,e,i){switch(e){case"input":if(Ca(t,i),e=i.name,i.type==="radio"&&e!=null){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var n=i[e];if(n!==t&&n.form===t.form){var r=hc(n);if(!r)throw Error(C(90));Up(n),Ca(n,r)}}}break;case"textarea":Fp(t,i);break;case"select":e=i.value,e!=null&&Ki(t,!!i.multiple,e,!1)}};Ql=hg;Dp=function(t,e,i,n,r){var s=$;$|=4;try{return qt(98,t.bind(null,e,i,n,r))}finally{$=s,$===ve&&yt()}};Gl=function(){($&(1|rt|wt))===ve&&(NM(),mn())};Lp=function(t,e){var i=$;$|=2;try{return t(e)}finally{$=i,$===ve&&yt()}};function Sg(t,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ar(e))throw Error(C(200));return WM(t,e,null,i)}var UM={Events:[Sr,Mi,hc,Pp,xa,ln,function(t){nc(t,k0)},Bp,zp,uo,co,mn,{current:!1}]};(function(t){var e=t.findFiberByHostInstance;return RM(ke({},t,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:nt.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=tf(i),i===null?null:i.stateNode},findFiberByHostInstance:function(i){return e?e(i):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:Mr,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"});Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UM;Ke.createPortal=Sg;Ke.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternalFiber;if(e===void 0)throw typeof t.render=="function"?Error(C(188)):Error(C(268,Object.keys(t)));return t=tf(e),t=t===null?null:t.stateNode,t};Ke.flushSync=function(t,e){if(($&(rt|wt))!==ve)throw Error(C(187));var i=$;$|=1;try{return qt(99,t.bind(null,e))}finally{$=i,yt()}};Ke.hydrate=function(t,e,i){if(!Ar(e))throw Error(C(200));return xo(null,t,e,!0,i)};Ke.render=function(t,e,i){if(!Ar(e))throw Error(C(200));return xo(null,t,e,!1,i)};Ke.unmountComponentAtNode=function(t){if(!Ar(t))throw Error(C(40));return t._reactRootContainer?(pg(function(){xo(null,null,t,!1,function(){t._reactRootContainer=null,t[xr]=null})}),!0):!1};Ke.unstable_batchedUpdates=hg;Ke.unstable_createPortal=function(t,e){return Sg(t,e,2<arguments.length&&arguments[2]!==void 0?arguments[2]:null)};Ke.unstable_renderSubtreeIntoContainer=function(t,e,i,n){if(!Ar(i))throw Error(C(200));if(t==null||t._reactInternalFiber===void 0)throw Error(C(38));return xo(t,e,i,!1,n)};Ke.version="16.14.0";function Ig(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ig)}catch(t){console.error(t)}}Ig(),bp.exports=Ke;var Gr=bp.exports,HM=Object.defineProperty,FM=Object.defineProperties,ZM=Object.getOwnPropertyDescriptors,Ld=Object.getOwnPropertySymbols,QM=Object.prototype.hasOwnProperty,GM=Object.prototype.propertyIsEnumerable,jd=(t,e,i)=>e in t?HM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,He=(t,e)=>{for(var i in e||(e={}))QM.call(e,i)&&jd(t,i,e[i]);if(Ld)for(var i of Ld(e))GM.call(e,i)&&jd(t,i,e[i]);return t};const Cg={src:"",currentTime:0,hostTime:0,muted:!1,paused:!0,volume:1},bg={currentTimeMaxError:1,syncInterval:1e3,retryInterval:15e3,verbose:!1,log:console.log.bind(console)};let At=bg;function Ag(t){At=He(He({},bg),t)}function Yr(t,e){if(t.paused)return t.currentTime;const i=function(n){if(n.player)return n.player.beginTimestamp+n.player.progressTime;if(n.room)return n.room.calibrationTimestamp}(e);return i?t.currentTime+(i-t.hostTime)/1e3:t.currentTime}const YM=navigator.userAgent.includes("Safari"),XM=navigator.userAgent.includes("iPhone")||navigator.userAgent.includes("iPad"),Tg=[".aac",".mid",".midi",".mp3",".ogg",".oga",".wav",".weba"];var JM=typeof global=="object"&&global&&global.Object===Object&&global,KM=typeof self=="object"&&self&&self.Object===Object&&self,Eg=JM||KM||Function("return this")(),Ys=Eg.Symbol,Ng=Object.prototype,qM=Ng.hasOwnProperty,eS=Ng.toString,Nn=Ys?Ys.toStringTag:void 0,tS=Object.prototype.toString,Rd=Ys?Ys.toStringTag:void 0;function iS(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Rd&&Rd in Object(t)?function(e){var i=qM.call(e,Nn),n=e[Nn];try{e[Nn]=void 0;var r=!0}catch{}var s=eS.call(e);return r&&(i?e[Nn]=n:delete e[Nn]),s}(t):function(e){return tS.call(e)}(t)}var nS=/\s/,rS=/^\s+/;function sS(t){return t&&t.slice(0,function(e){for(var i=e.length;i--&&nS.test(e.charAt(i)););return i}(t)+1).replace(rS,"")}function ll(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var oS=/^[-+]0x[0-9a-f]+$/i,aS=/^0b[01]+$/i,lS=/^0o[0-7]+$/i,cS=parseInt;function _d(t){if(typeof t=="number")return t;if(function(n){return typeof n=="symbol"||function(r){return r!=null&&typeof r=="object"}(n)&&iS(n)=="[object Symbol]"}(t))return NaN;if(ll(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ll(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=sS(t);var i=aS.test(t);return i||lS.test(t)?cS(t.slice(2),i?2:8):oS.test(t)?NaN:+t}var Ko=function(){return Eg.Date.now()},uS=Math.max,dS=Math.min;function Xr(t,e,i){var n,r,s,o,a,c,l=0,u=!1,d=!1,f=!0;if(typeof t!="function")throw new TypeError("Expected a function");function v(m){var y=n,M=r;return n=r=void 0,l=m,o=t.apply(M,y)}function w(m){return l=m,a=setTimeout(h,e),u?v(m):o}function x(m){var y=m-c;return c===void 0||y>=e||y<0||d&&m-l>=s}function h(){var m=Ko();if(x(m))return p(m);a=setTimeout(h,function(y){var M=e-(y-c);return d?dS(M,s-(y-l)):M}(m))}function p(m){return a=void 0,f&&n?v(m):(n=r=void 0,o)}function g(){var m=Ko(),y=x(m);if(n=arguments,r=this,c=m,y){if(a===void 0)return w(c);if(d)return clearTimeout(a),a=setTimeout(h,e),v(c)}return a===void 0&&(a=setTimeout(h,e)),o}return e=_d(e)||0,ll(i)&&(u=!!i.leading,s=(d="maxWait"in i)?uS(_d(i.maxWait)||0,e):s,f="trailing"in i?!!i.trailing:f),g.cancel=function(){a!==void 0&&clearTimeout(a),l=0,n=c=r=a=void 0},g.flush=function(){return a===void 0?o:p(Ko())},g}class Vd extends Ti.exports.Component{constructor(e){super(e),this.seeking=!1,this.mobileSeeking=!1,this.track=null,this.hoverTime=null,this.offset=0,this.secondsPrefix="00:00:",this.minutesPrefix="00:",this.seekPause=!1,this.handleTouchSeeking=i=>{let n=0;for(let r=0;r<i.changedTouches.length;r++)n=i.changedTouches[r].pageX;n=n<0?0:n,this.mobileSeeking&&this.changeCurrentTimePosition(n)},this.handleSeeking=i=>{this.seeking&&this.changeCurrentTimePosition(i.pageX)},this.setTrackWidthState=()=>{this.track&&this.setState({trackWidth:this.track.offsetWidth})},this.handleTrackHover=(i,n)=>{if(this.track){const r=this.props.scale||1;let s;s=i?0:(n.pageX-this.track.getBoundingClientRect().left)/r,this.setState({seekHoverPosition:s,trackWidth:this.track.offsetWidth})}},this.mouseSeekingHandler=i=>{this.setSeeking(!1,i),this.onMouseUp()},this.setSeeking=(i,n)=>{n.preventDefault(),this.handleSeeking(n),this.seeking=i,this.setState({seekHoverPosition:i?this.state.seekHoverPosition:0})},this.mobileTouchSeekingHandler=()=>{this.setMobileSeeking(!1)},this.setMobileSeeking=i=>{this.mobileSeeking=i,this.setState({seekHoverPosition:i?this.state.seekHoverPosition:0})},this.renderBufferProgress=()=>{if(this.props.buffered){const i=He(He({},this.getPositionStyle(this.props.buffered)),this.props.bufferColor&&{backgroundColor:this.props.bufferColor});return G.createElement("div",{className:"buffered",style:i})}return null},this.renderProgress=()=>{const i=He(He({},this.getPositionStyle(this.props.current)),this.props.sliderColor&&{backgroundColor:this.props.sliderColor});return G.createElement("div",{className:"connect",style:i})},this.renderHoverProgress=()=>{const i=He(He({},this.getSeekHoverPosition()),this.props.sliderHoverColor&&{backgroundColor:this.props.sliderHoverColor});return G.createElement("div",{className:"seek-hover",style:i})},this.renderThumb=()=>G.createElement("div",{className:this.isThumbActive()?"thumb active":"thumb",style:this.getThumbHandlerPosition()},G.createElement("div",{style:{backgroundColor:this.props.thumbColor},className:"handler"})),this.onMouseDown=i=>{var n,r;this.props.pause&&!this.props.paused&&(this.props.pause(),this.seekPause=!0),this.setSeeking(!0,i),(r=(n=this.props).onSeekStart)==null||r.call(n)},this.onMouseUp=()=>{var i,n;this.props.play&&this.seekPause&&(this.props.play(),this.seekPause=!1),(n=(i=this.props).onSeekEnd)==null||n.call(i)},this.props.secondsPrefix&&(this.secondsPrefix=this.props.secondsPrefix),this.props.minutesPrefix&&(this.minutesPrefix=this.props.minutesPrefix),this.state={ready:!1,trackWidth:0,seekHoverPosition:0}}componentDidMount(){this.setTrackWidthState(),window.addEventListener("resize",this.setTrackWidthState),window.addEventListener("mousemove",this.handleSeeking),window.addEventListener("mouseup",this.mouseSeekingHandler),window.addEventListener("touchmove",this.handleTouchSeeking),window.addEventListener("touchend",this.mobileTouchSeekingHandler)}componentWillUnmount(){window.removeEventListener("resize",this.setTrackWidthState),window.removeEventListener("mousemove",this.handleSeeking),window.removeEventListener("mouseup",this.mouseSeekingHandler),window.removeEventListener("touchmove",this.handleTouchSeeking),window.removeEventListener("touchend",this.mobileTouchSeekingHandler)}changeCurrentTimePosition(e){if(this.track){const i=this.props.scale||1;let n=(e-this.track.getBoundingClientRect().left)/i;n=Math.min(this.state.trackWidth,Math.max(0,n)),this.setState({seekHoverPosition:n});const r=+(n/this.state.trackWidth*this.props.total).toFixed(0);this.props.onChange(r)}}getPositionStyle(e){return{transform:`scaleX(${100*e/this.props.total/100})`}}getThumbHandlerPosition(){return{transform:`translateX(${this.state.trackWidth/(this.props.total/this.props.current)}px)`}}getSeekHoverPosition(){return{transform:`scaleX(${100*this.state.seekHoverPosition/this.state.trackWidth/100})`}}getHoverTimePosition(){let e=0;return this.hoverTime&&(e=this.state.seekHoverPosition-this.hoverTime.offsetWidth/2,this.props.limitTimeTooltipBySides&&(e<0?e=0:e+this.hoverTime.offsetWidth>this.state.trackWidth&&(e=this.state.trackWidth-this.hoverTime.offsetWidth))),{transform:`translateX(${e}px)`}}secondsToTime(e){e=Math.round(e+this.offset);const i=Math.floor(e/3600),n=e%3600,r=Math.floor(n/60),s=Math.ceil(n%60);return{hh:i.toString(),mm:r<10?"0"+r:r.toString(),ss:s<10?"0"+s:s.toString()}}getHoverTime(){const e=100*this.state.seekHoverPosition/this.state.trackWidth,i=Math.floor(+e*(this.props.total/100)),n=this.secondsToTime(i);return this.props.total+this.offset<60?this.secondsPrefix+n.ss:this.props.total+this.offset<3600?this.minutesPrefix+n.mm+":"+n.ss:n.hh+":"+n.mm+":"+n.ss}isThumbActive(){return this.state.seekHoverPosition>0||this.seeking}drawHoverTime(){return this.props.hideHoverTime?null:G.createElement("div",{className:this.isThumbActive()?"hover-time active":"hover-time",style:this.getHoverTimePosition(),ref:e=>this.hoverTime=e},this.getHoverTime())}render(){return G.createElement("div",{className:"seek-slider"},G.createElement("div",{className:"track",ref:e=>this.track=e,onMouseMove:e=>this.handleTrackHover(!1,e),onMouseLeave:e=>this.handleTrackHover(!0,e),onMouseDown:this.onMouseDown,onTouchStart:e=>{this.setMobileSeeking(!0),this.onMouseDown(e)},onMouseUp:this.onMouseUp,onTouchEnd:this.onMouseUp},G.createElement("div",{className:"main"},this.renderBufferProgress(),this.renderHoverProgress(),this.renderProgress())),this.drawHoverTime(),this.renderThumb())}}class hS extends Ti.exports.Component{constructor(e){super(e),this.stageVolume=0,this.updateVolumeTimer=0,this.onVolumeSeeking=!1,this.onClickOperationButton=()=>{const{paused:i}=this.props;i?this.props.play():this.props.pause()},this.operationButton=()=>{const{paused:i}=this.props;return i?G.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiBjbGFzcz0iaWNvbmlmeSBpY29uaWZ5LS1tZGkiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNOCA1LjE0djE0bDExLTdsLTExLTd6IiBmaWxsPSIjZmZmIj48L3BhdGg+PC9zdmc+Cg=="}):G.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiBjbGFzcz0iaWNvbmlmeSBpY29uaWZ5LS1tZGkiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTQgMTloNFY1aC00TTYgMTloNFY1SDZ2MTR6IiBmaWxsPSIjZmZmIj48L3BhdGg+PC9zdmc+Cg=="})},this.operationVolumeButton=()=>this.props.volume>.9?G.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiBjbGFzcz0iaWNvbmlmeSBpY29uaWZ5LS1tZGkiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTQgMy4yM3YyLjA2YzIuODkuODYgNSAzLjU0IDUgNi43MXMtMi4xMSA1Ljg0LTUgNi43djIuMDdjNC0uOTEgNy00LjQ5IDctOC43N2MwLTQuMjgtMy03Ljg2LTctOC43N00xNi41IDEyYzAtMS43Ny0xLTMuMjktMi41LTQuMDNWMTZjMS41LS43MSAyLjUtMi4yNCAyLjUtNE0zIDl2Nmg0bDUgNVY0TDcgOUgzeiIgZmlsbD0iI2ZmZiI+PC9wYXRoPjwvc3ZnPgo="}):this.props.volume===0?G.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiBjbGFzcz0iaWNvbmlmeSBpY29uaWZ5LS1tZGkiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNNyA5djZoNGw1IDVWNGwtNSA1SDd6IiBmaWxsPSIjZmZmIj48L3BhdGg+PC9zdmc+Cg=="}):G.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiBjbGFzcz0iaWNvbmlmeSBpY29uaWZ5LS1tZGkiIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNNSA5djZoNGw1IDVWNEw5IDltOS41IDNjMC0xLjc3LTEtMy4yOS0yLjUtNC4wM1YxNmMxLjUtLjcxIDIuNS0yLjI0IDIuNS00eiIgZmlsbD0iI2ZmZiI+PC9wYXRoPjwvc3ZnPgo="}),this.handleClickVolume=()=>{this.props.volume===0?this.stageVolume!==0?this.props.setVolume(this.stageVolume):this.props.setVolume(1):(this.stageVolume=this.props.volume,this.props.setVolume(0))},this.onChange=i=>{this.setState({currentTime:i}),i&&this.changeTime(i)},this.changeTime=Xr(i=>{this.props.setCurrentTime(i)},50),this.onVolumeChange=i=>{this.changeVolume(i),this.setState({seekVolume:i/100})},this.changeVolume=Xr(i=>{this.props.setVolume(i/100)},50),this.onVolumeSeekStart=()=>{this.onVolumeSeeking=!0},this.onVolumeSeekEnd=Xr(()=>{this.onVolumeSeeking=!1},500),this.onProgressSeekStart=()=>this.setState({isPlayerSeeking:!0}),this.onProgressSeekEnd=Xr(()=>{this.setState({isPlayerSeeking:!1})},500),this.state={isPlayerSeeking:!1,isVolumeHover:!1,seekVolume:1,visible:!0,currentTime:0},this.stageVolume=e.volume}componentDidMount(){this.updateVolumeTimer=setInterval(()=>{this.onVolumeSeeking||this.setState({seekVolume:this.props.volume}),this.state.isPlayerSeeking||this.setState({currentTime:this.props.currentTime})},100)}componentWillUnmount(){this.updateVolumeTimer&&clearInterval(this.updateVolumeTimer)}render(){const{duration:e,currentTime:i}=this.props;return G.createElement("div",{className:"player-controller",style:{opacity:this.props.visible?"1":"0"}},G.createElement("div",{className:"player-controller-progress"},G.createElement(Vd,{total:e,current:this.state.currentTime,onChange:this.onChange,buffered:this.props.buffered,bufferColor:"rgba(255,255,255,0.3)",hideHoverTime:!0,limitTimeTooltipBySides:!0,onSeekStart:this.onProgressSeekStart,onSeekEnd:this.onProgressSeekEnd,play:this.props.play,pause:this.props.pause,paused:this.props.paused,scale:this.props.scale})),G.createElement("div",{className:"player-controller-actions"},G.createElement("div",{className:"player-controller-actions-left"},G.createElement("div",{onClick:this.onClickOperationButton,className:"player-controller-play"},this.operationButton()),G.createElement("div",{className:"player-volume-box",onMouseEnter:()=>this.setState({isVolumeHover:!0}),onMouseLeave:()=>this.setState({isVolumeHover:!1})},G.createElement("div",{onClick:this.handleClickVolume,className:"player-volume"},this.operationVolumeButton()),G.createElement("div",{className:"player-volume-slider"},G.createElement(Vd,{total:100,current:100*this.state.seekVolume,onChange:this.onVolumeChange,onSeekStart:this.onVolumeSeekStart,onSeekEnd:this.onVolumeSeekEnd,scale:this.props.scale,limitTimeTooltipBySides:!0,hideHoverTime:!0})))),G.createElement("div",{className:"player-mid-box-time"},Od(Math.floor(i/1e3))," /"," ",Od(Math.floor(e/1e3)))))}}function Od(t){const e=t%60,i=(t-e)/60;if(i>=60){const n=i%60;return`${kn((i-n)/60)}:${kn(n)}:${kn(e)}`}return`${kn(i)}:${kn(e)}`}function kn(t){return t<=9?`0${t}`:`${t}`}let pS=99999;var cl,Bi;(Bi=cl||(cl={}))[Bi.Idle=0]="Idle",Bi[Bi.Playing=1]="Playing",Bi[Bi.Paused=2]="Paused";let Te={};function fe(t,...e){At.verbose&&console.log(`[RTCEffect] ${t}`,...e)}function fS(t,e,i){function n(s){Te[s].playState===0?(t.playEffect(s,i,0,1,0,100,!1,0).then(()=>{fe(">>> Play Success",{playingId:s})}),Te[s].playState=1):fe(">>> Skip Play",{playingId:s,state:Te[s].playState})}function r(s){Te[s].playState=0,Te[s].previousVideoJSAdvance=0,Te[s].previousSeekTargetTime=0,Te[s].previousBeginSeekTime=0}e.one("ready",()=>{var s;const o=((s=e==null?void 0:e.tagAttributes)==null?void 0:s.src)||"";Tg.includes("."+o.split(".").pop()||"")||(fe(">>> Mute js player",{src:o}),e.muted(!0),e.muted=c=>!1);const a=function(){const c=pS--,l={playState:cl.Idle,previousVideoJSAdvance:0,previousSeekTargetTime:0,previousBeginSeekTime:0};return Te[c]=l,c}();fe(">>> Setup",{playingId:a,src:o}),t.addListener("error",c=>{fe(">>> Error",{soundId:c}),r(c)}),t.addListener("effectFinished",c=>{fe(">>> Finished",{soundId:c}),r(c)}),e.on("play",()=>{switch(Te[a].playState){case 0:fe(">>> Start play",{playingId:a}),n(a);break;case 2:fe(">>> Resume play",{playingId:a}),t.resumeEffect(a),Te[a].playState=1}}),e.on("pause",()=>{const c=Te[a].playState;switch(c){case 1:fe(">>> Pause play",{playingId:a}),t.pauseEffect(a),Te[a].playState=2;break;default:fe(">>> Skip Pause",{playingId:a,currenState:c})}}),e.on("timeupdate",()=>{t.getEffectCurrentPosition(a).then(c=>{const l=Te[a],u=c/1e3,d=e.currentTime(),f=l.previousSeekTargetTime!==0&&l.previousBeginSeekTime!==0;if(fe(`>>> EffectSecond rtc: ${u} js: ${d} seeking: ${f}`,{playingId:a}),l.playState==0)return void(e.paused()||(fe(">>> Play effect due to time update.",{playingId:a}),n(a)));if(f&&u<l.previousSeekTargetTime)return;if(l.playState!==1)return void fe(">>> Skip timupdate",{playingId:a,state:l.playState,jsTime:e.currentTime(),rtcEffectTime:u});function v(x,h){t.setEffectPosition(h,1e3*x),l.previousBeginSeekTime=Date.now()/1e3,l.previousSeekTargetTime=x}const w=l.previousBeginSeekTime;if(c>0){const x=d-u,h=Math.abs(x),p=.5;if(h>p)if(f){const g=l.previousSeekTargetTime-u,m=Date.now()/1e3-w,y=m+(x>0?x:0),M=d+y;v(M,a),fe(">>> Start seeking after seeking lag",{jsPlayerTime:d,rtcEffectTime:u,jsPlayerTimerAdvance:x,lastSeekingCost:m,estimatedRTCLag:y,targetRTCSeekTime:M,previousBeginSeekTime:w,timeElapse:g})}else if(h>10)v(d,a),fe(">>> DirectSeek",{time:d,rtcEffectTime:u,jsPlayerTimerAdvance:x});else{const g=l.previousVideoJSAdvance,m=0,y=d+m;l.previousVideoJSAdvance=m,v(y,a),fe(">>> Start seeking with lag",{jsPlayerTime:d,rtcEffectTime:u,jsPlayerTimerAdvance:x,previousAdvance:g,estimatedRTCLag:m,targetRTCSeekTime:y})}else f&&(fe(">>> SeekingFinish no lag",{jsPlayerTime:d,rtcEffectTime:u,jsPlayerTimerAdvance:x,previousBeginSeekTime:w,rtcLagTolerance:p}),l.previousBeginSeekTime=0,l.previousSeekTargetTime=0)}})}),e.on("dispose",()=>{Te[a].playState&&(t.stopEffect(a),delete Te[a],fe(">>> Dispose",{playingId:a}))})})}class $d extends Ti.exports.Component{constructor(){super(...arguments),this.putAttributes=e=>{const{context:i}=this.props,n=i.getAttributes()||{};for(const r in e)n[r]!==e[r]&&i.updateAttributes([r],e[r])}}render(){const{context:e}=this.props,i=e.getRoom(),n=i?void 0:e.getDisplayer(),r=this.putAttributes;return G.createElement(gS,{room:i,player:n,context:e,plugin:{putAttributes:r}})}}class gS extends Ti.exports.Component{constructor(e){super(e),this.alertMask=null,this.container=G.createRef(),this.controllerHiddenTimer=0,this.syncPlayerTimer=0,this.retryCount=0,this.decreaseRetryTimer=0,this.noSoundSyncCount=0,this.everPlayed=!1,this.showController=()=>{this.setState({controllerVisible:!0}),this.debounceHidingController()},this.play=()=>{var i;const n=(i=this.props.room)==null?void 0:i.calibrationTimestamp;this.debug(">>> play",{paused:!1,hostTime:n}),this.isEnabled()&&this.props.plugin.putAttributes({paused:!1,hostTime:n})},this.pause=()=>{const i=Yr(this.getAttributes(),this.props);this.debug(">>> pause",{paused:!0,currentTime:i}),this.isEnabled()&&this.props.plugin.putAttributes({paused:!0,currentTime:i})},this.setVolume=i=>{this.debug(">>> volume",{volume:i}),this.isEnabled()&&this.props.plugin.putAttributes({volume:i}),this.isEnabled()&&this.props.plugin.putAttributes({volume:i,muted:i===0})},this.setCurrentTime=i=>{var n;const r=(n=this.props.room)==null?void 0:n.calibrationTimestamp;this.debug(">>> seek",{currentTime:i/1e3,hostTime:r}),this.isEnabled()&&this.props.plugin.putAttributes({currentTime:i/1e3,hostTime:r})},this.resetPlayer=()=>{var i;(i=this.player)==null||i.autoplay(!1),this.state.NoSound||(this.debug(">>> ended",{paused:!0,currentTime:0}),this.isEnabled()&&this.props.plugin.putAttributes({paused:!0,currentTime:0}))},this.syncPlayerWithAttributes=()=>{var i;const n=this.getAttributes();if(!n)return;const r=this.player;if(!r||this.state.NoSound&&(this.noSoundSyncCount+=1)%8!=0)return;r.paused()!==n.paused&&(this.debug("<<< paused -> %o",n.paused),n.paused?r.pause():((i=r.play())==null||i.catch(this.catchPlayFail),this.everPlayed=!0)),r.muted()!==n.muted&&(this.debug("<<< muted -> %o",n.muted),r.muted(n.muted)),r.volume()!==n.volume&&(this.debug("<<< volume -> %o",n.volume),r.volume(n.volume));const s=Yr(n,this.props);let o=At.currentTimeMaxError;if(this.state.NoSound&&(o*=3),s>r.duration())this.resetPlayer();else if(Math.abs(r.currentTime()-s)>o){if(this.debug("<<< currentTime -> %o",s),XM)return void(this.everPlayed?r.currentTime(s):this.debug("<<< ignore iOS idle time update. -> %o (ignored)",s));r.currentTime(s)}},this.debounceHidingController=()=>{this.controllerHiddenTimer&&(clearTimeout(this.controllerHiddenTimer),this.controllerHiddenTimer=0),this.controllerHiddenTimer=setTimeout(()=>{this.setState({controllerVisible:!1}),this.controllerHiddenTimer=0},3e3)},this.decreaseRetryCount=()=>{this.player&&this.retryCount>0&&(this.retryCount=this.retryCount-1)},this.catchPlayFail=i=>{var n,r;const s=String(i);if(YM&&s.includes("NotAllowedError")||s.includes("interact"))(n=this.player)==null||n.autoplay("any"),this.setState({NoSound:!0});else{const o=(r=this.player)==null?void 0:r.error();o&&(this.retryCount<=3?(this.initPlayer(),this.retryCount=this.retryCount+1):(this.debug("catch videojs media error",o),this.setState({MediaError:!0}))),this.debug("catch error",i)}},this.fixPlayFail=()=>{this.debug("try to fix play state"),this.setState({NoSound:!1});const{muted:i,volume:n}=this.getAttributes();this.player&&(this.player.muted(i),this.player.volume(n))},this.initPlayer=async()=>{var i;(i=this.player)==null||i.dispose(),this.player=void 0,this.debug("creating elements ...");const{type:n,src:r,poster:s}=this.getAttributes(),o=document.createElement("div");o.setAttribute("data-vjs-player","");const a=document.createElement("video");a.className="video-js",a.crossOrigin="anonymous",s&&(a.poster=s),a.setAttribute("playsInline",""),a.setAttribute("webkit-playsinline","");const c=document.createElement("source");new URL(r).pathname.endsWith(".m3u8")?c.type="application/x-mpegURL":a.src=r,c.src=r,n&&(c.type=n),a.appendChild(c),o.appendChild(a),this.container.current.appendChild(o),await new Promise(f=>(window.requestAnimationFrame||window.setTimeout)(f)),this.debug("initializing videojs() ...");const l=Vc.default(a);this.player=l,window.player=l,l.one("loadedmetadata",this.gracefullyUpdate);const u=window.__mediaPlayerAudioEffectClient;u!==void 0&&fS(u,l,r);const d=window.__pcmProxy;d!==void 0&&(l.one("play",()=>{const f=d.connect(a);this.audioSource=f,this.debug("Connect to PCMProxy ",r)}),l.one("dispose",()=>{this.audioSource&&(this.audioSource.disconnect(),this.audioSource=void 0,this.debug("Disconnect from PCMProxy",r))})),l.on("ready",()=>{var f;(f=At.onPlayer)==null||f.call(At,l),l.on("timeupdate",this.gracefullyUpdate),l.on("volumechange",this.gracefullyUpdate),l.on("seeked",this.gracefullyUpdate),l.on("play",this.gracefullyUpdate),l.on("pause",this.gracefullyUpdate),l.on("ended",this.resetPlayer)}),l.on("error",this.catchPlayFail),this.setState({MediaError:!1})},this.gracefullyUpdate=()=>this.setState({updater:!this.state.updater}),this.setupAlert=i=>{i&&(i.addEventListener("touchstart",this.fixPlayFail),i.addEventListener("click",this.fixPlayFail)),this.alertMask=i},this.setupReload=i=>{i&&(i.addEventListener("touchstart",this.initPlayer),i.addEventListener("click",this.initPlayer))},this.state={NoSound:!1,MediaError:!1,updater:!1,controllerVisible:!1},e.room&&function(i){if(!i.calibrationTimestamp)throw new Error("@netless/app-media-player@0.1.0-alpha.5 requires white-web-sdk@^2.13.8 to work properly.")}(e.room)}getAttributes(){const{context:e}=this.props;let i=e.getAttributes();if(i){if(i=He(He({},Cg),i),this.player){let r=Yr(i,this.props),s=this.player.duration();!i.paused&&r>s&&(n=He({},i),i=FM(n,ZM({currentTime:0,paused:!0})),this.resetPlayer())}var n;return i}}isShowingPoster(){const e=this.getAttributes();return!(e!=null&&e.src)||Tg.some(i=>e.src.endsWith(i))}render(){var e,i;if(!this.props.room&&!this.props.player)return null;const n=this.getAttributes();if(!n)return null;const r=1e3*(((e=this.player)==null?void 0:e.duration())||1e3),s=((i=this.player)==null?void 0:i.bufferedPercent())||0;return G.createElement("div",{className:this.isEnabled()?"vjs-p":"vjs-p disabled",onMouseEnter:this.showController,onMouseMove:this.showController},G.createElement("div",{className:"video-js-plugin-player",ref:this.container}),this.isShowingPoster()&&G.createElement("div",{className:"video-js-plugin-poster"},n.poster&&G.createElement("img",{src:n.poster,alt:"",draggable:!1})),G.createElement(hS,{duration:r,volume:n.volume,setVolume:this.setVolume,paused:n.paused,play:this.play,pause:this.pause,currentTime:1e3*Yr(n,this.props),setCurrentTime:this.setCurrentTime,buffered:r*s,visible:!0}),this.state.NoSound&&G.createElement("div",{ref:this.setupAlert,className:"videojs-plugin-muted-alert"}),this.state.MediaError&&G.createElement("div",{className:"videojs-plugin-recovery-mode"},G.createElement("button",{ref:this.setupReload},"Reload Player")))}debug(e,...i){At.verbose&&At.log(`[MediaPlayer] ${e}`,...i)}componentDidMount(){this.debug("app version =","0.1.0-alpha.5"),this.debug("video.js version =",Vc.default.VERSION),this.initPlayer(),this.props.context.emitter.on("attributesUpdate",this.syncPlayerWithAttributes),this.syncPlayerTimer=setInterval(this.syncPlayerWithAttributes,At.syncInterval),this.decreaseRetryTimer=setInterval(this.decreaseRetryCount,At.retryInterval)}componentWillUnmount(){var e;this.debug("unmount"),this.props.context.emitter.off("attributesUpdate",this.syncPlayerWithAttributes),(e=this.player)==null||e.dispose(),clearInterval(this.syncPlayerTimer),clearInterval(this.decreaseRetryTimer)}isEnabled(){return this.props.context.getIsWritable()}}const ul={kind:"MediaPlayer",setup(t){let e=t.getAttributes();if(!e||!e.src)return t.emitter.emit("destroy",{error:new Error("[MediaPlayer]: Missing 'attributes'.'src'.")});e=He(He({},Cg),e);const i=t.getBox();i.mountStyles(`.vjs-p{display:flex;flex-grow:1}.vjs-p *{pointer-events:auto}.vjs-p.disabled *{pointer-events:none}.vjs-p .video-js-plugin-poster{position:absolute;top:0;left:0;right:0;bottom:0;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgQAAACACAYAAAB0vHFxAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAACBKADAAQAAAABAAAAgAAAAACE3oPTAAAKXUlEQVR4Ae3dYW4ktxEG0LW9FwkC2McycokAOUGAXMLwtQwYvomdP4akHUnNnm6SVUU+/xqpe8ji+yiDWz3a/e7L5v/98se//3pL8K9//O+7t19Hv85eX7RP9vnllz2h4/rkd+wz+ir/0cLfjv/9t1/6igABAgQIENhRwIFgx9StmQABAgQIPAg4EDyA+JIAAQIECOwo8HXHRVvzPIHRzwBHjz9PKudMo31Hj59TdZ2qsueXvb5sO0GHIFsi6iFAgAABAgECOgQB6KbsJ5Dtt0L6rWyPkeRXO+fs+WWvL1v6OgTZElEPAQIECBAIENAhCEA3ZT8Bzwj7WUaMJL8I9X5zZs8ve339kugzkg5BH0ejECBAgACB0gIOBKXjUzwBAgQIEOgj4EDQx9EoBAgQIECgtIADQen4FE+AAAECBPoIOBD0cTQKAQIECBAoLeC3DErHp/iWgE8Zt4RyX5df7nxa1Y3Ob/T4rfWtdl2HYLVErYcAAQIECFwQWL5DsPoJcvX1XdjTpd4iv1JxvStWfu9IfCORwLP7U4cgUXhKIUCAAAECUQIOBFHy5iVAgAABAokEHAgShaEUAgQIECAQJXD7MwTPPqOIWujVeUevb/T4V9ftfecE5HfOKetd8suajLoiBHQIItTNSYAAAQIEkgnc7hAkW0/3ckb/e9qjx+8OYsBvBOT3DUe5L+RXLjIFDxTQIRiIa2gCBAgQIFBFoNkh2P0Z2+j1jx4/+0asvv7q9d/dH9XXX73+3fO7u/7W+3fbHzoErR3hOgECBAgQ2ECg2SHwjG2DXRC4xOj9tdufAHpHLb/eonPHk9+xd7TPcXX9r+oQ9Dc1IgECBAgQKCfgQFAuMgUTIECAAIH+Ag4E/U2NSIAAAQIEygk0P0MQvaLsz3hb9bWu840WOJ5ffsc+2a/KL3tC6jsSmL1/dQiO0nCNAAECBAhsItDsEMw+oTzrHl1f61OorevPrvfZ+6N9WvVmr09+xwnKr7ZP9vyOdcdfze7Tuz4dgvF7ygwECBAgQCC9QLNDkH0F0X+C45NdoHZ99rf8aguofqRA7/8/6BCMTMvYBAgQIECgiED5DkHvZyhFcjtdJp/TVClvlF/KWE4XJb/TVG68INB7f+kQXAjBWwgQIECAwGoCDgSrJWo9BAgQIEDggoADwQU0byFAgAABAqsJfO39DGI1IOuJFbA/Y/3vzi6/u4Kx7189v7vru/v+2HTfz65D8N7EdwgQIECAwHYCw3/LYLUT1HY7pLFg+TaAkl+WX/KAGuXJrwEUfLlaPjoEwRvG9AQIECBAIIPA8A5B779JKQOaGl4F5PtqUfGV/Cqm9lqz/F4tMr6qlo8OQcZdpCYCBAgQIDBZYHiHoNozlMn+5aeTb+0I5Se/2gK5q6/286VDkHs/qY4AAQIECEwRcCCYwmwSAgQIECCQW8CBIHc+qiNAgAABAlMEhn+GYMoqTEKAAAEC7wSqPcN+twDfmCqgQzCV22QECBAgQCCnQHiHoPoJtlV/63rObfFaVfX6X1dy7VX19Vev/1pqr++qvv7q9b8m4dVHAtny1SH4KCXfI0CAAAECmwmEdwiq/U1Om+2PL/Kpnbj85FdbYO3qs/186hCsvd+sjgABAgQInBJwIDjF5CYCBAgQILC2gAPB2vlaHQECBAgQOCUQ/hmCbJ+yPKW20U3yqR22/ORXW2Dt6qN/Ph/n1yFYe79ZHQECBAgQOCXgQHCKyU0ECBAgQGBtAQeCtfO1OgIECBAgcErAgeAUk5sIECBAgMDaAg4Ea+drdQQIECBA4JTA1+///OGnoztd52N/fC7g58PPx+e748sX+8P+qLQ/dAiO0nKNAAECBAhsIuBAsEnQlkmAAAECBI4EHAiOdFwjQIAAAQKbCDgQbBK0ZRIgQIAAgSMBB4IjHdcIECBAgMAmAuH/lsHP//zvb5tYl1ymfErG9lK0/F4oSr6QX8nYThcdne/j/DoEp6NzIwECBAgQWFfAgWDdbK2MAAECBAicFnAgOE3lRgIECBAgsK5A+GcIfv39Pz++5X18pvH2mtfzBeQz37znjPLrqTl/LPnNN585Y7Z8dQhmpm8uAgQIECCQVCC8Q1C9I9Cqv3U96b54Kat6/S8Lufii+vqr138xtpe3VV9/9fpfgvDiQ4Fs+eoQfBiTbxIgQIAAgb0EwjsEe3FbLQECBOYJZPsT6LyVm+mKgA7BFTXvIUCAAAECiwk4ECwWqOUQIECAAIErAg4EV9S8hwABAgQILCYw/DMEnmEttmMeliPfB5BiX8qvWGAP5crvASTZl9Xy0SFItoGUQ4AAAQIEIgSGdwiy/U1MEcgrzynf2unKT361BXJXX+3nS4cg935SHQECBAgQmCIwvENQ7RnKFPWFJpFv7TDlJ7/aArmrr/bzpUOQez+pjgABAgQITBH4Wu0EM0XFJGkE7M80UVwqRH6X2NK8afX87q7v7vvTBP13IToE2RJRDwECBAgQCBBwIAhANyUBAgQIEMgm4ECQLRH1ECBAgACBAIHhv2Uwek2rPcPp7cWnt+jc8eQ317v3bPLrLWq8twK995cOwVtdrwkQIECAwKYC5TsE1f4mqNn7jM9s8b7zya+v5+zR5DdbfK/5eu8vHYK99o/VEiBAgACBDwWaHYLezyg+rOLGN6Pra53QWtdvLP3UW6N9WkVmr09+xwnKr7ZP9vyOdcdfze7Tuz4dgvF7ygwECBAgQCC9QLNDEL2C3ieg3utp1de63rueZ8fLXt+z6+l9f3af7PX1zuPZ8bL7ZK/vWW/39xWYvT90CPrmZzQCBAgQIFBSwIGgZGyKJkCAAAECfQUcCPp6Go0AAQIECJQUaH6GIPpT1iVVFX1aIHp/zX5GdxqmyI3yKxLUJ2XK7xOYv78d7XNcXf+rOgT9TY1IgAABAgTKCTQ7BLv/CWr0+kePn31HVl9/9frv7o/q669e/+753V1/6/277Q8dgtaOcJ0AAQIECGwg0OwQbGBwuMTRz5BGj3+4OBdvC8jvNmHoAPIL5Td5MgEdgmSBKIcAAQIECEQI3O4QrP6MZfT6Ro8fsal2mlN+tdOWX+38VN9XQIegr6fRCBAgQIBASQEHgpKxKZoAAQIECPQVcCDo62k0AgQIECBQUuD2Zwiyr3r1Z4Srry/7/rpbn/zuCsa+X36x/mY/Fnh2f+oQHHu6SoAAAQIEthBYvkOwRYoW+anAsyfkTwdyIURAfiHs3SYdnd/o8btBFBlIh6BIUMokQIAAAQIjBRwIRuoamwABAgQIFBFwICgSlDIJECBAgMBIAQeCkbrGJkCAAAECRQQcCIoEpUwCBAgQIDBSwG8ZjNQ19nABnzIeTjx0AvkN5R0+ePb8stc3PKAnJ9AheBLM7QQIECBAYEUBHYIVU91oTf49+9phy09+IwXsr+d0dQie83I3AQIECBBYUkCHYMlY8yxq9DO80ePnkYypZLTv6PFj1PaZNXt+2evLtlN0CLIloh4CBAgQIBAg4EAQgG5KAgQIECCQTcCBIFsi6iFAgAABAgEC/wdVfx9UuC8B6AAAAABJRU5ErkJggg==);background-repeat:repeat-x;background-position:0 50%;display:flex;align-items:center;justify-content:center}.vjs-p .video-js-plugin-poster img{box-shadow:0 0 5px 10px #0006}.vjs-p .player-controller,.vjs-p .videojs-plugin-muted-alert{pointer-events:auto}.vjs-p.disabled .videojs-plugin-close-icon,.vjs-p.disabled .player-controller{pointer-events:none}.vjs-p .video-js-plugin-player{position:absolute;top:0;left:0;right:0;bottom:0}.video-js,[data-vjs-player]{width:100%;height:100%}.vjs-p .videojs-plugin-muted-alert{pointer-events:auto;cursor:pointer;position:absolute;top:0;left:0;right:0;bottom:0;z-index:43}.vjs-p .videojs-plugin-muted-alert:before{pointer-events:auto;cursor:pointer;position:absolute;top:0;left:0;right:0;bottom:0;z-index:43;content:"\\f104";background:rgba(0,0,0,.3);font-family:VideoJS;font-size:2em;display:flex;align-items:center;justify-content:center;color:#fff}.vjs-p .videojs-plugin-recovery-mode{pointer-events:auto;cursor:pointer;position:absolute;top:0;left:0;right:0;bottom:0;z-index:44}.vjs-p .videojs-plugin-recovery-mode button{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.vjs-p .seek-slider{position:relative;width:100%}.vjs-p .seek-slider:focus{outline:none}.vjs-p .seek-slider .track{padding:10px 0;cursor:pointer;outline:none}.vjs-p .seek-slider .track:focus{border:0;outline:none}.vjs-p .seek-slider .track .main{width:100%;height:3px;background-color:#ffffff4d;border-radius:30px;position:absolute;left:0;top:8.5px;transition:transform .4s;outline:none}.vjs-p .seek-slider .track .main:focus{border:0;outline:none}.vjs-p .seek-slider .track .main .buffered{position:absolute;background-color:#ffffff4d;width:100%;height:100%;transform:scaleX(.8);z-index:2;transform-origin:0 0}.vjs-p .seek-slider .track .main .seek-hover{position:absolute;background-color:#ffffff80;width:100%;height:100%;z-index:1;transform:scaleX(.6);transform-origin:0 0;opacity:0;transition:opacity .4s}.vjs-p .seek-slider .track .main .connect{position:absolute;background-color:#fff;width:100%;height:100%;z-index:3;left:0;transform:scaleX(.13);transform-origin:0 0}.vjs-p .seek-slider .track.active .main{transform:scaleY(2)}.vjs-p .seek-slider .thumb{pointer-events:none;position:absolute;width:12px;height:12px;left:-6px;top:4px;z-index:4;transform:translate(100px)}.vjs-p .seek-slider .thumb .handler{border-radius:100%;width:100%;height:100%;background-color:#fff;opacity:0;transform:scale(.4);cursor:pointer;transition:transform .2s;pointer-events:none}.vjs-p .seek-slider .thumb.active .handler{opacity:1;transform:scale(1)}.vjs-p .seek-slider .hover-time{position:absolute;background-color:#0000004d;line-height:18px;font-size:16px;color:#ddd;top:-25px;left:0;padding:5px 10px;border-radius:5px;box-shadow:0 0 5px #0000004d;opacity:0;transform:translate(150px);pointer-events:none}.vjs-p .seek-slider .hover-time.active{opacity:1}.vjs-p .seek-slider:hover .track .main .seek-hover{opacity:1}.vjs-p .player-controller{position:absolute;z-index:100;bottom:0px;left:0;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:stretch;height:64px;background-image:linear-gradient(0deg,#000,transparent);transition:opacity .2s;color:#fff}.vjs-p .player-menu-box{display:flex;align-items:center;justify-content:center;flex-direction:column;margin-bottom:40px}.vjs-p .player-menu-cell{width:100%;text-align:center;font-size:12px;color:#7a7b7c}.vjs-p .player-multiple-play{width:64px;height:120px}.vjs-p .player-controller-actions-left{display:flex;justify-content:center;align-items:center;flex-shrink:0}.vjs-p .player-right-box{font-size:14px;color:#7a7b7c;cursor:pointer;margin-right:12px}.vjs-p .player-controller-actions{display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding-left:8px;padding-right:8px;margin-top:2px}.vjs-p .player-mid-box-time{font-size:9px;display:flex;justify-content:center;align-items:center;color:#fff;flex-shrink:0;margin-right:8px;font-family:monospace}.vjs-p .player-controller-play{display:flex;align-items:center;justify-content:center;cursor:pointer;padding-right:4px}.vjs-p .player-controller-progress{width:calc(100% - 28px);margin-left:14px;display:flex;align-items:center;justify-content:center;margin-top:8px}.vjs-p .player-volume{display:flex;align-items:center;justify-content:center;cursor:pointer;margin-right:16px;margin-left:8px}.vjs-p .player-volume-slider{width:60px;margin-right:12px;display:flex;align-items:center}.vjs-p .player-volume-box{display:flex;flex-direction:row}.netless-app-media-player-container{display:flex;position:relative;height:100%}
`);const n=document.createElement("div");if(n.classList.add("netless-app-media-player-container"),Gr.render(G.createElement($d,{context:t}),n),i.mountContent(n),t.emitter.on("destroy",()=>{console.log("[MediaPlayer]: destroy"),Gr.unmountComponentAtNode(n)}),window.__pcmProxy){const r=()=>{document.visibilityState==="hidden"?(console.log("[MediaPlayer]: visibilitychange -> hidden. unmount for pcmproxy"),Gr.unmountComponentAtNode(n)):(console.log("[MediaPlayer]: visibilitychange -> visible. mount for pcmproxy"),Gr.render(G.createElement($d,{context:t}),n))};document.addEventListener("visibilitychange",r),t.emitter.on("destroy",()=>{document.removeEventListener("visibilitychange",r)})}}},mS=()=>{X.debug&&Ag({verbose:!0}),X.register({kind:ga.kind,src:ga}),X.register({kind:ul.kind,src:ul})},vS={DocsViewer:ga.kind,MediaPlayer:ul.kind};var kg=(t=>(t.Init="Init",t.AttributesUpdate="AttributesUpdate",t.SetAttributes="SetAttributes",t.RegisterMagixEvent="RegisterMagixEvent",t.RemoveMagixEvent="RemoveMagixEvent",t.RemoveAllMagixEvent="RemoveAllMagixEvent",t.RoomStateChanged="RoomStateChanged",t.DispatchMagixEvent="DispatchMagixEvent",t.ReciveMagixEvent="ReciveMagixEvent",t.NextPage="NextPage",t.PrevPage="PrevPage",t.SDKCreate="SDKCreate",t.OnCreate="OnCreate",t.SetPage="SetPage",t.GetAttributes="GetAttributes",t.Ready="Ready",t.Destory="Destory",t.StartCreate="StartCreate",t.WrapperDidUpdate="WrapperDidUpdate",t.DispayIframe="DispayIframe",t.HideIframe="HideIframe",t.GetRootRect="GetRootRect",t.ReplayRootRect="ReplayRootRect",t.PageTo="PageTo",t))(kg||{}),Pg=(t=>(t.WrapperDidMount="WrapperDidMount",t.IframeLoad="IframeLoad",t))(Pg||{});const Lt={Ready:"Ready",RootRect:"ReplayRootRect",Message:"message",ComputeStyle:"computeStyle",Load:"load",DisplayerState:"displayerState",Show:"show",Hide:"hide"},wS=(t,e)=>new Array(t).fill(0).map((i,n)=>e(n)),re=class{constructor(t,e){this.manager=t,this.appManager=e,this.magixEventMap=new Map,this.cssList=[],this.allowAppliances=["clicker"],this.bridgeDisposer=b.noop,this.rootRect=null,this.sideEffectManager=new hn,this.execListenIframe=b.debounce(i=>{this.listenIframe(i)},50),this.onPhaseChangedListener=i=>{i===T.PlayerPhase.Playing&&this.computedStyleAndIframeDisplay()},this.stateChangeListener=i=>{i={...i},i.cameraState=this.manager.cameraState,this.postMessage({kind:"RoomStateChanged",payload:i}),i.cameraState&&(re.emitter.emit("GetRootRect"),this.computedStyle(i)),i.memberState&&(this.computedZindex(),this.updateStyle()),i.sceneState&&this.computedIframeDisplay(i,this.attributes)},this.displayer=re.displayer=e.displayer,this.iframe=this._createIframe(),this.sideEffectManager.addDisposer(re.emitter.on("ReplayRootRect",i=>{this.rootRect=i}),Lt.RootRect),this.sideEffectManager.addDisposer(re.emitter.on("HideIframe",()=>{this.iframe.className=re.hiddenClass}),Lt.Hide),this.sideEffectManager.addDisposer(re.emitter.on("DispayIframe",()=>{this.iframe.className=""}),Lt.Show),this.sideEffectManager.addDisposer(re.emitter.on("created",()=>{this.bridgeDisposer(),this.bridgeDisposer=T.autorun(()=>{var n;const i=this.attributes;if(i.url){const r=(n=this.iframe)==null?void 0:n.src;r&&r!==i.url&&this.execListenIframe(i)}i.displaySceneDir&&this.computedIframeDisplay(this.displayer.state,i),(i.width||i.height)&&this.iframe&&(this.iframe.width=`${i.width}px`,this.iframe.height=`${i.height}px`),this.postMessage({kind:"AttributesUpdate",payload:i})})})),this.sideEffectManager.addDisposer(t.emitter.on("cameraStateChange",()=>{this.computedStyle(this.displayer.state)})),re.onCreate(this)}static onCreate(t){re.emitter.emit("StartCreate"),re.emitter.emit("OnCreate",t),re.emitter.emit("created")}insert(t){const e={url:t.url,width:t.width,height:t.height,displaySceneDir:t.displaySceneDir,useClicker:t.useClicker||!1,useSelector:t.useSelector};this.setAttributes(e);const i=()=>{this.getIframe(),this.listenIframe(this.attributes),this.listenDisplayerState(),re.emitter.emit("GetRootRect")};if(this.getIframe())i();else{const n=this.sideEffectManager.addDisposer(re.emitter.on("WrapperDidMount",()=>{i(),this.sideEffectManager.flush(n)})),r=this.sideEffectManager.addDisposer(re.emitter.on("WrapperDidUpdate",()=>{i(),this.sideEffectManager.flush(r)}))}return this.attributes.useSelector&&this.allowAppliances.push("selector"),this.computedStyle(this.displayer.state),this.listenDisplayerCallbacks(),this.getComputedIframeStyle(),this.sideEffectManager.addEventListener(window,"message",this.messageListener.bind(this),void 0,Lt.Message),re.alreadyCreate=!0,this}getComputedIframeStyle(){this.sideEffectManager.setTimeout(()=>{this.iframe&&getComputedStyle(this.iframe)},200,Lt.ComputeStyle)}destroy(){this.sideEffectManager.flushAll(),re.emitter.emit("Destory"),re.alreadyCreate=!1,re.emitter.clearListeners()}getIframe(){return this.iframe||(this.iframe=this._createIframe()),this.iframe}setIframeSize(t){this.iframe&&(this.iframe.width=`${t.width}px`,this.iframe.height=`${t.height}px`,this.setAttributes({width:t.width,height:t.height}))}get attributes(){return this.appManager.store.getIframeBridge()}setAttributes(t){this.appManager.store.setIframeBridge(t)}_createIframe(){const t=document.createElement("iframe");return t.id="IframeBridge",t.className=re.hiddenClass,this.appManager.mainView.divElement&&this.appManager.mainView.divElement.appendChild(t),t}scaleIframeToFit(t=T.AnimationMode.Immediately){if(!this.inDisplaySceneDir)return;const{width:e=1280,height:i=720}=this.attributes,n=e?-e/2:0,r=i?-i/2:0;this.manager.moveCameraToContain({originX:n,originY:r,width:e,height:i,animationMode:t})}get isReplay(){return this.manager.isReplay}handleSetPage(t){if(this.isReplay||!this.attributes.displaySceneDir)return;const e=t.payload,i=this.displayer,n=i.entireScenes()[this.attributes.displaySceneDir];if(!n||n.length!==e){const r=wS(e,s=>({name:String(s+1)}));i.putScenes(this.attributes.displaySceneDir,r),this.manager.setMainViewScenePath(this.attributes.displaySceneDir)}}listenIframe(t){const e=i=>{var n;this.postMessage({kind:"Init",payload:{attributes:this.attributes,roomState:(n=re.displayer)==null?void 0:n.state,currentPage:this.currentPage,observerId:this.displayer.observerId}}),re.emitter.emit("IframeLoad",i),this.sideEffectManager.addDisposer(re.emitter.on("Ready",()=>{var r;this.postMessage((r=this.attributes.lastEvent)==null?void 0:r.payload)}),Lt.Ready),this.computedStyleAndIframeDisplay()};t.url&&this.iframe.src!==t.url&&(this.src_url_equal_anchor||(this.src_url_equal_anchor=document.createElement("a")),this.src_url_equal_anchor.href=t.url,this.src_url_equal_anchor.href!==this.iframe.src&&(this.iframe.src=t.url)),this.iframe.width=`${t.width}px`,this.iframe.height=`${t.height}px`,this.sideEffectManager.addEventListener(this.iframe,"load",e,void 0,Lt.Load)}listenDisplayerState(){this.isReplay&&(this.displayer._phase===T.PlayerPhase.Playing&&this.computedStyleAndIframeDisplay(),this.sideEffectManager.add(()=>(this.displayer.callbacks.on("onPhaseChanged",this.onPhaseChangedListener),()=>this.displayer.callbacks.off("onPhaseChanged",this.onPhaseChangedListener)),Lt.DisplayerState)),this.computedStyleAndIframeDisplay()}computedStyleAndIframeDisplay(){this.computedStyle(this.displayer.state),this.computedIframeDisplay(this.displayer.state,this.attributes)}listenDisplayerCallbacks(){this.displayer.callbacks.on(this.callbackName,this.stateChangeListener)}get callbackName(){return this.isReplay?"onPlayerStateChanged":"onRoomStateChanged"}computedStyle(t){const e=this.manager.cameraState,i=this.attributes.width||1280,n=this.attributes.height||720;if(this.iframe){const{width:r,height:s,scale:o,centerX:a,centerY:c}=e,l=this.rootRect||{x:0,y:0},u=`${r/2+l.x}px`,d=`${s/2+l.y}px`,f=`transform-origin: ${u} ${d};`,v=(r-i)/2*o,w=(s-n)/2*o,x=-(a*o)+v,h=-(c*o)+w,p=`transform: translate(${x}px,${h}px) scale(${o}, ${o});`,E=["position: absolute;","border: 0.1px solid rgba(0,0,0,0);","top: 0px;","left: 0px;",f,p];this.cssList=E,this.computedZindex(),this.updateStyle()}}computedIframeDisplay(t,e){this.inDisplaySceneDir?re.emitter.emit("DispayIframe"):re.emitter.emit("HideIframe")}computedZindex(){const t="z-index: -1;",e=this.cssList.findIndex(i=>i===t);e!==-1&&this.cssList.splice(e,1),(!this.isClicker()||this.isDisableInput)&&this.cssList.push(t)}updateStyle(){this.iframe.style.cssText=this.cssList.join(" ")}get iframeOrigin(){if(this.iframe)try{return new URL(this.iframe.src).origin}catch(t){console.warn(t)}}messageListener(t){if(it("<<<",JSON.stringify(t.data)),t.origin!==this.iframeOrigin)return;const e=t.data;switch(e.kind){case"SetAttributes":{this.handleSetAttributes(e);break}case"RegisterMagixEvent":{this.handleRegisterMagixEvent(e);break}case"RemoveMagixEvent":{this.handleRemoveMagixEvent(e);break}case"DispatchMagixEvent":{this.handleDispatchMagixEvent(e);break}case"RemoveAllMagixEvent":{this.handleRemoveAllMagixEvent();break}case"NextPage":{this.handleNextPage();break}case"PrevPage":{this.handlePrevPage();break}case"SDKCreate":{this.handleSDKCreate();break}case"SetPage":{this.handleSetPage(e);break}case"GetAttributes":{this.handleGetAttributes();break}case"PageTo":{this.handlePageTo(e);break}default:{it(`${e.kind} not allow event.`);break}}}handleSDKCreate(){this.postMessage({kind:"Init",payload:{attributes:this.attributes,roomState:this.displayer.state,currentPage:this.currentPage,observerId:this.displayer.observerId}})}handleDispatchMagixEvent(t){const e=t.payload;this.appManager.safeDispatchMagixEvent(e.event,e.payload)}handleSetAttributes(t){this.setAttributes(t.payload)}handleRegisterMagixEvent(t){const e=t.payload,i=n=>{n.authorId!==this.displayer.observerId&&this.postMessage({kind:"ReciveMagixEvent",payload:n})};this.magixEventMap.set(e,i),this.displayer.addMagixEventListener(e,i)}handleRemoveMagixEvent(t){const e=t.payload,i=this.magixEventMap.get(e);this.displayer.removeMagixEventListener(e,i)}handleNextPage(){this.manager.canOperate&&(this.manager.nextPage(),this.dispatchMagixEvent("NextPage",{}))}handlePrevPage(){this.manager.canOperate&&(this.manager.prevPage(),this.dispatchMagixEvent("PrevPage",{}))}handlePageTo(t){if(this.manager.canOperate){const e=t.payload;if(!Number.isSafeInteger(e)||e<=0)return;this.manager.setMainViewSceneIndex(e-1),this.dispatchMagixEvent("PageTo",e-1)}}handleRemoveAllMagixEvent(){this.magixEventMap.forEach((t,e)=>{this.displayer.removeMagixEventListener(e,t)}),this.magixEventMap.clear()}handleGetAttributes(){this.postMessage({kind:"GetAttributes",payload:this.attributes})}postMessage(t){var e;this.iframe&&((e=this.iframe.contentWindow)==null||e.postMessage(JSON.parse(JSON.stringify(t)),"*"))}dispatchMagixEvent(t,e){this.manager.canOperate&&(this.setAttributes({lastEvent:{name:t,payload:e}}),this.displayer.dispatchMagixEvent(t,e))}get currentIndex(){return this.manager.mainViewSceneIndex}get currentPage(){return this.currentIndex+1}get totalPage(){return this.manager.mainViewScenesLength}get readonly(){return!this.displayer.isWritable}get inDisplaySceneDir(){return this.manager.mainViewSceneDir===this.attributes.displaySceneDir}isClicker(){if(this.readonly)return!1;const t=this.displayer.state.memberState.currentApplianceName;return this.allowAppliances.includes(t)}get isDisableInput(){return"disableDeviceInputs"in this.displayer?this.displayer.disableDeviceInputs:!0}};let Ni=re;Ni.kind="IframeBridge";Ni.hiddenClass="netless-iframe-brdige-hidden";Ni.emitter=new bi.default;Ni.displayer=null;Ni.alreadyCreate=!1;class yS extends bi.default{_inject(e){this.context=e}}class Bg{constructor(e){this.extends=new Map,this.context={manager:this,windowManager:e.windowManager,internalEmitter:e.internalEmitter},e.container&&this.refreshContainer(e.container)}refreshContainer(e){this.context.windowManagerContainer=e,this.extends.forEach(i=>{i._inject(this.context)})}hasRegister(e){return Ee.appClasses.has(e)}use(e){this.extends.set(e.kind,e),e._inject(this.context),e.onCreate()}destroy(){this.extends.forEach(e=>{this.extends.delete(e.kind),e.onDestroy()})}}function xS(){let t=new Set;function e(o){return t.add(o),()=>{i(o)}}function i(o){t.delete(o)}function n(...o){t.forEach(a=>{a(...o)})}function r(){return Boolean(t.size)}function s(){t=new Set}return{runCallbacks:n,addCallback:e,removeCallback:i,hasCallbacks:r,removeAll:s}}const zi=t=>b.isNumber(t)&&!Number.isNaN(t);class MS{constructor(e){this.baseScrollTop=0,this.baseScrollLeft=0,this._isInternalUpdate=!1,this._isRemoteSync=!1,this.updateSize=()=>{this.baseScrollTop=this._scrollingElement.scrollHeight-this._scrollingElement.clientHeight,this.baseScrollLeft=this._scrollingElement.scrollWidth-this._scrollingElement.clientWidth,this.scroll()},this.dispatchScrollEvent=b.debounce(({x:r,y:s})=>{var a,c,l,u;console.log(`${te} ViewScrollChange Dispatch Scroll Event`,{appId:this.appId,x:r,y:s});const o=(c=(a=this.manager.appManager)==null?void 0:a.store)==null?void 0:c.getViewScrollChange();if(o&&o.appId===this.appId&&Math.abs(o.x-r)<.01&&Math.abs(o.y-s)<.01){console.log(`${te} ViewScrollChange Skip - No significant change`);return}(u=(l=this.manager.appManager)==null?void 0:l.store)==null||u.setViewScrollChange({appId:this.appId,x:r,y:s})},200),this._sideEffect=new hn;const{createVal:i}=_c.createSideEffectBinder(this._sideEffect);this._scrollingElement=e.scrollElement,this.manager=e.manager,this.appId=e.appId,this.crood=i(this.getAttribute());const n={$crood:this.crood};_c.withValueEnhancer(this,n),this.updateSize(),this._sideEffect.addEventListener(this._scrollingElement,"scroll",this.onScroll.bind(this),!0),this.callbackManager=xS(),this.sizeObserver=new ResizeObserver(this.callbackManager.runCallbacks),this.callbackManager.addCallback(this.updateSize.bind(this)),this.sizeObserver.observe(this._scrollingElement),this.sizeObserver.observe(this._scrollingElement.firstElementChild),this.crood.reaction(()=>{this._isInternalUpdate||this.scroll()}),setTimeout(()=>{this.updateSize(),this.scroll()})}onScroll(){if(console.log("window manager scroll readonly",this.manager.readonly||X.appReadonly),this.manager.readonly||X.appReadonly||this._isInternalUpdate||this._isRemoteSync)return;const{x:e,y:i}=this.calcLocalToCoord(this.getLocalCoord());this.dispatchScrollEvent({x:e,y:i})}scroll(){if(!this._scrollingElement)return;const{x:e,y:i}=this.calcCoordToLocal();this._scrollingElement.scrollTo({left:e,top:i,behavior:"instant"})}setCoord(e){this._isInternalUpdate=!0,console.log(`${te} ViewScrollChange SetCoord`,JSON.stringify(e));try{this.crood.setValue({x:zi(e.x)?e.x:this.crood.value.x,y:zi(e.y)?e.y:this.crood.value.y})}finally{this._isInternalUpdate=!1}}setCoordFromRemote(e){this._isRemoteSync=!0,console.log(`${te} ViewScrollChange SetCoordFromRemote`,JSON.stringify(e));try{this.crood.setValue({x:zi(e.x)?e.x:this.crood.value.x,y:zi(e.y)?e.y:this.crood.value.y})}finally{this._isRemoteSync=!1}}getAttribute(){var i,n;return((n=(i=this.manager.appManager)==null?void 0:i.store)==null?void 0:n.getViewScrollChange())||{x:0,y:0}}calcCoordToLocal(){if(!this._scrollingElement)return{x:0,y:0};const{x:e,y:i}=this.crood.value;return{x:e*this.baseScrollLeft,y:i*this.baseScrollTop}}getLocalCoord(){return{x:this._scrollingElement.scrollLeft,y:this._scrollingElement.scrollTop}}calcLocalToCoord(e){if(!this._scrollingElement)return{x:0,y:0};const{x:i,y:n}=e,r={x:0,y:0};return zi(i)&&(r.x=Number((i/this.baseScrollLeft).toFixed(2))),zi(n)&&(r.y=Number((n/this.baseScrollTop).toFixed(2))),r}destroy(){this._sideEffect.flushAll(),this.callbackManager.removeAll(),this.sizeObserver.disconnect()}}const zg="windowMananerAppScrolling";class SS{constructor({manager:e}){this.scrollers=[],this.manager=e,R.on(zg,this.onAppScrolling.bind(this))}onAppScrolling(e){if(console.log(`${te} ScrollerManager onAppScrolling`,JSON.stringify(e)),e){const{appId:i,x:n,y:r}=e;i&&this.scrollToFromRemote(i,{x:n,y:r})}}add(e){if(this.scrollers.find(n=>n.appId==e.appId))return;const i=new MS(e);this.scrollers.push(i)}scrollTo(e,i){const n=this.getScroller(e);console.log(`${te} ScrollerManager ScrollTo`,JSON.stringify(i)),n&&n.setCoord(i)}scrollToFromRemote(e,i){const n=this.getScroller(e);console.log(`${te} ScrollerManager ScrollToFromRemote`,JSON.stringify(i)),n&&n.setCoordFromRemote(i)}moveToCenter(e){const i={x:.5,y:.5};if(e){const n=this.getScroller(e);n&&this.scrollTo(n==null?void 0:n.appId,i)}else this.scrollers.forEach(n=>this.scrollTo(n==null?void 0:n.appId,i))}getScroller(e){if(!!e)return this.scrollers.find(i=>i.appId==e)}remove(e){const i=this.getScroller(e);!i||(i.destroy(),this.scrollers=this.scrollers.filter(n=>n.appId!=e))}destroy(){this.scrollers.forEach(e=>{e.destroy()}),this.scrollers=[]}}const ye="[LaserPointer]";class IS{constructor(e){this._listenerViewMap={},this._pointMap={},this._mainViewId="mainViewId",this._currentPointActive=!1,this._manager=e,this.addWindowManagerListeners(),this.addEventListeners()}addWindowManagerListeners(){var e;this._manager.emitter.on("onAppViewMounted",i=>{var r,s,o;console.log(`${ye} onAppViewMounted event received for app:`,i);const n=(o=(s=(r=this._manager)==null?void 0:r.appManager)==null?void 0:s.appProxies)==null?void 0:o.get(i.appId);console.log(`${ye} App box view for ${i.appId}:`,!!n),n?(console.log(`${ye} Creating laser pointer manager for app:`,n),this._listenerViewMap[i.appId]=n):console.warn(`${ye} Failed to get app box view for:`,i.appId)}),this._manager.emitter.on("onBoxClose",i=>{var r,s,o;console.log(`${ye} onAppViewUnmounted event received for app:`,i),((o=(s=(r=this._manager)==null?void 0:r.appManager)==null?void 0:s.appProxies)==null?void 0:o.get(i.appId))&&(this._listenerViewMap[i.appId]=null,this._pointMap[i.appId]=null)}),(e=this._manager.displayer)==null||e.addMagixEventListener("teacherLaserPointerMove",i=>{var o,a,c,l,u;console.info(`${ye} \u6536\u5230\u8001\u5E08\u6FC0\u5149\u7B14\u79FB\u52A8\u4E8B\u4EF6:`,i);const n=(o=this._manager.appManager)==null?void 0:o.store.getTeacherInfo();if(i.payload.sendUserId===(n==null?void 0:n.uid)){console.info(`${ye} \u8DF3\u8FC7\u81EA\u5DF1\u7684\u4E8B\u4EF6`);return}let r=(l=(c=(a=this._manager.appManager)==null?void 0:a.appProxies)==null?void 0:c.get(i.payload.viewId))==null?void 0:l.view;r==null&&this._manager.mainView!=null&&this._mainViewId===i.payload.viewId&&(r=this._manager.mainView);let s=null;r==null?console.info(`${ye} \u627E\u4E0D\u5230\u89C6\u56FEID:`,i.payload.viewId):(this._mainViewId!==i.payload.viewId&&((u=r.divElement)==null||u.classList.add("teacher-current-pointer-enevnt-auto")),s=r.convertToPointOnScreen(i.payload.position.x,i.payload.position.y),s==null?console.info(`${ye} \u8F6C\u6362\u5931\u8D25:`,i.payload.position):console.info(`${ye} \u8F6C\u6362\u6210\u529F:`,i.payload.viewId,s)),this._showPointIcon(i.payload.viewId,r,s)})}addEventListeners(){var i;const e=(i=this._manager.appManager)==null?void 0:i.store.getTeacherInfo();this._manager.room.uid===(e==null?void 0:e.uid)&&(this._teacherMoveThrottle||(this._teacherMoveThrottle=b.throttle((n,r)=>{var o,a;console.log(`${ye} \u53D1\u9001\u8001\u5E08\u4F4D\u7F6E: \u4F4D\u7F6E=${JSON.stringify(n)}`);const s=(o=this._manager.appManager)==null?void 0:o.store.getTeacherInfo();(a=this._manager.room)==null||a.dispatchMagixEvent("teacherLaserPointerMove",{position:n,viewId:r,sendUserId:s==null?void 0:s.uid,timestamp:Date.now()})},150)),this._boundHandleTeacherMouseMove||(this._boundHandleTeacherMouseMove=n=>{var c,l;if(!this._currentPointActive)return;const r=Object.entries(this._listenerViewMap).sort((u,d)=>{var w,x,h,p,g,m;const f=(h=(x=(w=u[1])==null?void 0:w.box)==null?void 0:x.zIndex)!=null?h:0;return((m=(g=(p=d[1])==null?void 0:p.box)==null?void 0:g.zIndex)!=null?m:0)-f}).map(u=>({key:u[0],value:u[1]}));let s=null,o=null,a=null;for(const u of r){const d=u.key,f=u.value;if(f!=null&&f.view){const v=this._getViewOffset(f==null?void 0:f.view,n);if(v){o=d,s=v,a=f.view;break}}}if(!s){const u=this._getViewOffset(this._manager.mainView,n);u&&(o=this._mainViewId,s=u,a=this._manager.mainView)}if(s&&o){const u=a.convertToPointInWorld({x:s.x,y:s.y});console.log(`${ye} [${o}] \u9F20\u6807\u79FB\u52A8\u5904\u7406,\u5F53\u524D\u7A97\u53E3\u504F\u79FB\uFF1A${JSON.stringify(s)} \u8F6C\u6362\u81F3view\u504F\u79FB:`,JSON.stringify(u)),(c=this._teacherMoveThrottle)==null||c.call(this,u,o)}else console.log(`${ye} \u627E\u4E0D\u5230\u89C6\u56FEID:`,o),(l=this._teacherMoveThrottle)==null||l.call(this,{x:-1,y:-1},"")}),document.addEventListener("mousemove",this._boundHandleTeacherMouseMove))}removeEventListeners(){this._boundHandleTeacherMouseMove&&document.removeEventListener("mousemove",this._boundHandleTeacherMouseMove)}setLaserPointer(e){console.log(`${ye} \u8BBE\u7F6E\u6FC0\u5149\u7B14\u72B6\u6001:`,e),this._currentPointActive=e}destroy(){var e,i,n,r,s;this.removeEventListeners(),this._pointMap={},this._listenerViewMap={},this._teacherMoveThrottle=void 0,this._boundHandleTeacherMouseMove=void 0,this._currentPointActive=!1,this._mainViewId="mainViewId",(e=this._manager.displayer)==null||e.removeMagixEventListener("teacherLaserPointerMove"),(n=(i=this._manager.appManager)==null?void 0:i.refresher)==null||n.remove(V.LaserPointerActive),(s=(r=this._manager.appManager)==null?void 0:r.refresher)==null||s.remove(V.Scale)}_getViewOffset(e,i){const n=this._getViewDivElement(e);if(n&&n instanceof HTMLDivElement){const r=CS.getTargetPoint(i,document.documentElement,n),s=n.getBoundingClientRect();if(r&&r[0]>=0&&r[1]>=0&&r[0]<=s.width&&r[1]<=s.height)return{x:r[0],y:r[1]}}return null}_getViewDivElement(e){var n;const i=(n=e.divElement)==null?void 0:n.children;return i&&i.length>0?i[0]:null}_showPointIcon(e,i,n){var s;let r=this._pointMap[e];r||(r=document.createElement("div"),r.className="teacher-laser-pointer",r.style.display="none",i&&((s=this._getViewDivElement(i))==null||s.appendChild(r),console.log(`${ye} [${e}] \u6FC0\u5149\u7B14\u56FE\u6807\u5DF2\u6DFB\u52A0\u5230\u89C6\u56FE\u5BB9\u5668`),this._pointMap[e]=r)),Object.entries(this._pointMap).forEach(([o,a])=>{o!==e&&a&&(console.log(`${ye} [${o}] \u6FC0\u5149\u7B14\u56FE\u6807\u5DF2\u9690\u85CF`),a.style.display="none")}),n?(console.log(`${ye} [${e}] \u6FC0\u5149\u7B14\u56FE\u6807\u5DF2\u663E\u793A`),r.style.left=`${n.x}px`,r.style.top=`${n.y}px`,r.style.display="block"):r.style.display="none"}}class CS{static getTargetPoint(e,i,n){const r=this.getContainerOffset(n,{x:0,y:0}),s=this.getContainerOffset(i,{x:0,y:0}),o={x:r.x-s.x,y:r.y-s.y},a=this.getPosition(e);return a&&b.isNumber(a.x)&&b.isNumber(a.y)?[a.x-o.x,a.y-o.y]:null}static getPosition(e){return{x:e.pageX,y:e.pageY}}static getTranslate(e){const n=(e.style.WebkitTransform||getComputedStyle(e,"").getPropertyValue("-webkit-transform")||e.style.transform||getComputedStyle(e,"").getPropertyValue("transform")).match(/-?[0-9]+\.?[0-9]*/g),r=n&&parseInt(n[0])||0,s=n&&parseInt(n[1])||0;return[r,s]}static getContainerOffset(e,i){var s;const n=this.getTranslate(e);let r={x:i.x+e.offsetLeft-e.scrollLeft+n[0],y:i.y+e.offsetTop-e.scrollTop+n[1]};return((s=e.offsetParent)==null?void 0:s.nodeName)&&e.offsetParent.nodeName!=="BODY"&&(r=this.getContainerOffset(e.offsetParent,r)),r}static getElementViewportPosition(e){const i=e.getBoundingClientRect();return{x:i.left,y:i.top}}static pageToElementCoordinates(e,i){const n=this.getContainerOffset(i,{x:0,y:0});return{x:e.x-n.x,y:e.y-n.y}}static elementToPageCoordinates(e,i){const n=this.getContainerOffset(i,{x:0,y:0});return{x:e.x+n.x,y:e.y+n.y}}}function Di(t,e){let i=!1;return T.autorun(()=>{if(i){console.log(`${te} ${e||"Autorun"} Skipped - Already updating`);return}i=!0;try{console.log(`${te} ${e||"Autorun"} Executing`),t()}finally{i=!1,console.log(`${te} ${e||"Autorun"} Completed`)}})}const Dg=new Cw({emitter:R}),Vi="mainView",te="[TeleBox] WindowManager",B=class extends T.InvisiblePlugin{constructor(t){super(t),this.version="1.0.6-wukongBeta.8",this.dependencies={dependencies:{"@juggle/resize-observer":"^3.4.0","@netless/telebox-insider":"0.2.32-wukongBeta.8",emittery:"^0.9.2",lodash:"^4.17.21","p-retry":"^4.6.2",uuid:"^7.0.3","value-enhancer":"0.0.8","video.js":"^8.23.4"},peerDependencies:{jspdf:"2.5.1","white-web-sdk":"^2.16.52"},devDependencies:{"@hyrious/dts":"^0.2.11","@netless/app-docs-viewer":"0.2.23.wukongBeta.1","@netless/app-media-player":"0.1.4","@rollup/plugin-commonjs":"^20.0.0","@rollup/plugin-node-resolve":"^13.3.0","@rollup/plugin-url":"^6.1.0","@sveltejs/vite-plugin-svelte":"1.0.0-next.40","@tsconfig/svelte":"^2.0.1","@types/debug":"^4.1.12","@types/lodash":"^4.17.20","@types/lodash-es":"^4.17.12","@types/uuid":"^8.3.4","@typescript-eslint/eslint-plugin":"^4.33.0","@typescript-eslint/parser":"^4.33.0","@vitest/ui":"^0.14.2",cypress:"^8.7.0",dotenv:"^10.0.0",eslint:"^7.32.0","eslint-config-prettier":"^8.10.2","eslint-plugin-svelte3":"^3.4.1",jsdom:"^19.0.0",jspdf:"^2.5.2",less:"^4.4.1",prettier:"^2.8.8","prettier-plugin-svelte":"^2.10.1","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-styles":"^3.14.1","side-effect-manager":"0.1.5",svelte:"^3.59.2",typescript:"^4.9.5",vite:"^2.9.18",vitest:"^0.14.2","white-web-sdk":"^2.16.53"}},this.emitter=J,this.viewMode=T.ViewMode.Broadcaster,this.isReplay=T.isPlayer(this.displayer),this._cursorUIDs=[],this.containerSizeRatio=B.containerSizeRatio,B.displayer=t.displayer,window.NETLESS_DEPS={dependencies:{"@juggle/resize-observer":"^3.4.0","@netless/telebox-insider":"0.2.32-wukongBeta.8",emittery:"^0.9.2",lodash:"^4.17.21","p-retry":"^4.6.2",uuid:"^7.0.3","value-enhancer":"0.0.8","video.js":"^8.23.4"},peerDependencies:{jspdf:"2.5.1","white-web-sdk":"^2.16.52"},devDependencies:{"@hyrious/dts":"^0.2.11","@netless/app-docs-viewer":"0.2.23.wukongBeta.1","@netless/app-media-player":"0.1.4","@rollup/plugin-commonjs":"^20.0.0","@rollup/plugin-node-resolve":"^13.3.0","@rollup/plugin-url":"^6.1.0","@sveltejs/vite-plugin-svelte":"1.0.0-next.40","@tsconfig/svelte":"^2.0.1","@types/debug":"^4.1.12","@types/lodash":"^4.17.20","@types/lodash-es":"^4.17.12","@types/uuid":"^8.3.4","@typescript-eslint/eslint-plugin":"^4.33.0","@typescript-eslint/parser":"^4.33.0","@vitest/ui":"^0.14.2",cypress:"^8.7.0",dotenv:"^10.0.0",eslint:"^7.32.0","eslint-config-prettier":"^8.10.2","eslint-plugin-svelte3":"^3.4.1",jsdom:"^19.0.0",jspdf:"^2.5.2",less:"^4.4.1",prettier:"^2.8.8","prettier-plugin-svelte":"^2.10.1","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-styles":"^3.14.1","side-effect-manager":"0.1.5",svelte:"^3.59.2",typescript:"^4.9.5",vite:"^2.9.18",vitest:"^0.14.2","white-web-sdk":"^2.16.53"}}}static onCreate(t){B._resolve(t)}static async mount(t){var o,a,c,l,u,d,f,v,w,x,h,p;const e=t.room;B.container=t.container,B.supportAppliancePlugin=t.supportAppliancePlugin;const i=t.containerSizeRatio,n=t.debug,r=t.cursor;B.params=t,B.displayer=t.room,$v();let s;if(T.isRoom(e)){if(e.phase!==T.RoomPhase.Connected)throw new Error("[WindowManager]: Room only Connected can be mount");e.phase===T.RoomPhase.Connected&&e.isWritable&&(e.disableSerialization=!1),s=await this.initManager(e)}if(B.isCreated)throw new Error("[WindowManager]: Already created cannot be created again");if(this.debug=Boolean(n),this.debug&&Ag({verbose:!0}),it("Already insert room",s),T.isRoom(this.displayer)){if(!s)throw new Error("[WindowManager]: init InvisiblePlugin failed")}else await Ud.default(async g=>{if(s=e.getInvisiblePlugin(B.kind),!s)throw it(`manager is empty. retrying ${g}`),new Error},{retries:10,maxTimeout:5e3});if(!s)throw new Error("[WindowManager]: create manager failed");i&&(B.containerSizeRatio=i),await s.ensureAttributes(),s._fullscreen=t.fullscreen,s.appManager=new Vv(s),s.appManager.polling=t.polling||!1,s._pageState=new Iw(s.appManager),s.cursorManager=new Sw(s.appManager,Boolean(r),t.cursorOptions,t.applianceIcons),s.scrollerManager=new SS({manager:s}),s.extendPluginManager=new Bg({internalEmitter:R,windowManager:s}),i&&(s.containerSizeRatio=i),t.container&&s.bindContainer(t.container),bw(e,s),R.emit("onCreated"),B.isCreated=!0;try{await Yg()}catch(g){console.warn("[WindowManager]: indexedDB open failed"),console.log(g)}return(a=(o=s.appManager)==null?void 0:o.refresher)==null||a.add(V.Scale,()=>(console.log(`${te} Scale Register Listener`),Di(()=>{const g=b.get(s.appManager.attributes,V.Scale),m=Object.keys(g);if(m.length>0){const y=m[0],M=g[y];console.log(`${te} Scale Target`,JSON.stringify(g)),s==null||s._setScale({appId:y,scale:M},!0)}},"Scale"))),(l=(c=s.appManager)==null?void 0:c.refresher)==null||l.add(V.LaserPointerActive,()=>(console.log(`${te} LaserPointerActive Register Listener`),Di(()=>{var y;const g=b.get(s.appManager.attributes,V.LaserPointerActive);console.log(`${te} LaserPointerActive Target`,JSON.stringify(g)),s==null||s._setLaserPointer(g).catch(console.error);const m=(g==null?void 0:g.active)||!1;(y=s==null?void 0:s._laserPointerManager)==null||y.setLaserPointer(m)},"LaserPointerActive"))),(d=(u=s.appManager)==null?void 0:u.refresher)==null||d.add(V.ViewScrollChange,()=>(console.log(`${te} ViewScrollChange Register Listener`),Di(()=>{const g=b.get(s.appManager.attributes,V.ViewScrollChange);g&&(console.log(`${te} ViewScrollChange Target`,JSON.stringify(g)),R.emit(zg,g))},"ViewScrollChange"))),(v=(f=s.appManager)==null?void 0:f.refresher)==null||v.add(V.MainViewBackgroundInfo,()=>(console.log(`${te} MainViewBackgroundInfo Register Listener`),Di(()=>{const g=b.get(s.appManager.attributes,V.MainViewBackgroundInfo);console.log(`${te} MainViewBackgroundInfo Target`,JSON.stringify(g)),g.img.length>0?s==null||s._setBackgroundImg(g.img):g.color.length>0&&(s==null||s._setBackgroundColor(g.color))},"MainViewBackgroundInfo"))),(x=(w=s.appManager)==null?void 0:w.refresher)==null||x.add(V.AllBoxStatusInfo,()=>(console.log(`${te} AllBoxStatusInfo Register Listener`),Di(()=>{var m,y;const g=b.get(s.appManager.attributes,V.AllBoxStatusInfo);(y=(m=s==null?void 0:s.boxManager)==null?void 0:m.teleBoxManager)==null||y.setAllBoxStatusInfo(g,!0),console.log(`${te} AllBoxStatusInfo Target`,JSON.stringify(g)),Object.entries(g).forEach(([M,E])=>{var z;if(M.includes("Plyr")){const P=(z=s==null?void 0:s.appManager)==null?void 0:z.appProxies.get(M);P==null||P.appEmitter.emit("boxStatusChange",{appId:M,status:E})}})},"AllBoxStatusInfo"))),(p=(h=s.appManager)==null?void 0:h.refresher)==null||p.add(V.LastNotMinimizedBoxsStatus,()=>(console.log(`${te} LastNotMinimizedBoxsStatus Register Listener`),Di(()=>{var m,y;const g=b.get(s.appManager.attributes,V.LastNotMinimizedBoxsStatus);(y=(m=s==null?void 0:s.boxManager)==null?void 0:m.teleBoxManager)==null||y.setLastLastNotMinimizedBoxsStatus(g,!0),console.log(`${te} LastNotMinimizedBoxsStatus Target`,JSON.stringify(g))},"LastNotMinimizedBoxsStatus"))),R.on("playgroundSizeChange",()=>{s==null||s._updateMainViewWrapperSize(s.getAttributesValue(V.Scale)[Vi],!0)}),setTimeout(()=>{s==null||s._initAttribute()}),s}static initManager(t){return Wv(t)}static initContainer(t,e,i){var v;const{chessboard:n,overwriteStyles:r,fullscreen:s}=i;B.container||(B.container=e);const{playground:o,wrapper:a,sizer:c,mainViewElement:l,mainViewWrapper:u,extendWrapper:d,mainViewScrollWrapper:f}=Ov(e);if(B.playground=o,n&&c.classList.add("netless-window-manager-chess-sizer"),s&&c.classList.add("netless-window-manager-fullscreen"),r){const w=document.createElement("style");w.textContent=r,o.appendChild(w)}return t.containerResizeObserver=bl.create(o,c,a,R),B.wrapper=a,B.sizer=c,B.mainViewWrapper=u,B.extendWrapper=d,B.mainViewScrollWrapper=f,(v=B.mainViewScrollWrapper)==null||v.classList.toggle("netless-window-manager-fancy-scrollbar-readonly",B.appReadonly),l}static get registered(){return Ee.registered}bindContainer(t){var e,i,n,r,s,o,a,c;if(T.isRoom(this.displayer)&&this.room.phase!==T.RoomPhase.Connected)throw new eh;if(B.isCreated&&B.container)B.container.firstChild&&t.appendChild(B.container.firstChild);else if(B.params){const l=B.params,u=B.initContainer(this,t,l);this.boxManager&&this.boxManager.destroy();const d=Pv(this,J,R,bt,{collectorContainer:l.collectorContainer,collectorStyles:l.collectorStyles,prefersColorScheme:l.prefersColorScheme});this.boxManager=d,(e=this.appManager)==null||e.setBoxManager(d),B.mainViewScrollWrapper&&((i=this.scrollerManager)==null||i.add({appId:Vi,scrollElement:B.mainViewScrollWrapper,manager:this})),this.bindMainView(u,l.disableCameraTransform),B.wrapper&&((n=this.cursorManager)==null||n.setupWrapper(B.wrapper))}R.emit("updateManagerRect"),(r=this.appManager)==null||r.refresh(),(s=this.appManager)==null||s.resetMaximized(),(o=this.appManager)==null||o.resetMinimized(),(a=this.appManager)==null||a.displayerWritableListener(!this.room.isWritable),B.container=t,(c=this.extendPluginManager)==null||c.refreshContainer(t)}bindCollectorContainer(t){B.isCreated&&this.boxManager?this.boxManager.setCollectorContainer(t):B.params&&(B.params.collectorContainer=t)}static register(t){return Ee.register(t)}static unregister(t){return Ee.unregister(t)}async addApp(t){if(this.appManager)return this.appManager.rootDirRemoving?new Promise((e,i)=>{R.once("rootDirRemoved").then(async()=>{try{const n=await this._addApp(t);e(n)}catch(n){i(n.message)}})}):this._addApp(t);throw new et}async _addApp(t){var e,i,n;if(this.appManager){if(!t.kind||typeof t.kind!="string")throw new Xd;t.src&&typeof t.src=="string"&&Ee.register({kind:t.kind,src:t.src});const r=await((e=Ee.appClasses.get(t.kind))==null?void 0:e());if(r&&((i=r.config)==null?void 0:i.singleton)&&this.appManager.appProxies.has(t.kind))throw new Gd;const s=this.setupScenePath(t,this.appManager);return s===void 0?void 0:((n=t==null?void 0:t.options)!=null&&n.scenePath&&(t.options.scenePath=pm(t.options.scenePath)),await this.appManager.addApp(t,Boolean(s)))}else throw new et}setupScenePath(t,e){let i=!1;if(t.options){const{scenePath:n,scenes:r}=t.options;if(n){if(!hm(n))throw new Kd;const s=Object.keys(this.apps||{});for(const o of s){const a=e.store.getAppScenePath(o);if(a&&a===n){if(console.warn(`[WindowManager]: ScenePath "${n}" already opened`),this.boxManager){const c=this.boxManager.getTopBox();c&&(this.boxManager.setZIndex(o,c.zIndex+1,!1),this.boxManager.focusBox({appId:o},!1))}return}}}n&&r&&r.length>0&&(this.isDynamicPPT(r)?(i=!0,nn(this.displayer)[n]||Ln(this.room,n,r)):nn(this.displayer)[n]||Ln(this.room,n,[{name:r[0].name}])),n&&r===void 0&&Ln(this.room,n,[{}])}return i}async setMainViewScenePath(t){this.appManager&&await this.appManager.setMainViewScenePath(t)}async setMainViewSceneIndex(t){this.appManager&&await this.appManager.setMainViewSceneIndex(t)}async nextPage(){if(this.appManager){const t=this.mainViewSceneIndex+1;return t>=this.mainViewScenesLength?(console.warn("[WindowManager]: current page is the last page"),!1):(await this.appManager.setMainViewSceneIndex(t),!0)}else return!1}async prevPage(){if(this.appManager){const t=this.mainViewSceneIndex-1;return t<0?(console.warn("[WindowManager]: current page is the first page"),!1):(await this.appManager.setMainViewSceneIndex(t),!0)}else return!1}async jumpPage(t){return this.appManager?t<0||t>=this.pageState.length?(console.warn(`[WindowManager]: index ${t} out of range`),!1):(await this.appManager.setMainViewSceneIndex(t),!0):!1}async addPage(t){if(this.appManager){const e=t==null?void 0:t.after,i=t==null?void 0:t.scene;if(e){const n=this.mainViewSceneIndex+1;this.room.putScenes(Ue,[i||{}],n)}else this.room.putScenes(Ue,[i||{}])}}async removePage(t){if(this.appManager){const e=t===void 0?this.pageState.index:t;return this.pageState.length===1?(console.warn("[WindowManager]: can not remove the last page"),!1):e<0||e>=this.pageState.length?(console.warn(`[WindowManager]: index ${t} out of range`),!1):this.appManager.removeSceneByIndex(e)}else return!1}getMainViewScenePath(){var t;return(t=this.appManager)==null?void 0:t.store.getMainViewScenePath()}getMainViewSceneIndex(){var t;return(t=this.appManager)==null?void 0:t.store.getMainViewSceneIndex()}setReadonly(t){var e;this.readonly=t,(e=this.boxManager)==null||e.setReadonly(t),R.emit("setReadonly",t)}switchMainViewToWriter(){var t;return(t=this.appManager)==null?void 0:t.mainViewProxy.mainViewClickHandler()}onAppDestroy(t,e){um(`destroy-${t}`,e)}onAppEvent(t,e){return R.on(`custom-${t}`,e)}setViewMode(t){var e,i,n,r;(t===T.ViewMode.Broadcaster||t===T.ViewMode.Follower)&&(this.canOperate&&t===T.ViewMode.Broadcaster&&((e=this.appManager)==null||e.mainViewProxy.setCameraAndSize()),(i=this.appManager)==null||i.mainViewProxy.start()),t===T.ViewMode.Freedom&&((n=this.appManager)==null||n.mainViewProxy.stop()),this.viewMode=t,(r=this.appManager)==null||r.mainViewProxy.setViewMode(t)}setBoxState(t){!this.canOperate||console.log(t)}setMaximized(t){var e;!this.canOperate||(e=this.boxManager)==null||e.setMaximized(t,!1)}setMinimized(t){var e;!this.canOperate||(e=this.boxManager)==null||e.setMinimized(t,!1)}setFullscreen(t){var e;this._fullscreen!==t&&(this._fullscreen=t,(e=B.sizer)==null||e.classList.toggle("netless-window-manager-fullscreen",t),J.emit("fullscreenChange",t))}get cursorUIDs(){return this._cursorUIDs}setCursorUIDs(t){var e,i;if(this._cursorUIDs=t||[],this._cursorUIDs.length===0)(e=this._cursorUIDsStyleDOM)==null||e.remove();else{this._cursorUIDsStyleDOM||(this._cursorUIDsStyleDOM=document.createElement("style")),(i=B.playground)==null||i.appendChild(this._cursorUIDsStyleDOM);let n="[data-cursor-uid] { display: none }";for(const r of this._cursorUIDs)n+=`
[data-cursor-uid="${r}"] { display: flex }`;this._cursorUIDsStyleDOM.textContent=n}}maximizedBoxNextPage(){var i,n;const t=this.getTopMaxBoxId();if(!t)return!1;const e=(i=this.appManager)==null?void 0:i.appProxies.get(t);return e?(n=e==null?void 0:e.appContext)==null?void 0:n.nextPage():!1}maximizedBoxPrevPage(){var i,n;const t=this.getTopMaxBoxId();if(!t)return!1;const e=(i=this.appManager)==null?void 0:i.appProxies.get(t);return e?(n=e==null?void 0:e.appContext)==null?void 0:n.prevPage():!1}getMaximizedBoxPageState(){var i,n;const t=this.getTopMaxBoxId();if(!t)return;const e=(i=this.appManager)==null?void 0:i.appProxies.get(t);if(!!e)return(n=e==null?void 0:e.appContext)==null?void 0:n.pageState}getTopMaxBoxId(){var e,i;const t=(i=(e=this.appManager)==null?void 0:e.boxManager)==null?void 0:i.teleBoxManager.getMaximizedBoxes().filter(n=>{var r,s;return!((s=(r=this.appManager)==null?void 0:r.boxManager)!=null&&s.teleBoxManager.getMinimizedBoxes().includes(n))});if(!!(t!=null&&t.length))return t.reduce((n,r)=>{var s,o,a,c,l,u,d,f;return Number((c=(a=(o=(s=this.appManager)==null?void 0:s.boxManager)==null?void 0:o.getBox(n))==null?void 0:a._zIndex$)==null?void 0:c.value)>Number((f=(d=(u=(l=this.appManager)==null?void 0:l.boxManager)==null?void 0:u.getBox(r))==null?void 0:d._zIndex$)==null?void 0:f.value)?n:r})}get mainView(){if(this.appManager)return this.appManager.mainViewProxy.view;throw new et}get camera(){if(this.appManager)return this.appManager.mainViewProxy.view.camera;throw new et}get cameraState(){if(this.appManager)return this.appManager.mainViewProxy.cameraState;throw new et}get apps(){var t;return(t=this.appManager)==null?void 0:t.store.apps()}get boxState(){var t;if(this.appManager)return(t=this.appManager.boxManager)==null?void 0:t.boxState;throw new et}get darkMode(){var t,e;return Boolean((e=(t=this.appManager)==null?void 0:t.boxManager)==null?void 0:e.darkMode)}get prefersColorScheme(){var t;if(this.appManager)return(t=this.appManager.boxManager)==null?void 0:t.prefersColorScheme;throw new et}get focused(){return this.attributes.focus}get focusedView(){var t,e;return((e=(t=this.appManager)==null?void 0:t.focusApp)==null?void 0:e.view)||this.mainView}get polling(){var t;return((t=this.appManager)==null?void 0:t.polling)||!1}set polling(t){this.appManager&&(this.appManager.polling=t)}get cursorStyle(){var t;return((t=this.cursorManager)==null?void 0:t.style)||"default"}set cursorStyle(t){if(!this.cursorManager)throw new Error("[WindowManager]: cursor is not enabled, please set { cursor: true }.");this.cursorManager.style=t}get mainViewSceneIndex(){var t;return((t=this._pageState)==null?void 0:t.index)||0}get mainViewSceneDir(){var t;if(this.appManager)return(t=this.appManager)==null?void 0:t.getMainViewSceneDir();throw new et}get topApp(){var t,e;return(e=(t=this.boxManager)==null?void 0:t.getTopBox())==null?void 0:e.id}get mainViewScenesLength(){var t;return((t=this._pageState)==null?void 0:t.length)||0}get canRedoSteps(){var t;return((t=this.focusedView)==null?void 0:t.canRedoSteps)||0}get canUndoSteps(){var t;return((t=this.focusedView)==null?void 0:t.canUndoSteps)||0}get sceneState(){if(this.appManager)return this.appManager.sceneState;throw new et}get pageState(){if(this._pageState)return this._pageState.toObject();throw new et}get fullscreen(){return Boolean(this._fullscreen)}get extendWrapper(){return B.extendWrapper}queryAll(){var t;return Array.from(((t=this.appManager)==null?void 0:t.appProxies.values())||[])}queryOne(t){var e;return(e=this.appManager)==null?void 0:e.appProxies.get(t)}async closeApp(t){var e;return(e=this.appManager)==null?void 0:e.closeApp(t)}focusApp(t){var i,n,r;const e=(i=this.boxManager)==null?void 0:i.getBox(t);e&&((n=this.boxManager)==null||n.focusBox({appId:t},!1),((r=this.boxManager)==null?void 0:r.teleBoxManager).makeBoxTop(e,!1))}moveCamera(t){var n;const e=b.omit(t,["animationMode"]),i={...this.mainView.camera};b.isEqual({...i,...e},i)||(this.mainView.moveCamera(t),(n=this.appManager)==null||n.dispatchInternalEvent(ne.MoveCamera,t),setTimeout(()=>{var r;(r=this.appManager)==null||r.mainViewProxy.setCameraAndSize()},500))}moveCameraToContain(t){var e;this.mainView.moveCameraToContain(t),(e=this.appManager)==null||e.dispatchInternalEvent(ne.MoveCameraToContain,t),setTimeout(()=>{var i;(i=this.appManager)==null||i.mainViewProxy.setCameraAndSize()},500)}convertToPointInWorld(t){return this.mainView.convertToPointInWorld(t)}setCameraBound(t){this.mainView.setCameraBound(t)}onDestroy(){this._destroy()}destroy(){this._destroy()}_destroy(){var t,e,i,n,r,s;(t=this.containerResizeObserver)==null||t.disconnect(),(e=this.appManager)==null||e.destroy(),(i=this.cursorManager)==null||i.destroy(),(n=this.extendPluginManager)==null||n.destroy(),this._destroyLaserPointerManager(),B.container=void 0,B.wrapper=void 0,B.sizer=void 0,B.isCreated=!1,B.playground&&((r=B.playground.parentNode)==null||r.removeChild(B.playground)),B.params=void 0,(s=this._iframeBridge)==null||s.destroy(),this._iframeBridge=void 0,it("Destroyed")}bindMainView(t,e){var i;this.appManager&&(this.appManager.bindMainView(t,Boolean(e)),(i=this.cursorManager)==null||i.setMainViewDivElement(t))}get canOperate(){return T.isRoom(this.displayer)?this.displayer.isWritable&&this.displayer.phase===T.RoomPhase.Connected:!1}get room(){return this.displayer}get appReadonly(){return B.appReadonly}setAppReadonly(t){B.appReadonly=t}safeSetAttributes(t){this.canOperate&&this.setAttributes(t)}safeUpdateAttributes(t,e){this.canOperate&&this.updateAttributes(t,e)}setPrefersColorScheme(t){var e,i;(i=(e=this.appManager)==null?void 0:e.boxManager)==null||i.setPrefersColorScheme(t)}cleanCurrentScene(){var t;it("clean current scene"),(t=this.focusedView)==null||t.cleanCurrentScene()}redo(){var t;return((t=this.focusedView)==null?void 0:t.redo())||0}undo(){var t;return((t=this.focusedView)==null?void 0:t.undo())||0}delete(){var t;(t=this.focusedView)==null||t.delete()}copy(){var t;(t=this.focusedView)==null||t.copy()}paste(){var t;(t=this.focusedView)==null||t.paste()}duplicate(){var t;(t=this.focusedView)==null||t.duplicate()}insertText(t,e,i){var n;return((n=this.focusedView)==null?void 0:n.insertText(t,e,i))||""}insertImage(t){var e;return(e=this.focusedView)==null?void 0:e.insertImage(t)}completeImageUpload(t,e){var i;return(i=this.focusedView)==null?void 0:i.completeImageUpload(t,e)}lockImage(t,e){var i;return(i=this.focusedView)==null?void 0:i.lockImage(t,e)}lockImages(t){var e;return(e=this.focusedView)==null?void 0:e.lockImages(t)}refresh(){var t;this._refresh(),(t=this.appManager)==null||t.dispatchInternalEvent(ne.Refresh)}_refresh(){var t,e;(t=this.appManager)==null||t.mainViewProxy.rebind(),B.container&&this.bindContainer(B.container),(e=this.appManager)==null||e.refresher.refresh()}setContainerSizeRatio(t){if(!b.isNumber(t)||!(t>0))throw new Error(`[WindowManager]: updateContainerSizeRatio error, ratio must be a positive number. but got ${t}`);B.containerSizeRatio=t,this.containerSizeRatio=t,R.emit("containerSizeRatioUpdate",t)}setScale(t,e){var r;if(!b.isNumber(e))return;let i=e;i<1&&(i=1);const n=(r=this.getScale())==null?void 0:r[t];i!==n&&(console.log(`${te} Scale Set`,{appId:t,newScale:i},b.isNumber(i),this.canOperate),this.safeUpdateAttributes([V.Scale,t],i))}_updateMainViewWrapperSize(t,e){var r;const i=(r=B.wrapper)==null?void 0:r.getBoundingClientRect();if(!i)return!1;const n=t!=null?t:this.getAttributesValue(V.Scale)[Vi];!B.mainViewWrapper||!B.mainViewWrapper||(B.mainViewWrapper.style.width=`${(i==null?void 0:i.width)*n}px`,B.mainViewWrapper.style.height=`${(i==null?void 0:i.height)*n}px`,e||this.readonly||Ks()||qs(),this.room.disableCameraTransform=!0,R.emit("wrapperSizeChange",B.mainViewWrapper.getBoundingClientRect()))}_setScale(t,e){var r;const{appId:i,scale:n}=t;return i==Vi?this._updateMainViewWrapperSize(n,e):R.emit("onScaleChange",{appId:i,scale:n}),(r=this.scrollerManager)==null||r.moveToCenter(i),!0}getScale(){return this.getAttributesValue([V.Scale])}setTeacherInfo(t){var e,i;(i=(e=this.appManager)==null?void 0:e.store)==null||i.setTeacherInfo(t)}get teacherInfo(){var t,e;return((e=(t=this.appManager)==null?void 0:t.store)==null?void 0:e.getTeacherInfo())||{}}setLaserPointer(t){var e;this.safeUpdateAttributes([V.LaserPointerActive],{active:t,uid:(e=this.appManager)==null?void 0:e.uid})}async _setLaserPointer(t){var e,i,n;if(!t){(e=this._laserPointerManager)==null||e.setLaserPointer(!1);const r=document.querySelectorAll(".netless-window-manager-cursor-mid");r==null||r.forEach(s=>{s.classList.add("force-none")});return}this._laserPointerManager||await this._initLaserPointerManager(),((i=this.teacherInfo)==null?void 0:i.uid)===this._getCurrentUserId()&&((n=this._laserPointerManager)==null||n.setLaserPointer(!0))}async _initLaserPointerManager(){if(console.log(`${te} Initializing LaserPointerMultiManager, existing:`,!!this._laserPointerManager),this._laserPointerManager){console.log(`${te} LaserPointerMultiManager already exists, skipping initialization`);return}if(this.room&&this.displayer&&this.appManager){const{LaserPointerManager:t}=await Promise.resolve().then(function(){return require("./index2.js")});this._laserPointerManager=new t(this),console.log(`${te} LaserPointerMultiManager created successfully`)}else console.warn(`${te} Cannot initialize LaserPointerMultiManager - missing dependencies`)}_getCurrentUserId(){var t,e,i,n;return(t=this.appManager)!=null&&t.uid?(n=(i=ws(this.room,(e=this.appManager)==null?void 0:e.uid))==null?void 0:i.payload)==null?void 0:n.uid:void 0}_destroyLaserPointerManager(){var t;(t=this._laserPointerManager)==null||t.destroy(),this._laserPointerManager=void 0}get isLaserPointerActive(){return this.getAttributesValue([V.LaserPointerActive]).active||!1}get container(){return B.container}getAppScale(t){return this.getAttributesValue([V.Scale])[t]}isDynamicPPT(t){var i,n;const e=(n=(i=t[0])==null?void 0:i.ppt)==null?void 0:n.src;return e==null?void 0:e.startsWith("pptx://")}async ensureAttributes(){if(b.isNull(this.attributes)&&await Qd(50),b.isObject(this.attributes)){if(this.attributes[V.Apps]||this.safeSetAttributes({[V.Apps]:{}}),this.attributes[V.Cursors]||this.safeSetAttributes({[V.Cursors]:{}}),this.attributes._mainScenePath||this.safeSetAttributes({_mainScenePath:Fd}),this.attributes._mainSceneIndex||this.safeSetAttributes({_mainSceneIndex:0}),this.attributes[V.Registered]||this.safeSetAttributes({[V.Registered]:{}}),this.attributes[V.IframeBridge]||this.safeSetAttributes({[V.IframeBridge]:{}}),this.attributes[V.MainViewBackgroundInfo]||this.safeSetAttributes({[V.MainViewBackgroundInfo]:{img:"",color:""}}),!this.attributes[V.Scale]){if(B.appReadonly||this.readonly)return;this.safeSetAttributes({[V.Scale]:{[Vi]:1}})}this.attributes[V.LaserPointerActive]||this.safeSetAttributes({[V.LaserPointerActive]:{active:!1,uid:""}})}}getIframeBridge(){if(!this.appManager)throw new Error("[WindowManager]: should call getIframeBridge() after await mount()");return this._iframeBridge||(this._iframeBridge=new Ni(this,this.appManager)),this._iframeBridge}useExtendPlugin(t){var e;(e=this.extendPluginManager)==null||e.use(t)}getBackground(){if(this.attributes[V.MainViewBackgroundInfo]){const t=this.attributes[V.MainViewBackgroundInfo];if(t.img.length>0)return{type:"img",value:t.img};if(t.color.length>0)return{type:"color",value:t.color}}}setBackgroundImg(t){this.safeUpdateAttributes([V.MainViewBackgroundInfo],{color:"",img:t})}setBackgroundColor(t){this.safeUpdateAttributes([V.MainViewBackgroundInfo],{color:t,img:""})}_setBackgroundColor(t){!B.mainViewWrapper||(B.mainViewWrapper.style.backgroundColor=t,B.mainViewWrapper.style.backgroundImage="unset")}_setBackgroundImg(t){!B.mainViewWrapper||(B.mainViewWrapper.style.backgroundImage=`url(${t})`,B.mainViewWrapper.style.backgroundColor="unset")}_initAttribute(){const t=this.attributes[V.MainViewBackgroundInfo];if(t&&t.img.length>0?this._setBackgroundImg(t.img):t&&t.color.length>0&&this._setBackgroundColor(t.color),this.attributes[V.Scale]){const e=this.attributes[V.Scale];Object.keys(e).forEach(i=>{this._setScale({appId:i,scale:e[i]},!0)})}if(this.attributes[V.LaserPointerActive]){const{active:e}=this.attributes[V.LaserPointerActive];this._setLaserPointer(e).catch(console.error)}}};let X=B;X.kind="WindowManager";X.debug=!1;X.containerSizeRatio=Zg;X.isCreated=!1;X.appReadonly=qs()||Ks();X._resolve=t=>{};mS();exports.AppCreateError=Gd;exports.AppManagerNotInitError=et;exports.AppNotRegisterError=mm;exports.BindContainerRoomPhaseInvalidError=eh;exports.BoxManagerNotFoundError=qd;exports.BoxNotCreatedError=Jd;exports.BuiltinApps=vS;exports.DomEvents=Pg;exports.ExtendPlugin=yS;exports.ExtendPluginManager=Bg;exports.IframeBridge=Ni;exports.IframeEvents=kg;exports.InvalidScenePath=Kd;exports.LaserPointerManager=IS;exports.ParamsInvalidError=Xd;exports.WhiteWebSDKInvalidError=Yd;exports.WindowManager=X;exports.calculateNextIndex=Il;exports.logFirstTag=te;exports.mainViewField=Vi;exports.reconnectRefresher=Dg;
//# sourceMappingURL=index.js.map
